(function(){var e={5358:function(e,t,a){var l={"./af":5177,"./af.js":5177,"./ar":1509,"./ar-dz":1488,"./ar-dz.js":1488,"./ar-kw":8676,"./ar-kw.js":8676,"./ar-ly":2353,"./ar-ly.js":2353,"./ar-ma":4496,"./ar-ma.js":4496,"./ar-ps":6947,"./ar-ps.js":6947,"./ar-sa":2682,"./ar-sa.js":2682,"./ar-tn":9756,"./ar-tn.js":9756,"./ar.js":1509,"./az":5533,"./az.js":5533,"./be":8959,"./be.js":8959,"./bg":7777,"./bg.js":7777,"./bm":4903,"./bm.js":4903,"./bn":1290,"./bn-bd":7357,"./bn-bd.js":7357,"./bn.js":1290,"./bo":1545,"./bo.js":1545,"./br":1470,"./br.js":1470,"./bs":4429,"./bs.js":4429,"./ca":7306,"./ca.js":7306,"./cs":6464,"./cs.js":6464,"./cv":3635,"./cv.js":3635,"./cy":4226,"./cy.js":4226,"./da":3601,"./da.js":3601,"./de":7853,"./de-at":6111,"./de-at.js":6111,"./de-ch":4697,"./de-ch.js":4697,"./de.js":7853,"./dv":708,"./dv.js":708,"./el":4691,"./el.js":4691,"./en-au":3872,"./en-au.js":3872,"./en-ca":8298,"./en-ca.js":8298,"./en-gb":6195,"./en-gb.js":6195,"./en-ie":6584,"./en-ie.js":6584,"./en-il":5543,"./en-il.js":5543,"./en-in":9033,"./en-in.js":9033,"./en-nz":9402,"./en-nz.js":9402,"./en-sg":3004,"./en-sg.js":3004,"./eo":2934,"./eo.js":2934,"./es":7650,"./es-do":838,"./es-do.js":838,"./es-mx":7730,"./es-mx.js":7730,"./es-us":6575,"./es-us.js":6575,"./es.js":7650,"./et":3035,"./et.js":3035,"./eu":3508,"./eu.js":3508,"./fa":119,"./fa.js":119,"./fi":527,"./fi.js":527,"./fil":5995,"./fil.js":5995,"./fo":2477,"./fo.js":2477,"./fr":5498,"./fr-ca":6435,"./fr-ca.js":6435,"./fr-ch":7892,"./fr-ch.js":7892,"./fr.js":5498,"./fy":7071,"./fy.js":7071,"./ga":1734,"./ga.js":1734,"./gd":217,"./gd.js":217,"./gl":7329,"./gl.js":7329,"./gom-deva":2124,"./gom-deva.js":2124,"./gom-latn":3383,"./gom-latn.js":3383,"./gu":5050,"./gu.js":5050,"./he":1713,"./he.js":1713,"./hi":3861,"./hi.js":3861,"./hr":6308,"./hr.js":6308,"./hu":609,"./hu.js":609,"./hy-am":7160,"./hy-am.js":7160,"./id":4063,"./id.js":4063,"./is":9374,"./is.js":9374,"./it":8383,"./it-ch":1827,"./it-ch.js":1827,"./it.js":8383,"./ja":3827,"./ja.js":3827,"./jv":9722,"./jv.js":9722,"./ka":1794,"./ka.js":1794,"./kk":7088,"./kk.js":7088,"./km":6870,"./km.js":6870,"./kn":4451,"./kn.js":4451,"./ko":3164,"./ko.js":3164,"./ku":8174,"./ku-kmr":6181,"./ku-kmr.js":6181,"./ku.js":8174,"./ky":8474,"./ky.js":8474,"./lb":9680,"./lb.js":9680,"./lo":5867,"./lo.js":5867,"./lt":5766,"./lt.js":5766,"./lv":9532,"./lv.js":9532,"./me":8076,"./me.js":8076,"./mi":1848,"./mi.js":1848,"./mk":306,"./mk.js":306,"./ml":3739,"./ml.js":3739,"./mn":9053,"./mn.js":9053,"./mr":6169,"./mr.js":6169,"./ms":3386,"./ms-my":2297,"./ms-my.js":2297,"./ms.js":3386,"./mt":7075,"./mt.js":7075,"./my":2264,"./my.js":2264,"./nb":2274,"./nb.js":2274,"./ne":8235,"./ne.js":8235,"./nl":2572,"./nl-be":3784,"./nl-be.js":3784,"./nl.js":2572,"./nn":4566,"./nn.js":4566,"./oc-lnc":9330,"./oc-lnc.js":9330,"./pa-in":9849,"./pa-in.js":9849,"./pl":4418,"./pl.js":4418,"./pt":9834,"./pt-br":8303,"./pt-br.js":8303,"./pt.js":9834,"./ro":4457,"./ro.js":4457,"./ru":2271,"./ru.js":2271,"./sd":1221,"./sd.js":1221,"./se":3478,"./se.js":3478,"./si":7538,"./si.js":7538,"./sk":5784,"./sk.js":5784,"./sl":6637,"./sl.js":6637,"./sq":6794,"./sq.js":6794,"./sr":5719,"./sr-cyrl":3322,"./sr-cyrl.js":3322,"./sr.js":5719,"./ss":6e3,"./ss.js":6e3,"./sv":1011,"./sv.js":1011,"./sw":748,"./sw.js":748,"./ta":1025,"./ta.js":1025,"./te":1885,"./te.js":1885,"./tet":8861,"./tet.js":8861,"./tg":6571,"./tg.js":6571,"./th":5802,"./th.js":5802,"./tk":9527,"./tk.js":9527,"./tl-ph":9231,"./tl-ph.js":9231,"./tlh":1052,"./tlh.js":1052,"./tr":5096,"./tr.js":5096,"./tzl":9846,"./tzl.js":9846,"./tzm":1765,"./tzm-latn":7711,"./tzm-latn.js":7711,"./tzm.js":1765,"./ug-cn":8414,"./ug-cn.js":8414,"./uk":6618,"./uk.js":6618,"./ur":158,"./ur.js":158,"./uz":7609,"./uz-latn":4856,"./uz-latn.js":4856,"./uz.js":7609,"./vi":1135,"./vi.js":1135,"./x-pseudo":4051,"./x-pseudo.js":4051,"./yo":2218,"./yo.js":2218,"./zh-cn":2648,"./zh-cn.js":2648,"./zh-hk":1632,"./zh-hk.js":1632,"./zh-mo":1541,"./zh-mo.js":1541,"./zh-tw":304,"./zh-tw.js":304};function s(e){var t=o(e);return a(t)}function o(e){if(!a.o(l,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return l[e]}s.keys=function(){return Object.keys(l)},s.resolve=o,e.exports=s,s.id=5358},2963:function(e,t,a){"use strict";var l=a(3751),s=(a(4114),a(7642),a(8004),a(3853),a(5876),a(2475),a(5024),a(1698),a(641)),o=a(953),n=a(33),i=a.p+"img/celli.2d8862ab.png",r=a(5220),c=a(6278);const u={I_CAS_STAT_ID_LIST:[{cd:"0",cdNm:"Empty"},{cd:"1",cdNm:"Ready"},{cd:"2",cdNm:"Analyzing"},{cd:"3",cdNm:"Complete"},{cd:"4",cdNm:"Error"},{cd:"9",cdNm:"Scan"}]},d=[{value:"01",text:"WBC Diff"},{value:"04",text:"PBS"},{value:"02",text:"Body fluid default"},{value:"03",text:"Body fluid select"}],m=[{value:"02",text:"BM smear"},{value:"03",text:"Touch print"},{value:"04",text:"BM biopsy"},{value:"05",text:"Clot section"}],v={SIZE:{CATEGORY_ID:"01",NORMAL:"01",MACROCYTE:"02",MICROCTYE:"03",ANISOCYTOSIS:"04"},CHROMIA:{CATEGORY_ID:"02",NORMAL:"01",HYPERCHROMIC:"02",HYPOCHROMIC:"03",POLYCHROMIA:"04"},SHAPE:{CATEGORY_ID:"03",NORMAL:"01",POLIKILOCYTOSIS:"02",TARGET_CELL:"03",BURR_CELL:"04",ACANTHOCYTE:"05",OVALOCYTE:"06",SCHISTOCYTE:"07",SICKLE_CELL:"08",STOMATOCYTE:"09",TEAR_DROP_CELL:"10",SPHEROCYTE:"11"},INCLUSION_BODY:{CATEGORY_ID:"05",HOWELL_JOLLY_BODY:"01",BASOPHILIC_STIPPLING:"02",MALARIA:"03"},OTHERS:{CATEGORY_ID:"04",PLATELET:"01"}},p=[v.SHAPE.NORMAL,v.SHAPE.POLIKILOCYTOSIS,v.SHAPE.TARGET_CELL,v.SHAPE.BURR_CELL,v.SHAPE.ACANTHOCYTE,v.SHAPE.OVALOCYTE,v.SHAPE.SCHISTOCYTE,v.SHAPE.SICKLE_CELL,v.SHAPE.STOMATOCYTE,v.SHAPE.TEAR_DROP_CELL,v.SHAPE.SPHEROCYTE];function g(e){if(!e)return"";const[t,a,l,s,o,n]=[e.substring(0,4),e.substring(4,6),e.substring(6,8),e.substring(8,10),e.substring(10,12),e.substring(12,14)];return`${t}-${a}-${l} ${s}:${o}:${n}`}const f=e=>{const t=d.find((t=>t.value===e));return t?t.text:""},y=e=>{const t=m.find((t=>t.value===e));return t?t.text:""},b=(e,t,a,l)=>{const s=window.APP_API_BASE_URL||"http://192.168.0.115:3002";return`${s}/images/imgQualityCdn?folder=${t+"/"+a+"/"+l+"/"}&imageName=${e}&quality=30`},I={UIMD:"0000",NONE:"","서울성모병원":"0002","스타고":"0003","이원의료재단":"0004","일산병원":"0005","고대안암병원":"0006","삼광의료재단":"0007","신촌세브란스병원":"0008","양산부산병원":"0009","녹십자의료재단":"0010","인하대병원":"0011","경북대학교병원":"0012","부산인제백병원":"0013","씨젠검사센터_부산":"0014","씨젠검사센터_대구":"0015","영남대학교":"0016","씨젠검사센터_서울":"0017","창원경상대학병원":"0018","인천길병원":"0019","충남대병원":"0020","인천성모병원":"0021","삼성서울병원":"0022","충북대병원":"0023","천안순천향병원":"0024","부산해운대백병원":"0025","건국대학교병원":"0026","광명중앙대학교병원":"0027","전북대학교병원":"0028","진주경상대병원":"0029","원주기독병원":"0030","SD의학연구소":"0031","강북삼성병원":"0032","원자력병원":"0033","고대구로병원":"0034","국립암센터":"0035","대구카톨릭병원":"0036","츠쿠바":"0099"},C={class:"processInfoUl"},h={class:"proVal"},k={class:"proVal"},S={class:"proVal"},w={class:"proVal"},N={class:"proSpan"},R={class:"proVal"},L={class:"proVal"},E={class:"proVal"},_={class:"proVal"},P={class:"proSpan"},T={class:"proVal"};var A=(0,s.pM)({__name:"processInfo",props:["parsedData"],setup(e){const t=e,a=(0,c.Pj)(),l=(0,s.EW)((()=>a.state.embeddedStatusModule)),i=(0,s.EW)((()=>a.state.commonModule.siteCd)),r=(0,o.KR)({}),u=(0,o.KR)(null),d=((0,s.nI)(),(0,o.KR)(!1)),m=(0,o.KR)(""),v=(0,o.KR)("");(0,s.wB)([l.value],(async e=>{if(e.length>0){const t=e[0].sysInfo;t.oilCount!==u.value&&(r.value.oilCount=t.oilCount,u.value=t.oilCount),m.value=t.currentCardCount,v.value=t.currentCardName}})),(0,s.sV)((()=>{u.value=l.value[0]?.sysInfo.oilCount,d.value="bm"===window.PROJECT_TYPE})),(0,s.wB)((()=>t.parsedData),((e,t)=>{p(e)}),{deep:!0});const p=async e=>{const t=e;if("RUNNING_INFO"===t.jobCmd){const e=t?.slotInfo;e&&(r.value={cassetteNo:t.cassetId??"",barcodeId:e.barcodeNo,patientId:e.patientId,patientName:e.patientNm,orderDate:g(e.orderDttm),analyzedDttm:g(e.analyzedDttm)})}};return(e,t)=>((0,s.uX)(),(0,s.CE)("div",null,[t[11]||(t[11]=(0,s.Lk)("h3",{class:"titleText"},"Processing Information ",-1)),(0,s.Lk)("ul",C,[(0,s.Lk)("li",null,[t[0]||(t[0]=(0,s.Lk)("span",{class:"proSpan"},"Cassette No",-1)),t[1]||(t[1]=(0,s.eW)()),(0,s.Lk)("span",h,(0,n.v_)(r.value?.cassetteNo),1)]),(0,s.Lk)("li",null,[t[2]||(t[2]=(0,s.Lk)("span",{class:"proSpan"},"Barcode ID",-1)),t[3]||(t[3]=(0,s.eW)()),(0,s.Lk)("span",k,(0,n.v_)(r.value?.barcodeId),1)]),(0,s.Lk)("li",null,[t[4]||(t[4]=(0,s.Lk)("span",{class:"proSpan"},"Patient ID",-1)),t[5]||(t[5]=(0,s.eW)()),(0,s.Lk)("span",S,(0,n.v_)(r.value?.patientId),1)]),(0,s.Lk)("li",null,[t[6]||(t[6]=(0,s.Lk)("span",{class:"proSpan"},"Patient Name",-1)),t[7]||(t[7]=(0,s.eW)()),(0,s.Lk)("span",w,(0,n.v_)(r.value?.patientName),1)]),(0,s.Lk)("li",null,[(0,s.Lk)("span",N,(0,n.v_)(d.value?"BM CELL Count ":"WBC Count "),1),(0,s.Lk)("span",R,(0,n.v_)(r.value?.wbcCount),1)]),(0,s.Lk)("li",null,[(0,o.R1)(I)["인천길병원"]===i.value?((0,s.uX)(),(0,s.CE)(s.FK,{key:0},[t[8]||(t[8]=(0,s.Lk)("span",{class:"proSpan"},"Order Date",-1)),(0,s.Lk)("span",L,(0,n.v_)(r.value?.analyzedDttm),1)],64)):((0,s.uX)(),(0,s.CE)(s.FK,{key:1},[t[9]||(t[9]=(0,s.Lk)("span",{class:"proSpan"},"Analyzed Date",-1)),(0,s.Lk)("span",E,(0,n.v_)(r.value?.orderDate),1)],64))]),(0,s.Lk)("li",null,[t[10]||(t[10]=(0,s.Lk)("span",{class:"proSpan"},"Oil Count",-1)),(0,s.Lk)("span",_,(0,n.v_)(u.value),1)]),(0,s.Lk)("li",null,[(0,s.Lk)("span",P,(0,n.v_)(v.value),1),(0,s.Lk)("span",T,(0,n.v_)(m.value),1)])])]))}});const M=A;var D=M;const x=[{value:"100",text:"100 WBC"},{value:"150",text:"150 WBC"},{value:"200",text:"200 WBC"},{value:"250",text:"250 WBC"},{value:"300",text:"300 WBC"},{value:"350",text:"350 WBC"},{value:"400",text:"400 WBC"},{value:"450",text:"450 WBC"},{value:"500",text:"500 WBC"}],O=[{value:"100",text:"100"},{value:"200",text:"200"},{value:"300",text:"300"},{value:"400",text:"400"},{value:"500",text:"500"},{value:"600",text:"600"},{value:"700",text:"700"},{value:"800",text:"800"},{value:"900",text:"900"},{value:"1000",text:"1000"},{value:"1100",text:"1100"},{value:"1200",text:"1200"},{value:"1300",text:"1300"},{value:"1400",text:"1400"},{value:"1500",text:"1500"}],K=[{value:"1",text:"1 stitch"},{value:"2",text:"2 stitch"},{value:"3",text:"3 stitch"},{value:"4",text:"4 stitch"},{value:"5",text:"5 stitch"}],B={INPUT:[{slotNo:1,slotState:"0"},{slotNo:2,slotState:"0"},{slotNo:3,slotState:"0"},{slotNo:4,slotState:"0"},{slotNo:5,slotState:"0"},{slotNo:6,slotState:"0"},{slotNo:7,slotState:"0"},{slotNo:8,slotState:"0"},{slotNo:9,slotState:"0"},{slotNo:10,slotState:"0"},{slotNo:11,slotState:"0"},{slotNo:12,slotState:"0"}],OUTPUT:[{slotNo:1,slotState:"0"},{slotNo:2,slotState:"0"},{slotNo:3,slotState:"0"},{slotNo:4,slotState:"0"},{slotNo:5,slotState:"0"},{slotNo:6,slotState:"0"},{slotNo:7,slotState:"0"},{slotNo:8,slotState:"0"},{slotNo:9,slotState:"0"},{slotNo:10,slotState:"0"},{slotNo:11,slotState:"0"},{slotNo:12,slotState:"0"}]},F={INPUT:[{slotNo:1,slotState:"0"},{slotNo:2,slotState:"0"},{slotNo:3,slotState:"0"},{slotNo:4,slotState:"0"},{slotNo:5,slotState:"0"},{slotNo:6,slotState:"0"},{slotNo:7,slotState:"0"},{slotNo:8,slotState:"0"},{slotNo:9,slotState:"0"},{slotNo:10,slotState:"0"}],OUTPUT:[{slotNo:1,slotState:"0"},{slotNo:2,slotState:"0"},{slotNo:3,slotState:"0"},{slotNo:4,slotState:"0"},{slotNo:5,slotState:"0"},{slotNo:6,slotState:"0"},{slotNo:7,slotState:"0"},{slotNo:8,slotState:"0"},{slotNo:9,slotState:"0"},{slotNo:10,slotState:"0"}]};var U;(function(e){e["LOGOUT"]="Would you like to log out?",e["IDS_MSG_SUCCESS"]="Success",e["IDS_ERROR_NOT_MATCHED_PASSWORD"]="Passwords do not match.",e["IDS_ERROR_SIGINUP"]="Please check the input field.",e["IDS_ERROR_SIGINUP_ALREADY_ID"]="ID already registered.",e["IDS_ERROR_LOGIN_ERROR"]="Please check your ID and password.",e["IDS_ERROR_LOGIN_ID"]="Please check your Login ID.",e["IDS_ERROR_ALREADY_RUNNING"]="Process is already running.",e["IDS_ERROR_STOP_PROCESS"]="Process is terminating.",e["IDS_ERROR_INIT_ERROR"]="Please initialize.",e["IDS_ERROR_CHECK_REQUIRED_FIELDS"]="Please check required fields",e["IDS_ERROR_CHECK_SLOT_NO"]="Please check the slot number.",e["IDS_ERROR_FAVORITE_MAX_REGIST"]="Up to 5 favorites can be registered.",e["IDS_ERROR_FAVORITE_MAX_REGIST2"]="Up to 12 favorites can be registered.",e["IDS_ERROR_ENTER_YOUR_ORDER_DETAILS"]="Please enter your order details.",e["IDS_ERROR_SELECT_A_TARGET_ITEM"]="Please select items",e["IDS_ERROR_PLEASE_SELECT_AN_IMAGE"]="Please select an image.",e["IDS_ERROR_ALREADY_ADDED"]="This item has already been added.",e["IDS_ERROR_ADD_A_WORKLIST"]="Please add a worklist",e["IDS_ERROR_NO_TEST_RESULTS"]="There are no test results.",e["IDS_ERROR_FILE_CLISSIFICATION"]="File classification error",e["IDS_ERROR_ENTER_CLASS_INFO"]="Please enter class information",e["IDS_ERROR_PLEASE_CONFIRM_YOUR_USER_ID"]="Please confirm your user ID.",e["IDS_SIGNED_ITEMS_CANNOT_BE_MODIFIED"]="Signed items cannot be modified.",e["IDS_RECOVER_GRIPPER_CONDITION"]="Would you like to recover the gripper condition?",e["IDS_PLEASE_ENTER_END_DATE"]="Please enter the end date.",e["IDS_PLEASE_ENTER_START_DATE"]="Please enter the start date.",e["IDS_THE_MAXIMUM_INQUIRY_DATE_IS_31_DAYS"]="The maximum inquiry date is 31 days.",e["IDS_START_DATE_IS_NOT_GREATER_THEN_END_DATE"]="Start date is not greater than end date.",e["IDS_RESTART_SYSTEM"]="A new version has been downloaded. Please restart the application to apply the update.",e["IDS_PLEASE_ENTER_YOUR_BARCODE_NUMBER"]="Please enter your barcode number",e["IDS_BARCODE_REGISTRATION_SUCCESSFUL"]="Barcode registration successful",e["IDS_THIS_IS_A_DUPLICATION_ABBREVIATION"]="This is a duplicate abbreviation.",e["IDS_MSG_UPLOAD_LIS"]="Upload current results to LIS",e["IDS_MSG_SUBMIT_SLIDE"]="Submit slide",e["IDS_MSG_CONFIRM_SLIDE"]="Confirm slide",e["IDS_PLEASE_SELECT_A_CLASS"]="Please select a class",e["IDS_PLEASE_SELECT_A_BACKUP_DATE"]="Please select a backup date.",e["IDS_PLEASE_SELECT_A_BACKUP_PATH"]="Please select a backup path.",e["IDS_PLEASE_SELECT_A_BACKUP_FILE"]="Please select a backup file.",e["IDS_NO_DATA_FOUND"]="No data found.",e["IDS_MSG_DATA_BACKUP"]="Data from that period will be deleted. Would you like to proceed?",e["IDS_MSG_DATA_RESTORE"]="Do you want to recover your data?",e["IDS_MSG_SIZE_CHROMIA_LINKED_LIS"]="Size and Chromia categories are linked with LIS data.",e["UPLOAD_PLEASE_LIS"]="To upload the LIS, please enter the content in the LIS File Path field under the LIS(CBC) Hot Key & File Path tab in the settings page and save it.",e["UPLOAD_PLEASE_CBC"]="To load CBC, please enter the content in the CBC File Path field under the LIS(CBC) Hot Key & File Path tab in the settings page and save it.",e["UPDATE_SUCCESSFULLY"]="Update Successfully",e["TCP_DiSCONNECTED"]="The TCP connection was disconnected.",e["alreadyInitialized"]="It has already been initialized.",e["lockRow"]="Deletion is not allowed when locked.",e["exit"]="Are you sure you want to quit the program?",e["settingSaveSuccess"]="Saved successfully",e["settingSaveFailure"]="Save failed",e["settingUpdateSuccess"]="Updated successfully",e["settingUpdateFailure"]="Update failed",e["settingNotSaved"]="Setting not saved",e["SAVE"]="Save",e["LEAVE"]="Leave",e["CANCEL"]="Cancel",e["CLOSE"]="Close",e["COPY"]="Copy",e["MOVE"]="Move",e["DELETE"]="Delete",e["UPLOAD"]="Upload",e["OK"]="Ok",e["FULLSCREEN_SUGGEST"]="Please click the full screen button.",e["TOAST_MSG_SUCCESS"]="success",e["TOAST_MSG_ERROR"]="error",e["TOAST_MSG_BAR_CODE_SUCCESS"]="Barcode Copied",e["SETTING_INFO_DOWNLOAD_SAVE_PATH_EN"]="Destination path for download and Origin path for upload",e["SETTING_INFO_DOWNLOAD_SAVE_PATH_KO"]="다운로드 시 저장 경로 & 업로드 시 백업 파일 경로",e["SETTING_INFO_UPLOAD_EN"]="",e["SETTING_INFO_UPLOAD_KO"]="Download Save Path에서 업로드할 폴더 선택 & 데이터 업로드 폴더 경로 선택",e["SETTING_INFO_DOWNLOAD_EN"]="",e["SETTING_INFO_DOWNLOAD_KO"]="다운로드 받을 날짜 선택 & copy: 다른 컴퓨터로 이동시킬때 사용(데이터 복사)",e["SETTING_INFO_KEEP_PAGE_EN"]="Keep page when moving in Database detail page by up, down arrows",e["SETTING_INFO_KEEP_PAGE_KO"]="데이터베이스 상세 페이지에서 검체 이동 시 보고 있는 탭 유지",e["SETTING_INFO_ALARM_TIME_EN"]="",e["SETTING_INFO_ALARM_TIME_KO"]="알람 켜기/끄기 & 타이머(초) 선택",e["SETTING_INFO_NS_NB_INTEGRATION_EN"]="",e["SETTING_INFO_NS_NB_INTEGRATION_KO"]="ON일 경우 Neutrophil-Segment, Neutrophil-Band 를 Neutrophil로 합쳐서 검사",e["SETTING_INFO_IA_ROOT_PATH_EN"]="Data Save Path",e["SETTING_INFO_IA_ROOT_PATH_KO"]="검체 데이터 저장 경로 및 다운로드 진행 시 시작 경로",e["SETTING_INFO_COMMON"]="",e["SETTING_INFO_BF_ANALYSIS_VALUES"]="",e["SETTING_INFO_PBS_ANALYSIS_VALUES"]="",e["SETTING_INFO_WBC_DIFF_ANALYSIS_VALUES"]="",e["SETTING_INFO_ANALYSIS_TYPE"]=""})(U||(U={}));const X={TOOLTIP:{BARCODE_COPY:"Copy barcodeNo",MEMO:"Memo On/Off",CONFIRM:"Confirm",CLASS_MOVE:"Class Drag movement Lock/Unlock",LIS_UPLOAD:"Upload LIS",COUNT_PERCENT:"Count   Percent",IA_ROOT_PATH:"Analysis Data Save Path",NS_NB_INTEGRATION:"Integrate (Neutrophil-Segment & Neutrophil-Band) to Neutrophil",ALARM:"Alarm & Alarm Timer On/Off",KEEP_PAGE:"Maintain page state when navigating",DOWNLOAD_SAVE_PATH:"Download Save Path & Upload Data Path",DOWNLOAD:"1. Select the date for download\n2. Click 'Copy' to back up the data or 'Move' to change the storage location.",UPLOAD:"Select Upload Destination Path",OPEN_DOWNLOAD_SAVE_PATH:"Open Download Save Path",LIS_UPLOAD_CHECK:"Show LIS Upload Button after viewing all cell"},TOAST:{SUCCESS:"success",ERROR:"error",BARCODE_COPIED:"Barcode Copied"},ERROR:{SETTING_SAVE:"Save failed",SETTING_UPDATE:"Update failed",SETTING_NOT_SAVE:"Setting not saved"},SUCCESS:{SETTING_SAVE:"Saved successfully",SETTING_UPDATE:"Updated successfully"},SYSTEM:{PROCESS_ALREADY_RUNNING:"Process is already running.",STOP_PROCESS:"Process is terminating."}};var $=a(5093),W=a.n($);a(4743);function H(){const e=W()(),t=e.format("YYYYMMDDHHmm");return t}const G=e=>{if(!e)return null;const t=W()(e,"YYYY-MM-DD HH:mm:ss");return t.format("YYYY-MM-DD HH:mm:ss")};function Y(){const e=W()(),t=e.format("YYYYMMDDHHmmssSSSSS");return t}const V=e=>{if(!e)return null;const t=W()(e,"YYYYMMDDHHmmssSSSSS");return t.format("YYYY-MM-DD HH:mm:ss")},j=e=>{const t=Math.floor(e/3600),a=Math.floor(e%3600/60),l=Math.floor(e%3600%60);return`${Q(t,2)}:${Q(a,2)}:${Q(l,2)}`},Q=(e,t)=>String(e).padStart(t,"0"),q=e=>{const t=e.getFullYear(),a=(e.getMonth()+1).toString().padStart(2,"0"),l=e.getDate().toString().padStart(2,"0");return`${t}-${a}-${l}`},J=()=>{const e=H(),t=Y();return{embedStatus:{start:{jobCmd:"START",reqUserId:"",testType:"",wbcCount:"",reqDttm:e},startAction:{jobCmd:"START",reqUserId:"",testType:"01",wbcCount:"",stitchCount:"",runningMode:"00",positionMargin:"0",wbcPositionMargin:"0",pltPositionMargin:"0",reqDttm:e},init:{jobCmd:"INIT",reqUserId:"",reqDttm:e},restart:{jobCmd:"RESTART",reqUserId:"",reqDttm:e,bfSelectFiles:[]},stop:{jobCmd:"STOP",reqUserId:"",reqDttm:e,isEmergency:"N",isUserStop:"Y"},end:{jobCmd:"END",reqUserId:"",testType:"",wbcCount:"",reqDttm:e},runningInfo:{jobCmd:"RUNNING_INFO",reqUserId:"",reqDttm:e},sysInfo:{jobCmd:"SYSINFO",reqUserId:"",reqDttm:e},pause:{jobCmd:"PAUSE",reqUserId:"",reqDttm:e},runIngComp:{jobCmd:"RUNNING_COMP",reqUserId:"",reqDttm:e},recovery:{jobCmd:"RECOVERY",reqUserId:"",reqDttm:e},settings:{jobCmd:"SETTINGS",reqUserId:"",reqDttm:e,saveReqDttm:t,pbiaRootDir:"D:/IA_Proc",oilCount:"",isOilReset:"",deviceType:"01",isNsNbIntegration:""},oilPrime:{jobCmd:"OIL_PRIME",reqUserId:"",reqDttm:e},gripperOpen:{jobCmd:"GRIPPER_OPEN",reqUserId:"",reqDttm:e},cameraReset:{jobCmd:"CAMERA_RESET",reqUserId:"",reqDttm:e},exit:{jobCmd:"clientExit",reqUserId:"",reqDttm:e},searchCardCount:{jobCmd:"SEARCH_CARD_COUNT",reqUserId:"",reqDttm:e,testType:""},errorClear:{jobCmd:"ERROR_CLEAR",reqUserId:"",reqDttm:e}}}};var z=a(4335);function Z(){let e=window.APP_API_BASE_URL||"http://192.168.0.131:3002";const t=async(e,t,l)=>a(e.endpoint,t,l),a=async(t,a,l,s)=>{const o={headers:{"Content-Type":"application/json; charset=UTF-8","Cache-Control":"public, max-age=3600"}};z.A.defaults.withCredentials=!0;const n=a?l?"?":"/":"";a=a||"","viewer"===s&&(e=window.MAIN_API_IP);try{const l=await z.A.get(`${e}/${t}${n}${a}`,o);return Promise.resolve(l.data||{code:500,data:void 0,success:!1})}catch(i){return Promise.reject(i)}},l=async(e,t,a,l=!1,o)=>s(e.endpoint,t,a,l,o),s=async(t,a,l,s=!1,o)=>{const n={headers:{"Content-Type":"application/json; charset=UTF-8"}};"blob"===l&&(n.responseType="blob"),"text/plain"===l&&(n.headers={"Content-Type":"text/plain"}),s&&(n.headers={"Content-Type":"multipart/form-data"}),z.A.defaults.withCredentials=!0,"viewer"===o&&(e=window.MAIN_API_IP);try{const l=await z.A.post(`${e}/${t}`,a,n);return Promise.resolve(l.data||{code:500,data:void 0,success:!1})}catch(i){return Promise.reject(i)}},o=async(e,t,a,l)=>n(e.endpoint,t,a,l),n=async(t,a,l,s)=>{const o={headers:{"Content-Type":"application/json; charset=UTF-8","Cache-Control":"no-cache"}};z.A.defaults.withCredentials=!0;const n=l?s?"?":"/":"";l=l||"";try{const s=await z.A.put(`${e}/${t}${n}${l}`,a,o);return Promise.resolve(s.data||{code:500,data:void 0,success:!1})}catch(i){return Promise.reject(i)}},i=async(e,t,a)=>r(e.endpoint,t,a),r=async(t,a,l)=>{const s={headers:{"Content-Type":"application/json; charset=UTF-8","Cache-Control":"no-cache"}};z.A.defaults.withCredentials=!0;const o=l?"?":"/";try{const l=await z.A.delete(`${e}/${t}${o}`,{...s,data:a});return Promise.resolve(l.data||{code:500,data:void 0,success:!1})}catch(n){return Promise.reject(n)}};return{httpGet:t,httpGetAct:a,httpPost:l,httpPostAct:s,httpPut:o,httpPutAct:n,httpDelete:i,httpDeleteAct:r}}const ee={lisSend:{ywmcCbcCheck:{endpoint:"sybase/cbc-results",requiresToken:!1},ywmcLisPostSend:{endpoint:"sybase/save-uimd-result",requiresToken:!1},saveComment:{endpoint:"sybase/saveComment",requiresToken:!1},cbcImgGet:{endpoint:"sybase/cbcImgGet",requiresToken:!1}},auth:{refresh:{endpoint:"/auth/refresh",requiresToken:!1}},processInfo:{list:{endpoint:"proinfo/getAllProcessInfo",requiresToken:!1}},rbcclassification:{list:{endpoint:"rbc/getAllRbc",requiresToken:!1}},wbcclassification:{list:{endpoint:"wbc/getAllWbc",requiresToken:!1}},user:{register:{endpoint:"user/register",requiresToken:!1},login:{endpoint:"user/login",requiresToken:!1},logout:{endpoint:"user/logout",requiresToken:!1},userCheck:{endpoint:"user",requiresToken:!1},getUsers:{endpoint:"user/getUsers",requiresToken:!1},userDataPut:{endpoint:"user/update",requiresToken:!1},deleteUser:{endpoint:"user/delete",requiresToken:!1}},settings:{cellImgAnalyzedPost:{cellImgAdd:{endpoint:"cellImgAnalyzed/cellImgAdd",requiresToken:!1},cellImgGet:{endpoint:"cellImgAnalyzed",requiresToken:!1},cellImgPut:{endpoint:"cellImgAnalyzed/update",requiresToken:!1}},rbcDegree:{rbcDegreeAdd:{endpoint:"rbcDegree/rbcDegreeAdd",requiresToken:!1},rbcDegree:{endpoint:"rbcDegree",requiresToken:!1}},wbcCustomClass:{create:{endpoint:"wbcCustomClass/wbcCustomClassCreate",requiresToken:!1},update:{endpoint:"wbcCustomClass/wbcCustomClassUpdate",requiresToken:!1},get:{endpoint:"wbcCustomClass/wbcCustomClassGet",requiresToken:!1}},wbcHotKeys:{create:{endpoint:"wbcHotKeys/wbcHotKeysCreate",requiresToken:!1},update:{endpoint:"wbcHotKeys/wbcHotKeysUpdate",requiresToken:!1},get:{endpoint:"wbcHotKeys/wbcHotKeysGet",requiresToken:!1}},bfHotKeys:{create:{endpoint:"bfHotKeys/create",requiresToken:!1},update:{endpoint:"bfHotKeys/update",requiresToken:!1},get:{endpoint:"bfHotKeys/get",requiresToken:!1}},normalRange:{create:{endpoint:"normalRange/create",requiresToken:!1},update:{endpoint:"normalRange/update",requiresToken:!1},get:{endpoint:"normalRange/normalRangeGet",requiresToken:!1}},imagePrint:{create:{endpoint:"imagePrint/create",requiresToken:!1},update:{endpoint:"imagePrint/update",requiresToken:!1},get:{endpoint:"imagePrint/get",requiresToken:!1}},lisCode:{create:{endpoint:"lisCode/lisCodeCreate",requiresToken:!1},update:{endpoint:"lisCode/lisCodeUpdate",requiresToken:!1},get:{endpoint:"lisCode/lisCodeGet",requiresToken:!1}},lisCodeRbc:{create:{endpoint:"lisCodeRbc/lisCodeRbcCreate",requiresToken:!1},update:{endpoint:"lisCodeRbc/lisCodeRbcUpdate",requiresToken:!1},get:{endpoint:"lisCodeRbc/lisCodeRbcGet",requiresToken:!1}},cbcCode:{create:{endpoint:"cbcCode/cbcCodeCreate",requiresToken:!1},update:{endpoint:"cbcCode/cbcCodeUpdate",requiresToken:!1},get:{endpoint:"cbcCode/cbcCodeGet",requiresToken:!1}},filePathSet:{create:{endpoint:"filePathSet/filePathSetCreate",requiresToken:!1},update:{endpoint:"filePathSet/filePathSetUpdate",requiresToken:!1},get:{endpoint:"filePathSet/filePathSetGet",requiresToken:!1}},runCount:{create:{endpoint:"runCount/create",requiresToken:!1},update:{endpoint:"runCount/update",requiresToken:!1},get:{endpoint:"runCount/get",requiresToken:!1}},minCount:{create:{endpoint:"minCount/minCountCreate",requiresToken:!1},update:{endpoint:"minCount/minCountUpdate",requiresToken:!1},get:{endpoint:"minCount/minCountGet",requiresToken:!1}},runningInfo:{create:{endpoint:"runningInfo/create",requiresToken:!1},update:{endpoint:"runningInfo/update",requiresToken:!1},get:{endpoint:"runningInfo/getAll",requiresToken:!1},delete:{endpoint:"runningInfo/delete",requiresToken:!1},detail:{endpoint:"runningInfo/detail",requiresToken:!1},classInfoDetail:{endpoint:"runningInfo/classInfoDetail",requiresToken:!1},classInfoDetailSelectQuery:{endpoint:"runningInfo/classInfoDetailSelectQuery",requiresToken:!1},classInfoMenuDetailSelectQuery:{endpoint:"runningInfo/classInfoMenuDetailSelectQuery",requiresToken:!1},pageUpDown:{endpoint:"runningInfo/pageUpDown",requiresToken:!1},updatePcIpState:{endpoint:"runningInfo/updatePcIpState",requiresToken:!1},clearPcIpState:{endpoint:"runningInfo/clearPcIpState",requiresToken:!1},removePageAllData:{endpoint:"runningInfo/removePageAllData",requiresToken:!1}},folder:{get:{endpoint:"folder/drives",requiresToken:!1}},folders:{get:{endpoint:"folders",requiresToken:!1}},classOrder:{create:{endpoint:"classOrders/classOrdersCreate",requiresToken:!1},update:{endpoint:"classOrders/classOrdersUpdate",requiresToken:!1},get:{endpoint:"classOrders/classOrdersGet",requiresToken:!1}},remainingCount:{get:{endpoint:"remaining-count/execute",requiresToken:!1}},qualityCheck:{get:{endpoint:"qualityCheck/execute",requiresToken:!1}},crc:{crcSettingCreate:{endpoint:"crc-setting",requiresToken:!1},crcGet:{endpoint:"crc-setting/crc-get",requiresToken:!1},crcPut:{endpoint:"crc-setting/crc-put",requiresToken:!1},crcDel:{endpoint:"crc-setting/crcDel",requiresToken:!1}}},images:{move:{endpoint:"images/move",requiresToken:!1},moveClassImage:{endpoint:"images/moveClassImage",requiresToken:!1}},jsonReader:{get:{endpoint:"jsonReader/send",requiresToken:!1},jsonCreate:{endpoint:"jsonReader/upload",requiresToken:!1}},dziReader:{get:{endpoint:"dzi/send",requiresToken:!1}},pdf:{post:{endpoint:"pdf/generate",requiresToken:!1}},filesystem:{post:{endpoint:"filesystem/create-folder",requiresToken:!1},copy:{endpoint:"filesystem/copy",requiresToken:!1},cleanup:{endpoint:"filesystem/cleanup",requiresToken:!1},existsFile:{endpoint:"filesystem/existsFile",requiresToken:!1},fileSearch:{endpoint:"filesystem/fileSearch",requiresToken:!1},delete:{endpoint:"filesystem/delete-folder",requiresToken:!1},readGetJpg:{endpoint:"file/check-file-exists",requiresToken:!1},createDirectory:{endpoint:"file/create-directory",requiresToken:!1},fileCreate:{endpoint:"file/createFile",requiresToken:!1},cbcSaveData:{endpoint:"file/cbcSaveData",requiresToken:!1},errLogsRead:{endpoint:"filesystem/errLogsRead",requiresToken:!1}},fileTxtRead:{get:{endpoint:"file/read",requiresToken:!1},readFileEUCKR:{endpoint:"file/readFileEUCKR",requiresToken:!1}},H7Read:{post:{endpoint:"hl7/parse",requiresToken:!1}},H7Message:{post:{endpoint:"hl7/message",requiresToken:!1},noFlagHl7:{endpoint:"hl7/noFlagMessage",requiresToken:!1}},H7MessageCustom:{post:{endpoint:"hl7/customMessage",requiresToken:!1}},Hl7Create:{post:{endpoint:"hl7/hl7Create",requiresToken:!1}},device:{getDeviceInfo:{create:{endpoint:"device/create",requiresToken:!1},get:{endpoint:"device/get",requiresToken:!1},ip:{endpoint:"ip",requiresToken:!1}},updateDeviceInfo:{endpoint:"device/put",requiresToken:!1}},download:{backUpDate:{endpoint:"download/post",requiresToken:!1},checkIsPossibleToBackup:{endpoint:"download/check",requiresToken:!1},openDrive:{endpoint:"download/openDrive",requiresToken:!1}},upload:{restoreData:{endpoint:"upload/execute",requiresToken:!1},checkDuplicated:{endpoint:"upload/checkDuplicatedData",requiresToken:!1},checkPossibleUploadFile:{endpoint:"upload/checkPossibleUploadFile",requiresToken:!1}},excel:{execute:{endpoint:"excel/execute",requiresToken:!1}},browser:{exit:{endpoint:"browser/close-edge",requiresToken:!1},nodeExit:{endpoint:"browser/close-node",requiresToken:!1}},img:{checkImageExists:{endpoint:"images/checkImageExists",requiresToken:!1}},report:{crcRemarkCreate:{endpoint:"crc-remark-setting/crcRemarkCreate",requiresToken:!1},crcRemarkFindAll:{endpoint:"crc-remark-setting/crcRemarkFindAll",requiresToken:!1},crcRemarkRemove:{endpoint:"crc-remark-setting/crcRemarkRemove",requiresToken:!1},crcRemarkUpdate:{endpoint:"crc-remark-setting/crcRemarkUpdate",requiresToken:!1},crcSearch:{endpoint:"crc-remark-setting/crcRemark",requiresToken:!1},crcDataCreate:{endpoint:"crc-data-setting/crcDataCreate",requiresToken:!1},crcDataFindAll:{endpoint:"crc-data-setting/crcDataDFindAll",requiresToken:!1},crcDataRemove:{endpoint:"crc-data-setting/crcDataRemove",requiresToken:!1},crcDataUpdate:{endpoint:"crc-data-setting/crcDataUpdate",requiresToken:!1},crcOptionGet:{endpoint:"crc-option/crcOptionGet",requiresToken:!1},crcOptionCreate:{endpoint:"crc-option/crcOptionCreate",requiresToken:!1},crcOptionUpdate:{endpoint:"crc-option/crcOptionUpdate",requiresToken:!1},crcRecoCreate:{endpoint:"crc-recommendation-setting/crcRecommendationCreate",requiresToken:!1},crcRecoFindAll:{endpoint:"crc-recommendation-setting/crcRecommendationFindAll",requiresToken:!1},crcRecoRemove:{endpoint:"crc-recommendation-setting/crcRecommendationRemove",requiresToken:!1},crcRecoUpdate:{endpoint:"crc-recommendation-setting/crcRecommendationUpdate",requiresToken:!1},crcRecoSearch:{endpoint:"crc-recommendation-setting/crcRSearch",requiresToken:!1},crcCommentCreate:{endpoint:"crc-comment-setting/crcCommentCreate",requiresToken:!1},crcCommentFindAll:{endpoint:"crc-comment-setting/crcCommentFindAll",requiresToken:!1},crcCommentRemove:{endpoint:"crc-comment-setting/crcCommentRemove",requiresToken:!1},crcCommentUpdate:{endpoint:"crc-comment-setting/crcCommentUpdate",requiresToken:!1},crcCommentSearch:{endpoint:"crc-comment-setting/crcCommentSearch",requiresToken:!1},saveDataCreate:{endpoint:"crc-save-data/saveDataCreate",requiresToken:!1},saveDataSlotIdGet:{endpoint:"crc-save-data/saveDataSlotIdGet",requiresToken:!1},saveDataPutData:{endpoint:"crc-save-data/saveDataPutData",requiresToken:!1},saveDataDelete:{endpoint:"crc-save-data/saveDataDelete",requiresToken:!1}}},te=Z(),ae=async e=>te.httpPost(ee.settings.cellImgAnalyzedPost.cellImgAdd,e),le=async()=>te.httpGet(ee.settings.cellImgAnalyzedPost.cellImgGet),se=async(e,t)=>te.httpPut(ee.settings.cellImgAnalyzedPost.cellImgPut,e,t),oe=async e=>te.httpPost(ee.settings.rbcDegree.rbcDegreeAdd,e),ne=async e=>te.httpPut(ee.settings.rbcDegree.rbcDegree,e),ie=async()=>te.httpGet(ee.settings.rbcDegree.rbcDegree),re=async e=>te.httpPost(ee.settings.wbcCustomClass.create,e),ce=async e=>te.httpPut(ee.settings.wbcCustomClass.update,e),ue=async()=>te.httpGet(ee.settings.wbcCustomClass.get),de=async e=>te.httpPost(ee.settings.wbcHotKeys.create,e),me=async e=>te.httpPut(ee.settings.wbcHotKeys.update,e),ve=async()=>te.httpGet(ee.settings.wbcHotKeys.get),pe=async e=>te.httpPost(ee.settings.bfHotKeys.create,e),ge=async e=>te.httpPut(ee.settings.bfHotKeys.update,e),fe=async()=>te.httpGet(ee.settings.bfHotKeys.get),ye=async e=>te.httpPost(ee.settings.normalRange.create,e),be=async e=>te.httpPut(ee.settings.normalRange.update,e),Ie=async()=>te.httpGet(ee.settings.normalRange.get),Ce=async e=>te.httpPost(ee.settings.imagePrint.create,e),he=async e=>te.httpPut(ee.settings.imagePrint.update,e),ke=async()=>te.httpGet(ee.settings.imagePrint.get),Se=async e=>te.httpPost(ee.settings.lisCode.create,e),we=async e=>te.httpPut(ee.settings.lisCode.update,e),Ne=async()=>te.httpGet(ee.settings.lisCode.get),Re=async e=>te.httpPost(ee.settings.lisCodeRbc.create,e),Le=async e=>te.httpPut(ee.settings.lisCodeRbc.update,e),Ee=async()=>te.httpGet(ee.settings.lisCodeRbc.get),_e=async e=>te.httpPost(ee.settings.cbcCode.create,e),Pe=async e=>te.httpPut(ee.settings.cbcCode.update,e),Te=async()=>te.httpGet(ee.settings.cbcCode.get),Ae=async e=>te.httpPost(ee.settings.filePathSet.create,e),Me=async e=>te.httpPut(ee.settings.filePathSet.update,e),De=async()=>te.httpGet(ee.settings.filePathSet.get),xe=async e=>te.httpPost(ee.settings.runCount.create,e),Oe=async e=>te.httpPut(ee.settings.runCount.update,e),Ke=async()=>te.httpGet(ee.settings.runCount.get),Be=async e=>te.httpPost(ee.settings.minCount.create,e),Fe=async e=>te.httpPut(ee.settings.minCount.update,e),Ue=async()=>te.httpGet(ee.settings.minCount.get),Xe=async()=>te.httpGet(ee.settings.lisCode.get),$e=async()=>te.httpGet(ee.settings.folder.get),We=async e=>te.httpPost(ee.settings.classOrder.create,e),He=async()=>te.httpGet(ee.settings.classOrder.get),Ge=async e=>te.httpPut(ee.settings.classOrder.update,e),Ye=async()=>te.httpGet(ee.settings.remainingCount.get),Ve=async()=>te.httpGet(ee.settings.qualityCheck.get),je=async e=>te.httpPost(ee.settings.crc.crcSettingCreate,e),Qe=async e=>te.httpPut(ee.settings.crc.crcPut,e),qe=async()=>te.httpGet(ee.settings.crc.crcGet),Je=async e=>te.httpDelete(ee.settings.crc.crcDel,e,!0),ze=async e=>te.httpPost(ee.report.crcRemarkCreate,e),Ze=async()=>te.httpGet(ee.report.crcRemarkFindAll),et=async e=>{const t=Object.entries(e).filter((([e,t])=>void 0!==t)).map((([e,t])=>`${encodeURIComponent(e)}=${encodeURIComponent(String(t))}`)).join("&");return te.httpGet(ee.report.crcSearch,`${t}`,!0)},tt=async e=>te.httpPut(ee.report.crcRemarkUpdate,e),at=async e=>te.httpDelete(ee.report.crcRemarkRemove,e,!0),lt=async e=>te.httpPost(ee.report.crcDataCreate,e),st=async()=>te.httpGet(ee.report.crcDataFindAll),ot=async e=>te.httpPut(ee.report.crcDataUpdate,e),nt=async e=>te.httpDelete(ee.report.crcDataRemove,e,!0),it=async e=>te.httpPost(ee.report.crcOptionCreate,e),rt=async()=>te.httpGet(ee.report.crcOptionGet),ct=async e=>te.httpPut(ee.report.crcOptionUpdate,e),ut=async e=>te.httpPost(ee.report.crcRecoCreate,e),dt=async()=>te.httpGet(ee.report.crcRecoFindAll),mt=async e=>{const t=Object.entries(e).filter((([e,t])=>void 0!==t)).map((([e,t])=>`${encodeURIComponent(e)}=${encodeURIComponent(String(t))}`)).join("&");return te.httpGet(ee.report.crcRecoSearch,`${t}`,!0)},vt=async e=>te.httpPut(ee.report.crcRecoUpdate,e),pt=async e=>te.httpDelete(ee.report.crcRecoRemove,e,!0),gt=async e=>te.httpPost(ee.report.crcCommentCreate,e),ft=async()=>te.httpGet(ee.report.crcCommentFindAll),yt=async e=>{const t=Object.entries(e).filter((([e,t])=>void 0!==t)).map((([e,t])=>`${encodeURIComponent(e)}=${encodeURIComponent(String(t))}`)).join("&");return te.httpGet(ee.report.crcCommentSearch,`${t}`,!0)},bt=async e=>te.httpPut(ee.report.crcCommentUpdate,e),It=async e=>te.httpDelete(ee.report.crcCommentRemove,e,!0),Ct=async e=>te.httpPost(ee.report.saveDataCreate,e),ht=async e=>te.httpGet(ee.report.saveDataSlotIdGet,`${e}`,!1),kt=async e=>te.httpPut(ee.report.saveDataPutData,e);var St=a(3772);class wt{constructor(){(0,St.A)(this,"events",{})}subscribe(e,t){this.events[e]||(this.events[e]=[]),this.events[e].push(t)}async publish(e,...t){const a=this.events[e];if(a)for(const l of a)await l(...t)}unsubscribe(e,t){const a=this.events[e];a&&(this.events[e]=a.filter((e=>e!==t)))}}var Nt=new wt;const Rt={key:0},Lt={class:"mb10 alertMessage"};var Et={__name:"Alert",props:["isVisible","type","message"],emits:["update:hideAlert"],setup(e,{emit:t}){const a=e,l=(0,s.EW)((()=>`alert-${a.type}`)),o=t,i=()=>{o("hide")};return(t,o)=>{const r=(0,s.g2)("font-awesome-icon");return e.isVisible?((0,s.uX)(),(0,s.CE)("div",{key:0,class:(0,n.C4)(["alert",l.value])},["error"===a.type?((0,s.uX)(),(0,s.CE)("p",Rt,[(0,s.bF)(r,{icon:["fas","circle-exclamation"],class:"bigFont"})])):(0,s.Q3)("",!0),(0,s.Lk)("p",Lt,(0,n.v_)(e.message),1),(0,s.Lk)("button",{class:"alertButton",onClick:i},"Close")],2)):(0,s.Q3)("",!0)}}};const _t=Et;var Pt=_t;const Tt=[{value:"01",text:"WBC Diff(Standard)"},{value:"04",text:"PBS(Premium)"},{value:"05",text:"Quality Check"}],At=[{value:"02",text:"BM wedge"},{value:"06",text:"BM squash"},{value:"03",text:"Touch print"},{value:"04",text:"BM biopsy"},{value:"05",text:"Clot section"}],Mt=[{value:"100",text:"100"},{value:"150",text:"150"},{value:"200",text:"200"},{value:"250",text:"250"},{value:"300",text:"300"},{value:"350",text:"350"},{value:"400",text:"400"},{value:"450",text:"450"},{value:"500",text:"500"}],Dt=[{value:"100",text:"100"},{value:"200",text:"200"},{value:"300",text:"300"},{value:"400",text:"400"},{value:"500",text:"500"},{value:"600",text:"600"},{value:"700",text:"700"},{value:"800",text:"800"},{value:"900",text:"900"},{value:"1000",text:"1000"},{value:"1100",text:"1100"},{value:"1200",text:"1200"},{value:"1300",text:"1300"},{value:"1400",text:"1400"},{value:"1500",text:"1500"}],xt=[{value:"50",text:"50"},{value:"100",text:"100"},{value:"150",text:"150"},{value:"200",text:"200"},{value:"250",text:"250"},{value:"300",text:"300"},{value:"350",text:"350"},{value:"400",text:"400"},{value:"450",text:"450"},{value:"500",text:"500"}],Ot=[{value:"1",text:"1"},{value:"2",text:"2"},{value:"3",text:"3"},{value:"4",text:"4"},{value:"5",text:"5"}],Kt=[{value:"0",text:"None"},{value:"1",text:"Smear Top"},{value:"2",text:"Smear Top + Low Power Side"},{value:"3",text:"Smear Top + High Power Side"}],Bt=[{value:"1",text:"1"},{value:"2",text:"2"}],Ft=[{value:"1",text:"1"},{value:"2",text:"2"},{value:"3",text:"3"},{value:"4",text:"4"},{value:"5",text:"5"}],Ut=[{value:"-5",text:"-5"},{value:"-4",text:"-4"},{value:"-3",text:"-3"},{value:"-2",text:"-2"},{value:"-1",text:"-1"},{value:"0",text:"0"},{value:"1",text:"1"},{value:"2",text:"2"},{value:"3",text:"3"},{value:"4",text:"4"},{value:"5",text:"5"}],Xt=[{cd:"01",classCd:"diff",fullNm:"WBC Diff. Count",isSelected:!0},{cd:"02",classCd:"seg",fullNm:"Seg.-neutrophils",isSelected:!0},{cd:"03",classCd:"band",fullNm:"Band-neutrophils",isSelected:!0},{cd:"04",classCd:"",fullNm:"Lymphocytes",isSelected:!0},{cd:"05",classCd:"",fullNm:"Monocytes",isSelected:!0},{cd:"06",classCd:"",fullNm:"Eosinophils",isSelected:!0},{cd:"07",classCd:"",fullNm:"Basophils",isSelected:!0},{cd:"08",classCd:"",fullNm:"Metamyelocytes",isSelected:!0},{cd:"09",classCd:"",fullNm:"Myelocytes",isSelected:!0},{cd:"10",classCd:"",fullNm:"Promyelocytes",isSelected:!0},{cd:"11",classCd:"",fullNm:"Blasts",isSelected:!0},{cd:"12",classCd:"",fullNm:"Immature cells",isSelected:!0},{cd:"13",classCd:"",fullNm:"Atypical cells",isSelected:!0},{cd:"14",classCd:"",fullNm:"Atypical lymphocyte",isSelected:!0},{cd:"15",classCd:"",fullNm:"Activated lymphocyte",isSelected:!0},{cd:"16",classCd:"",fullNm:"Prolymphocytes",isSelected:!0},{cd:"17",classCd:"",fullNm:"Promonocytes",isSelected:!0},{cd:"18",classCd:"",fullNm:"Plasma cells",isSelected:!0},{cd:"19",classCd:"",fullNm:"Nucleated RBC",isSelected:!0},{cd:"20",classCd:"",fullNm:"Others",isSelected:!0},{cd:"21",classCd:"",fullNm:"Atypical Lymphoid cells",isSelected:!0},{cd:"22",classCd:"",fullNm:"Leukemic cells",isSelected:!0},{cd:"23",classCd:"",fullNm:"Abnormal lymphocyte",isSelected:!0},{cd:"24",classCd:"",fullNm:"Reactive lymphocyte",isSelected:!0},{cd:"25",classCd:"",fullNm:"Plasmacytoid lymphocyte",isSelected:!0},{cd:"26",classCd:"",fullNm:"ANC calc",isSelected:!0},{cd:"27",classCd:"",fullNm:"WBC",isSelected:!0},{cd:"28",classCd:"",fullNm:"RBC",isSelected:!0},{cd:"29",classCd:"",fullNm:"HGB",isSelected:!0},{cd:"30",classCd:"",fullNm:"HCT",isSelected:!0},{cd:"31",classCd:"",fullNm:"MCV",isSelected:!0},{cd:"32",classCd:"",fullNm:"MCH",isSelected:!0},{cd:"33",classCd:"",fullNm:"MCHC",isSelected:!0},{cd:"34",classCd:"",fullNm:"RDW",isSelected:!0},{cd:"35",classCd:"",fullNm:"Platelet",isSelected:!0},{cd:"36",classCd:"",fullNm:"PCT",isSelected:!0},{cd:"37",classCd:"",fullNm:"MPV",isSelected:!0},{cd:"38",classCd:"",fullNm:"PDW",isSelected:!0},{cd:"39",classCd:"",fullNm:"ESR",isSelected:!0},{cd:"40",classCd:"",fullNm:"LUC",isSelected:!0}],$t=[{cd:"01",classCd:"diff",fullNm:"WBC Diff. Count",isSelected:!0},{cd:"02",classCd:"seg",fullNm:"Seg.-neutrophils",isSelected:!0},{cd:"03",classCd:"band",fullNm:"Band-neutrophils",isSelected:!0},{cd:"04",classCd:"",fullNm:"Lymphocytes",isSelected:!0},{cd:"05",classCd:"",fullNm:"Monocytes",isSelected:!0},{cd:"06",classCd:"",fullNm:"Eosinophils",isSelected:!0},{cd:"07",classCd:"",fullNm:"Basophils",isSelected:!0},{cd:"08",classCd:"",fullNm:"Metamyelocytes",isSelected:!0},{cd:"09",classCd:"",fullNm:"Myelocytes",isSelected:!0},{cd:"10",classCd:"",fullNm:"Promyelocytes",isSelected:!0},{cd:"11",classCd:"",fullNm:"Blasts",isSelected:!0},{cd:"12",classCd:"",fullNm:"Immature cells",isSelected:!0},{cd:"13",classCd:"",fullNm:"Atypical cells",isSelected:!0},{cd:"14",classCd:"",fullNm:"Atypical lymphocyte",isSelected:!0},{cd:"15",classCd:"",fullNm:"Activated lymphocyte",isSelected:!0},{cd:"16",classCd:"",fullNm:"Prolymphocytes",isSelected:!0},{cd:"17",classCd:"",fullNm:"Promonocytes",isSelected:!0},{cd:"18",classCd:"",fullNm:"Plasma cells",isSelected:!0},{cd:"19",classCd:"",fullNm:"Nucleated RBC",isSelected:!0},{cd:"20",classCd:"",fullNm:"Others",isSelected:!0},{cd:"21",classCd:"",fullNm:"Atypical Lymphoid cells",isSelected:!0},{cd:"22",classCd:"",fullNm:"Leukemic cells",isSelected:!0},{cd:"23",classCd:"",fullNm:"Abnormal lymphocyte",isSelected:!0},{cd:"24",classCd:"",fullNm:"Reactive lymphocyte",isSelected:!0},{cd:"25",classCd:"",fullNm:"Plasmacytoid lymphocyte",isSelected:!0},{cd:"26",classCd:"",fullNm:"ANC calc",isSelected:!0},{cd:"27",classCd:"",fullNm:"WBC",isSelected:!0},{cd:"28",classCd:"",fullNm:"RBC",isSelected:!0},{cd:"29",classCd:"",fullNm:"HGB",isSelected:!0},{cd:"30",classCd:"",fullNm:"HCT",isSelected:!0},{cd:"31",classCd:"",fullNm:"MCV",isSelected:!0},{cd:"32",classCd:"",fullNm:"MCH",isSelected:!0},{cd:"33",classCd:"",fullNm:"MCHC",isSelected:!0},{cd:"34",classCd:"",fullNm:"RDW",isSelected:!0},{cd:"35",classCd:"",fullNm:"Platelet",isSelected:!0},{cd:"36",classCd:"",fullNm:"PCT",isSelected:!0},{cd:"37",classCd:"",fullNm:"MPV",isSelected:!0},{cd:"38",classCd:"",fullNm:"PDW",isSelected:!0},{cd:"39",classCd:"",fullNm:"ESR",isSelected:!0},{cd:"40",classCd:"",fullNm:"RETI",isSelected:!0}],Wt={rbcClassList:[{categoryId:"01",categoryNm:"Size",classInfo:[{classId:"01",classNm:"Normal",degree:"0"},{classId:"02",classNm:"Macrocyte",degree:"0"},{classId:"03",classNm:"Microcyte",degree:"0"},{classId:"04",classNm:"Anisocytosis",degree:"0"}]},{categoryId:"02",categoryNm:"Chromia",classInfo:[{classId:"01",classNm:"Normal",degree:"0"},{classId:"02",classNm:"Hyperchromic",degree:"0"},{classId:"03",classNm:"Hypochromic",degree:"0"},{classId:"04",classNm:"Polychromia",degree:"0"}]},{categoryId:"03",categoryNm:"Shape",classInfo:[{classId:"01",classNm:"Normal",degree:"0"},{classId:"02",classNm:"Poikilocytosis",degree:"0"},{classId:"03",classNm:"Target Cell",degree:"0"},{classId:"04",classNm:"Burr Cell",degree:"0"},{classId:"05",classNm:"Acanthocyte",degree:"0"},{classId:"06",classNm:"Ovalocyte",degree:"0"},{classId:"07",classNm:"Schistocyte",degree:"0"},{classId:"08",classNm:"Sickle Cell",degree:"0"},{classId:"09",classNm:"Stomatocyte",degree:"0"},{classId:"10",classNm:"Tear Drop Cell",degree:"0"},{classId:"11",classNm:"Spherocyte",degree:"0"}]},{categoryId:"05",categoryNm:"Inclusion Body",classInfo:[{classId:"01",classNm:"Howell-Jolly Body",degree:"0"},{classId:"02",classNm:"Basophilic Stippling",degree:"0"}]}],malariaCount:0,currentRbcResults:null},Ht=[{categoryId:"01",classId:"02",degree1:"5",degree2:"10",degree3:"20"},{categoryId:"01",classId:"03",degree1:"5",degree2:"10",degree3:"20"},{categoryId:"01",classId:"04",degree1:"5",degree2:"10",degree3:"20"},{categoryId:"02",classId:"02",degree1:"5",degree2:"10",degree3:"20"},{categoryId:"02",classId:"03",degree1:"5",degree2:"10",degree3:"20"},{categoryId:"02",classId:"04",degree1:"5",degree2:"10",degree3:"20"},{categoryId:"03",classId:"03",degree1:"2.5",degree2:"5",degree3:"20"},{categoryId:"03",classId:"04",degree1:"2.5",degree2:"5",degree3:"20"},{categoryId:"03",classId:"05",degree1:"2.5",degree2:"5",degree3:"20"},{categoryId:"03",classId:"06",degree1:"2.5",degree2:"5",degree3:"20"},{categoryId:"03",classId:"07",degree1:"0.5",degree2:"1",degree3:"2"},{categoryId:"03",classId:"08",degree1:"0.5",degree2:"1",degree3:"2"},{categoryId:"03",classId:"09",degree1:"2.5",degree2:"5",degree3:"20"},{categoryId:"03",classId:"10",degree1:"2.5",degree2:"5",degree3:"20"},{categoryId:"03",classId:"11",degree1:"2.5",degree2:"5",degree3:"20"},{categoryId:"05",classId:"01",degree1:"1",degree2:"2",degree3:"3"},{categoryId:"05",classId:"02",degree1:"2.5",degree2:"5",degree3:"20"}],Gt=[{id:"01",abbreviation:"NE",fullNm:"Neutrophil",key:"",orderIdx:1},{id:"71",abbreviation:"NS",fullNm:"Neutrophil-Segmented",key:"",orderIdx:2},{id:"72",abbreviation:"NB",fullNm:"Neutrophil-Band",key:"",orderIdx:3},{id:"02",abbreviation:"ME",fullNm:"Metamyelocyte",key:"",orderIdx:4},{id:"03",abbreviation:"MY",fullNm:"Myelocyte",key:"",orderIdx:5},{id:"04",abbreviation:"PR",fullNm:"Promyelocyte",key:"",orderIdx:6},{id:"05",abbreviation:"LY",fullNm:"Lymphocyte",key:"",orderIdx:7},{id:"61",abbreviation:"LR",fullNm:"Reactive lymphocyte",key:"",orderIdx:8},{id:"62",abbreviation:"LA",fullNm:"Abnormal lymphocyte",key:"",orderIdx:9},{id:"07",abbreviation:"MO",fullNm:"Monocyte",key:"",orderIdx:10},{id:"08",abbreviation:"EO",fullNm:"Eosinophil",key:"",orderIdx:11},{id:"09",abbreviation:"BA",fullNm:"Basophil",key:"",orderIdx:12},{id:"10",abbreviation:"BL",fullNm:"Blast",key:"",orderIdx:13},{id:"11",abbreviation:"PC",fullNm:"Plasma cell",key:"",orderIdx:14},{id:"12",abbreviation:"NR",fullNm:"nRBC",key:"",orderIdx:15},{id:"13",abbreviation:"GP",fullNm:"Giant platelet",key:"",orderIdx:16},{id:"14",abbreviation:"PA",fullNm:"Platelet aggregation",key:"",orderIdx:17},{id:"16",abbreviation:"MA",fullNm:"Malaria",key:"",orderIdx:18},{id:"15",abbreviation:"AR",fullNm:"Artifact(Smudge)",key:"",orderIdx:19},{classId:"17",abbreviation:"SM",fullNm:"Smudge",orderIdx:20}],Yt=[{id:"01",abbreviation:"NE",fullNm:"Neutrophil",key:"",orderIdx:1},{id:"71",abbreviation:"NS",fullNm:"Neutrophil-Segmented",key:"",orderIdx:2},{id:"72",abbreviation:"NB",fullNm:"Neutrophil-Band",key:"",orderIdx:3},{id:"02",abbreviation:"ME",fullNm:"Metamyelocyte",key:"",orderIdx:4},{id:"03",abbreviation:"MY",fullNm:"Myelocyte",key:"",orderIdx:5},{id:"04",abbreviation:"PR",fullNm:"Promyelocyte",key:"",orderIdx:6},{id:"05",abbreviation:"LY",fullNm:"Lymphocyte",key:"",orderIdx:7},{id:"06",abbreviation:"LA",fullNm:"Abnormal lymphocyte",key:"",orderIdx:8},{id:"07",abbreviation:"MO",fullNm:"Monocyte",key:"",orderIdx:9},{id:"08",abbreviation:"EO",fullNm:"Eosinophil",key:"",orderIdx:10},{id:"09",abbreviation:"BA",fullNm:"Basophil",key:"",orderIdx:11},{id:"10",abbreviation:"BL",fullNm:"Blast",key:"",orderIdx:12},{id:"11",abbreviation:"PC",fullNm:"Plasma cell",key:"",orderIdx:13},{id:"12",abbreviation:"ON",fullNm:"Orthochromic Normoblast",key:"",orderIdx:14},{id:"13",abbreviation:"PN",fullNm:"Polychromic Normoblast",key:"",orderIdx:15},{id:"14",abbreviation:"BN",fullNm:"Basophilic Normoblast",key:"",orderIdx:16},{id:"15",abbreviation:"PE",fullNm:"Proerythroblast",key:"",orderIdx:17},{id:"16",abbreviation:"HC",fullNm:"Histiocyte",key:"",orderIdx:18},{id:"17",abbreviation:"OT",fullNm:"Others",key:"",orderIdx:19}],Vt=[{id:"01",abbreviation:"NE",fullNm:"Neutrophil",key:"",orderIdx:1},{id:"02",abbreviation:"LY",fullNm:"Lymphocyte",key:"",orderIdx:2},{id:"03",abbreviation:"MO",fullNm:"Monocyte",key:"",orderIdx:3},{id:"04",abbreviation:"EO",fullNm:"Eosinophil",key:"",orderIdx:4},{id:"05",abbreviation:"BA",fullNm:"Basophil",key:"",orderIdx:5},{id:"06",abbreviation:"BL",fullNm:"Blast",key:"",orderIdx:6},{id:"07",abbreviation:"PC",fullNm:"Plasma cell",key:"",orderIdx:7},{id:"08",abbreviation:"NR",fullNm:"NRBC",key:"",orderIdx:8},{id:"09",abbreviation:"AR",fullNm:"Artifact(Smudge)",key:"",orderIdx:9},{id:"10",abbreviation:"MC",fullNm:"Malignant cell",key:"",orderIdx:10},{id:"11",abbreviation:"MT",fullNm:"Mesothelial cell",key:"",orderIdx:11}],jt=[{abbreviation:"NE",fullNm:"Neutrophil",classId:"01",min:42,max:85,unit:"%"},{abbreviation:"ME",fullNm:"Metamyelocyte",classId:"02",min:0,max:100,unit:"%"},{abbreviation:"MY",fullNm:"Myelocyte",classId:"03",min:0,max:100,unit:"%"},{abbreviation:"PR",fullNm:"Promyelocyte",classId:"04",min:0,max:100,unit:"%"},{abbreviation:"LY",fullNm:"Lymphocyte",classId:"05",min:11,max:49,unit:"%"},{abbreviation:"MO",fullNm:"Monocyte",classId:"07",min:0,max:9,unit:"%"},{abbreviation:"EO",fullNm:"Eosinophil",classId:"08",min:0,max:6,unit:"%"},{abbreviation:"BA",fullNm:"Basophil",classId:"09",min:0,max:2,unit:"%"},{abbreviation:"BL",fullNm:"Blast",classId:"10",min:0,max:100,unit:"%"},{abbreviation:"PC",fullNm:"Plasma cell",classId:"11",min:0,max:100,unit:"%"},{abbreviation:"NR",fullNm:"nRBC",classId:"12",min:0,max:100,unit:"Count"},{abbreviation:"GP",fullNm:"Giant platelet",classId:"13",min:0,max:100,unit:"Count"},{abbreviation:"PA",fullNm:"Platelet aggregation",classId:"14",min:0,max:100,unit:"Count"},{abbreviation:"AR",fullNm:"Artifact(Smudge)",classId:"15",min:0,max:100,unit:"Count"},{abbreviation:"MA",fullNm:"Malaria",classId:"16",min:0,max:100,unit:"Count"},{abbreviation:"LR",fullNm:"Reactive lymphocyte",classId:"61",min:0,max:100,unit:"%"},{abbreviation:"LA",fullNm:"Abnormal lymphocyte",classId:"62",min:0,max:100,unit:"%"}],Qt=[{fullNm:"Neutrophil",classId:"01",checked:!1},{fullNm:"Neutrophil-Segmented",classId:"71",checked:!1},{fullNm:"Neutrophil-Band",classId:"72",checked:!1},{fullNm:"Metamyelocyte",classId:"02",checked:!1},{fullNm:"Myelocyte",classId:"03",checked:!1},{fullNm:"Promyelocyte",classId:"04",checked:!1},{fullNm:"Lymphocyte",classId:"05",checked:!1},{fullNm:"Reactive lymphocyte",classId:"61",checked:!1},{fullNm:"Abnormal lymphocyte",classId:"62",checked:!1},{fullNm:"Monocyte",classId:"07",checked:!1},{fullNm:"Eosinophil",classId:"08",checked:!1},{fullNm:"Basophil",classId:"09",checked:!1},{fullNm:"Blast",classId:"10",checked:!1},{fullNm:"Plasma cell",classId:"11",checked:!1},{fullNm:"nRBC",classId:"12",checked:!1},{fullNm:"Giant platelet",classId:"13",checked:!1},{fullNm:"Platelet aggregation",classId:"14",checked:!1},{fullNm:"Malaria",classId:"16",checked:!1},{fullNm:"Artifact(Smudge)",classId:"15",checked:!1},{fullNm:"rbcPrintModel",classId:"99999",checked:!1}],qt=[{fullNm:"Neutrophil",classId:"01",checked:!1},{fullNm:"Neutrophil-Segmented",classId:"71",checked:!1},{fullNm:"Neutrophil-Band",classId:"72",checked:!1},{fullNm:"Metamyelocyte",classId:"02",checked:!1},{fullNm:"Myelocyte",classId:"03",checked:!1},{fullNm:"Promyelocyte",classId:"04",checked:!1},{fullNm:"Lymphocyte",classId:"05",checked:!1},{fullNm:"Abnormal lymphocyte",classId:"06",checked:!1},{fullNm:"Monocyte",classId:"07",checked:!1},{fullNm:"Eosinophil",classId:"08",checked:!1},{fullNm:"Basophil",classId:"09",checked:!1},{fullNm:"Blast",classId:"10",checked:!1},{fullNm:"Plasma cell",classId:"11",checked:!1},{fullNm:"Orthochromic Normoblast",classId:"12",checked:!1},{fullNm:"Polychromic Normoblast",classId:"13",checked:!1},{fullNm:"Basophilic Normoblast",classId:"14",checked:!1},{fullNm:"Proerythroblast",classId:"15",checked:!1},{fullNm:"Histiocyte",classId:"16",checked:!1},{fullNm:"Others",classId:"17",checked:!1}],Jt=[{fullNm:"Neutrophil",classId:"01",key:"NE"},{fullNm:"Neutrophil-Segmented",classId:"71",key:"NS"},{fullNm:"Neutrophil-Band",classId:"72",key:"NB"},{fullNm:"Metamyelocyte",classId:"02",key:"ME"},{fullNm:"Myelocyte",classId:"03",key:"MY"},{fullNm:"Promyelocyte",classId:"04",key:"PR"},{fullNm:"Lymphocyte",classId:"05",key:"LY"},{fullNm:"Reactive lymphocyte",classId:"61",key:"LR"},{fullNm:"Abnormal lymphocyte",classId:"62",key:"LA"},{fullNm:"Monocyte",classId:"07",key:"MO"},{fullNm:"Eosinophil",classId:"08",key:"EO"},{fullNm:"Basophil",classId:"09",key:"BA"},{fullNm:"Blast",classId:"10",key:"BL"},{fullNm:"Plasma cell",classId:"11",key:"PC"},{fullNm:"nRBC",classId:"12",key:"NR"},{fullNm:"Giant platelet",classId:"13",key:"GP"},{fullNm:"Platelet aggregation",classId:"14",key:"PA"},{fullNm:"Malaria",classId:"16",key:"MA"},{fullNm:"Artifact(Smudge)",classId:"15",key:"AR"},{fullNm:"rbcPrintModel",classId:"99999",key:""}],zt=[{categoryId:"01",categoryNm:"Size",classId:"01",fullNm:"Normal",key:"SIZENO"},{categoryId:"01",categoryNm:"Size",classId:"02",fullNm:"Macrocyte",key:"SIZEMA"},{categoryId:"01",categoryNm:"Size",classId:"03",fullNm:"Microcyte",key:"SIZEMI"},{categoryId:"01",categoryNm:"Size",classId:"04",fullNm:"Anisocytosis",key:"SIZEAN"},{categoryId:"02",categoryNm:"Chromia",classId:"01",fullNm:"Normal",key:"CHRONO"},{categoryId:"02",categoryNm:"Chromia",classId:"02",fullNm:"Hyperchromic",key:"CHRHPE"},{categoryId:"02",categoryNm:"Chromia",classId:"03",fullNm:"Hypochromic",key:"CHRHPO"},{categoryId:"02",categoryNm:"Chromia",classId:"04",fullNm:"Polychromia",key:"CHRPOL"},{categoryId:"03",categoryNm:"Shape",classId:"01",fullNm:"Normal",key:"SHAPNO"},{categoryId:"03",categoryNm:"Shape",classId:"02",fullNm:"Poikilocytosis",key:"SHAPPO"},{categoryId:"03",categoryNm:"Shape",classId:"03",fullNm:"Target Cell",key:"SHAPTA"},{categoryId:"03",categoryNm:"Shape",classId:"04",fullNm:"Burr Cell",key:"SHAPBU"},{categoryId:"03",categoryNm:"Shape",classId:"05",fullNm:"Acanthocyte",key:"SHAPAC"},{categoryId:"03",categoryNm:"Shape",classId:"06",fullNm:"Ovalocyte",key:"SHAPOV"},{categoryId:"03",categoryNm:"Shape",classId:"07",fullNm:"Schistocyte",key:"SHAPSC"},{categoryId:"03",categoryNm:"Shape",classId:"08",fullNm:"Sickle Cell",key:"SHAPSI"},{categoryId:"03",categoryNm:"Shape",classId:"09",fullNm:"Stomatocyte",key:"SHAPST"},{categoryId:"03",categoryNm:"Shape",classId:"10",fullNm:"Tear Drop Cell",key:"SHAPTE"},{categoryId:"03",categoryNm:"Shape",classId:"11",fullNm:"Spherocyte",key:"SHAPSP"},{categoryId:"04",categoryNm:"Platelet",classId:"01",fullNm:"Platelet",key:"PLAT"},{categoryId:"05",categoryNm:"Inclusion Body",classId:"01",fullNm:"Howell-Jolly Body",key:"INBDHO"},{categoryId:"05",categoryNm:"Inclusion Body",classId:"02",fullNm:"Basophilic Stippling",key:"INBDBA"},{categoryId:"05",categoryNm:"Inclusion Body",classId:"03",fullNm:"Malaria",key:"INBDMA"}],Zt=[{minGPCount:0,minPACount:0}],ea=[{min:0,max:700,wbcTargetCount:50},{min:701,max:1e3,wbcTargetCount:100},{min:1001,max:2e3,wbcTargetCount:150},{min:2001,max:3e3,wbcTargetCount:250}],ta=[{lisHotKey:"",lisFilePath:"",cbcFilePath:""}],aa={HOWELL_JOLLY:"19_Howell_jolly",MALARIA:"43_InclusionBody_Malaria",NO_MALARIA:"44_InclusionBody_NoMalaria",RBC_CLASS:"03_RBC_Classification",RBC_IMAGE:"02_RBC_Image",BARCODE:"00_Barcode_Image",WBC_CLASS:"01_WBC_Classification",BF:"02_LowPower_Image",BF_HIGH:"03_HighPower_Image",BF_CLASS:"05_BF_Classification",IA_ROOT_PATH:"D:/ia_proc"},la={cellImageAnalyzed:"cellImageAnalyzed",rbcDegree:"rbcDegree",wbcRunningCount:"wbcRunningCount",wbcCustomClass:"wbcCustomClass",wbcHotKeys:"wbcHotKeys",bfHotKeys:"bfHotKeys",normalRange:"normalRange",classOrder:"classOrder",imagePrint:"imagePrint",lisCode:"lisCode",cbcCode:"cbcCode",filePathSet:"filePathSet"},sa=[{customNum:90,abbreviation:"",fullNm:""},{customNum:91,abbreviation:"",fullNm:""},{customNum:92,abbreviation:"",fullNm:""},{customNum:93,abbreviation:"",fullNm:""},{customNum:94,abbreviation:"",fullNm:""}],oa={class:"mb10 fs10"};var na={__name:"Confirm",props:["isVisible","type","message"],emits:["okConfirm"],setup(e,{emit:t}){const a=e,l=(0,s.EW)((()=>`confirm-${a.type}`)),o=t,i=e=>{switch(e){case"setting":return U.SAVE;case"delete":return U.DELETE;default:return"OK"}},r=e=>{switch(e){case"setting":return U.LEAVE;case"delete":return U.CLOSE;default:return"CLOSE"}},c=()=>{o("hide")},u=()=>{o("okConfirm")};return(t,a)=>e.isVisible?((0,s.uX)(),(0,s.CE)("div",{key:0,class:(0,n.C4)(["alert",l.value])},[(0,s.Lk)("p",oa,(0,n.v_)(e.message),1),(0,s.Lk)("button",{class:"alertButton",onClick:u},(0,n.v_)(i(e.type)||"OK"),1),(0,s.Lk)("button",{class:"alertCloseButton",onClick:c},(0,n.v_)(r(e.type)||"CLOSE"),1)],2)):(0,s.Q3)("",!0)}};const ia=na;var ra=ia;const ca=Z(),ua=async e=>ca.httpPost(ee.device.getDeviceInfo.create,e),da=async()=>ca.httpGet(ee.device.getDeviceInfo.get),ma=async e=>ca.httpPut(ee.device.updateDeviceInfo,e),va=async()=>ca.httpGet(ee.device.getDeviceInfo.ip),pa={class:"execute"},ga={class:"startDiv"},fa=["disabled"],ya=["value"],ba={class:"stopDiv"},Ia=["disabled"],Ca=["value"],ha=["disabled"],ka=["value"],Sa={class:"flex-justify-between"};var wa=(0,s.pM)({__name:"execute",setup(e,{emit:t}){const a=(0,c.Pj)(),i=(0,s.EW)((()=>a.state.embeddedStatusModule)),r=(0,s.EW)((()=>a.state.userModule)),u=(0,s.EW)((()=>a.state.commonModule.viewerCheck)),d=(0,o.KR)("pb"),m=(0,o.KR)([]),v=(0,s.EW)((()=>a.state.commonModule)),p=(0,s.EW)((()=>a.state.executeModule)),g=(0,o.KR)(v.value?.isPause),f=(0,s.EW)((()=>a.state.commonModule.isRunningState)),y=(0,o.KR)(i.value?.userStop),b=(0,o.KR)(i.value?.isRecoveryRun),I=(0,o.KR)(i.value?.isInit),C=(0,o.KR)(""),h=(0,o.KR)(),k=(0,o.KR)(),S=(0,o.KR)(),w=(0,o.KR)([]),N=(0,s.EW)((()=>a.state.commonModule)),R=(0,o.KR)(!1),L=(0,o.KR)(""),E=(0,o.KR)(!1),_=(0,o.KR)(""),P=(0,o.KR)(""),T=(0,o.KR)([]),A=t,M=(0,o.KR)(!1),D=(0,o.KR)(""),B=(0,o.KR)(""),F=(0,o.KR)(""),X=(0,o.KR)(),$=(0,o.KR)(!1);(0,s.wB)(r.value,(async(e,t)=>{""!==e.id&&(C.value=e.id,await W())})),(0,s.KC)((()=>{$.value="100a"===window.MACHINE_VERSION})),(0,s.sV)((async()=>{await W()}));const W=async()=>{d.value="bm"===window.PROJECT_TYPE?"bm":"pb",T.value="bm"===window.PROJECT_TYPE?At:Tt,m.value="bm"===window.PROJECT_TYPE?O:x,await(0,s.dY)(),await ae(),await oe(),await se(),await te(),f.value?(L.value="isRunning",R.value=!1):(L.value="start",R.value=!0)};(0,s.wB)(N.value,(e=>{""===e.loginSetData&&(W(),a.dispatch("commonModule/setCommonInfo",{loginSetData:"nn"})),e.resetAnalyzing&&(ae(),a.dispatch("commonModule/setCommonInfo",{resetAnalyzing:!1}))}),{deep:!0}),(0,s.wB)([v.value],(async e=>{await(0,s.dY)();const[t]=e,{bfSelectFiles:a}=t||{};w.value=a,f.value?(L.value="isRunning",R.value=!1):R.value=!0})),(0,s.wB)([i.value,p.value],(async e=>{const[t]=e;await(0,s.dY)();const{isPause:a,userStop:l,isRecoveryRun:o,isInit:n}=t||{};$.value&&Number(t.sysInfo.autoStart)&&V("start","autoStart"),g.value=a,y.value=l,b.value=o,I.value=n,g.value?L.value="isPause":y.value&&!b.value?L.value="onRecover":"N"===I.value||""===I.value?L.value="isInit":L.value="start"}));const G=async(e,t)=>{await Nt.publish("childEmitSocketData",t)},Y=()=>{const e=H(),t={jobCmd:"SEARCH_CARD_COUNT",reqUserId:C.value,reqDttm:e,testType:h.value};J().embedStatus.searchCardCount.reqUserId=C.value,J().embedStatus.searchCardCount.testType=h.value,Nt.publish("childEmitSocketData",t)},V=(e,t="")=>{if("main"===u.value||"main"===window.FORCE_VIEWER)if("start"===e){if(g.value)return J().embedStatus.restart.bfSelectFiles=w.value,J().embedStatus.restart.reqUserId=C.value,void G("SEND_DATA",J().embedStatus.restart);if(f.value&&"autoStart"!==o)return void j(U.IDS_ERROR_ALREADY_RUNNING);if(y.value)return B.value=U.IDS_RECOVER_GRIPPER_CONDITION,void(M.value=!0);const e=sessionStorage.getItem("rbcPositionMargin"),t=sessionStorage.getItem("wbcPositionMargin"),l=sessionStorage.getItem("pltPositionMargin"),s=sessionStorage.getItem("edgeShotType")||"0",o=sessionStorage.getItem("autoStart")||1;let n=J().embedStatus.startAction;if(Object.assign(n,{testType:h.value,wbcCount:X.value||k.value,stitchCount:S.value,reqUserId:C.value,rbcPositionMargin:e||"0",wbcPositionMargin:t||"0",pltPositionMargin:l||"0",edgeShotType:s||"0"}),$.value&&Object.assign(n,{autoStart:Number(o)}),"pb"===window.PROJECT_TYPE&&["2","3"].includes(s)){const e="2"===s?"edgeShotLPCount":"edgeShotHPCount",t="2"===s?"1":"3",a=sessionStorage.getItem(e)||t;Object.assign(n,{edgeShotCount:a})}if("bm"===window.PROJECT_TYPE&&(n={jobCmd:"START",reqUserId:C.value,reqDttm:J().embedStatus.startAction.reqDttm,orderInfo:[{orderId:"1",cassetNo:"",slotNo:"1",bmNo:"1",patientId:"",patientNm:"",age:"1",gender:"01",testType:"02",stainType:"01",userInputStainType:"",analysisType:h.value,bmSamplingSide:"01",cellCount:k.value,department:"s",stitchCount:S.value}],runningMode:"00",positionMargin:"0"}),"Y"===I.value){G("SEND_DATA",n);const e={startEmbedded:!0};a.dispatch("commonModule/setCommonInfo",e)}}else{if(!f.value)return void j(U.IDS_ERROR_STOP_PROCESS);a.dispatch("embeddedStatusModule/setEmbeddedStatusInfo",{userStop:!0}),J().embedStatus.stop.reqUserId=C.value,G("SEND_DATA",J().embedStatus.stop)}},j=e=>{E.value=!0,_.value="success",P.value=e},Q=()=>{E.value=!1},q=()=>{M.value=!1},z=()=>{M.value=!1,J().embedStatus.recovery.reqUserId=C.value,G("SEND_DATA",J().embedStatus.recovery)},Z=()=>{"main"!==u.value&&"main"!==window.FORCE_VIEWER||("Y"!==I.value?(J().embedStatus.init.reqUserId=C.value,G("SEND_DATA",J().embedStatus.init),A("initDataChangeText",!0)):j(U.alreadyInitialized))},ee=async e=>{await a.dispatch("commonModule/setCommonInfo",{isRewindingBelt:e})},te=async()=>{const e={...i.value};I.value=e.isInit,g.value=e.isPause,y.value=e.userStop,b.value=e.isRecoveryRun,R.value=("N"===I.value||""===I.value)&&!f.value},ae=async()=>{try{const e=await le();if(e&&e?.data){const t=e.data;if(h.value=t.analysisType,await a.dispatch("commonModule/setCommonInfo",{analysisType:h.value}),"bm"===window.PROJECT_TYPE)k.value=t.diffCellAnalyzingCount;else switch(h.value){case"01":k.value=t.diffCellAnalyzingCount;break;case"04":k.value=t.pbsCellAnalyzingCount;break;default:k.value=t.bfCellAnalyzingCount}S.value=t.stitchCount}}catch(e){console.error(e)}},se=async()=>{if("pb"===window.PROJECT_TYPE&&"0011"===F.value)try{const e=await Ke();if(e&&e.data){const t=e.data;if(t&&t?.length>0){const e=t.filter((e=>e.min<=k.value&&k.value<=e.max))[0];e.wbcTargetCount&&(X.value=e.wbcTargetCount)}}}catch(e){console.error(e)}},oe=async()=>{try{const e=await da();F.value=e.data.siteCd}catch(e){console.error(e)}};return(e,t)=>{const a=(0,s.g2)("font-awesome-icon");return(0,s.uX)(),(0,s.CE)(s.FK,null,[(0,s.Lk)("div",pa,[(0,s.Lk)("div",ga,[(0,s.bo)((0,s.Lk)("select",{"onUpdate:modelValue":t[0]||(t[0]=e=>h.value=e),disabled:f.value,onChange:Y},[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(T.value,(e=>((0,s.uX)(),(0,s.CE)("option",{key:e.value,value:e.value},(0,n.v_)(e.text),9,ya)))),128))],40,fa),[[l.u1,h.value]]),R.value?((0,s.uX)(),(0,s.CE)("p",{key:0,class:"startStopP",onClick:t[1]||(t[1]=e=>"Y"===I.value&&V("start"))},[(0,s.bF)(a,{icon:["fas","circle-play"],class:(0,n.C4)({startBtn:!0,[L.value]:!0})},null,8,["class"])])):((0,s.uX)(),(0,s.CE)("p",{key:1,class:"startStopP",onClick:t[2]||(t[2]=e=>V("stop"))},[(0,s.bF)(a,{icon:["fas","circle-stop"],class:"stopBtn"})]))]),(0,s.Lk)("div",ba,[(0,s.bo)((0,s.Lk)("select",{"onUpdate:modelValue":t[3]||(t[3]=e=>k.value=e),disabled:f.value||"05"===h.value},[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(m.value,(e=>((0,s.uX)(),(0,s.CE)("option",{key:e.value,value:e.value},(0,n.v_)(e.text),9,Ca)))),128))],8,Ia),[[l.u1,k.value]]),(0,s.bo)((0,s.Lk)("select",{class:"stopDivSelect","onUpdate:modelValue":t[4]||(t[4]=e=>S.value=e),disabled:f.value||"05"===h.value},[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)((0,o.R1)(K),(e=>((0,s.uX)(),(0,s.CE)("option",{key:e.value,value:e.value},(0,n.v_)(e.text),9,ka)))),128))],8,ha),[[l.u1,S.value]]),(0,s.Lk)("div",Sa,[$.value?((0,s.uX)(),(0,s.CE)("div",{key:0,class:"rewindBtn flex-center",onMousedown:t[5]||(t[5]=e=>ee(!0)),onMouseup:t[6]||(t[6]=e=>ee(!1))},[(0,s.bF)(a,{icon:["fas","backward-fast"],flip:"horizontal"})],32)):(0,s.Q3)("",!0),(0,s.Lk)("div",{class:(0,n.C4)(["initBtn",{isInitDisabled:"Y"===I.value,"initBtn-is100a":$.value}]),onClick:Z,style:{width:"100%"}},[(0,s.Lk)("span",null,(0,n.v_)(f.value?"INITIALIZING":"INITIALIZE"),1)],2)])])]),E.value?((0,s.uX)(),(0,s.Wv)(Pt,{key:0,"is-visible":E.value,type:_.value,message:P.value,onHide:Q,"onUpdate:hideAlert":Q},null,8,["is-visible","type","message"])):(0,s.Q3)("",!0),M.value?((0,s.uX)(),(0,s.Wv)(ra,{key:1,"is-visible":M.value,type:D.value,message:B.value,onHide:q,onOkConfirm:z},null,8,["is-visible","type","message"])):(0,s.Q3)("",!0)],64)}}});const Na=wa;var Ra=Na;const La={class:"circular-progress-bar mt20"},Ea={class:"progress-ring",width:"120",height:"120"},_a={id:"gradient",x1:"0%",y1:"0%",x2:"100%",y2:"100%"},Pa=["stop-color"],Ta=["cx","cy","r","stroke-width"],Aa=["cx","cy","r","stroke-width","stroke-dasharray","stroke-dashoffset"],Ma={class:"slideTime"},Da={key:0,class:"slideCardWrap"},xa={class:"slideContent"},Oa={class:"mt10"},Ka={class:"slideContent"},Ba={class:"mt10"},Fa={key:1,class:"slideCardWrap"},Ua={class:"slideContent pb100a"};var Xa=(0,s.pM)({__name:"workingView",props:["parsedData","pb100aCassette"],setup(e){const t=(0,c.Pj)(),a=(0,s.EW)((()=>t.state.runningInfoModule)),i=(0,s.EW)((()=>t.state.commonModule)),r=(0,s.EW)((()=>t.state.commonModule.initValData)),u=(0,s.EW)((()=>t.state.timeModule)),d=(0,s.EW)((()=>t.state.embeddedStatusModule)),m=e,v=((0,s.EW)((()=>t.state.commonModule.siteCd)),(0,o.KR)(0)),p=(0,o.KR)(120),g=(0,o.KR)(6),f=(0,o.KR)("#00c2ff"),y=(0,o.KR)(p.value/2),b=(0,o.KR)(2*Math.PI*(y.value-g.value/2)),I=(0,o.KR)(b.value),C=(0,o.KR)(0),h=(0,o.KR)(0),k=(0,o.KR)(""),S=(0,o.KR)(""),w=(0,o.KR)("");let N=null,R=null;const L=(0,o.KR)(B);let E=(0,o.KR)(0),_=(0,o.KR)(0);const P=(0,o.KR)(!1);let T=(0,o.KR)(null);const A=(0,o.KR)(!1),M=(0,o.KR)(!1),D=(0,o.KR)(""),x=(0,o.KR)("0"),O=(0,o.KR)("0");(0,s.wB)((()=>d.value?.userStop),(e=>{if(e){f.value="red";const e="100a"===D.value?F:B;L.value={INPUT:e.INPUT.map((e=>({...e,slotState:"0"}))),OUTPUT:e.OUTPUT.map((e=>({...e,slotState:"0"})))}}else f.value="#00c2ff"})),(0,s.wB)((()=>t.state.embeddedStatusModule),(e=>{const t=e.sysInfo;"02"===t.eqStatCd&&(M.value=!1),M.value||(k.value=e.sysInfo.eqStatCd),i.value.isRunningState?(U(t.iCasStat,L.value.INPUT),U(t.oCasStat,L.value.OUTPUT)):(I.value=b.value,H(),W());const a=/[1,2,9]/g,l=String(t?.iCasStat);"999999999999"!==String(t?.iCasStat)&&(l.search(a)<0||"111111111111"===t?.oCasStat)&&(U(t.iCasStat,L.value.INPUT),U(t.oCasStat,L.value.OUTPUT))}),{deep:!0}),(0,s.wB)([i.value],(async e=>{const t=JSON.parse(JSON.stringify(e));t[0].startEmbedded?""===t[0].runningSlotId&&t[0].startEmbedded&&$():W(),t[0].isRunningState||(H(),W(),I.value=b.value)})),(0,s.wB)([a.value],(e=>{const t=JSON.parse(JSON.stringify(e));if(x.value=t[0]?.runningInfo?.iCasExist,O.value=t[0]?.runningInfo?.oCasExist,"start"===t[0].changeSlideState?.changeSlide.value&&!0===t[0].slideBooleanState?.slideIs.value?X():"stop"===t[0].changeSlideState?.changeSlide.value&&null!==N&&(clearInterval(N),N=null),"afterChange"===t[0].changeSlideState?.changeSlide.value&&(W(),X()),t[0].runningInfo){const e=t[0].runningInfo.slotInfo;if(e&&"03"===e?.stateCd){C.value=Number(e.wbcCount),h.value="pb"===window.PROJECT_TYPE?Number(e.maxWbcCount):Number(e.cellCount);const t=C.value/h.value*100;I.value=K(t)}}})),(0,s.wB)((()=>k.value),(e=>{"05"===e?T.value=setInterval((()=>{P.value=!P.value}),1e3):(P.value=!1,clearInterval(T.value))})),(0,s.wB)((()=>r.value),(e=>{e&&(k.value="05"),M.value=e})),(0,s.wB)((()=>m.pb100aCassette),(e=>{"reset"===e&&(H(),$(),W())}),{deep:!0}),(0,s.KC)((()=>{D.value=window.MACHINE_VERSION,L.value="100a"===D.value?F:B})),(0,s.sV)((()=>{k.value="01",L.value.INPUT.forEach((e=>{e.slotState="0"})),L.value.OUTPUT.forEach((e=>{e.slotState="0"})),A.value="bm"===window.PROJECT_TYPE}));const K=e=>b.value*(1-e/100),U=(e,t)=>{t.forEach(((t,a)=>{t.slotState=e.charAt(a)}))},X=()=>{N||(N=setInterval((()=>{i.value.isRunningState&&(_.value+=1,v.value=_.value%60,sessionStorage.setItem("elapsedTimeCount",String(_.value)),t.dispatch("timeModule/setTimeInfo",{slideTime:j(_.value)}))}),1e3))};(0,s.xo)((()=>{N&&(clearInterval(N),N=null),R&&(clearInterval(R),R=null)}));const $=()=>{R||(R=setInterval((()=>{i.value.isRunningState&&(E.value+=1,sessionStorage.setItem("totalElapsedTimeCount",String(E.value)),t.dispatch("timeModule/setTimeInfo",{totalSlideTime:j(E.value)}))}),1e3))},W=()=>{clearInterval(N),N=null,_.value=0,S.value=j(0),sessionStorage.removeItem("elapsedTimeCount"),t.dispatch("timeModule/setTimeInfo",{slideTime:"00:00:00"})},H=()=>{clearInterval(R),R=null,E.value=0,w.value=j(0),sessionStorage.removeItem("totalElapsedTimeCount"),t.dispatch("timeModule/setTimeInfo",{totalSlideTime:"00:00:00"})},G=()=>{switch(k.value){case"01":return"IDLE";case"02":return"READY";case"03":return"ERROR";case"04":return"RUNNING";case"05":return"INITIALIZATION";default:return"UNKNOWN"}},Y=(e,t)=>{if("input"===t)switch(e){case"0":return"class-for-state-0";case"1":return"class-for-state-1";case"2":return"class-for-state-2";case"3":return"class-for-state-3";case"4":return"class-for-state-4";default:return""}else switch(e){case"0":return"out-for-state-0";case"1":return"out-for-state-1";default:return"outClassDefault"}},V=e=>{switch(e){case"0":return"EMPTY";case"1":return"EXIST";case"2":return"FULL"}};return(e,t)=>((0,s.uX)(),(0,s.CE)("div",null,[t[6]||(t[6]=(0,s.Lk)("h3",{class:"titleText"},"Working View",-1)),(0,s.Lk)("div",null,[(0,s.Lk)("p",{class:(0,n.C4)({blinkColor:P.value})},(0,n.v_)(G()),3),(0,s.Lk)("p",null,(0,n.v_)(C.value),1),(0,s.Lk)("div",La,[((0,s.uX)(),(0,s.CE)("svg",Ea,[(0,s.Lk)("defs",null,[(0,s.Lk)("linearGradient",_a,[d.value.value?.userStop?((0,s.uX)(),(0,s.CE)("stop",{key:1,offset:"100%","stop-color":f.value},null,8,Pa)):((0,s.uX)(),(0,s.CE)(s.FK,{key:0},[t[0]||(t[0]=(0,s.Lk)("stop",{offset:"0%","stop-color":"#56ccf2"},null,-1)),t[1]||(t[1]=(0,s.Lk)("stop",{offset:"50%","stop-color":"#35b0b6"},null,-1)),t[2]||(t[2]=(0,s.Lk)("stop",{offset:"100%","stop-color":"#2f80ed"},null,-1))],64)),t[3]||(t[3]=(0,s.Lk)("animateTransform",{attributeName:"gradientTransform",type:"rotate",from:"0 0.5 0.5",to:"360 0.5 0.5",dur:"2s",repeatCount:"indefinite"},null,-1))]),t[4]||(t[4]=(0,s.Lk)("filter",{id:"shadow"},[(0,s.Lk)("feDropShadow",{dx:"0",dy:"0",stdDeviation:"6","flood-color":"rgba(0, 0, 0, 0.3)"})],-1))]),(0,s.Lk)("circle",{cx:y.value,cy:y.value,r:y.value-g.value/2,"stroke-width":g.value,stroke:"#ccc",fill:"none"},null,8,Ta),(0,s.Lk)("circle",{cx:y.value,cy:y.value,r:y.value-g.value/2,"stroke-width":g.value,stroke:"url(#gradient)",fill:"none","stroke-dasharray":b.value,"stroke-dashoffset":I.value,filter:"url(#shadow)"},null,8,Aa)])),(0,s.Lk)("p",Ma,(0,n.v_)(u.value.slideTime),1)]),t[5]||(t[5]=(0,s.Lk)("p",{class:"slideTime1 mt20"},"Total Time",-1)),(0,s.Lk)("p",null,(0,n.v_)(u.value.totalSlideTime),1)]),"12a"===D.value?((0,s.uX)(),(0,s.CE)("div",Da,[(0,s.Lk)("ul",xa,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(L.value.INPUT,(e=>((0,s.uX)(),(0,s.CE)("li",{key:e.slotNo,class:(0,n.C4)(Y(e.slotState,"input"))},null,2)))),128)),(0,s.bo)((0,s.Lk)("p",Oa,"INPUT",512),[[l.aG,i.value.isRunningState]])]),(0,s.Lk)("ul",Ka,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(L.value.OUTPUT,(e=>((0,s.uX)(),(0,s.CE)("li",{key:e.slotNo,class:(0,n.C4)(Y(e.slotState,"output"))},null,2)))),128)),(0,s.bo)((0,s.Lk)("p",Ba,"OUTPUT",512),[[l.aG,i.value.isRunningState]])])])):((0,s.uX)(),(0,s.CE)("div",Fa,[(0,s.Lk)("ul",Ua,[(0,s.bo)((0,s.Lk)("p",null,"INPUT : "+(0,n.v_)(V(x.value)),513),[[l.aG,i.value.isRunningState]]),((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)([...L.value.INPUT].reverse(),(e=>((0,s.uX)(),(0,s.CE)("li",{key:e.slotNo,class:(0,n.C4)(Y(e.slotState,"input"))},null,2)))),128)),(0,s.bo)((0,s.Lk)("p",{class:"mt10"},"OUTPUT : "+(0,n.v_)(V(O.value)),513),[[l.aG,i.value.isRunningState]])])]))]))}});const $a=Xa;var Wa=$a;const Ha={class:"orderListTableContainer"},Ga={class:"orderListTable"},Ya={key:0},Va={key:1};var ja=(0,s.pM)({__name:"orderList",props:["parsedData","startStatus","pb100aCassette"],setup(e){const t=(0,c.Pj)(),a=(0,s.EW)((()=>t.state.commonModule.siteCd)),l=e,i=(0,o.KR)([]);(0,s.wB)((()=>l.parsedData),(e=>{r(e)}),{deep:!0}),(0,s.wB)((()=>l.pb100aCassette),(e=>{"reset"===e&&(i.value=[],console.log("pb100aCassette 초기화",i.value))}),{deep:!0}),(0,s.wB)((()=>l.startStatus),(e=>{!0===e&&(i.value=[])}),{deep:!0});const r=async e=>{const t=e;if("RUNNING_INFO"===t.jobCmd){const e=t?.slotInfo;if(e){const a=e.barcodeNo,l=i.value.findIndex((e=>e.barcodeId===a)),s=[...t?.iCasStat].filter((e=>"0"!==e));if(-1===l&&""!==a){if(i.value.length>10&&(i.value=[]),i.value&&i.value.length>0){const e=s.lastIndexOf("3");-1!==e&&(i.value[e].stateCd=u.I_CAS_STAT_ID_LIST[3].cdNm)}const t=u.I_CAS_STAT_ID_LIST.find((e=>e.cd===s[i.value.length]));i.value.push({barcodeId:a,patientName:e.patientNm,orderDate:g(e.orderDttm)||0,analyzedDttm:g(e.analyzedDttm)||0,stateCd:t?.cdNm})}else{const e=u.I_CAS_STAT_ID_LIST.find((e=>e.cd===s[l]));i.value&&i.value.length>0&&i.value[l]?.stateCd&&(i.value[l].stateCd=e?.cdNm)}}}};return(e,t)=>((0,s.uX)(),(0,s.CE)("div",Ha,[t[2]||(t[2]=(0,s.Lk)("h3",{class:"titleText"},"Order List",-1)),(0,s.Lk)("table",Ga,[t[1]||(t[1]=(0,s.Lk)("thead",null,[(0,s.Lk)("tr",null,[(0,s.Lk)("th",null,"Barcode ID"),(0,s.Lk)("th",null,"Patient Name"),(0,s.Lk)("th",null,"Order Date"),(0,s.Lk)("th",null,"State")])],-1)),i.value.length>0?((0,s.uX)(),(0,s.CE)("tbody",Ya,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(i.value,((e,t)=>((0,s.uX)(),(0,s.CE)("tr",{key:t},[(0,s.Lk)("td",null,(0,n.v_)(e?.barcodeId),1),(0,s.Lk)("td",null,(0,n.v_)(e?.patientName),1),(0,s.Lk)("td",null,(0,n.v_)((0,o.R1)(I)["인천길병원"]===a.value?(0,o.R1)(V)(e?.analyzedDttm):(0,o.R1)(V)(e?.orderDate)),1),(0,s.Lk)("td",null,(0,n.v_)(e?.stateCd),1)])))),128))])):((0,s.uX)(),(0,s.CE)("tbody",Va,t[0]||(t[0]=[(0,s.Lk)("tr",null,[(0,s.Lk)("td",{colspan:"4"},"Data is empty.")],-1)])))])]))}});const Qa=ja;var qa=Qa;const Ja=[{id:"01",abbreviation:"NE",fullNm:"Neutrophil",key:"",orderIdx:1},{id:"71",abbreviation:"NS",fullNm:"Neutrophil-Segmented",key:"",orderIdx:2},{id:"72",abbreviation:"NB",fullNm:"Neutrophil-Band",key:"",orderIdx:3},{id:"02",abbreviation:"ME",fullNm:"Metamyelocyte",key:"",orderIdx:4},{id:"03",abbreviation:"MY",fullNm:"Myelocyte",key:"",orderIdx:5},{id:"04",abbreviation:"PR",fullNm:"Promyelocyte",key:"",orderIdx:6},{id:"05",abbreviation:"LY",fullNm:"Lymphocyte",key:"",orderIdx:7},{id:"61",abbreviation:"LR",fullNm:"Reactive lymphocyte",key:"",orderIdx:8},{id:"62",abbreviation:"LA",fullNm:"Abnormal lymphocyte",key:"",orderIdx:9},{id:"07",abbreviation:"MO",fullNm:"Monocyte",key:"",orderIdx:10},{id:"08",abbreviation:"EO",fullNm:"Eosinophil",key:"",orderIdx:11},{id:"09",abbreviation:"BA",fullNm:"Basophil",key:"",orderIdx:12},{id:"10",abbreviation:"BL",fullNm:"Blast",key:"",orderIdx:13},{id:"11",abbreviation:"PC",fullNm:"Plasma cell",key:"",orderIdx:14},{id:"12",abbreviation:"NR",fullNm:"nRBC",key:"",orderIdx:15},{id:"13",abbreviation:"GP",fullNm:"Giant platelet",key:"",orderIdx:16},{id:"14",abbreviation:"PA",fullNm:"Platelet aggregation",key:"",orderIdx:17},{id:"16",abbreviation:"MA",fullNm:"Malaria",key:"",orderIdx:18},{id:"15",abbreviation:"AR",fullNm:"Artifact",key:"",orderIdx:19},{id:"17",abbreviation:"SM",fullNm:"Smudge",key:"",orderIdx:20}],za=[{id:"01",abbreviation:"NE",fullNm:"Neutrophil",key:"",orderIdx:1},{id:"71",abbreviation:"NS",fullNm:"Neutrophil-Segmented",key:"",orderIdx:2},{id:"72",abbreviation:"NB",fullNm:"Neutrophil-Band",key:"",orderIdx:3},{id:"02",abbreviation:"ME",fullNm:"Metamyelocyte",key:"",orderIdx:4},{id:"03",abbreviation:"MY",fullNm:"Myelocyte",key:"",orderIdx:5},{id:"04",abbreviation:"PR",fullNm:"Promyelocyte",key:"",orderIdx:6},{id:"05",abbreviation:"LY",fullNm:"Lymphocyte",key:"",orderIdx:7},{id:"06",abbreviation:"LA",fullNm:"Abnormal lymphocyte",key:"",orderIdx:8},{id:"07",abbreviation:"MO",fullNm:"Monocyte",key:"",orderIdx:9},{id:"08",abbreviation:"EO",fullNm:"Eosinophil",key:"",orderIdx:10},{id:"09",abbreviation:"BA",fullNm:"Basophil",key:"",orderIdx:11},{id:"10",abbreviation:"BL",fullNm:"Blast",key:"",orderIdx:12},{id:"11",abbreviation:"PC",fullNm:"Plasma cell",key:"",orderIdx:13},{id:"12",abbreviation:"ON",fullNm:"Orthochromic Normoblast",key:"",orderIdx:14},{id:"13",abbreviation:"PN",fullNm:"Polychromic Normoblast",key:"",orderIdx:15},{id:"14",abbreviation:"BN",fullNm:"Basophilic Normoblast",key:"",orderIdx:16},{id:"15",abbreviation:"PE",fullNm:"Proerythroblast",key:"",orderIdx:17},{id:"16",abbreviation:"HC",fullNm:"Histiocyte",key:"",orderIdx:18},{id:"17",abbreviation:"OT",fullNm:"Others",key:"",orderIdx:19}],Za=[{classId:"01",abbreviation:"NE",fullNm:"Neutrophil",orderIdx:1},{classId:"71",abbreviation:"NS",fullNm:"Neutrophil-Segmented",orderIdx:2},{classId:"72",abbreviation:"NB",fullNm:"Neutrophil-Band",orderIdx:3},{classId:"02",abbreviation:"ME",fullNm:"Metamyelocyte",orderIdx:4},{classId:"03",abbreviation:"MY",fullNm:"Myelocyte",orderIdx:5},{classId:"04",abbreviation:"PR",fullNm:"Promyelocyte",orderIdx:6},{classId:"05",abbreviation:"LY",fullNm:"Lymphocyte",orderIdx:7},{classId:"61",abbreviation:"LR",fullNm:"Reactive lymphocyte",orderIdx:8},{classId:"62",abbreviation:"LA",fullNm:"Abnormal lymphocyte",orderIdx:9},{classId:"07",abbreviation:"MO",fullNm:"Monocyte",orderIdx:10},{classId:"08",abbreviation:"EO",fullNm:"Eosinophil",orderIdx:11},{classId:"09",abbreviation:"BA",fullNm:"Basophil",orderIdx:12},{classId:"10",abbreviation:"BL",fullNm:"Blast",orderIdx:13},{classId:"11",abbreviation:"PC",fullNm:"Plasma cell",orderIdx:14},{classId:"12",abbreviation:"NR",fullNm:"nRBC",orderIdx:15},{classId:"13",abbreviation:"GP",fullNm:"Giant platelet",orderIdx:16},{classId:"14",abbreviation:"PA",fullNm:"Platelet aggregation",orderIdx:17},{classId:"16",abbreviation:"MA",fullNm:"Malaria",orderIdx:18},{classId:"15",abbreviation:"AR",fullNm:"Artifact",orderIdx:19},{classId:"17",abbreviation:"SM",fullNm:"Smudge",orderIdx:20}],el=[{classId:"01",abbreviation:"NE",fullNm:"Neutrophil",orderIdx:1},{classId:"71",abbreviation:"NS",fullNm:"Neutrophil-Segmented",orderIdx:2},{classId:"72",abbreviation:"NB",fullNm:"Neutrophil-Band",orderIdx:3},{classId:"02",abbreviation:"ME",fullNm:"Metamyelocyte",orderIdx:4},{classId:"03",abbreviation:"MY",fullNm:"Myelocyte",orderIdx:5},{classId:"04",abbreviation:"PR",fullNm:"Promyelocyte",orderIdx:6},{classId:"05",abbreviation:"LY",fullNm:"Lymphocyte",orderIdx:7},{classId:"06",abbreviation:"LA",fullNm:"Abnormal lymphocyte",orderIdx:8},{classId:"07",abbreviation:"MO",fullNm:"Monocyte",orderIdx:9},{classId:"08",abbreviation:"EO",fullNm:"Eosinophil",orderIdx:10},{classId:"09",abbreviation:"BA",fullNm:"Basophil",orderIdx:11},{classId:"10",abbreviation:"BL",fullNm:"Blast",orderIdx:12},{classId:"11",abbreviation:"PC",fullNm:"Plasma cell",orderIdx:13},{classId:"12",abbreviation:"ON",fullNm:"Orthochromic Normoblast",orderIdx:14},{classId:"13",abbreviation:"PN",fullNm:"Polychromic Normoblast",orderIdx:15},{classId:"14",abbreviation:"BN",fullNm:"Basophilic Normoblast",orderIdx:16},{classId:"15",abbreviation:"PE",fullNm:"Proerythroblast",orderIdx:17},{classId:"16",abbreviation:"HC",fullNm:"Histiocyte",orderIdx:18},{classId:"17",abbreviation:"OT",fullNm:"Others",orderIdx:19}],tl=[{id:"01",title:"NE",name:"Neutrophil",count:0,percent:0,key:"",order:1},{id:"71",title:"NS",name:"Neutrophil-Segmented",count:0,percent:0,key:"",order:2},{id:"72",title:"NB",name:"Neutrophil-Band",count:0,percent:0,key:"",order:3},{id:"02",title:"ME",name:"Metamyelocyte",count:0,percent:0,key:"",order:4},{id:"03",title:"MY",name:"Myelocyte",count:0,percent:0,key:"",order:5},{id:"04",title:"PR",name:"Promyelocyte",count:0,percent:0,key:"",order:6},{id:"05",title:"LY",name:"Lymphocyte",count:0,percent:0,key:"",order:7},{id:"61",title:"LR",name:"Reactive lymphocyte",count:0,percent:0,key:"",order:8},{id:"62",title:"LA",name:"Abnormal lymphocyte",count:0,percent:0,key:"",order:9},{id:"07",title:"MO",name:"Monocyte",count:0,percent:0,key:"",order:10},{id:"08",title:"EO",name:"Eosinophil",count:0,percent:0,key:"",order:11},{id:"09",title:"BA",name:"Basophil",count:0,percent:0,key:"",order:12},{id:"10",title:"BL",name:"Blast",count:0,percent:0,key:"",order:13},{id:"11",title:"PC",name:"Plasma cell",count:0,percent:0,key:"",order:14},{id:"12",title:"NR",name:"nRBC",count:0,percent:0,key:"",order:15},{id:"13",title:"GP",name:"Giant platelet",count:0,percent:0,key:"",order:16},{id:"14",title:"PA",name:"Platelet aggregation",count:0,percent:0,key:"",order:17},{id:"16",title:"MA",name:"Malaria",count:0,percent:0,key:"",order:18},{id:"15",title:"AR",name:"Artifact",count:0,percent:0,key:"",order:19},{id:"17",title:"SM",name:"Smudge",count:0,percent:0,key:"",order:20}],al=[{id:"01",title:"NE",name:"Neutrophil",count:0,percent:0,order:1},{id:"71",title:"NS",name:"Neutrophil-Segmented",count:0,percent:0,key:"",order:2},{id:"72",title:"NB",name:"Neutrophil-Band",count:0,percent:0,key:"",order:3},{id:"02",title:"ME",name:"Metamyelocyte",count:0,percent:0,order:4},{id:"03",title:"MY",name:"Myelocyte",count:0,percent:0,order:5},{id:"04",title:"PR",name:"Promyelocyte",count:0,percent:0,order:6},{id:"05",title:"LY",name:"Lymphocyte",count:0,percent:0,order:7},{id:"06",title:"LA",name:"Abnormal lymphocyte",count:0,percent:0,order:8},{id:"07",title:"MO",name:"Monocyte",count:0,percent:0,order:9},{id:"08",title:"EO",name:"Eosinophil",count:0,percent:0,order:10},{id:"09",title:"BA",name:"Basophil",count:0,percent:0,order:11},{id:"10",title:"BL",name:"Blast",count:0,percent:0,order:12},{id:"11",title:"PC",name:"Plasma cell",count:0,percent:0,order:13},{id:"12",title:"ON",name:"Orthochromic Normoblast",count:0,percent:0,order:14},{id:"13",title:"PN",name:"Polychromic Normoblast",count:0,percent:0,order:15},{id:"14",title:"BN",name:"Basophilic Normoblast",count:0,percent:0,order:16},{id:"15",title:"PE",name:"Proerythroblast",count:0,percent:0,order:17},{id:"16",title:"HC",name:"Histiocyte",count:0,percent:0,order:18},{id:"17",title:"OT",name:"Others",count:0,percent:0,order:19}],ll={class:"titleText"},sl={class:"analysisWbc"},ol={key:0,class:"categories"},nl={class:"categoryNm"},il={key:0,class:"mb10 liTitle",style:{cursor:"default"}},rl={style:{cursor:"default"}},cl={class:"classNm"},ul={key:0,class:"mb10 liTitle",style:{cursor:"default"}},dl={style:{"text-align":"center",cursor:"default"}},ml={class:"degree"},vl={key:0,class:"mb10 liTitle",style:{cursor:"default"}},pl={style:{cursor:"default"}},gl={class:"categories"},fl={class:"classNm"},yl={style:{cursor:"default"}},bl={key:0,class:"categories mt10"},Il={class:"categoryNm"},Cl={key:0,class:"mb10 liTitle"},hl={class:"classNm"},kl={key:0,class:"mb10 liTitle"},Sl={style:{"text-align":"center"}},wl={class:"degree"},Nl={key:0,class:"mb10 liTitle"},Rl={class:"mt10"},Ll={class:"categoryNm",style:{cursor:"default"}},El={key:0,class:"mb10 liTitle",style:{cursor:"default"}},_l={style:{cursor:"default"}},Pl={class:"classNm"},Tl={key:0,class:"mb10 liTitle"},Al={style:{cursor:"default"}},Ml={key:0},Dl={class:"degree"},xl={key:0,class:"mb10 liTitle"};var Ol=(0,s.pM)({__name:"classInfoification",props:["bmIsBoolen","parsedData"],setup(e,{emit:t}){const a=e,l=(0,c.Pj)(),i=(0,s.EW)((()=>l.state.commonModule.siteCd)),r=((0,o.KR)(!1),(0,o.KR)([])),u=(0,o.KR)([]),d=(0,o.KR)(""),m=(0,o.KR)("0"),v=(0,o.KR)(""),p=t;sessionStorage.getItem("isNsNbIntegration");(0,s.sV)((()=>{f(za,null,!0)})),(0,s.wB)((()=>a.parsedData),((e,t)=>{g(e)}),{deep:!0});const g=async e=>{const t=e;"RUNNING_INFO"===t.jobCmd&&await f({wbcInfo:t.slotInfo},t)},f=async(e,t,l)=>{const s=JSON.parse(JSON.stringify(e));if(s.wbcInfo){d.value=s?.wbcInfo?.testType;const e=a.bmIsBoolen?[s.wbcInfo.bmInfo]:[s.wbcInfo.wbcInfo],t=e,l=a.bmIsBoolen?[al]:[tl];r.value=t[0].length>0?t:l;const o=e=>e.every((e=>e.every((e=>"0"===e.count)))),n=o(r.value);n&&(m.value="0"),u.value=r.value.flat()}else{const e=a.bmIsBoolen?[al]:[tl];r.value=e,u.value=r.value.flat()}if(s&&s.wbcInfo){const e=s.wbcInfo;e&&"03"===e?.stateCd&&(await C(e),v.value=e.maxWbcCount)}const o=t?.iCasStat??"",n=[...o];if(-1!==n.lastIndexOf("2")){const e={classInfo:{wbcInfo:r.value,totalCount:m.value,maxWbcCount:v.value,slotId:t.slotInfo.slotId},iCasStatArr:n.lastIndexOf("2")};p("classInfoUpdate",e)}},y=e=>e.flat().filter((e=>["NR","AR","GP","PA","MC","MA","GP","PA","SM"].includes(e?.title))),b=(e,t)=>{e&&""!==e||(e="0000",t="01");const a={"0006":{includesStr:["AR","NR","GP","PA","MC","MA","SM","NE","GP","PA","OT"],includesStr2:["NR","AR","MC","MA","SM","NE","GP","PA","OT"]}},l=a[e]||{includesStr:["AR","NR","GP","PA","MC","SM","MA","GP","PA","OT"],includesStr2:["NR","AR","MC","MA","SM","GP","PA","OT"]};return"01"===t||"04"===t?l.includesStr:l.includesStr2},I=(e,t)=>{const a=b(i.value,d.value);let l=0;for(let s of e)a.includes(s.title)||(l+=Number(s.count));return l},C=async e=>{const t=a.bmIsBoolen?e.bmInfo:e.wbcInfo,l=t;let s="0";s="01"===d.value||"04"===d.value?I(r.value.flat(),l).toFixed(0):I(u.value,l).toFixed(0),m.value=s,await S()},h=e=>{const t=k(i.value,d.value);return!t.includes(e.title)},k=(e,t)=>{const a={"0006":{includesStr:["AR","NR","GP","PA","MC","MA","SM","NE","GP","PA","OT"],includesStr2:["NR","AR","MC","MA","SM","NE","GP","PA","OT"]}},l=a[e]||{includesStr:["AR","NR","GP","PA","MC","SM","MA","GP","PA","OT"],includesStr2:["NR","AR","MC","MA","SM","GP","PA","OT"]};return"01"===t||"04"===t?l.includesStr:l.includesStr2},S=async()=>{const e=r.value.map((e=>e.map((e=>{const t=m.value&&"0"!==m.value?(Number(e.count)/Number(m.value)*100).toFixed(1):"0",a=Number(t)===Math.floor(Number(t))?Math.floor(Number(t)).toString():t;return{...e,percent:a}}))));r.value=e},w=e=>e?.name;return(t,a)=>((0,s.uX)(),(0,s.CE)("div",{class:(0,n.C4)([e.bmIsBoolen?"bmclass":""])},[(0,s.Lk)("h3",ll,[e.bmIsBoolen?((0,s.uX)(),(0,s.CE)(s.FK,{key:0},[(0,s.eW)("BM Classification ")],64)):((0,s.uX)(),(0,s.CE)(s.FK,{key:1},[(0,s.eW)("WBC Classification")],64))]),(0,s.Lk)("div",sl,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(r.value,((e,t)=>((0,s.uX)(),(0,s.CE)(s.FK,{key:t},[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(e,((e,a)=>((0,s.uX)(),(0,s.CE)(s.FK,{key:a},[h(e)?((0,s.uX)(),(0,s.CE)("div",ol,[(0,s.Lk)("ul",nl,[0===a&&0===t?((0,s.uX)(),(0,s.CE)("li",il,"Class")):(0,s.Q3)("",!0),(0,s.Lk)("li",rl,(0,n.v_)(w(e)),1)]),(0,s.Lk)("ul",cl,[0===a&&0===t?((0,s.uX)(),(0,s.CE)("li",ul,"Count")):(0,s.Q3)("",!0),(0,s.Lk)("li",dl,(0,n.v_)(e?.count),1)]),(0,s.Lk)("ul",ml,[0===a&&0===t?((0,s.uX)(),(0,s.CE)("li",vl,"%")):(0,s.Q3)("",!0),(0,s.Lk)("li",pl,(0,n.v_)(m.value&&"0"!==m.value?(Number(e?.count)/Number(m.value)*100).toFixed(Number(e?.count)/Number(m.value)===0?0:1):"0"),1)])])):(0,s.Q3)("",!0)],64)))),128))],64)))),128)),(0,s.Lk)("div",gl,[a[0]||(a[0]=(0,s.Lk)("ul",{class:"categoryNm"},[(0,s.Lk)("li",{style:{cursor:"default"}}," Total ")],-1)),(0,s.Lk)("ul",fl,[(0,s.Lk)("li",yl,(0,n.v_)(m.value||0),1)]),a[1]||(a[1]=(0,s.Lk)("ul",{class:"degree"},[(0,s.Lk)("li",{style:{cursor:"default"}}," 100.00 ")],-1))]),((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(r.value,((e,t)=>((0,s.uX)(),(0,s.CE)(s.FK,{key:t},[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(e,((e,a)=>((0,s.uX)(),(0,s.CE)(s.FK,{key:a},["OT"===e.title?((0,s.uX)(),(0,s.CE)("div",bl,[(0,s.Lk)("ul",Il,[0===a&&0===t?((0,s.uX)(),(0,s.CE)("li",Cl,"Class")):(0,s.Q3)("",!0),(0,s.Lk)("li",null,(0,n.v_)(w(e)),1)]),(0,s.Lk)("ul",hl,[0===a&&0===t?((0,s.uX)(),(0,s.CE)("li",kl,"Count")):(0,s.Q3)("",!0),(0,s.Lk)("li",Sl,(0,n.v_)(e?.count),1)]),(0,s.Lk)("ul",wl,[0===a&&0===t?((0,s.uX)(),(0,s.CE)("li",Nl,"-")):(0,s.Q3)("",!0),(0,s.Lk)("li",null,(0,n.v_)(m.value&&"0"!==m.value?(Number(e?.count)/Number(m.value)*100).toFixed(0):"0"),1)])])):(0,s.Q3)("",!0)],64)))),128))],64)))),128)),(0,s.Lk)("div",Rl,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(y(r.value),((e,t)=>((0,s.uX)(),(0,s.CE)("div",{key:t,class:"categories"},[(0,s.Lk)("ul",Ll,[0===t?((0,s.uX)(),(0,s.CE)("li",El,"non-WBC")):(0,s.Q3)("",!0),(0,s.Lk)("li",_l,(0,n.v_)(w(e)),1)]),(0,s.Lk)("ul",Pl,[0===t?((0,s.uX)(),(0,s.CE)("li",Tl)):(0,s.Q3)("",!0),(0,s.Lk)("li",Al,[(0,s.eW)((0,n.v_)(e?.count)+" ",1),"NR"===e.title||"GP"===e.title?((0,s.uX)(),(0,s.CE)("span",Ml," / "+(0,n.v_)(v.value)+" WBC",1)):(0,s.Q3)("",!0)])]),(0,s.Lk)("ul",Dl,[0===t?((0,s.uX)(),(0,s.CE)("li",xl)):(0,s.Q3)("",!0),a[2]||(a[2]=(0,s.Lk)("li",{style:{cursor:"default"}},"-",-1))])])))),128))])])],2))}});const Kl=Ol;var Bl=Kl;const Fl=[{categoryId:"01",categoryNm:"Size",classInfo:[{classId:"01",classNm:"Normal",degree:"0"},{classId:"02",classNm:"Macrocyte",degree:"0"},{classId:"03",classNm:"Microcyte",degree:"0"},{classId:"04",classNm:"Anisocytosis",degree:"0"}]},{categoryId:"02",categoryNm:"Chromia",classInfo:[{classId:"01",classNm:"Normal",degree:"0"},{classId:"02",classNm:"Hyperchromic",degree:"0"},{classId:"03",classNm:"Hypochromic",degree:"0"},{classId:"04",classNm:"Polychromia",degree:"0"}]},{categoryId:"03",categoryNm:"Shape",classInfo:[{classId:"01",classNm:"Normal",degree:"0"},{classId:"02",classNm:"Poikilocytosis",degree:"0"},{classId:"03",classNm:"Target Cell",degree:"0"},{classId:"04",classNm:"Burr Cell",degree:"0"},{classId:"05",classNm:"Acanthocyte",degree:"0"},{classId:"06",classNm:"Ovalocyte",degree:"0"},{classId:"07",classNm:"Schistocyte",degree:"0"},{classId:"08",classNm:"Sickle Cell",degree:"0"},{classId:"09",classNm:"Stomatocyte",degree:"0"},{classId:"10",classNm:"Tear Drop Cell",degree:"0"},{classId:"11",classNm:"Spherocyte",degree:"0"}]},{categoryId:"05",categoryNm:"Inclusion Body",classInfo:[{classId:"01",classNm:"Howell-Jolly Body",degree:"0"},{classId:"02",classNm:"Basophilic Stippling",degree:"0"}]}],Ul={key:0},Xl={class:"row"},$l=["src","id","onClick"],Wl={key:0,class:"mt-3 row"},Hl={class:"col"},Gl={key:1},Yl={class:"categoryNm"},Vl={key:0,class:"mb10 liTitle",style:{cursor:"default"}},jl={style:{cursor:"default"}},Ql={class:"classNmRbc"},ql={key:0,class:"mb10 liTitle",style:{cursor:"default"}},Jl={style:{cursor:"default"}},zl={key:0,style:{cursor:"default"}},Zl={class:"degree analysis"},es={key:0,class:"mb10 liTitle",style:{cursor:"default"}},ts={key:0,style:{cursor:"default"}},as={key:1,style:{cursor:"default"}},ls={key:0},ss={key:1},os={key:2,style:{"font-size":"0.7rem",cursor:"default"}},ns={class:"categories"},is={class:"degree analysis"},rs={style:{"font-size":"0.7rem",cursor:"default"}};var cs=(0,s.pM)({__name:"rbcclassification",props:["bmIsBoolen","parsedData"],setup(e,{emit:t}){const a=e,l=(0,o.KR)([]),i=(0,o.KR)(""),r=(0,o.KR)(""),c=(0,o.KR)(""),u=(0,o.KR)("01"),d=(0,o.KR)([]),m=(0,o.KR)([]),v=t;(0,s.sV)((async()=>{await C(),await f({rbcInfo:a.parsedData.slotInfo},"")})),(0,s.wB)((()=>a.parsedData),((e,t)=>{p(e)}),{deep:!0});const p=async e=>{const t=e;if("RUNNING_INFO"===t.jobCmd){const a=e?.slotInfo;a&&"03"===a?.stateCd&&(i.value=a.malariaCount,r.value=a.maxRbcCount,c.value=a.pltCount),await f({rbcInfo:t.slotInfo},t)}},g=(0,o.KR)([]),f=async(e,t)=>{const a=JSON.parse(JSON.stringify(e));if(Array.isArray(a.rbcInfo)){if(u.value=a.rbcInfo[0].testType,!a.rbcInfo[0])return;const e=[a.rbcInfo[0].rbcInfo],l=e[0].length>0?e:[Fl];y(l[0],t),a.rbcInfo[0].lowPowerPath?g.value=a.rbcInfo[0].lowPowerPath.sort((function(e,t){return e.seqNo-t.seqNo})):g.value=[]}else y([Fl][0],t)},y=(e,t)=>{let a=0,s=0,o=0;const n=0!==t.length&&t?JSON.parse(JSON.stringify(t?.slotInfo?.rbcInfo)):JSON.parse(JSON.stringify(e)),i=0!==t.length&&t?JSON.parse(JSON.stringify(t?.slotInfo?.rbcInfo)):JSON.parse(JSON.stringify(e));i.forEach((e=>{e.classInfo.forEach((t=>{"01"===e.categoryId?"04"!==t.classId&&(s+=Number(t.degree)):"02"===e.categoryId?"04"!==t.classId&&(o+=Number(t.degree)):a+=Number(t.degree)}))})),i.forEach(((e,t)=>{e.classInfo.forEach(((l,i)=>{m.value&&m.value.forEach((r=>{if(l.originalDegree=n[t].classInfo[i].degree,r.categoryId===e.categoryId&&r.classId===l.classId){const e=Number(l.degree);let t=0;t="01"===r.categoryId?Number((e/s*100).toFixed(2)):"02"===r.categoryId?Number((e/o*100).toFixed(2)):Number((e/a*100).toFixed(2)),isNaN(t)&&(t=0);const n=e=>l.degree=e;t<Number(r.degree1)?n("0"):t<Number(r.degree2)?n("1"):t<Number(r.degree3)?n("2"):n("3")}}))}))})),i.forEach((e=>{e.classInfo.forEach((t=>{if("01"===e.categoryId&&("01"===t.classId&&(e.classInfo[0].degree="1"),["02","03"].includes(t.classId)&&Number(t.degree)>0&&(e.classInfo[0].degree="0")),"02"===e.categoryId&&("01"===t.classId&&(e.classInfo[0].degree="1"),["02","03"].includes(t.classId)&&Number(t.degree)>0&&(e.classInfo[0].degree="0")),"03"===e.categoryId&&("01"===t.classId&&(e.classInfo[0].degree="1",e.classInfo[1].degree="0"),"01"!==t.classId&&"02"!==t.classId)){var a=Number(e.classInfo[1].degree);Number(t.degree)>a&&(e.classInfo[0].degree="0",e.classInfo[1].degree=t.degree)}}))})),l.value[0]=i,0===i.length&&(l.value[0]=Fl);const r=t?.iCasStat??"",c=[...r];if(-1!==c.lastIndexOf("2")){const e={rbc:{rbcInfo:i,slotId:t.slotInfo.slotId},iCasStatArr:c.lastIndexOf("2")};v("rbcUpdate",e)}},b=e=>e?.categoryNm,I=(e,t)=>{if("03"===u.value){const e=d.value.findIndex((e=>e.seqNo===t.seqNo));-1!==e?d.value.splice(e,1):d.value.push(t)}},C=async()=>{try{const e=await ie(),t=e.data;m.value=t}catch(e){console.error(e)}};return(e,t)=>{const a=(0,s.g2)("font-awesome-icon");return(0,s.uX)(),(0,s.CE)("div",null,["01"!==u.value&&"04"!==u.value?((0,s.uX)(),(0,s.CE)("div",Ul,[t[1]||(t[1]=(0,s.Lk)("h3",{class:"titleText"},[(0,s.Lk)("span",{class:"greenColor"},"Whole"),(0,s.eW)(" Slide Image ")],-1)),(0,s.Lk)("div",null,[((0,s.uX)(),(0,s.CE)(s.FK,null,(0,s.pI)([0,6,12,18,24,30],((e,t)=>(0,s.Lk)("div",{key:t,class:"pl-2"},[(0,s.Lk)("div",Xl,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(g.value.slice(e,e+6),((e,t)=>((0,s.uX)(),(0,s.CE)("div",{key:t,class:"col-2 p-1"},[(0,s.Lk)("img",{src:e.path,id:e.seqNo,ref_for:!0,ref:"wholeSlideImg",class:"wholeSlideImg",onClick:t=>I(t,e),style:{width:"75px"}},null,8,$l)])))),128))])]))),64)),"03"===u.value?((0,s.uX)(),(0,s.CE)("div",Wl,[t[0]||(t[0]=(0,s.Lk)("div",{class:"col"},[(0,s.Lk)("div",{style:{color:"#2798DC"}},"Select Interest Area")],-1)),(0,s.Lk)("div",Hl,[(0,s.Lk)("div",null,(0,n.v_)(d.value.length),1)])])):(0,s.Q3)("",!0)])])):((0,s.uX)(),(0,s.CE)("div",Gl,[t[2]||(t[2]=(0,s.Lk)("h3",{class:"titleText"},"RBC Classification",-1)),((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(l.value,((e,t)=>((0,s.uX)(),(0,s.CE)(s.FK,{key:t},[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(e,((e,t)=>((0,s.uX)(),(0,s.CE)("div",{key:t,class:"categories"},[(0,s.Lk)("ul",Yl,[0===t?((0,s.uX)(),(0,s.CE)("li",Vl,"Category")):(0,s.Q3)("",!0),(0,s.Lk)("li",jl,(0,n.v_)(b(e)),1)]),(0,s.Lk)("ul",Ql,[0===t?((0,s.uX)(),(0,s.CE)("li",ql,"Class")):(0,s.Q3)("",!0),((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(e?.classInfo,((e,t)=>((0,s.uX)(),(0,s.CE)(s.FK,{key:t},[(0,s.Lk)("li",Jl,(0,n.v_)(e?.classNm),1),"Basophilic Stippling"===e.classNm?((0,s.uX)(),(0,s.CE)("li",zl,"Malaria")):(0,s.Q3)("",!0)],64)))),128))]),(0,s.Lk)("ul",Zl,[0===t?((0,s.uX)(),(0,s.CE)("li",es,"Degree")):(0,s.Q3)("",!0),((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(e?.classInfo,((t,l)=>((0,s.uX)(),(0,s.CE)(s.FK,{key:l},["01"!==t.classId||"05"===e.categoryId?((0,s.uX)(),(0,s.CE)("li",ts,[((0,s.uX)(),(0,s.CE)(s.FK,null,(0,s.pI)(4,(e=>(0,s.bF)(a,{icon:["fas","circle"],key:e,class:(0,n.C4)({degreeActive:e<Number(t?.degree)+2||0,"degree0-img":e>=Number(t?.degree)+1||0}),style:{cursor:"default"}},null,8,["class"]))),64))])):((0,s.uX)(),(0,s.CE)("li",as,["0"===t.degree?((0,s.uX)(),(0,s.CE)("div",ls,[(0,s.bF)(a,{icon:["fas","circle"]})])):((0,s.uX)(),(0,s.CE)("div",ss,[(0,s.bF)(a,{icon:["fas","circle"],class:"degreeActive"})]))])),"Basophilic Stippling"===t.classNm?((0,s.uX)(),(0,s.CE)("li",os,(0,n.v_)(i.value||0)+" / "+(0,n.v_)(r.value||0)+" RBC",1)):(0,s.Q3)("",!0)],64)))),128))])])))),128))],64)))),128))])),(0,s.Lk)("div",null,[(0,s.Lk)("div",ns,[t[3]||(t[3]=(0,s.Lk)("ul",{class:"categoryNm"},[(0,s.Lk)("li",{style:{cursor:"default"}},"Others")],-1)),t[4]||(t[4]=(0,s.Lk)("ul",{class:"classNmRbc"},[(0,s.Lk)("li",{style:{cursor:"default"}},"Platelets")],-1)),(0,s.Lk)("ul",is,[(0,s.Lk)("li",rs,(0,n.v_)(c.value||0)+" PLT / 1000 RBC",1)])])])])}}});const us=cs;var ds=us;const ms={class:"mt10"},vs={key:0,class:"slider-found"},ps=["src"];var gs=(0,s.pM)({__name:"foundingCells",props:["parsedData","pb100aCassette"],setup(e){const t=window.APP_API_BASE_URL||"http://192.168.0.131:3002",a=e,n=(0,c.Pj)(),i=(0,s.EW)((()=>n.state.runningInfoModule.changeSlideState)),r=(0,o.KR)([]);function u(){return Math.random().toString(36).substring(2,15)+Math.random().toString(36).substring(2,15)}function d(e){if(!e||0===e.length)return"";const a=e?.path.match(/^(.*\\)\d+_Real_Time\\/)?.[0],l=e?.path.match(/[^\\]*$/)[0],s=`${t}/images/getImageRealTime?folder=${a}&imageName=${l}`;return s}return(0,s.wB)((()=>a.pb100aCassette),(e=>{console.log("IMAGE_RESET - should be 'reset'",e),"reset"===e&&(r.value=[])}),{deep:!0}),(0,s.wB)((()=>a.parsedData),((e,t)=>{const a=e?.slotInfo;if("afterChange"===i.value.changeSlide.value&&(r.value=[]),a&&"03"===a.stateCd&&a.runningPath&&a.runningPath.length>0){const e=a.runningPath.map((e=>({...e,path:e.path,id:u()})));for(const t of e)r.value.unshift(t)}}),{deep:!0}),(e,t)=>((0,s.uX)(),(0,s.CE)("div",ms,[(0,s.bF)(l.eB,{name:"fade",mode:"out-in"},{default:(0,s.k6)((()=>[r.value.length>0?((0,s.uX)(),(0,s.CE)("div",vs,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(r.value,(e=>((0,s.uX)(),(0,s.CE)(s.FK,{key:e.id},[d(e)?((0,s.uX)(),(0,s.CE)("img",{key:0,style:{width:"150px",height:"150px"},src:d(e),alt:"Slide"},null,8,ps)):(0,s.Q3)("",!0)],64)))),128))])):(0,s.Q3)("",!0)])),_:1})]))}});const fs=gs;var ys=fs;const bs={class:"progress-bar-guage"},Is={class:"steps"},Cs={key:0},hs={key:1},ks={key:0,class:"lineGuasge"},Ss={class:"newProgressNm"};var ws=(0,s.pM)({__name:"GaugeBar",props:["parsedDataSysInfo"],setup(e){const t=e,a=(0,o.Kh)({progressBarText:"",progressBarPercent:0,progressArr:[]});(0,s.wB)((()=>t.parsedDataSysInfo),(e=>{e&&(a.progressBarText=e.progressBarText||"",a.progressBarPercent=e.progressBarPercent||0,console.log(e.progressArr),a.progressArr=(e.progressArr||[]).map((e=>({progressNo:e.progressNo,progressName:e.progressName,progressPercent:e.progressPercent}))))}),{immediate:!0,deep:!0});return(0,s.sV)((()=>{0===a.progressArr.length&&(a.progressArr=[{progressNo:1,progressName:"Step 1",progressPercent:0},{progressNo:2,progressName:"Step 2",progressPercent:0},{progressNo:3,progressName:"Step 3",progressPercent:0}])})),(e,t)=>((0,s.uX)(),(0,s.CE)("div",bs,[(0,s.Lk)("div",Is,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(a.progressArr,((e,t)=>((0,s.uX)(),(0,s.CE)("div",{key:t,class:"step-container"},[(0,s.Lk)("div",{class:(0,n.C4)(["circleGuage",{completed:100===e.progressPercent,active:e.progressPercent>0&&e.progressPercent<100,waiting:""===e.progressPercent&&t===a.progressArr.length-1}])},[100===e.progressPercent?((0,s.uX)(),(0,s.CE)("span",Cs,"✔")):((0,s.uX)(),(0,s.CE)("span",hs,(0,n.v_)(e.progressNo),1))],2),t<a.progressArr.length?((0,s.uX)(),(0,s.CE)("div",ks,[(0,s.Lk)("div",{class:"line-fill",style:(0,n.Tr)({width:e.progressPercent+"%",transition:"width 0.5s ease"})},null,4),(0,s.Lk)("div",Ss,(0,n.v_)(e.progressName),1)])):(0,s.Q3)("",!0)])))),128))])]))}});const Ns=ws;var Rs=Ns;const Ls={class:"circular-progress-bar mt20"},Es={class:"progress-ring",width:"140",height:"140"},_s={id:"gradient",x1:"0%",y1:"0%",x2:"100%",y2:"100%"},Ps=["stop-color"],Ts=["cx","cy","r","stroke-width"],As=["cx","cy","r","stroke-width","stroke-dasharray","stroke-dashoffset"],Ms={class:"progress-bar-text-gauge"},Ds={key:1,class:"slideCardWrap"},xs={class:"slideContent"},Os={class:"mt10"},Ks={class:"slideContent"},Bs={class:"mt10"},Fs={key:2,class:"slideCardWrap"},Us={class:"slideContent pb100a"},Xs={class:"renewalTotalTime"},$s={class:"renewalSlideTime"},Ws={class:"slideTime"};var Hs=(0,s.pM)({__name:"renewalWorking",props:["parsedData","pb100aCassette","parsedDataSysInfo"],setup(e){const t=(0,c.Pj)(),a=(0,s.EW)((()=>t.state.runningInfoModule)),i=(0,s.EW)((()=>t.state.commonModule)),r=(0,s.EW)((()=>t.state.commonModule.initValData)),u=(0,s.EW)((()=>t.state.timeModule)),d=(0,s.EW)((()=>t.state.embeddedStatusModule)),m=e,v=(0,s.EW)((()=>t.state.commonModule.siteCd)),p=(0,o.KR)(0),g=(0,o.KR)(140),f=(0,o.KR)(3),y=(0,o.KR)("#00c2ff"),b=(0,o.KR)(g.value/2),I=(0,o.KR)(2*Math.PI*(b.value-f.value/2)),C=(0,o.KR)(I.value),h=(0,o.KR)(0),k=(0,o.KR)(0),S=(0,o.KR)(""),w=(0,o.KR)(""),N=(0,o.KR)("");let R=null,L=null;const E=(0,o.KR)({});let _=(0,o.KR)(0),P=(0,o.KR)(0);const T=(0,o.KR)(!1);let A=(0,o.KR)(null);const M=(0,o.KR)(!1),D=(0,o.KR)(!1),x=(0,o.KR)(""),O=(0,o.KR)("0"),K=(0,o.KR)("0"),U=(0,o.Kh)({progressBarText:"",progressBarPercent:0});(0,s.wB)((()=>d.value?.userStop),(async e=>{if(e){await(0,s.dY)(),y.value="red",U.progressBarPercent=0;const e="100a"===x.value?F:B;E.value={INPUT:e.INPUT.map((e=>({...e,slotState:"0"}))),OUTPUT:e.OUTPUT.map((e=>({...e,slotState:"0"})))},console.log("slideCardData",E.value)}else y.value="#00c2ff"})),(0,s.wB)((()=>t.state.embeddedStatusModule),(e=>{const t=e.sysInfo;"02"===t.eqStatCd&&(D.value=!1),D.value||(S.value=e.sysInfo.eqStatCd),i.value.isRunningState?($(t.iCasStat,E.value.INPUT),$(t.oCasStat,E.value.OUTPUT)):(C.value=I.value,Y(),G());const a=/[1,2,9]/g,l=String(t?.iCasStat);"999999999999"!==String(t?.iCasStat)&&(l.search(a)<0||"111111111111"===t?.oCasStat)&&($(t.iCasStat,E.value.INPUT),$(t.oCasStat,E.value.OUTPUT))}),{deep:!0}),(0,s.wB)([i.value],(async e=>{const t=JSON.parse(JSON.stringify(e));t[0].startEmbedded?""===t[0].runningSlotId&&t[0].startEmbedded&&H():G(),t[0].isRunningState||(Y(),G(),C.value=I.value)})),(0,s.wB)((()=>m.parsedDataSysInfo),((e,t)=>{U.progressBarText=e.progressBarText||"",U.progressBarPercent=e.progressBarPercent||25,console.log(e)}),{deep:!0}),(0,s.wB)([a.value],(e=>{const t=JSON.parse(JSON.stringify(e));if(console.log("slotArray",t),O.value=t[0]?.runningInfo?.iCasExist,K.value=t[0]?.runningInfo?.oCasExist,"start"===t[0].changeSlideState?.changeSlide.value&&!0===t[0].slideBooleanState?.slideIs.value?W():"stop"===t[0].changeSlideState?.changeSlide.value&&null!==R&&(clearInterval(R),R=null),"afterChange"===t[0].changeSlideState?.changeSlide.value&&(G(),W()),t[0].runningInfo){const e=t[0].runningInfo.slotInfo;if(e&&"03"===e?.stateCd){h.value=Number(e.wbcCount),k.value="pb"===window.PROJECT_TYPE?Number(e.maxWbcCount):Number(e.cellCount);const t=h.value/k.value*100;C.value=X(t)}}})),(0,s.wB)((()=>S.value),(e=>{"05"===e?A.value=setInterval((()=>{T.value=!T.value}),1e3):(T.value=!1,clearInterval(A.value))})),(0,s.wB)((()=>r.value),(e=>{e&&(S.value="05"),D.value=e})),(0,s.wB)((()=>m.pb100aCassette),(e=>{"reset"===e&&(Y(),H(),G())}),{deep:!0}),(0,s.KC)((()=>{x.value=window.MACHINE_VERSION,E.value="100a"===x.value?JSON.parse(JSON.stringify(F)):JSON.parse(JSON.stringify(B))})),(0,s.sV)((()=>{S.value="01",E.value.INPUT.forEach((e=>{e.slotState="0"})),E.value.OUTPUT.forEach((e=>{e.slotState="0"})),M.value="bm"===window.PROJECT_TYPE}));const X=e=>I.value*(1-e/100),$=(e,t)=>{t.forEach(((t,a)=>{t.slotState=e.charAt(a)}))},W=()=>{R||(R=setInterval((()=>{i.value.isRunningState&&(P.value+=1,p.value=P.value%60,sessionStorage.setItem("elapsedTimeCount",String(P.value)),t.dispatch("timeModule/setTimeInfo",{slideTime:j(P.value)}))}),1e3))};(0,s.xo)((()=>{R&&(clearInterval(R),R=null),L&&(clearInterval(L),L=null)}));const H=()=>{L||(L=setInterval((()=>{i.value.isRunningState&&(_.value+=1,sessionStorage.setItem("totalElapsedTimeCount",String(_.value)),t.dispatch("timeModule/setTimeInfo",{totalSlideTime:j(_.value)}))}),1e3))},G=()=>{clearInterval(R),R=null,P.value=0,w.value=j(0),sessionStorage.removeItem("elapsedTimeCount"),t.dispatch("timeModule/setTimeInfo",{slideTime:"00:00:00"})},Y=()=>{clearInterval(L),L=null,_.value=0,N.value=j(0),sessionStorage.removeItem("totalElapsedTimeCount"),t.dispatch("timeModule/setTimeInfo",{totalSlideTime:"00:00:00"})},V=()=>{switch(S.value){case"01":return"IDLE";case"02":return"READY";case"03":return"ERROR";case"04":return"RUNNING";case"05":return"INITIALIZATION";default:return"UNKNOWN"}},Q=(e,t)=>{if("input"===t)switch(e){case"0":return"class-for-state-0";case"1":return"class-for-state-1";case"2":return"class-for-state-2";case"3":return"class-for-state-3";case"4":return"class-for-state-4";default:return""}else switch(e){case"0":return"out-for-state-0";case"1":return"out-for-state-1";default:return"outClassDefault"}},q=e=>{switch(e){case"0":return"EMPTY";case"1":return"EXIST";case"2":return"FULL"}};return(t,a)=>((0,s.uX)(),(0,s.CE)("div",null,[a[7]||(a[7]=(0,s.Lk)("h3",{class:"titleText"},"Working View",-1)),(0,s.Lk)("div",null,[(0,s.Lk)("div",Ls,[((0,s.uX)(),(0,s.CE)("svg",Es,[(0,s.Lk)("defs",null,[(0,s.Lk)("linearGradient",_s,[d.value.value?.userStop?((0,s.uX)(),(0,s.CE)("stop",{key:1,offset:"100%","stop-color":y.value},null,8,Ps)):((0,s.uX)(),(0,s.CE)(s.FK,{key:0},[a[0]||(a[0]=(0,s.Lk)("stop",{offset:"0%","stop-color":"#56ccf2"},null,-1)),a[1]||(a[1]=(0,s.Lk)("stop",{offset:"50%","stop-color":"#35b0b6"},null,-1)),a[2]||(a[2]=(0,s.Lk)("stop",{offset:"100%","stop-color":"#2f80ed"},null,-1))],64)),a[3]||(a[3]=(0,s.Lk)("animateTransform",{attributeName:"gradientTransform",type:"rotate",from:"0 0.5 0.5",to:"360 0.5 0.5",dur:"2s",repeatCount:"indefinite"},null,-1))]),a[4]||(a[4]=(0,s.Lk)("filter",{id:"shadow"},[(0,s.Lk)("feDropShadow",{dx:"0",dy:"0",stdDeviation:"6","flood-color":"rgba(0, 0, 0, 0.3)"})],-1))]),(0,s.Lk)("circle",{cx:b.value,cy:b.value,r:b.value-f.value/2,"stroke-width":f.value,stroke:"#2e2e2e",fill:"none"},null,8,Ts),(0,s.Lk)("circle",{cx:b.value,cy:b.value,r:b.value-f.value/2,"stroke-width":f.value,stroke:"url(#gradient)",fill:"none","stroke-dasharray":I.value,"stroke-dashoffset":C.value,filter:"url(#shadow)"},null,8,As)])),(0,s.Lk)("p",{class:(0,n.C4)({blinkColor:T.value,renewalStateText:!0})},(0,n.v_)(V()),3),(0,s.Lk)("div",Ms,[(0,s.Lk)("div",null,(0,n.v_)(U.progressBarPercent),1),a[5]||(a[5]=(0,s.Lk)("span",null,"%",-1))])])]),"0000"===v.value?((0,s.uX)(),(0,s.Wv)(Rs,{key:0,parsedDataSysInfo:e.parsedDataSysInfo},null,8,["parsedDataSysInfo"])):(0,s.Q3)("",!0),"12a"===x.value?((0,s.uX)(),(0,s.CE)("div",Ds,[(0,s.Lk)("ul",xs,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(E.value.INPUT,(e=>((0,s.uX)(),(0,s.CE)("li",{key:e.slotNo,class:(0,n.C4)(Q(e.slotState,"input"))},null,2)))),128)),(0,s.bo)((0,s.Lk)("p",Os,"INPUT",512),[[l.aG,i.value.isRunningState]])]),(0,s.Lk)("ul",Ks,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(E.value.OUTPUT,(e=>((0,s.uX)(),(0,s.CE)("li",{key:e.slotNo,class:(0,n.C4)(Q(e.slotState,"output"))},null,2)))),128)),(0,s.bo)((0,s.Lk)("p",Bs,"OUTPUT",512),[[l.aG,i.value.isRunningState]])])])):((0,s.uX)(),(0,s.CE)("div",Fs,[(0,s.Lk)("ul",Us,[(0,s.bo)((0,s.Lk)("p",null,"INPUT : "+(0,n.v_)(q(O.value)),513),[[l.aG,i.value.isRunningState]]),((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)([...E.value.INPUT].reverse(),(e=>((0,s.uX)(),(0,s.CE)("li",{key:e.slotNo,class:(0,n.C4)(Q(e.slotState,"input"))},null,2)))),128)),(0,s.bo)((0,s.Lk)("p",{class:"mt10"},"OUTPUT : "+(0,n.v_)(q(K.value)),513),[[l.aG,i.value.isRunningState]])])])),a[8]||(a[8]=(0,s.Lk)("div",{class:"lineRenewal"},null,-1)),a[9]||(a[9]=(0,s.Lk)("p",{class:"renewal slideTime1"},"Processing Total Time",-1)),(0,s.Lk)("p",Xs,(0,n.v_)(u.value.totalSlideTime),1),(0,s.Lk)("div",$s,[a[6]||(a[6]=(0,s.Lk)("span",null,"Slide Time",-1)),(0,s.Lk)("p",Ws,(0,n.v_)(u.value.slideTime),1)])]))}});const Gs=Hs;var Ys=Gs;const Vs={class:"contentLeft"},js={class:"contentRight"},Qs={class:"contentBottom"};var qs=(0,s.pM)({__name:"index",props:["parsedData","isClass","startStatus","pb100aCassette","parsedDataSysInfo"],setup(e,{emit:t}){const a=t,n=(0,c.Pj)(),i=(0,o.KR)(!1),r=e,u=(0,o.KR)(""),d=(0,o.KR)(!1),m=(0,s.EW)((()=>n.state.commonModule.viewerCheck)),v=(0,s.EW)((()=>n.state.commonModule.siteCd));(0,s.KC)((async()=>{"viewer"===m.value&&Pw.push("/database"),u.value=window.MACHINE_VERSION,i.value="bm"===window.PROJECT_TYPE}));const p=e=>{a("rbcAppUpdate",e)},g=e=>{a("classAppUpdateLast",e)},f=e=>{n.dispatch("commonModule/setCommonInfo",{initValData:e})};return(t,a)=>((0,s.uX)(),(0,s.CE)(s.FK,null,[(0,s.bo)((0,s.Lk)("div",Vs,[(0,s.bF)(Ra,{onInitDataChangeText:f}),(0,s.bF)(D,{parsedData:r.parsedData,pb100aCassette:e.pb100aCassette},null,8,["parsedData","pb100aCassette"]),(0,s.bF)(qa,{parsedData:r.parsedData,startStatus:r.startStatus,pb100aCassette:e.pb100aCassette},null,8,["parsedData","startStatus","pb100aCassette"])],512),[[l.aG,r.isClass]]),(0,s.bo)((0,s.Lk)("div",js,["9090"===v.value?((0,s.uX)(),(0,s.Wv)(Ys,{key:0,initValData:d.value,parsedData:r.parsedData,parsedDataSysInfo:e.parsedDataSysInfo,pb100aCassette:e.pb100aCassette,class:"contentRightChild"},null,8,["initValData","parsedData","parsedDataSysInfo","pb100aCassette"])):((0,s.uX)(),(0,s.Wv)(Wa,{key:1,initValData:d.value,parsedData:r.parsedData,pb100aCassette:e.pb100aCassette,class:"contentRightChild"},null,8,["initValData","parsedData","pb100aCassette"])),i.value?(0,s.Q3)("",!0):((0,s.uX)(),(0,s.Wv)(ds,{key:2,onRbcUpdate:p,parsedData:r.parsedData,class:"contentRightChild"},null,8,["parsedData"])),(0,s.bF)(Bl,{onClassInfoUpdate:g,parsedData:r.parsedData,bmIsBoolen:i.value,class:"contentRightChild"},null,8,["parsedData","bmIsBoolen"]),(0,s.Lk)("div",Qs,[(0,s.bF)(ys,{parsedData:r.parsedData,pb100aCassette:e.pb100aCassette},null,8,["parsedData","pb100aCassette"])])],512),[[l.aG,r.isClass]])],64))}});const Js=qs;var zs=Js,Zs=(0,s.pM)({__name:"HomeView",setup(e){return(e,t)=>{const a=(0,s.g2)("Fragment");return(0,s.uX)(),(0,s.Wv)(a,null,{default:(0,s.k6)((()=>[(0,s.bF)(zs)])),_:1})}}});const eo=Zs;var to=eo;const ao=Z(),lo=async e=>ao.httpPost(ee.user.register,e),so=async e=>ao.httpPost(ee.user.login,e),oo=async e=>ao.httpPost(ee.user.logout,e),no=async e=>ao.httpGet(ee.user.getUsers,e),io=async e=>ao.httpGet(ee.user.userCheck,e),ro=async(e,t)=>ao.httpPut(ee.user.userDataPut,e,t),co=async e=>ao.httpDelete(ee.user.deleteUser,e,!0),uo={class:"joinContent"},mo={class:"joinWrapper"};var vo=(0,s.pM)({__name:"index",setup(e){const t=(0,o.KR)(""),a=(0,o.KR)(""),n=(0,o.KR)(""),i=(0,o.KR)(""),r=(0,o.KR)(""),c=(0,o.KR)("normal"),u=(0,o.KR)(!1),d=(0,o.KR)(""),m=(0,o.KR)(""),v=()=>{Pw.push("/user/login")},p=async()=>{const e=new Date;if(""===a.value)return void await f("Please enter id");if(a.value.includes("_"))return void await f("UserId is not available");if(""===r.value)return void await f("Please enter password");if(""===n.value)return void await f("Please enter name");if(""===t.value)return void await f("Please enter Employee No");if(""===i.value)return void await f("Please enter repeat password");if(r.value!==i.value)return void await f("Please check if the password and password are the same");const l={userId:a.value,password:r.value,name:n.value,employeeNo:t.value,userType:c.value,subscriptionDate:e};try{const e=await lo(l);e.data?.userId?(await g("registration successful"),await Pw.push("/user/login")):e.data.includes("Duplicate")&&await f("Duplicated user id")}catch(s){console.error(s),await f("Signin fail")}},g=async e=>{u.value=!0,d.value="success",m.value=e},f=e=>{u.value=!0,d.value="error",m.value=e},y=()=>{u.value=!1};return(e,o)=>((0,s.uX)(),(0,s.CE)(s.FK,null,[(0,s.Lk)("div",uo,[o[13]||(o[13]=(0,s.Lk)("p",{class:"mt20 mb40"},"CREATE ACCOUNT",-1)),(0,s.Lk)("div",null,[(0,s.Lk)("ul",mo,[(0,s.Lk)("li",null,[o[6]||(o[6]=(0,s.Lk)("span",{class:"loginTitle"},"ID",-1)),(0,s.bo)((0,s.Lk)("input",{class:"loginInput",type:"text","onUpdate:modelValue":o[0]||(o[0]=e=>a.value=e)},null,512),[[l.Jo,a.value]])]),(0,s.Lk)("li",null,[o[7]||(o[7]=(0,s.Lk)("span",{class:"loginTitle"},"password",-1)),(0,s.bo)((0,s.Lk)("input",{class:"loginInput",type:"text","onUpdate:modelValue":o[1]||(o[1]=e=>r.value=e)},null,512),[[l.Jo,r.value]])]),(0,s.Lk)("li",null,[o[8]||(o[8]=(0,s.Lk)("span",{class:"loginTitle"},"Repeat password",-1)),(0,s.bo)((0,s.Lk)("input",{class:"loginInput",type:"text","onUpdate:modelValue":o[2]||(o[2]=e=>i.value=e)},null,512),[[l.Jo,i.value]])]),(0,s.Lk)("li",null,[o[9]||(o[9]=(0,s.Lk)("span",{class:"loginTitle"},"name",-1)),(0,s.bo)((0,s.Lk)("input",{class:"loginInput",type:"text","onUpdate:modelValue":o[3]||(o[3]=e=>n.value=e)},null,512),[[l.Jo,n.value]])]),(0,s.Lk)("li",null,[o[10]||(o[10]=(0,s.Lk)("span",{class:"loginTitle"},"Employee No",-1)),(0,s.bo)((0,s.Lk)("input",{class:"loginInput",type:"text","onUpdate:modelValue":o[4]||(o[4]=e=>t.value=e)},null,512),[[l.Jo,t.value]])]),(0,s.Lk)("li",null,[o[12]||(o[12]=(0,s.Lk)("span",{class:"loginTitle"},"user Type",-1)),(0,s.bo)((0,s.Lk)("select",{"onUpdate:modelValue":o[5]||(o[5]=e=>c.value=e),disabled:""},o[11]||(o[11]=[(0,s.Lk)("option",{value:"admin"},"Admin",-1),(0,s.Lk)("option",{value:"normal"},"Normal",-1)]),512),[[l.u1,c.value]])])]),(0,s.Lk)("div",{class:"joinBtn"},[(0,s.Lk)("button",{class:"defaultBtn",type:"button",onClick:p},"Create Account"),(0,s.Lk)("button",{class:"defaultBtn",type:"button",onClick:v},"Back")])])]),u.value?((0,s.uX)(),(0,s.Wv)(Pt,{key:0,"is-visible":u.value,type:d.value,message:m.value,onHide:y,"onUpdate:hideAlert":y},null,8,["is-visible","type","message"])):(0,s.Q3)("",!0)],64))}});const po=vo;var go=po;const fo=(0,o.Kh)({value:[]}),yo="bm"===window.PROJECT_TYPE,bo={testTypeCd:yo?"02":"01",diffCellAnalyzingCount:yo?"500":"100",diffWbcPositionMargin:"0",diffRbcPositionMargin:"0",diffPltPositionMargin:"0",pbsCellAnalyzingCount:"100",stitchCount:"1",edgeShotType:"0",edgeShotLPCount:"1",edgeShotHPCount:"3",bfCellAnalyzingCount:"100",iaRootPath:yo?"D:\\BMIA_proc":"D:\\PBIA_proc",isNsNbIntegration:!1,isAlarm:!1,alarmCount:"5",keepPage:!1,lisUploadCheckAll:!1,backupPath:"",backupStartDate:new Date,backupEndDate:new Date,userId:""},Io=(0,o.KR)({lisCodeWbc:{sendingForm:"lisCodeItems",defaultItem:Jt,getRequest:Ne,createRequest:Se},lisCodeRbc:{sendingForm:"lisCodeItems",defaultItem:zt,getRequest:Ee,createRequest:Re},cbcCode:{sendingForm:"cbcCodeItems",defaultItem:$t,getRequest:Te,createRequest:_e},cellImage:{getRequest:le,createRequest:ae},normalRange:{sendingForm:"normalRangeItems",defaultItem:jt,getRequest:Ie,createRequest:ye},orderClass:{getRequest:He,createRequest:We},rbcDegree:{getRequest:ie,createRequest:oe}}),Co=async()=>{await ho("cellImage"),await ho("orderClass"),await ho("rbcDegree"),await ho("lisCodeWbc"),await ho("lisCodeRbc"),await ho("cbcCode"),await ho("normalRange")},ho=async e=>{const t=Io.value[e].getRequest;try{const{data:a}=await t()||{};if(!a||0===a.length||0===Object.keys(a).length){const t=Io.value[e]?.sendingForm,a=Io.value[e].defaultItem,l=Io.value[e].createRequest,s=await ko(e);t?await l({[t]:s||a}):await l(s||a),So(e)}}catch(a){console.error(`${e} Error - ${a}`)}},ko=async e=>{switch(e){case"cellImage":const e={analysisType:bo.testTypeCd,diffCellAnalyzingCount:bo.diffCellAnalyzingCount,diffWbcPositionMargin:bo.diffWbcPositionMargin,diffRbcPositionMargin:bo.diffRbcPositionMargin,diffPltPositionMargin:bo.diffPltPositionMargin,pbsCellAnalyzingCount:bo.pbsCellAnalyzingCount,stitchCount:bo.stitchCount,edgeShotType:bo.edgeShotType,edgeShotLPCount:bo.edgeShotLPCount,edgeShotHPCount:bo.edgeShotHPCount,bfCellAnalyzingCount:bo.bfCellAnalyzingCount,iaRootPath:bo.iaRootPath,isNsNbIntegration:bo.isNsNbIntegration?"Y":"N",isAlarm:bo.isAlarm,alarmCount:bo.alarmCount,keepPage:bo.keepPage,lisUploadCheckAll:bo.lisUploadCheckAll,backupPath:bo.backupPath,backupStartDate:bo.backupStartDate.toISOString().split("T")[0],backupEndDate:bo.backupEndDate.toISOString().split("T")[0],autoBackUpMonth:"Not selected",autoBackUpStartDate:null};return e;case"orderClass":const t="bm"===window.PROJECT_TYPE?el:Za;for(const l in t)t[l].orderIdx=l;return t;case"rbcDegree":await wo();const a=[];return fo.value.forEach((e=>{e.classInfo.forEach((t=>{a.push({categoryId:e.categoryId,categoryNm:e.categoryNm,classId:t.classId,classNm:t.classNm,degree1:t.degree1,degree2:t.degree2,degree3:t.degree3})}))})),a;default:return null}},So=async e=>{const t=(0,c.Pj)();switch(e){case"cellImage":sessionStorage.setItem("isNsNbIntegration",bo.isNsNbIntegration?"Y":"N"),sessionStorage.setItem("wbcPositionMargin",String(bo?.diffWbcPositionMargin)),sessionStorage.setItem("rbcPositionMargin",String(bo?.diffRbcPositionMargin)),sessionStorage.setItem("pltPositionMargin",String(bo?.diffPltPositionMargin)),sessionStorage.setItem("edgeShotType",String(bo?.edgeShotType)),sessionStorage.setItem("edgeShotLPCount",String(bo?.edgeShotLPCount)),sessionStorage.setItem("edgeShotHPCount",String(bo?.edgeShotHPCount)),sessionStorage.setItem("iaRootPath",String(bo?.iaRootPath)),sessionStorage.setItem("keepPage",String(bo?.keepPage)),await t.dispatch("commonModule/setCommonInfo",{showLISUploadAfterCheckingAll:bo?.lisUploadCheckAll});break;default:break}},wo=async()=>{fo.value=Wt.rbcClassList.map((e=>({...e,classInfo:e.classInfo.map((t=>{const a=Ht.find((a=>a.categoryId===e.categoryId&&a.classId===t.classId));return{...t,degree1:a?.degree1||0,degree2:a?.degree2||0,degree3:a?.degree3||0}}))})))},No=Z(),Ro=async e=>No.httpPost(ee.jsonReader.get,e,"",!1,sessionStorage.getItem("viewerCheck")||"viewer"),Lo=async e=>No.httpPost(ee.dziReader.get,e),Eo=async e=>No.httpGet(ee.fileTxtRead.get,`${e}`,!0),_o=async e=>No.httpGet(ee.fileTxtRead.readFileEUCKR,`${e}`,!0),Po=async e=>No.httpPost(ee.H7Read.post,e,"text/plain",!1,sessionStorage.getItem("viewerCheck")||"viewer"),To=async e=>No.httpPost(ee.H7Message.noFlagHl7,e,"",!1,sessionStorage.getItem("viewerCheck")||"viewer"),Ao=async e=>No.httpPost(ee.H7MessageCustom.post,e,"",!1,sessionStorage.getItem("viewerCheck")||"viewer"),Mo=async e=>No.httpPost(ee.Hl7Create.post,e),Do={key:0,class:"progressBarLogin"},xo={class:"progressDiv"},Oo=["value"],Ko={class:"uimdLogin"},Bo={class:"loginContent"},Fo={class:"mt30 loginDiv"},Uo={class:"loginUl"},Xo={class:"loginBtn"};var $o=(0,s.pM)({__name:"index",setup(e){const t=(0,c.Pj)(),a=(0,o.KR)(""),n=(0,o.KR)(""),i=(0,o.KR)(!1),r=(0,o.KR)(""),u=(0,o.KR)(""),d=(0,o.KR)(!1),m=(0,s.EW)((()=>t.state.commonModule.isTcpConnected)),v=(0,o.KR)(!1),p=(0,o.KR)(""),g=(0,o.KR)(""),f=(0,o.KR)(0),y=(0,o.KR)(!1);(0,s.KC)((async()=>{g.value=window.MAIN_WEBSOCKET_IP,p.value=window.FORCE_VIEWER,await w()}));const b=()=>{f.value=0;const e=setInterval((()=>{m.value?(f.value=100,clearInterval(e)):f.value+=.5}),1e3);(0,s.wB)(m,(t=>{t&&(f.value=100,setTimeout((()=>{y.value=!0}),1e3),clearInterval(e))}))};(0,s.sV)((async()=>{C(),b(),m.value&&(y.value=!0)}));const C=()=>{const e=JSON.parse(localStorage.getItem("user")||"{}");e.userId&&e.password&&(n.value=e.userId,a.value=e.password,S())},h=async()=>{const e="D:\\UIMD_Data\\Backend_INI",a="HW_Config";try{const l=await Eo(`path=${e}&filename=${a}`),s=l.data.data,o=/DEVICE_SERIAL\s*=\s*(.+)/,n=/SERVICE_SITE\s*=\s*(.+)/,i=s.match(o)[1]||"",r=s.match(n)[1]||"",c={siteCd:r,deviceSerialNm:i},u=await da();0!==u.data.length&&u.data?(sessionStorage.setItem("autoStart",u.data[0]?.autoStart),await ma({siteCd:r,deviceSerialNm:i})):(await ua({deviceItem:c}),sessionStorage.setItem("autoStart","true")),await t.dispatch("commonModule/setCommonInfo",{siteCd:r}),localStorage.setItem("siteCd",r)}catch(l){console.error(l)}},k=()=>{Pw.push("/user/join")},S=async e=>{if(e&&"Enter"!==e.key&&"click"!==e.type)return;const l={userId:n.value,password:a.value};if(""!==l.userId&&""!==l.password)try{const e=await so(l);e?.data?.user?(await h(),await Co(),await t.dispatch("userModule/setUserAction",e.data?.user),sessionStorage.setItem("user",JSON.stringify(e.data.user)),d.value&&localStorage.setItem("user",JSON.stringify(e.data.user)),await N(e?.data?.user.userId)):L("Login failed.")}catch(s){L("server Err."),console.error(s)}else L("Login failed.")},w=async()=>{try{const e=await va();"1"===e.data||window.APP_API_BASE_URL&&window.APP_API_BASE_URL.includes(e.data)?v.value=!1:v.value=!0}catch(e){console.error(e)}},N=async e=>{try{const e=await va();if(("1"===e.data||window.APP_API_BASE_URL&&window.APP_API_BASE_URL.includes(e.data))&&"viewer"!==window.FORCE_VIEWER)await t.dispatch("commonModule/setCommonInfo",{viewerCheck:"main"}),await R("main"),sessionStorage.setItem("viewerCheck","main"),sessionStorage.setItem("pcIp",JSON.stringify(e.data));else{await t.dispatch("commonModule/setCommonInfo",{viewerCheck:"viewer"}),await R("viewer"),sessionStorage.setItem("viewerCheck","viewer"),sessionStorage.setItem("pcIp",JSON.stringify(e.data));const a=await da(),l=a.data[0]?.siteCd?a.data[0]?.siteCd:I["UIMD"];await t.dispatch("commonModule/setCommonInfo",{siteCd:l}),localStorage.setItem("siteCd",l)}}catch(a){console.error(a)}},R=async e=>{L("login successful."),"main"===e?(await Pw.push("/"),await document.documentElement.requestFullscreen()):(await Pw.push("/dataBase"),await document.documentElement.requestFullscreen()),await t.dispatch("commonModule/setCommonInfo",{loginSetData:""}),await t.dispatch("commonModule/setCommonInfo",{resFlag:!1})},L=e=>{i.value=!0,r.value="success",u.value=e},E=()=>{i.value=!1};return(e,t)=>((0,s.uX)(),(0,s.CE)(s.FK,null,[y.value||"main"!==p.value||v.value?(0,s.Q3)("",!0):((0,s.uX)(),(0,s.CE)("div",Do,[(0,s.Lk)("div",xo,[(0,s.Lk)("progress",{id:"file",value:f.value,max:"100"},null,8,Oo),t[3]||(t[3]=(0,s.Lk)("div",{class:"loading-text"},"Loading...",-1))])])),(0,s.Lk)("div",Ko,[(0,s.Lk)("div",Bo,[t[4]||(t[4]=(0,s.Lk)("p",{class:"loginTitle"},[(0,s.Lk)("span",{class:"loginColorSpan"},"U"),(0,s.eW)("IMD")],-1)),t[5]||(t[5]=(0,s.Lk)("p",{class:"loginP mt20"},"Unique Idea Medical Device",-1)),(0,s.Lk)("div",Fo,[(0,s.Lk)("ul",Uo,[(0,s.Lk)("li",null,[(0,s.bo)((0,s.Lk)("input",{class:"loginInput",type:"text","onUpdate:modelValue":t[0]||(t[0]=e=>n.value=e),placeholder:"ID",onKeydown:S},null,544),[[l.Jo,n.value]])]),(0,s.Lk)("li",null,[(0,s.bo)((0,s.Lk)("input",{class:"loginInput",type:"password","onUpdate:modelValue":t[1]||(t[1]=e=>a.value=e),placeholder:"password",onKeydown:S},null,544),[[l.Jo,a.value]])])]),(0,s.Lk)("div",Xo,[(0,s.Lk)("button",{type:"button",onClick:t[2]||(t[2]=e=>S()),onKeydown:S},"Login",32),(0,s.Lk)("button",{type:"button",onClick:k},"Add User")])])])]),i.value?((0,s.uX)(),(0,s.Wv)(Pt,{key:1,"is-visible":i.value,type:r.value,message:u.value,onHide:E,"onUpdate:hideAlert":E},null,8,["is-visible","type","message"])):(0,s.Q3)("",!0)],64))}});const Wo=$o;var Ho=Wo,Go=a(2903);const Yo=Z(),Vo=async e=>Yo.httpPost(ee.download.backUpDate,e),jo=async e=>Yo.httpPost(ee.download.checkIsPossibleToBackup,e),Qo=async e=>Yo.httpPost(ee.download.openDrive,e),qo=async e=>Yo.httpPost(ee.upload.restoreData,e),Jo=async e=>Yo.httpPost(ee.upload.checkDuplicated,e),zo=async e=>Yo.httpPost(ee.upload.checkPossibleUploadFile,e),Zo={class:"mb10"};var en={__name:"ConfirmThreeBtn",props:["isVisible","type","message","confirmFirstText","confirmSecondText","closeText"],emits:["okConfirm, okConfirm2"],setup(e,{emit:t}){const a=e,l=(0,s.EW)((()=>`confirm-${a.type}`)),o=t,i=()=>{o("hide")},r=()=>{o("okConfirm")},c=()=>{o("okConfirm2")};return(t,a)=>e.isVisible?((0,s.uX)(),(0,s.CE)("div",{key:0,class:(0,n.C4)(["alert",l.value])},[(0,s.Lk)("p",Zo,(0,n.v_)(e.message),1),(0,s.Lk)("button",{class:"alertButton",onClick:r},(0,n.v_)(e.confirmFirstText||"OK"),1),(0,s.Lk)("button",{class:"alertButton",onClick:c},(0,n.v_)(e.confirmSecondText||"OK"),1),(0,s.Lk)("button",{class:"alertCloseButton",onClick:i},(0,n.v_)(e.closeText||"CLOSE"),1)],2)):(0,s.Q3)("",!0)}};const tn=en;var an=tn,ln=a.p+"img/commonMargin.9c95e394.png",sn=a.p+"img/smearTop.6922ad43.png",on=(0,s.pM)({__name:"Tooltip",props:{isVisible:{type:Boolean},type:{},message:{},position:{default:"top"},className:{}},setup(e){return(e,t)=>e.isVisible?((0,s.uX)(),(0,s.CE)("div",{key:0,class:(0,n.C4)(`tooltip-container tooltip-pos-${e.position} ${e.className}`)},[(0,s.Lk)("pre",null,(0,n.v_)(e.message),1)],2)):(0,s.Q3)("",!0)}});const nn=on;var rn=nn;const cn=()=>{document.body.style.overflow="hidden"},un=()=>{document.body.style.overflow="auto"},dn=()=>{window.scrollTo({top:0,behavior:"smooth"})},mn={class:"loadingBackground"},vn={class:"progressContainer"},pn={class:"loadingProgressBarText"},gn={key:0,class:"loadingBackground"},fn={class:"settingTable"},yn={key:0},bn={colspan:"2"},In=["value"],Cn={key:1},hn={key:0,rowspan:"1"},kn={key:1},Sn=["value"],wn={key:2},Nn=["rowspan"],Rn=["value"],Ln={key:3},En={key:0},_n=["value"],Pn={class:"pos-relative"},Tn={key:0,class:"tutorial-edgeShotType-container"},An=["src"],Mn=["value"],Dn=["value"],xn=["value"],On={key:4},Kn=["value"],Bn={key:5},Fn={rowspan:"3",class:"pos-relative"},Un={class:"tutorial-positionMargin-container"},Xn=["src"],$n=["value"],Wn={key:6},Hn=["value"],Gn={key:7},Yn=["value"],Vn={colspan:"2"},jn=["value"],Qn={key:8},qn={class:"pos-relative"},Jn={key:9},zn={class:"pos-relative"},Zn={class:"pos-relative"},ei={class:"settingTable auto"},ti={class:"pos-relative"},ai={class:"downloadSavePathContainer"},li=["value"],si={class:"pos-relative"},oi={class:"pos-relative"},ni={class:"backupDatePickers"},ii={class:"pos-relative"},ri={colspan:"2"},ci={class:"settingUploadContainer"},ui=["value"],di={key:0,class:"fs12",style:{top:"0"}},mi={key:1,class:"fs12"},vi={key:2,class:"uploadDuplicatedSlotContainer"},pi={class:"uploadDuplicatedSlotWrapper"},gi={class:"uploadModalBtnContainer"},fi={class:"downloadDeleteContainer"},yi={class:"downloadDeleteWrapper"},bi={style:{"font-size":"0.8rem"}},Ii=["value"],Ci={class:"mt40"},hi={class:"uploadModalBtnContainer"};var ki=(0,s.pM)({__name:"cellImageAnalyzed",setup(e){const t=(0,s.nI)(),a=(0,c.Pj)(),i=(0,r.rd)(),u=(0,o.KR)(!1),d=(0,o.KR)(""),m=(0,o.KR)(!1),v=(0,o.KR)(""),p=(0,o.KR)([]),g=(0,o.KR)("01"),f=(0,o.KR)("100"),y=(0,o.KR)("0"),b=(0,o.KR)("0"),I=(0,o.KR)("0"),C=(0,o.KR)("100"),h=(0,o.KR)("1"),k=(0,o.KR)("0"),S=(0,o.KR)({LP:"1",HP:"3"}),w=(0,o.KR)("100"),N=(0,o.KR)("bm"===window.PROJECT_TYPE?"D:\\BMIA_proc":"D:\\PBIA_proc"),R=(0,o.KR)("bm"===window.PROJECT_TYPE?"D:\\UIMD_BM_backup":"D:\\UIMD_PB_backup"),L=(0,o.KR)("bm"===window.PROJECT_TYPE?"D:\\BMIA_proc":"D:\\PBIA_proc"),E=(0,o.KR)(!1),_=(0,o.KR)(!1),P=(0,o.KR)("5"),T=(0,o.KR)(!1),A=(0,o.KR)(!1),M=(0,o.KR)(W()().local().toDate()),D=(0,o.KR)(W()().local().toDate()),x=((0,o.KR)([{value:"Not selected"},{value:1},{value:2},{value:3},{value:4},{value:5},{value:6},{value:7},{value:8},{value:9},{value:10},{value:11},{value:12}]),(0,o.KR)("Not selected")),O=(0,o.KR)(""),K=(0,o.KR)([]),B=(0,o.KR)([]),F=(0,o.KR)(""),$=(0,o.KR)("pb"),H=(0,o.KR)([]),G=(0,o.KR)({duplicated:[],nonDuplicated:[]}),Y=(0,s.EW)((()=>G.value?.nonDuplicated&&G.value?.nonDuplicated.length)),V=(0,s.EW)((()=>G.value?.duplicated&&G.value?.duplicated.length)),j=(0,o.KR)(!1),Q=(0,o.KR)(""),q=(0,s.EW)((()=>a.state.commonModule.viewerCheck)),J=(0,s.EW)((()=>a.state.commonModule.enteringRouterPath)),z=(0,s.EW)((()=>a.state.commonModule.settingChangedChecker)),Z=(0,s.EW)((()=>a.state.commonModule.settingType)),ee=(0,o.KR)(!1),te=(0,o.KR)(!1),oe=(0,o.KR)(!1),ne=(0,o.KR)(!1),ie=(0,o.KR)(""),re=(0,o.KR)({}),ce=(0,o.KR)(1),ue=(0,o.KR)(0),de=(0,o.KR)("copy"),me=(0,o.KR)(null),ve=(0,o.KR)({}),pe=(0,o.KR)(""),ge=(0,o.KR)(!1),fe=(0,o.KR)([]),ye=(0,o.KR)(""),be=(0,o.KR)({edgeShotType:!1,positionMargin:!1}),Ie=(0,o.KR)(""),Ce=(0,o.KR)({iaRootPath:!1,nsNbIntegration:!1,alarm:!1,keepPage:!1,lisUploadCheckAll:!1,downloadSavePath:!1,download:!1,upload:!1,openDownloadSavePath:!1}),he=(0,o.KR)("12a");t?.appContext.config.globalProperties.$socket.on("downloadUploadFinished",(async e=>{e?.isFinished&&(clearInterval(me.value),ue.value=ce.value,Xe(!1),await a.dispatch("commonModule/setCommonInfo",{isDownloadOrUploading:!1}),await He())})),(0,s.KC)((()=>{$.value="bm"===window.PROJECT_TYPE?"bm":"pb",he.value=window.MACHINE_VERSION})),(0,s.sV)((async()=>{ke(),await(0,s.dY)(),g.value="bm"===window.PROJECT_TYPE?"02":"01",H.value="bm"===window.PROJECT_TYPE?At:Tt,p.value="bm"===window.PROJECT_TYPE?Dt:Mt,await a.dispatch("commonModule/setCommonInfo",{settingType:la.cellImageAnalyzed}),await Re(),await we()})),(0,s.wB)([g,f,f,y,b,I,C,k,S,h,w,N,E,_,P,T,A],(async()=>{const e={id:F.value,analysisType:g.value,diffCellAnalyzingCount:f.value,diffWbcPositionMargin:y.value,diffRbcPositionMargin:b.value,diffPltPositionMargin:I.value,pbsCellAnalyzingCount:C.value,stitchCount:h.value,edgeShotType:k.value,edgeShotLPCount:S.value.LP,edgeShotHPCount:S.value.HP,bfCellAnalyzingCount:w.value,iaRootPath:N.value,isNsNbIntegration:E.value,isAlarm:_.value,alarmCount:P.value,keepPage:T.value,lisUploadCheckAll:A.value};await a.dispatch("commonModule/setCommonInfo",{afterSettingFormattedString:JSON.stringify(e)}),Z.value!==la.cellImageAnalyzed&&await a.dispatch("commonModule/setCommonInfo",{settingType:la.cellImageAnalyzed})})),(0,s.wB)((()=>z.value),(()=>{Ne()}));const ke=()=>{const e=window.APP_API_BASE_URL.split(":");Ie.value=`${e[0]}:${e[1]}`},Se=e=>{const t=e.target,a=t.value.replace(/[^0-9]/g,"");P.value=a.trim()},we=async()=>{try{const e=await $e();if(e)if(e?.data){const t=e.data,a=JSON.parse(JSON.stringify(t)),l=JSON.parse(JSON.stringify(t)),s="bm"===window.PROJECT_TYPE?"BMIA_proc":"PBIA_proc",o="bm"===window.PROJECT_TYPE?"UIMD_BM_backup":"UIMD_PB_backup";for(const e in t)a[e]=a[e]+`\\${s}`,l[e]=l[e]+`\\${o}`;K.value=a,B.value=l}else;}catch(e){console.error(e)}},Ne=()=>{j.value=!0,Q.value=`${Z.value} ${U.settingNotSaved}`},Re=async()=>{try{const e=await le();if(e)if(e?.data){O.value="put";const t=e.data;F.value=String(t.id),g.value=t.analysisType,f.value=t.diffCellAnalyzingCount,y.value=t.diffWbcPositionMargin,b.value=t.diffRbcPositionMargin,I.value=t.diffPltPositionMargin,C.value=t.pbsCellAnalyzingCount,h.value=t.stitchCount,w.value=t.bfCellAnalyzingCount,k.value=String(t?.edgeShotType),S.value.LP=String(t?.edgeShotLPCount),S.value.HP=String(t?.edgeShotHPCount),N.value=t.iaRootPath,R.value=t.backupPath||("bm"===window.PROJECT_TYPE?"D:\\UIMD_BM_backup":"D:\\UIMD_PB_backup"),E.value=t.isNsNbIntegration,_.value=t.isAlarm,P.value=t.alarmCount,T.value=t.keepPage,A.value=t.lisUploadCheckAll,M.value=W()(t.backupStartDate).local().toDate(),D.value=W()(t.backupEndDate).local().toDate(),x.value=t?.autoBackUpMonth;const l={id:F.value,analysisType:t?.analysisType,diffCellAnalyzingCount:t?.diffCellAnalyzingCount,diffWbcPositionMargin:t?.diffWbcPositionMargin,diffRbcPositionMargin:t?.diffRbcPositionMargin,diffPltPositionMargin:t?.diffPltPositionMargin,pbsCellAnalyzingCount:t?.pbsCellAnalyzingCount,stitchCount:t?.stitchCount,edgeShotType:t?.edgeShotType,edgeShotLPCount:t?.edgeShotLPCount,edgeShotHPCount:t?.edgeShotHPCount,bfCellAnalyzingCount:t?.bfCellAnalyzingCount,iaRootPath:t?.iaRootPath,isNsNbIntegration:t?.isNsNbIntegration,isAlarm:t?.isAlarm,alarmCount:t?.alarmCount,keepPage:t?.keepPage,lisUploadCheckAll:t?.lisUploadCheckAll};sessionStorage.setItem("isAlarm",String(t?.isAlarm)),await a.dispatch("commonModule/setCommonInfo",{beforeSettingFormattedString:JSON.stringify(l)}),await a.dispatch("commonModule/setCommonInfo",{afterSettingFormattedString:JSON.stringify(l)})}else O.value="post"}catch(e){console.error(e)}},Le=async()=>{const e={analysisType:g.value,diffCellAnalyzingCount:f.value,diffWbcPositionMargin:y.value,diffRbcPositionMargin:b.value,diffPltPositionMargin:I.value,pbsCellAnalyzingCount:C.value,edgeShotType:k.value,edgeShotLPCount:S.value.LP,edgeShotHPCount:S.value.HP,stitchCount:h.value,bfCellAnalyzingCount:w.value,iaRootPath:N.value,isNsNbIntegration:E.value,isAlarm:_.value,alarmCount:P.value,keepPage:T.value,lisUploadCheckAll:A.value,backupPath:R.value,backupStartDate:W()(M.value).add(1,"day").local().toDate().toISOString().split("T")[0],backupEndDate:W()(D.value).add(1,"day").local().toDate().toISOString().split("T")[0],autoBackUpMonth:x.value,autoBackUpStartDate:"Not selected"!==x.value?W()(new Date).local().toDate().toISOString().split("T")[0]:null};try{let t={};if(t="post"===O.value?await ae(e):await se(e,F.value),t){const e="post"===O.value?U.settingSaveSuccess:U.UPDATE_SUCCESSFULLY;De(e),dn();const l=t?.data;await a.dispatch("commonModule/setCommonInfo",{isNsNbIntegration:l?.isNsNbIntegration?"Y":"N"}),await a.dispatch("dataBaseSetDataModule/setDataBaseSetData",{isNsNbIntegration:l?.isNsNbIntegration?"Y":"N"}),sessionStorage.setItem("isNsNbIntegration",l.isNsNbIntegration?"Y":"N"),sessionStorage.setItem("wbcPositionMargin",l?.diffWbcPositionMargin),sessionStorage.setItem("rbcPositionMargin",l?.diffRbcPositionMargin),sessionStorage.setItem("pltPositionMargin",l?.diffPltPositionMargin),sessionStorage.setItem("edgeShotType",String(l?.edgeShotType)),sessionStorage.setItem("edgeShotLPCount",String(l?.edgeShotLPCount)),sessionStorage.setItem("edgeShotHPCount",String(l?.edgeShotHPCount)),sessionStorage.setItem("iaRootPath",l?.iaRootPath),sessionStorage.setItem("isAlarm",String(l?.isAlarm));const s="pb"===$.value?"keepPage":"bmKeepPage";sessionStorage.setItem(s,String(l?.keepPage)),await a.dispatch("commonModule/setCommonInfo",{resetAnalyzing:!0}),await a.dispatch("commonModule/setCommonInfo",{showLISUploadAfterCheckingAll:l?.lisUploadCheckAll})}await a.dispatch("commonModule/setCommonInfo",{beforeSettingFormattedString:null}),await a.dispatch("commonModule/setCommonInfo",{afterSettingFormattedString:null})}catch(t){console.error(t)}},Ee=()=>{E.value=!E.value},_e=()=>{_.value=!_.value},Pe=()=>{T.value=!T.value},Te=(e,t)=>{if("leave"===t)return be.value.edgeShotType=!1,void(be.value.positionMargin=!1);switch(e){case"edgeShotType":be.value.edgeShotType=!0;break;case"positionMargin":be.value.positionMargin=!0;break;default:break}},Ae=async e=>{m.value=!1,ce.value=Y.value;try{oe.value=!0;const t=sessionStorage.getItem("lastSearchParams")||localStorage.getItem("lastSearchParams")||"",{startDate:l,endDate:s,page:o,searchText:n,nrCount:i,testType:r,wbcInfo:c,wbcTotal:u}=JSON.parse(t),d=l+s+o+n+i+r+c+u,m={fileName:ye.value,destinationUploadPath:L.value,originUploadPath:R.value,dayQuery:d,projectType:$.value,uploadType:e,apiUrl:Ie.value};de.value=e,pe.value="move"===e?"moved":"copied",ue.value=0,await a.dispatch("commonModule/setCommonInfo",{isDownloadOrUploading:!0}),Xe(!0),Ue();const v=await qo(m);"string"===typeof v.data?xe(v.data):(De("Upload completed successfully"),dn())}catch(t){console.error(t)}},Me=async()=>{m.value=!1},De=e=>{u.value=!0,d.value="success",v.value=e},xe=e=>{u.value=!0,d.value="error",v.value=e},Oe=()=>{u.value=!1},Ke=async()=>{await a.dispatch("commonModule/setCommonInfo",{beforeSettingFormattedString:null}),await a.dispatch("commonModule/setCommonInfo",{afterSettingFormattedString:null}),j.value=!1,await i.push(J.value)},Be=async()=>{await Le(),j.value=!1},Fe=()=>{ne.value=!1},Ue=async()=>{const e=String(ce.value).length;me.value=setInterval((async()=>{ue.value+=1,ue.value===ce.value-1&&clearInterval(me.value)}),3e3*e)},Xe=e=>{t?.appContext.config.globalProperties.$socket.emit("isDownloadUploading",{type:"SEND_DATA",payload:e})},We=async e=>{const t=Ge(e);await a.dispatch("commonModule/setCommonInfo",{isDownloadOrUploading:!0}),Xe(!0),pe.value="move"===e?"moved":"copied",ue.value=0,console.log("downloadDto",t);try{Ue(),await Vo(t)}catch(l){console.error(l)}},He=async()=>{ue.value=ce.value,setTimeout((async()=>{ce.value=0,ue.value=0,oe.value=!1}),2e3),await De("Success")},Ge=e=>{de.value=e,ne.value=!1;const t=sessionStorage.getItem("lastSearchParams")||localStorage.getItem("lastSearchParams")||"",{startDate:a,endDate:l,page:s,searchText:o,nrCount:n,testType:i,wbcInfo:r,wbcTotal:c}=JSON.parse(t),u=a+l+s+o+n+i+r+c,d=W()(M.value).add(1,"day").local().toDate().toISOString().split("T")[0],m=W()(D.value).add(1,"day").local().toDate().toISOString().split("T")[0],v={startDate:d,endDate:m,originDownloadPath:`${N.value}`,destinationDownloadPath:R.value,projectType:$.value,dayQuery:u,downloadType:e,apiUrl:Ie.value};return oe.value=!0,v},Ye=async()=>{if(""===R.value)return void xe("Please select a download save path");const e=W()(M.value).add(1,"day").local().toDate().toISOString().split("T")[0],t=W()(D.value).add(1,"day").local().toDate().toISOString().split("T")[0];if(W()(e).isSameOrBefore(t)){re.value={startDate:e,endDate:t,originDownloadPath:`${N.value}`,destinationDownloadPath:R.value,projectType:$.value};try{await a.dispatch("commonModule/setCommonInfo",{isDownloadOrUploading:!0}),Xe(!0);const e=await jo(re.value);e.data.success?(ce.value=Number(e.data.message.split(" ")[1]),ne.value=!0,ie.value="Would you like to copy files?"):xe(e.data.message)}catch(l){console.error(l)}finally{Xe(!1),await a.dispatch("commonModule/setCommonInfo",{isDownloadOrUploading:!1})}}else xe("Please check the date")},Ve=async()=>{const e={originUploadPath:R.value};try{const t=await zo(e);t.success&&(fe.value=t.data)}catch(t){console.error(t),fe.value=[]}finally{ge.value=!0}},je=async()=>{const e={originDownloadPath:R.value};try{await Qo(e)}catch(t){ve.value=[],console.error(t)}},Qe=async()=>{try{ee.value=!0;const e={fileName:ye.value,destinationUploadPath:L.value,originUploadPath:R.value,projectType:$.value,apiUrl:Ie.value};await a.dispatch("commonModule/setCommonInfo",{isDownloadOrUploading:!0}),Xe(!0);const t=await Jo(e);"string"===typeof t.data?xe(t.data):(ce.value=t.data.totalMove,ue.value=t.data.successMove,m.value=!0,G.value=t.data)}catch(e){console.error(e)}finally{Xe(!1),await a.dispatch("commonModule/setCommonInfo",{isDownloadOrUploading:!1}),ee.value=!1}ge.value=!1},qe=()=>{ge.value=!1,ye.value=""},Je=(e,t)=>{Ce.value[e]=t},ze=()=>"pb"!==$.value?2:"100a"!==he.value||"2"!==k.value&&"3"!==k.value?("100a"===he.value||he.value,3):4;return(e,t)=>{const a=(0,s.g2)("font-awesome-icon");return(0,s.uX)(),(0,s.CE)(s.FK,null,[(0,s.bo)((0,s.Lk)("div",mn,[(0,s.Lk)("div",vn,[(0,s.Lk)("p",pn,(0,n.v_)((ue.value/ce.value*100).toFixed(0))+"%",1),(0,s.Lk)("div",{class:"progressBar",style:(0,n.Tr)({width:ue.value/ce.value*100+"%"})},null,4)])],512),[[l.aG,oe.value]]),ee.value||te.value?((0,s.uX)(),(0,s.CE)("div",gn,t[44]||(t[44]=[(0,s.Lk)("div",{class:"loaderForLogin"},null,-1),(0,s.Lk)("p",{class:"loadingTextLogin"},"Loading...",-1)]))):(0,s.Q3)("",!0),(0,s.Lk)("table",fn,[(0,s.Lk)("tbody",null,["viewer"!==q.value?((0,s.uX)(),(0,s.CE)("tr",yn,[t[45]||(t[45]=(0,s.Lk)("th",null,"Analysis Type",-1)),(0,s.Lk)("td",bn,[(0,s.bo)((0,s.Lk)("select",{"onUpdate:modelValue":t[0]||(t[0]=e=>g.value=e)},[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(H.value,(e=>((0,s.uX)(),(0,s.CE)("option",{key:e.value,value:e.value},(0,n.v_)(e.text),9,In)))),128))],512),[[l.u1,g.value]])])])):(0,s.Q3)("",!0),"viewer"!==q.value?((0,s.uX)(),(0,s.CE)("tr",Cn,["pb"===$.value?((0,s.uX)(),(0,s.CE)("th",hn,"WBC Diff Analysis Values")):(0,s.Q3)("",!0),"bm"===$.value?((0,s.uX)(),(0,s.CE)("th",kn,"BM Diff Analysis Values")):(0,s.Q3)("",!0),t[46]||(t[46]=(0,s.Lk)("th",null,"Cell Analyzing Count",-1)),(0,s.Lk)("td",null,[(0,s.bo)((0,s.Lk)("select",{"onUpdate:modelValue":t[1]||(t[1]=e=>f.value=e)},[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(p.value,(e=>((0,s.uX)(),(0,s.CE)("option",{key:e.value,value:e.value},(0,n.v_)(e.text),9,Sn)))),128))],512),[[l.u1,f.value]])])])):(0,s.Q3)("",!0),"pb"===$.value&&"viewer"!==q.value?((0,s.uX)(),(0,s.CE)("tr",wn,[(0,s.Lk)("th",{rowspan:ze()},"PBS Analysis Values",8,Nn),t[47]||(t[47]=(0,s.Lk)("th",null," Cell Analyzing Count ",-1)),(0,s.Lk)("td",null,[(0,s.bo)((0,s.Lk)("select",{"onUpdate:modelValue":t[2]||(t[2]=e=>C.value=e)},[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)((0,o.R1)(Mt),(e=>((0,s.uX)(),(0,s.CE)("option",{key:e.value,value:e.value},(0,n.v_)(e.text),9,Rn)))),128))],512),[[l.u1,C.value]])])])):(0,s.Q3)("",!0),"viewer"!==q.value?((0,s.uX)(),(0,s.CE)("tr",Ln,["bm"===$.value?((0,s.uX)(),(0,s.CE)("th",En)):(0,s.Q3)("",!0),t[48]||(t[48]=(0,s.Lk)("th",null,"Stitch Count",-1)),(0,s.Lk)("td",null,[(0,s.bo)((0,s.Lk)("select",{"onUpdate:modelValue":t[3]||(t[3]=e=>h.value=e)},[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)((0,o.R1)(Ot),(e=>((0,s.uX)(),(0,s.CE)("option",{key:e.value,value:e.value},(0,n.v_)(e.text),9,_n)))),128))],512),[[l.u1,h.value]])])])):(0,s.Q3)("",!0),(0,s.bo)((0,s.Lk)("tr",null,[(0,s.Lk)("th",Pn,[t[49]||(t[49]=(0,s.eW)(" Edge Shot Type ")),(0,s.bF)(a,{icon:["fas","circle-info"],onMouseenter:t[4]||(t[4]=()=>Te("edgeShotType","hover")),onMouseleave:t[5]||(t[5]=e=>Te("edgeShotType","leave"))}),(0,s.bF)(l.eB,null,{default:(0,s.k6)((()=>[be.value.edgeShotType?((0,s.uX)(),(0,s.CE)("div",Tn,[(0,s.Lk)("img",{src:(0,o.R1)(sn),width:"400"},null,8,An)])):(0,s.Q3)("",!0)])),_:1})]),(0,s.Lk)("td",null,[(0,s.bo)((0,s.Lk)("select",{"onUpdate:modelValue":t[6]||(t[6]=e=>k.value=e)},[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)((0,o.R1)(Kt),(e=>((0,s.uX)(),(0,s.CE)("option",{key:e.value,value:e.value},(0,n.v_)(e.text),9,Mn)))),128))],512),[[l.u1,k.value]])])],512),[[l.aG,"pb"===$.value&&"viewer"!==q.value]]),(0,s.bo)((0,s.Lk)("tr",null,[t[50]||(t[50]=(0,s.Lk)("th",{class:"pos-relative"},"Edge Shot Count",-1)),(0,s.bo)((0,s.Lk)("td",null,[(0,s.bo)((0,s.Lk)("select",{"onUpdate:modelValue":t[7]||(t[7]=e=>S.value.LP=e)},[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)((0,o.R1)(Bt),(e=>((0,s.uX)(),(0,s.CE)("option",{key:e.value,value:e.value},(0,n.v_)(e.text),9,Dn)))),128))],512),[[l.u1,S.value.LP]])],512),[[l.aG,"2"===k.value]]),(0,s.bo)((0,s.Lk)("td",null,[(0,s.bo)((0,s.Lk)("select",{"onUpdate:modelValue":t[8]||(t[8]=e=>S.value.HP=e)},[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)((0,o.R1)(Ft),(e=>((0,s.uX)(),(0,s.CE)("option",{key:e.value,value:e.value},(0,n.v_)(e.text),9,xn)))),128))],512),[[l.u1,S.value.HP]])],512),[[l.aG,"3"===k.value]])],512),[[l.aG,"pb"===$.value&&"viewer"!==q.value&&"100a"===he.value&&("2"===k.value||"3"===k.value)]]),"pb"===$.value&&"viewer"!==q.value?((0,s.uX)(),(0,s.CE)("tr",On,[t[51]||(t[51]=(0,s.Lk)("th",null,"BF Analysis Values",-1)),t[52]||(t[52]=(0,s.Lk)("th",null,"Cell Analyzing Count",-1)),(0,s.Lk)("td",null,[(0,s.bo)((0,s.Lk)("select",{"onUpdate:modelValue":t[9]||(t[9]=e=>w.value=e)},[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)((0,o.R1)(Mt),(e=>((0,s.uX)(),(0,s.CE)("option",{key:e.value,value:e.value},(0,n.v_)(e.text),9,Kn)))),128))],512),[[l.u1,w.value]])])])):(0,s.Q3)("",!0),"pb"===$.value&&"viewer"!==q.value?((0,s.uX)(),(0,s.CE)("tr",Bn,[(0,s.Lk)("th",Fn,[t[53]||(t[53]=(0,s.eW)(" Common ")),(0,s.bF)(a,{icon:["fas","circle-info"],onMouseenter:t[10]||(t[10]=()=>Te("positionMargin","hover")),onMouseleave:t[11]||(t[11]=e=>Te("positionMargin","leave"))}),(0,s.bF)(l.eB,null,{default:(0,s.k6)((()=>[(0,s.bo)((0,s.Lk)("div",Un,[(0,s.Lk)("img",{src:(0,o.R1)(ln),width:"140"},null,8,Xn)],512),[[l.aG,be.value.positionMargin]])])),_:1})]),t[54]||(t[54]=(0,s.Lk)("th",null,"Wbc Position Margin",-1)),(0,s.Lk)("td",null,[(0,s.bo)((0,s.Lk)("select",{"onUpdate:modelValue":t[12]||(t[12]=e=>y.value=e)},[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)((0,o.R1)(Ut),(e=>((0,s.uX)(),(0,s.CE)("option",{key:e.value,value:e.value},(0,n.v_)(e.text),9,$n)))),128))],512),[[l.u1,y.value]])])])):(0,s.Q3)("",!0),"pb"===$.value&&"viewer"!==q.value?((0,s.uX)(),(0,s.CE)("tr",Wn,[t[55]||(t[55]=(0,s.Lk)("th",null,"Rbc Position Margin",-1)),(0,s.Lk)("td",null,[(0,s.bo)((0,s.Lk)("select",{"onUpdate:modelValue":t[13]||(t[13]=e=>b.value=e)},[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)((0,o.R1)(Ut),(e=>((0,s.uX)(),(0,s.CE)("option",{key:e.value,value:e.value},(0,n.v_)(e.text),9,Hn)))),128))],512),[[l.u1,b.value]])])])):(0,s.Q3)("",!0),"pb"===$.value&&"viewer"!==q.value?((0,s.uX)(),(0,s.CE)("tr",Gn,[t[56]||(t[56]=(0,s.Lk)("th",null,"Edge Position Margin",-1)),(0,s.Lk)("td",null,[(0,s.bo)((0,s.Lk)("select",{"onUpdate:modelValue":t[14]||(t[14]=e=>I.value=e)},[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)((0,o.R1)(Ut),(e=>((0,s.uX)(),(0,s.CE)("option",{key:e.value,value:e.value},(0,n.v_)(e.text),9,Yn)))),128))],512),[[l.u1,I.value]])])])):(0,s.Q3)("",!0),(0,s.Lk)("tr",null,[(0,s.Lk)("th",{style:(0,n.Tr)("viewer"===q.value&&"width: 214px;"),class:"pos-relative"},[t[57]||(t[57]=(0,s.eW)(" IA Root Path ")),(0,s.bF)(a,{icon:["fas","circle-info"],title:(0,o.R1)(U).SETTING_INFO_IA_ROOT_PATH_KO,onMouseenter:t[15]||(t[15]=e=>Je("iaRootPath",!0)),onMouseleave:t[16]||(t[16]=e=>Je("iaRootPath",!1))},null,8,["title"]),(0,s.bF)(rn,{isVisible:Ce.value.iaRootPath,className:"mb08",position:"top",type:"",message:(0,o.R1)(X).TOOLTIP.IA_ROOT_PATH},null,8,["isVisible","message"])],4),(0,s.Lk)("td",Vn,[(0,s.bo)((0,s.Lk)("select",{"onUpdate:modelValue":t[17]||(t[17]=e=>N.value=e)},[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(K.value,(e=>((0,s.uX)(),(0,s.CE)("option",{key:e,value:e},(0,n.v_)(e),9,jn)))),128))],512),[[l.u1,N.value]])])]),"viewer"!==q.value?((0,s.uX)(),(0,s.CE)("tr",Qn,[(0,s.Lk)("th",qn,[t[58]||(t[58]=(0,s.eW)(" NS/NB Integration ")),(0,s.bF)(a,{icon:["fas","circle-info"],onMouseenter:t[18]||(t[18]=e=>Je("nsNbIntegration",!0)),onMouseleave:t[19]||(t[19]=e=>Je("nsNbIntegration",!1))}),(0,s.bF)(rn,{isVisible:Ce.value.nsNbIntegration,className:"mb08",position:"top",type:"",message:(0,o.R1)(X).TOOLTIP.NS_NB_INTEGRATION},null,8,["isVisible","message"])]),(0,s.Lk)("td",null,[(0,s.bF)(a,{icon:E.value?["fas","toggle-on"]:["fas","toggle-off"],class:"iconSize",onClick:Ee},null,8,["icon"])])])):(0,s.Q3)("",!0),"viewer"!==q.value?((0,s.uX)(),(0,s.CE)("tr",Jn,[(0,s.Lk)("th",zn,[t[59]||(t[59]=(0,s.eW)(" Alarm Timer (sec) ")),(0,s.bF)(a,{icon:["fas","circle-info"],onMouseenter:t[20]||(t[20]=e=>Je("alarm",!0)),onMouseleave:t[21]||(t[21]=e=>Je("alarm",!1))}),(0,s.bF)(rn,{isVisible:Ce.value.alarm,className:"mb08",position:"top",type:"",message:(0,o.R1)(X).TOOLTIP.ALARM},null,8,["isVisible","message"])]),(0,s.Lk)("td",null,[(0,s.bF)(a,{icon:_.value?["fas","toggle-on"]:["fas","toggle-off"],class:"iconSize",onClick:_e},null,8,["icon"])]),(0,s.Lk)("td",null,[(0,s.bo)((0,s.Lk)("input",{type:"text","onUpdate:modelValue":t[22]||(t[22]=e=>P.value=e),class:"alarmInput",onInput:t[23]||(t[23]=e=>Se(e))},null,544),[[l.Jo,P.value]])])])):(0,s.Q3)("",!0),(0,s.Lk)("tr",null,[(0,s.Lk)("th",Zn,[t[60]||(t[60]=(0,s.eW)(" Keep Page ")),(0,s.bF)(a,{icon:["fas","circle-info"],onMouseenter:t[24]||(t[24]=e=>Je("keepPage",!0)),onMouseleave:t[25]||(t[25]=e=>Je("keepPage",!1))}),(0,s.bF)(rn,{isVisible:Ce.value.keepPage,className:"mb08",position:"top",type:"",message:(0,o.R1)(X).TOOLTIP.KEEP_PAGE},null,8,["isVisible","message"])]),(0,s.Lk)("td",null,[(0,s.bF)(a,{icon:T.value?["fas","toggle-on"]:["fas","toggle-off"],class:"iconSize",onClick:Pe},null,8,["icon"])])])])]),(0,s.Lk)("table",ei,[t[64]||(t[64]=(0,s.Lk)("colgroup",null,[(0,s.Lk)("col",{width:"70"}),(0,s.Lk)("col",{width:"30"})],-1)),(0,s.Lk)("tbody",null,[(0,s.Lk)("tr",null,[(0,s.Lk)("th",ti,[t[61]||(t[61]=(0,s.eW)(" Download Save Path ")),(0,s.bF)(a,{icon:["fas","circle-info"],onMouseenter:t[26]||(t[26]=e=>Je("downloadSavePath",!0)),onMouseleave:t[27]||(t[27]=e=>Je("downloadSavePath",!1))}),(0,s.bF)(rn,{isVisible:Ce.value.downloadSavePath,className:"mb08",position:"top",type:"",message:(0,o.R1)(X).TOOLTIP.DOWNLOAD_SAVE_PATH},null,8,["isVisible","message"])]),(0,s.Lk)("td",null,[(0,s.Lk)("div",ai,[(0,s.bo)((0,s.Lk)("select",{"onUpdate:modelValue":t[28]||(t[28]=e=>R.value=e),class:"downloadPath"},[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(B.value,(e=>((0,s.uX)(),(0,s.CE)("option",{key:e,value:e},(0,n.v_)(e),9,li)))),128))],512),[[l.u1,R.value]]),(0,s.Lk)("div",si,[(0,s.bF)(a,{icon:["fas","folder-open"],onClick:je,class:"openDriveIcon",onMouseenter:t[29]||(t[29]=e=>Je("openDownloadSavePath",!0)),onMouseleave:t[30]||(t[30]=e=>Je("openDownloadSavePath",!1))}),(0,s.bF)(rn,{isVisible:Ce.value.openDownloadSavePath,className:"mb08",position:"top",type:"",message:(0,o.R1)(X).TOOLTIP.OPEN_DOWNLOAD_SAVE_PATH},null,8,["isVisible","message"])])])])]),(0,s.Lk)("tr",null,[(0,s.Lk)("th",oi,[t[62]||(t[62]=(0,s.eW)(" Download ")),(0,s.bF)(a,{icon:["fas","circle-info"],onMouseenter:t[31]||(t[31]=e=>Je("download",!0)),onMouseleave:t[32]||(t[32]=e=>Je("download",!1))}),(0,s.bF)(rn,{isVisible:Ce.value.download,className:"mb08",position:"top",type:"",message:(0,o.R1)(X).TOOLTIP.DOWNLOAD},null,8,["isVisible","message"])]),(0,s.Lk)("td",null,[(0,s.Lk)("div",ni,[(0,s.bF)((0,o.R1)(Go.A),{modelValue:M.value,"onUpdate:modelValue":t[33]||(t[33]=e=>M.value=e)},null,8,["modelValue"]),(0,s.bF)((0,o.R1)(Go.A),{modelValue:D.value,"onUpdate:modelValue":t[34]||(t[34]=e=>D.value=e)},null,8,["modelValue"]),(0,s.Lk)("button",{class:"backupBtn",onClick:Ye},"Download")])])]),(0,s.Lk)("tr",null,[(0,s.Lk)("th",ii,[t[63]||(t[63]=(0,s.eW)(" Upload ")),(0,s.bF)(a,{icon:["fas","circle-info"],title:(0,o.R1)(U).SETTING_INFO_UPLOAD_KO,onMouseenter:t[35]||(t[35]=e=>Je("upload",!0)),onMouseleave:t[36]||(t[36]=e=>Je("upload",!1))},null,8,["title"]),(0,s.bF)(rn,{isVisible:Ce.value.upload,className:"mb08",position:"top",type:"",message:(0,o.R1)(X).TOOLTIP.UPLOAD},null,8,["isVisible","message"])]),(0,s.Lk)("td",ri,[(0,s.Lk)("div",ci,[(0,s.bo)((0,s.Lk)("select",{"onUpdate:modelValue":t[37]||(t[37]=e=>L.value=e),class:"uploadSavePath"},[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(K.value,(e=>((0,s.uX)(),(0,s.CE)("option",{key:e,value:e},(0,n.v_)(e),9,ui)))),128))],512),[[l.u1,L.value]]),(0,s.Lk)("button",{class:"uploadBtn",onClick:Ve},"Upload")])])])])]),(0,s.Lk)("button",{class:"saveBtn mb20",type:"button",onClick:t[38]||(t[38]=e=>Le())},"Save"),m.value?((0,s.uX)(),(0,s.CE)("div",{key:1,class:(0,n.C4)(0===V.value?"uploadModalSmall":"uploadModal")},[0===V.value?((0,s.uX)(),(0,s.CE)("p",di,"Would you like to upload?")):V.value>0?((0,s.uX)(),(0,s.CE)("pre",mi,t[65]||(t[65]=[(0,s.eW)("      There are "),(0,s.Lk)("span",{style:{color:"red"}},"duplicated",-1),(0,s.eW)(" items\n      Would you like to upload possible items?\n    ")]))):(0,s.Q3)("",!0),(0,s.Lk)("div",{class:(0,n.C4)(0===V.value&&"uploadModalCountWrapperSmall")},[(0,s.Lk)("p",null,"Movable Items Count: "+(0,n.v_)(Y.value),1),(0,s.Lk)("p",null,"Duplicated Count: "+(0,n.v_)(V.value),1)],2),V.value>0?((0,s.uX)(),(0,s.CE)("div",vi,[t[66]||(t[66]=(0,s.Lk)("p",{style:{color:"black"}},"Duplicated Barcode Numbers",-1)),(0,s.Lk)("ul",pi,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(G.value?.duplicated,(e=>((0,s.uX)(),(0,s.CE)("li",{class:"userSelectText",key:e},(0,n.v_)(e),1)))),128))])])):(0,s.Q3)("",!0),(0,s.Lk)("div",gi,[(0,s.bo)((0,s.Lk)("button",{class:"memoModalBtn",onClick:t[39]||(t[39]=e=>Ae("copy"))},(0,n.v_)((0,o.R1)(U).COPY),513),[[l.aG,Y.value>0]]),(0,s.bo)((0,s.Lk)("button",{class:"memoModalBtn",onClick:t[40]||(t[40]=e=>Ae("move"))},(0,n.v_)((0,o.R1)(U).MOVE),513),[[l.aG,Y.value>0]]),(0,s.Lk)("button",{class:"memoModalBtn",onClick:Me},(0,n.v_)(0===V.value?(0,o.R1)(U).CANCEL:(0,o.R1)(U).CLOSE),1)])],2)):(0,s.Q3)("",!0),(0,s.bo)((0,s.Lk)("div",{class:(0,n.C4)(0===fe.value.length?"downloadDeleteSmallModal":"downloadDeleteModal")},[t[68]||(t[68]=(0,s.Lk)("p",{class:"fs12",style:{top:"0"}},"Upload file list",-1)),(0,s.bo)((0,s.Lk)("div",fi,[t[67]||(t[67]=(0,s.Lk)("p",{class:"downloadDeleteSemiTitle"},"Select upload file",-1)),(0,s.Lk)("ul",yi,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(fe.value,(e=>((0,s.uX)(),(0,s.CE)("li",{class:"userSelectText flex-justify-between",key:e},[(0,s.Lk)("p",bi,(0,n.v_)(e),1),(0,s.bo)((0,s.Lk)("input",{style:{margin:"0"},"onUpdate:modelValue":t[41]||(t[41]=e=>ye.value=e),type:"radio",value:e},null,8,Ii),[[l.XL,ye.value]])])))),128))])],512),[[l.aG,fe.value.length>0]]),(0,s.bo)((0,s.Lk)("p",Ci,"No files",512),[[l.aG,0===fe.value.length]]),(0,s.Lk)("div",hi,[fe.value.length>0?((0,s.uX)(),(0,s.CE)(s.FK,{key:0},[(0,s.Lk)("button",{class:"memoModalBtn",onClick:Qe},(0,n.v_)((0,o.R1)(U).UPLOAD),1),(0,s.Lk)("button",{class:"memoModalBtn",onClick:qe},(0,n.v_)((0,o.R1)(U).CANCEL),1)],64)):((0,s.uX)(),(0,s.CE)("button",{key:1,class:"memoModalBtn",onClick:qe},(0,n.v_)((0,o.R1)(U).CLOSE),1))])],2),[[l.aG,ge.value]]),j.value?((0,s.uX)(),(0,s.Wv)(ra,{key:2,"is-visible":j.value,type:"setting",message:Q.value,onHide:Ke,onOkConfirm:Be},null,8,["is-visible","message"])):(0,s.Q3)("",!0),ne.value?((0,s.uX)(),(0,s.Wv)(an,{key:3,"is-visible":ne.value,message:ie.value,confirmFirstText:(0,o.R1)(U).MOVE,confirmSecondText:(0,o.R1)(U).COPY,closeText:(0,o.R1)(U).CLOSE,onHide:Fe,onOkConfirm:t[42]||(t[42]=e=>We("move")),onOkConfirm2:t[43]||(t[43]=e=>We("copy"))},null,8,["is-visible","message","confirmFirstText","confirmSecondText","closeText"])):(0,s.Q3)("",!0),u.value?((0,s.uX)(),(0,s.Wv)(Pt,{key:4,"is-visible":u.value,type:d.value,message:v.value,onHide:Oe,"onUpdate:hideAlert":Oe},null,8,["is-visible","type","message"])):(0,s.Q3)("",!0)],64)}}});const Si=ki;var wi=Si;const Ni={class:"flex-column-center"},Ri={class:"flex-column mt22"},Li={class:"fs12 mb14"},Ei={class:"flex-align-center-justify-between mb10"},_i={style:{width:"240px"},class:"flex-justify-between"},Pi={class:"fs10"},Ti={class:"degreeInput mt1 mb1 flex-justify-between"},Ai=["onUpdate:modelValue"],Mi=["onUpdate:modelValue"],Di=["onUpdate:modelValue"];var xi=(0,s.pM)({__name:"rbcDegree",setup(e){const t=(0,c.Pj)(),a=(0,r.rd)(),i=(0,o.Kh)({value:[]}),u=(0,o.KR)("post"),d=(0,o.KR)(!1),m=(0,o.KR)(""),v=(0,o.KR)(""),p=(0,o.KR)(!1),g=(0,o.KR)(""),f=(0,s.EW)((()=>t.state.commonModule.enteringRouterPath)),y=(0,s.EW)((()=>t.state.commonModule.settingChangedChecker)),b=(0,s.EW)((()=>t.state.commonModule.settingType));(0,s.sV)((async()=>{await S(),await t.dispatch("commonModule/setCommonInfo",{settingType:la.rbcDegree})})),(0,s.wB)((()=>i.value),(async e=>{await t.dispatch("commonModule/setCommonInfo",{afterSettingFormattedString:JSON.stringify(e)}),b.value!==la.rbcDegree&&await t.dispatch("commonModule/setCommonInfo",{settingType:la.rbcDegree})}),{deep:!0}),(0,s.wB)((()=>y.value),(()=>{I()}));const I=()=>{p.value=!0,g.value=`${b.value} ${U.settingNotSaved}`},C=async()=>{i.value=Wt.rbcClassList.map((e=>({...e,classInfo:e.classInfo.map((t=>{const a=Ht.find((a=>a.categoryId===e.categoryId&&a.classId===t.classId));return{...t,degree1:a?.degree1||0,degree2:a?.degree2||0,degree3:a?.degree3||0}}))})))},h=()=>{C()},k=async()=>{const e=[];i.value.forEach((t=>{t.classInfo.forEach((a=>{e.push({categoryId:t.categoryId,categoryNm:t.categoryNm,classId:a.classId,classNm:a.classNm,degree1:a.degree1,degree2:a.degree2,degree3:a.degree3})}))}));try{let t={};t="post"===u.value?await oe(e):await ne(e),t&&(N(U.settingSaveSuccess),dn(),u.value="put")}catch(a){R(U.settingSaveFailure),console.error(a)}finally{await t.dispatch("commonModule/setCommonInfo",{beforeSettingFormattedString:null}),await t.dispatch("commonModule/setCommonInfo",{afterSettingFormattedString:null})}},S=async()=>{try{const e=await ie();u.value="put";const t=e.data;w(t)}catch(e){u.value="post",await C()}await t.dispatch("commonModule/setCommonInfo",{beforeSettingFormattedString:JSON.stringify(i.value)}),await t.dispatch("commonModule/setCommonInfo",{afterSettingFormattedString:JSON.stringify(i.value)})},w=e=>{const t=new Map;e.forEach((e=>{const a=e.categoryId,l=e.classId;if(t.has(a)){const s=t.get(a),o=s.classInfo.findIndex((e=>e.classId===l));-1===o?s.classInfo.push({classId:l,classNm:e.classNm,degree1:e.degree1,degree2:e.degree2,degree3:e.degree3}):s.classInfo[o].degree=e.degree}else{const s={categoryId:a,categoryNm:e.categoryNm,classInfo:[{classId:l,classNm:e.classNm,degree1:e.degree1,degree2:e.degree2,degree3:e.degree3}]};t.set(a,s)}})),i.value=Array.from(t.values())},N=e=>{d.value=!0,m.value="success",v.value=e},R=e=>{d.value=!0,m.value="error",v.value=e},L=()=>{d.value=!1},E=async()=>{await t.dispatch("commonModule/setCommonInfo",{beforeSettingFormattedString:null}),await t.dispatch("commonModule/setCommonInfo",{afterSettingFormattedString:null}),p.value=!1,await a.push(f.value)},_=async()=>{await k(),p.value=!1};return(e,t)=>((0,s.uX)(),(0,s.CE)(s.FK,null,[(0,s.Lk)("div",Ni,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(i.value,((e,t)=>((0,s.uX)(),(0,s.CE)("div",{style:{width:"480px"},class:"mt2 mb4",key:"rbc"+t},[(0,s.Lk)("div",Ri,[(0,s.Lk)("h2",Li,(0,n.v_)(e?.categoryNm),1),((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(e.classInfo,((e,t)=>((0,s.uX)(),(0,s.CE)("div",{key:t},[(0,s.Lk)("div",Ei,["Normal"!==e.classNm?((0,s.uX)(),(0,s.CE)(s.FK,{key:0},[(0,s.Lk)("div",_i,[(0,s.Lk)("h3",Pi,(0,n.v_)(e.classNm),1),(0,s.Lk)("h3",null,"["+(0,n.v_)(e.degree1)+", "+(0,n.v_)(e.degree2)+", "+(0,n.v_)(e.degree3)+"]",1)]),(0,s.Lk)("div",Ti,[(0,s.bo)((0,s.Lk)("input",{class:"number-small",type:"number","onUpdate:modelValue":t=>e.degree1=t},null,8,Ai),[[l.Jo,e.degree1]]),(0,s.bo)((0,s.Lk)("input",{class:"number-small",type:"number","onUpdate:modelValue":t=>e.degree2=t},null,8,Mi),[[l.Jo,e.degree2]]),(0,s.bo)((0,s.Lk)("input",{class:"number-small",type:"number","onUpdate:modelValue":t=>e.degree3=t},null,8,Di),[[l.Jo,e.degree3]])])],64)):(0,s.Q3)("",!0)])])))),128))])])))),128)),(0,s.Lk)("div",{class:"mt-2 degreeDiv"},[(0,s.Lk)("button",{class:"saveBtn mb20",onClick:h},"Reset"),(0,s.Lk)("button",{class:"saveBtn mb20",type:"button",onClick:k},"Save")])]),p.value?((0,s.uX)(),(0,s.Wv)(ra,{key:0,"is-visible":p.value,type:"setting",message:g.value,onHide:E,onOkConfirm:_},null,8,["is-visible","message"])):(0,s.Q3)("",!0),d.value?((0,s.uX)(),(0,s.Wv)(Pt,{key:1,"is-visible":d.value,type:m.value,message:v.value,onHide:L,"onUpdate:hideAlert":L},null,8,["is-visible","type","message"])):(0,s.Q3)("",!0)],64))}});const Oi=xi;var Ki=Oi;const Bi={class:"customSettingContainer"},Fi={class:"mt20"},Ui={class:"mt22"};var Xi=(0,s.pM)({__name:"deviceControls",setup(e){const t=(0,o.KR)(!1),a=(0,o.KR)(""),l=(0,o.KR)(""),i=(0,c.Pj)(),r=(0,o.KR)(""),u=(0,s.EW)((()=>i.state.userModule)),d=(0,s.EW)((()=>i.state.commonModule)),m=(0,o.KR)(!1),v=(0,o.KR)(!1),p=(0,o.KR)(!1);let g=null,f=null;const y=(0,o.KR)(!1);(0,s.sV)((async()=>{const e=JSON.parse(JSON.stringify(u.value));r.value=e.userId,await h()})),(0,s.wB)([d.value],(async e=>{await(0,s.dY)();const[t]=e,{isRunningState:a}=t||{};m.value=a}));const b=async()=>{await Ye()},I=()=>{null!==g&&clearTimeout(g),v.value=!0,J().embedStatus.gripperOpen.reqUserId=r.value,Nt.publish("childEmitSocketData",J().embedStatus.gripperOpen),g=setTimeout((()=>{v.value=!1,g=null}),500)},C=()=>{null!==f&&clearTimeout(f),p.value=!0,J().embedStatus.gripperOpen.reqUserId=r.value,Nt.publish("childEmitSocketData",J().embedStatus.cameraReset),f=setTimeout((()=>{p.value=!1,f=null}),500)},h=async()=>{try{const e=await da();y.value=!!e.data[0]?.autoStart}catch(e){y.value=!0}sessionStorage.setItem("autoStart",JSON.stringify(y.value))},k=async()=>{try{await ma({autoStart:y.value})}catch(e){console.error(e)}},S=async()=>{y.value=!y.value,sessionStorage.setItem("autoStart",JSON.stringify(y.value)),await k()},w=()=>{t.value=!1};return(e,o)=>{const i=(0,s.g2)("font-awesome-icon");return(0,s.uX)(),(0,s.CE)(s.FK,null,[(0,s.Lk)("div",null,[(0,s.Lk)("ul",Bi,[(0,s.Lk)("li",null,[o[0]||(o[0]=(0,s.Lk)("p",{class:"mb10"},"Gripper Open",-1)),(0,s.Lk)("button",{onClick:I,class:(0,n.C4)({defaultBtn:!0,blinkGripper:v.value})},"OK",2)]),(0,s.Lk)("li",Fi,[o[1]||(o[1]=(0,s.Lk)("p",{class:"mb10"},"Camera Reset",-1)),(0,s.Lk)("button",{type:"button",class:(0,n.C4)(["defaultBtn",{defaultBtn:!0,blinkGripper:p.value}]),onClick:C},"OK ",2)]),(0,s.Lk)("li",{class:"mt20"},[o[2]||(o[2]=(0,s.Lk)("p",{class:"mb10"},"Charge Remaining Count",-1)),(0,s.Lk)("button",{type:"button",class:"defaultBtn",onClick:b},"Scan")]),(0,s.Lk)("li",Ui,[o[3]||(o[3]=(0,s.Lk)("p",{class:"mb10"},"Auto Start",-1)),(0,s.bF)(i,{icon:y.value?["fas","toggle-on"]:["fas","toggle-off"],class:"iconSize",onClick:S},null,8,["icon"])])])]),t.value?((0,s.uX)(),(0,s.Wv)(Pt,{key:0,"is-visible":t.value,type:a.value,message:l.value,onHide:w,"onUpdate:hideAlert":w},null,8,["is-visible","type","message"])):(0,s.Q3)("",!0)],64)}}});const $i=Xi;var Wi=$i;const Hi={class:"customClass customSettingContainer"},Gi=["onUpdate:modelValue","onInput"],Yi=["onUpdate:modelValue","onInput"];var Vi=(0,s.pM)({__name:"customClass",setup(e){const t=(0,c.Pj)(),a=(0,r.rd)(),i=(0,o.KR)(""),u=(0,o.KR)([]),d=(0,o.KR)(!1),m=(0,o.KR)(""),v=(0,o.KR)(""),p=(0,o.KR)(!1),g=(0,o.KR)(!1),f=(0,o.KR)(""),y=(0,s.EW)((()=>t.state.commonModule.enteringRouterPath)),b=(0,s.EW)((()=>t.state.commonModule.settingChangedChecker)),I=(0,s.EW)((()=>t.state.commonModule.settingType));(0,o.KR)([]);(0,s.KC)((()=>{p.value="bm"===window.PROJECT_TYPE})),(0,s.sV)((async()=>{await S(),await t.dispatch("commonModule/setCommonInfo",{settingType:la.wbcCustomClass})})),(0,s.wB)((()=>u.value),(async e=>{I.value!==la.wbcCustomClass&&await t.dispatch("commonModule/setCommonInfo",{settingType:la.wbcCustomClass})}),{deep:!0}),(0,s.wB)((()=>b.value),(()=>{C()}));const C=()=>{g.value=!0,f.value=`${I.value} ${U.settingNotSaved}`},h=async()=>{if(w())try{let e;if("post"!==i.value){const e=await ce({classArr:u.value});return e.data?(N(U.UPDATE_SUCCESSFULLY),await S()):R(U.settingUpdateFailure),await t.dispatch("commonModule/setCommonInfo",{beforeSettingFormattedString:null}),void await t.dispatch("commonModule/setCommonInfo",{afterSettingFormattedString:null})}e=await re({classArr:u.value}),e&&(N(U.settingSaveSuccess),i.value="put",await S(),await t.dispatch("commonModule/setCommonInfo",{beforeSettingFormattedString:null}),await t.dispatch("commonModule/setCommonInfo",{afterSettingFormattedString:null}))}catch(e){console.error(e)}},k=(e,t,a)=>{const l=e.target,s=l.value.replace(/[^a-zA-Z0-9]/g,"");t[a]=s.trim()},S=async()=>{try{const e=await ue();e&&(!e?.data||e?.data instanceof Array&&0===e?.data.length?(i.value="post",u.value=sa):(i.value="put",u.value=e.data),await t.dispatch("commonModule/setCommonInfo",{beforeSettingFormattedString:JSON.stringify(u.value)}),await t.dispatch("commonModule/setCommonInfo",{afterSettingFormattedString:JSON.stringify(u.value)}))}catch(e){console.error(e)}},w=()=>{let e,t;p.value?(e=za.map((e=>e.fullNm)),t=za.map((e=>e.abbreviation))):(e=Ja.map((e=>e.fullNm)),t=Ja.map((e=>e.abbreviation)));for(const a of u.value){if(""===a.fullNm&&""!==a.abbreviation)return R("You should enter abbreviation"),!1;if(""!==a.fullNm&&""===a.abbreviation)return R("You should enter class name"),!1;if(t.includes(a.abbreviation))return R(`${a.abbreviation} is existing abbreviation`),!1;if(e.includes(a.fullNm))return R(`${a.fullNm} is existing class name`),!1;if("OT"===a.abbreviation)return R("Can't use OT abbreviation!"),!1}return!0},N=e=>{d.value=!0,m.value="success",v.value=e},R=e=>{d.value=!0,m.value="error",v.value=e},L=()=>{d.value=!1},E=async()=>{await t.dispatch("commonModule/setCommonInfo",{beforeSettingFormattedString:null}),await t.dispatch("commonModule/setCommonInfo",{afterSettingFormattedString:null}),g.value=!1,await a.push(y.value)},_=async()=>{await h(),g.value=!1};return(e,t)=>((0,s.uX)(),(0,s.CE)(s.FK,null,[(0,s.Lk)("div",null,[(0,s.Lk)("ul",Hi,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(u.value,(e=>((0,s.uX)(),(0,s.CE)("li",{key:e.id},[(0,s.Lk)("span",null,"ID: "+(0,n.v_)(e.customNum),1),(0,s.Lk)("span",null,[(0,s.bo)((0,s.Lk)("input",{"onUpdate:modelValue":t=>e.abbreviation=t,type:"text",maxlength:"3",placeholder:"abbreviation",onInput:t=>k(t,e,"abbreviation")},null,40,Gi),[[l.Jo,e.abbreviation]])]),(0,s.Lk)("span",null,[(0,s.bo)((0,s.Lk)("input",{"onUpdate:modelValue":t=>e.fullNm=t,type:"text",maxlength:"25",placeholder:"class name",onInput:t=>k(t,e,"fullNm")},null,40,Yi),[[l.Jo,e.fullNm]])])])))),128))]),(0,s.Lk)("button",{class:"saveBtn",type:"button",onClick:h},"Save")]),g.value?((0,s.uX)(),(0,s.Wv)(ra,{key:0,"is-visible":g.value,type:"setting",message:f.value,onHide:E,onOkConfirm:_},null,8,["is-visible","message"])):(0,s.Q3)("",!0),d.value?((0,s.uX)(),(0,s.Wv)(Pt,{key:1,"is-visible":d.value,type:m.value,message:v.value,onHide:L,"onUpdate:hideAlert":L},null,8,["is-visible","type","message"])):(0,s.Q3)("",!0)],64))}});const ji=Vi;var Qi=ji;const qi={class:"wbcHotKeysItems"},Ji=["onUpdate:modelValue","onInput"];var zi=(0,s.pM)({__name:"wbcHotKeys",setup(e){const t=(0,c.Pj)(),a=(0,r.rd)(),i=(0,o.KR)(""),u=(0,o.KR)([]),d=(0,o.KR)(!1),m=(0,o.KR)(""),v=(0,o.KR)(""),p=(0,o.KR)("pb"),g=(0,o.KR)(!1),f=(0,o.KR)(""),y=(0,s.EW)((()=>t.state.commonModule.enteringRouterPath)),b=(0,s.EW)((()=>t.state.commonModule.settingChangedChecker)),I=(0,s.EW)((()=>t.state.commonModule.settingType));(0,s.KC)((()=>{p.value="bm"===window.PROJECT_TYPE?"bm":"pb"})),(0,s.sV)((async()=>{await S(),await t.dispatch("commonModule/setCommonInfo",{settingType:la.wbcHotKeys})})),(0,s.wB)((()=>u.value),(async e=>{await t.dispatch("commonModule/setCommonInfo",{afterSettingFormattedString:JSON.stringify(e)}),I.value!==la.wbcHotKeys&&await t.dispatch("commonModule/setCommonInfo",{settingType:la.wbcHotKeys})}),{deep:!0}),(0,s.wB)((()=>b.value),(()=>{C()}));const C=()=>{g.value=!0,f.value=`${I.value} ${U.settingNotSaved}`},h=(e,t,a)=>{const l=e.target,s=l.value.replace(/[^a-zA-Z0-9!@#$%^&*()\\/*\-+,.?":\[\]`{}|<> ]/g,"");t[a]=s.trim()},k=async()=>{try{let e;if("post"!==i.value){const e=await me({wbcHotKeysItems:u.value});return e.data?(w(U.UPDATE_SUCCESSFULLY),await S()):N(U.settingUpdateFailure),await t.dispatch("commonModule/setCommonInfo",{beforeSettingFormattedString:null}),void await t.dispatch("commonModule/setCommonInfo",{afterSettingFormattedString:null})}e=await de({wbcHotKeysItems:u.value}),e&&(w(U.settingSaveSuccess),i.value="put",await S(),await t.dispatch("commonModule/setCommonInfo",{beforeSettingFormattedString:null}),await t.dispatch("commonModule/setCommonInfo",{afterSettingFormattedString:null}))}catch(e){console.error(e)}},S=async()=>{try{const e=await ve();e&&(!e?.data||e?.data instanceof Array&&0===e?.data.length?(i.value="post",u.value="bm"===p.value?Yt:Gt):(i.value="put",u.value=e.data),await t.dispatch("commonModule/setCommonInfo",{beforeSettingFormattedString:JSON.stringify(u.value)}),await t.dispatch("commonModule/setCommonInfo",{afterSettingFormattedString:JSON.stringify(u.value)}))}catch(e){console.error(e)}},w=e=>{d.value=!0,m.value="success",v.value=e},N=e=>{d.value=!0,m.value="error",v.value=e},R=()=>{d.value=!1},L=async()=>{await t.dispatch("commonModule/setCommonInfo",{beforeSettingFormattedString:null}),await t.dispatch("commonModule/setCommonInfo",{afterSettingFormattedString:null}),g.value=!1,await a.push(y.value)},E=async()=>{await k(),g.value=!1};return(e,t)=>((0,s.uX)(),(0,s.CE)(s.FK,null,[(0,s.Lk)("div",null,[(0,s.Lk)("ul",qi,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(u.value,(e=>((0,s.uX)(),(0,s.CE)("li",{key:e.id},[(0,s.Lk)("span",null,(0,n.v_)(e.abbreviation),1),(0,s.Lk)("span",null,(0,n.v_)(e.fullNm),1),(0,s.Lk)("span",null,[(0,s.bo)((0,s.Lk)("input",{"onUpdate:modelValue":t=>e.key=t,type:"text",maxlength:"1",placeholder:"hot key",onInput:t=>h(t,e,"key")},null,40,Ji),[[l.Jo,e.key]])])])))),128))]),(0,s.Lk)("button",{onClick:k,class:"saveBtn",type:"button"},"Save")]),g.value?((0,s.uX)(),(0,s.Wv)(ra,{key:0,"is-visible":g.value,type:"setting",message:f.value,onHide:L,onOkConfirm:E},null,8,["is-visible","message"])):(0,s.Q3)("",!0),d.value?((0,s.uX)(),(0,s.Wv)(Pt,{key:1,"is-visible":d.value,type:m.value,message:v.value,onHide:R,"onUpdate:hideAlert":R},null,8,["is-visible","type","message"])):(0,s.Q3)("",!0)],64))}});const Zi=zi;var er=Zi;const tr={class:"wbcHotKeysItems"},ar=["onUpdate:modelValue","onInput"];var lr=(0,s.pM)({__name:"bfHotKeys",setup(e){const t=(0,c.Pj)(),a=(0,r.rd)(),i=(0,o.KR)(""),u=(0,o.KR)([]),d=(0,o.KR)(!1),m=(0,o.KR)(""),v=(0,o.KR)(""),p=(0,o.KR)(!1),g=(0,o.KR)(""),f=(0,s.EW)((()=>t.state.commonModule.enteringRouterPath)),y=(0,s.EW)((()=>t.state.commonModule.settingChangedChecker)),b=(0,s.EW)((()=>t.state.commonModule.settingType));(0,s.sV)((async()=>{await k(),await t.dispatch("commonModule/setCommonInfo",{settingType:la.bfHotKeys})})),(0,s.wB)((()=>u.value),(async e=>{await t.dispatch("commonModule/setCommonInfo",{afterSettingFormattedString:JSON.stringify(e)}),b.value!==la.bfHotKeys&&await t.dispatch("commonModule/setCommonInfo",{settingType:la.bfHotKeys})}),{deep:!0}),(0,s.wB)((()=>y.value),(()=>{I()}));const I=()=>{p.value=!0,g.value=`${b.value} ${U.settingNotSaved}`},C=(e,t,a)=>{const l=e.target,s=l.value.replace(/[^a-zA-Z0-9]/g,"");t[a]=s.trim()},h=async()=>{try{let e;if("post"!==i.value){const e=await ge({bfHotKeysItems:u.value});return e.data?(S(U.UPDATE_SUCCESSFULLY),await k()):w(U.settingUpdateFailure),await t.dispatch("commonModule/setCommonInfo",{beforeSettingFormattedString:null}),void await t.dispatch("commonModule/setCommonInfo",{afterSettingFormattedString:null})}e=await pe({bfHotKeysItems:u.value}),e&&(S(U.settingSaveSuccess),i.value="put",await k(),await t.dispatch("commonModule/setCommonInfo",{beforeSettingFormattedString:null}),await t.dispatch("commonModule/setCommonInfo",{afterSettingFormattedString:null}))}catch(e){console.error(e)}},k=async()=>{try{const e=await fe();e&&(!e?.data||e?.data instanceof Array&&0===e?.data.length?(i.value="post",u.value=Vt):(i.value="put",u.value=e.data),await t.dispatch("commonModule/setCommonInfo",{beforeSettingFormattedString:JSON.stringify(u.value)}),await t.dispatch("commonModule/setCommonInfo",{afterSettingFormattedString:JSON.stringify(u.value)}))}catch(e){console.error(e)}},S=e=>{d.value=!0,m.value="success",v.value=e},w=e=>{d.value=!0,m.value="error",v.value=e},N=()=>{d.value=!1},R=async()=>{await t.dispatch("commonModule/setCommonInfo",{beforeSettingFormattedString:null}),await t.dispatch("commonModule/setCommonInfo",{afterSettingFormattedString:null}),p.value=!1,await a.push(f.value)},L=async()=>{await h(),p.value=!1};return(e,t)=>((0,s.uX)(),(0,s.CE)(s.FK,null,[(0,s.Lk)("div",null,[(0,s.Lk)("ul",tr,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(u.value,(e=>((0,s.uX)(),(0,s.CE)("li",{key:e.id},[(0,s.Lk)("span",null,(0,n.v_)(e?.abbreviation),1),(0,s.Lk)("span",null,(0,n.v_)(e?.fullNm),1),(0,s.Lk)("span",null,[(0,s.bo)((0,s.Lk)("input",{"onUpdate:modelValue":t=>e.key=t,type:"text",maxlength:"1",placeholder:"hot key",onInput:t=>C(t,e,"key")},null,40,ar),[[l.Jo,e.key]])])])))),128))]),(0,s.Lk)("button",{onClick:h,class:"saveBtn",type:"button"},"Save")]),p.value?((0,s.uX)(),(0,s.Wv)(ra,{key:0,"is-visible":p.value,type:"setting",message:g.value,onHide:R,onOkConfirm:L},null,8,["is-visible","message"])):(0,s.Q3)("",!0),d.value?((0,s.uX)(),(0,s.Wv)(Pt,{key:1,"is-visible":d.value,type:m.value,message:v.value,onHide:N,"onUpdate:hideAlert":N},null,8,["is-visible","type","message"])):(0,s.Q3)("",!0)],64))}});const sr=lr;var or=sr;const nr={class:"flex-column-center"},ir={class:"normalItems"},rr={class:"text-left"},cr={class:"flex-justify-start-align-center gap14",style:{width:"250px"}},ur=["onUpdate:modelValue","onInput"],dr=["onInput","onUpdate:modelValue"];var mr=(0,s.pM)({__name:"normalRange",setup(e){const t=(0,c.Pj)(),a=(0,r.rd)(),i=(0,o.KR)(""),u=(0,o.KR)([]),d=(0,o.KR)(!1),m=(0,o.KR)(""),v=(0,o.KR)(""),p=(0,o.KR)(!1),g=(0,o.KR)(""),f=(0,s.EW)((()=>t.state.commonModule.enteringRouterPath)),y=(0,s.EW)((()=>t.state.commonModule.settingChangedChecker)),b=(0,s.EW)((()=>t.state.commonModule.settingType));(0,s.sV)((async()=>{await k(),await t.dispatch("commonModule/setCommonInfo",{settingType:la.normalRange})})),(0,s.wB)((()=>u.value),(async e=>{await t.dispatch("commonModule/setCommonInfo",{afterSettingFormattedString:JSON.stringify(e)}),b.value!==la.normalRange&&await t.dispatch("commonModule/setCommonInfo",{settingType:la.normalRange})}),{deep:!0}),(0,s.wB)((()=>y.value),(()=>{I()}));const I=()=>{p.value=!0,g.value=`${b.value} ${U.settingNotSaved}`},C=async()=>{try{let e;if("post"!==i.value){const e=await be({normalRangeItems:u.value});return e.data?(S(U.UPDATE_SUCCESSFULLY),await k()):w("update failed"),await t.dispatch("commonModule/setCommonInfo",{beforeSettingFormattedString:null}),void await t.dispatch("commonModule/setCommonInfo",{afterSettingFormattedString:null})}e=await ye({normalRangeItems:u.value}),e&&(S(U.settingSaveSuccess),i.value="put",await k(),await t.dispatch("commonModule/setCommonInfo",{beforeSettingFormattedString:null}),await t.dispatch("commonModule/setCommonInfo",{afterSettingFormattedString:null}))}catch(e){console.error(e)}},h=(e,t,a)=>{const l=e.target,s=l.value.replace(/[^0-9]/g,"");t[a]=s.trim()},k=async()=>{try{const e=await Ie();e&&(!e?.data||e?.data instanceof Array&&0===e?.data.length?(i.value="post",u.value=jt):(i.value="put",u.value=e.data),await t.dispatch("commonModule/setCommonInfo",{beforeSettingFormattedString:JSON.stringify(u.value)}),await t.dispatch("commonModule/setCommonInfo",{afterSettingFormattedString:JSON.stringify(u.value)}))}catch(e){console.error(e)}},S=e=>{d.value=!0,m.value="success",v.value=e},w=e=>{d.value=!0,m.value="error",v.value=e},N=()=>{d.value=!1},R=async()=>{await t.dispatch("commonModule/setCommonInfo",{beforeSettingFormattedString:null}),await t.dispatch("commonModule/setCommonInfo",{afterSettingFormattedString:null}),p.value=!1,await a.push(f.value)},L=async()=>{await C(),p.value=!1};return(e,t)=>((0,s.uX)(),(0,s.CE)(s.FK,null,[(0,s.Lk)("div",nr,[(0,s.Lk)("ul",ir,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(u.value,(e=>((0,s.uX)(),(0,s.CE)("li",{key:e.id,class:"flex-justify-start-align-center normalItems-wrapper"},[(0,s.Lk)("span",null,(0,n.v_)(e.abbreviation),1),(0,s.Lk)("span",rr,(0,n.v_)(e?.fullNm),1),(0,s.Lk)("div",cr,[(0,s.bo)((0,s.Lk)("input",{"onUpdate:modelValue":t=>e.min=t,class:"w50",type:"number",maxlength:"25",placeholder:"class name",onInput:t=>h(t,e,"min")},null,40,ur),[[l.Jo,e.min]]),t[0]||(t[0]=(0,s.Lk)("span",null,"-",-1)),(0,s.bo)((0,s.Lk)("input",{class:"w50",onInput:t=>h(t,e,"max"),"onUpdate:modelValue":t=>e.max=t,type:"number",maxlength:"25",placeholder:"class name"},null,40,dr),[[l.Jo,e.max]]),(0,s.Lk)("span",null,(0,n.v_)(e.unit),1)])])))),128))]),(0,s.Lk)("button",{onClick:C,class:"saveBtn",type:"button"},"Save")]),p.value?((0,s.uX)(),(0,s.Wv)(ra,{key:0,"is-visible":p.value,type:"setting",message:g.value,onHide:R,onOkConfirm:L},null,8,["is-visible","message"])):(0,s.Q3)("",!0),d.value?((0,s.uX)(),(0,s.Wv)(Pt,{key:1,"is-visible":d.value,type:m.value,message:v.value,onHide:N,"onUpdate:hideAlert":N},null,8,["is-visible","type","message"])):(0,s.Q3)("",!0)],64))}});const vr=mr;var pr=vr;const gr={class:"wbcClassScroll"},fr=["onDragstart","onDrop"],yr={class:"nth1ChildOrder"};var br=(0,s.pM)({__name:"classOrder",setup(e){const t=(0,c.Pj)(),a=(0,r.rd)(),i=(0,o.KR)([]),u=(0,o.KR)(-1),d=(0,o.KR)(0),m=(0,o.KR)(""),v=(0,o.KR)(!1),p=(0,o.KR)(""),g=(0,o.KR)(""),f=(0,o.KR)(!1),y=(0,o.KR)(""),b=(0,s.EW)((()=>t.state.commonModule.enteringRouterPath)),I=(0,s.EW)((()=>t.state.commonModule.settingChangedChecker)),C=(0,s.EW)((()=>t.state.commonModule.settingType)),h=(0,o.KR)([]);(0,s.sV)((async()=>{i.value="bm"===window.PROJECT_TYPE?el:Za,await t.dispatch("commonModule/setCommonInfo",{settingType:la.classOrder}),await w(),await S()})),(0,s.wB)((()=>i.value),(async e=>{await t.dispatch("commonModule/setCommonInfo",{afterSettingFormattedString:JSON.stringify(e)}),C.value!==la.classOrder&&await t.dispatch("commonModule/setCommonInfo",{settingType:la.classOrder})}),{deep:!0}),(0,s.wB)((()=>I.value),(()=>{k()}));const k=()=>{f.value=!0,y.value=`${C.value} ${U.settingNotSaved}`},S=async()=>{try{const e=await ue();if(e?.data){h.value=e.data.filter((e=>e.abbreviation&&e.fullNm));const t=new Set(h.value.map((e=>String(e.customNum)))),a=new Set(sa.map((e=>String(e.customNum))));i.value=i.value.filter((e=>!(a.has(String(e.classId))&&!t.has(String(e.classId)))));const l=new Set(i.value.map((e=>e.classId)));let s=Math.max(...i.value.map((e=>e.orderIdx)),0);for(const e of h.value)l.has(String(e.customNum))?i.value=i.value.map((t=>String(t.classId)===String(e.customNum)?{...t,fullNm:e.fullNm,abbreviation:e.abbreviation}:t)):i.value.push({abbreviation:e.abbreviation,classId:e.customNum,fullNm:e.fullNm,orderIdx:++s})}i.value=i.value.sort(((e,t)=>Number(e.orderIdx)-Number(t.orderIdx))),await t.dispatch("commonModule/setCommonInfo",{beforeSettingFormattedString:JSON.stringify(i.value)}),await t.dispatch("commonModule/setCommonInfo",{afterSettingFormattedString:JSON.stringify(i.value)})}catch(e){console.error("Error fetching WBC custom classes:",e)}},w=async()=>{try{const e=await He();e&&(0===e?.data.length?m.value="post":(m.value="put",i.value=e.data.sort(((e,t)=>Number(e.orderIdx)-Number(t.orderIdx)))))}catch(e){console.error(e)}},N=async()=>{let e=i.value;for(const t in e)e[t].orderIdx=t;try{let a={};if(a="post"===m.value?await We(e):await Ge(e),a){const e="post"===m.value?U.settingSaveSuccess:U.UPDATE_SUCCESSFULLY;E(e)}await t.dispatch("commonModule/setCommonInfo",{beforeSettingFormattedString:null}),await t.dispatch("commonModule/setCommonInfo",{afterSettingFormattedString:null})}catch(a){console.error(a)}},R=(e,t)=>{u.value=e,d.value=t.clientY-t.target.getBoundingClientRect().top},L=(e,t)=>{if(t.preventDefault(),-1!==u.value){const t=i.value.splice(u.value,1)[0];i.value.splice(e,0,t),u.value=-1}},E=e=>{v.value=!0,p.value="success",g.value=e},_=()=>{v.value=!1},P=async()=>{await t.dispatch("commonModule/setCommonInfo",{beforeSettingFormattedString:null}),await t.dispatch("commonModule/setCommonInfo",{afterSettingFormattedString:null}),f.value=!1,await a.push(b.value)},T=async()=>{await N(),f.value=!1,await t.dispatch("commonModule/setCommonInfo",{beforeSettingFormattedString:null}),await t.dispatch("commonModule/setCommonInfo",{afterSettingFormattedString:null})};return(e,t)=>((0,s.uX)(),(0,s.CE)(s.FK,null,[(0,s.Lk)("div",gr,[t[1]||(t[1]=(0,s.Lk)("h1",{class:"classTitle"},"Class",-1)),((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(i.value,((e,a)=>((0,s.uX)(),(0,s.CE)("div",{key:e.id,class:"wbcClassDbDiv",draggable:"true",onDragstart:e=>R(a,e),onDragover:t[0]||(t[0]=(0,l.D$)((()=>{}),["prevent"])),onDrop:e=>L(a,e)},[(0,s.Lk)("ul",yr,[(0,s.Lk)("li",null,(0,n.v_)(e?.fullNm),1)])],40,fr)))),128))]),(0,s.Lk)("button",{onClick:N,class:"saveBtn",type:"button"},"Save"),f.value?((0,s.uX)(),(0,s.Wv)(ra,{key:0,"is-visible":f.value,type:"setting",message:y.value,onHide:P,onOkConfirm:T},null,8,["is-visible","message"])):(0,s.Q3)("",!0),v.value?((0,s.uX)(),(0,s.Wv)(Pt,{key:1,"is-visible":v.value,type:p.value,message:g.value,onHide:_,"onUpdate:hideAlert":_},null,8,["is-visible","type","message"])):(0,s.Q3)("",!0)],64))}});const Ir=br;var Cr=Ir;const hr={class:"alignDiv"},kr={class:"defaultTable",style:{margin:"auto",width:"300px"}},Sr=["onUpdate:modelValue"],wr=["onUpdate:modelValue"],Nr=["onUpdate:modelValue"],Rr=["value"],Lr={class:"mt10"};var Er=(0,s.pM)({__name:"wbcRunningCount",setup(e){const t=(0,c.Pj)(),a=(0,r.rd)(),i=(0,o.KR)(""),u=(0,o.KR)([]),d=(0,o.KR)(!1),m=(0,o.KR)(""),v=(0,o.KR)(""),p=(0,o.KR)(!1),g=(0,o.KR)(""),f=(0,s.EW)((()=>t.state.commonModule.enteringRouterPath)),y=(0,s.EW)((()=>t.state.commonModule.settingChangedChecker)),b=(0,s.EW)((()=>t.state.commonModule.settingType));(0,s.sV)((async()=>{await C(),await t.dispatch("commonModule/setCommonInfo",{settingType:la.wbcRunningCount})})),(0,s.wB)((()=>u.value),(async e=>{await t.dispatch("commonModule/setCommonInfo",{afterSettingFormattedString:JSON.stringify(e)}),b.value!==la.wbcRunningCount&&await t.dispatch("commonModule/setCommonInfo",{settingType:la.wbcRunningCount})}),{deep:!0}),(0,s.wB)((()=>y.value),(()=>{I()}));const I=()=>{p.value=!0,g.value=`${b.value} ${U.settingNotSaved}`},C=async()=>{try{const e=await Ke();if(e&&e.data){const a=e.data;!a||a instanceof Array&&0===a.length?(i.value="post",u.value=ea):(i.value="put",u.value=a),await t.dispatch("commonModule/setCommonInfo",{beforeSettingFormattedString:JSON.stringify(u.value)}),await t.dispatch("commonModule/setCommonInfo",{afterSettingFormattedString:JSON.stringify(u.value)})}}catch(e){console.error(e)}},h=async()=>{try{let e;if("post"!==i.value){const e=await Oe({wbcRunCountItems:u.value});return e.data?(k(U.UPDATE_SUCCESSFULLY),await C()):S(U.settingUpdateFailure),await t.dispatch("commonModule/setCommonInfo",{beforeSettingFormattedString:null}),void await t.dispatch("commonModule/setCommonInfo",{afterSettingFormattedString:null})}e=await xe({wbcRunCountItems:u.value}),e&&(k(U.settingSaveSuccess),i.value="put",await C(),await t.dispatch("commonModule/setCommonInfo",{beforeSettingFormattedString:null}),await t.dispatch("commonModule/setCommonInfo",{afterSettingFormattedString:null}))}catch(e){console.error(e)}},k=e=>{d.value=!0,m.value="success",v.value=e},S=e=>{d.value=!0,m.value="error",v.value=e},w=()=>{d.value=!1},N=async()=>{await t.dispatch("commonModule/setCommonInfo",{beforeSettingFormattedString:null}),await t.dispatch("commonModule/setCommonInfo",{afterSettingFormattedString:null}),p.value=!1,await a.push(f.value)},R=async()=>{await h(),p.value=!1};return(e,t)=>((0,s.uX)(),(0,s.CE)(s.FK,null,[(0,s.Lk)("div",hr,[(0,s.Lk)("table",kr,[t[1]||(t[1]=(0,s.Lk)("colgroup",null,[(0,s.Lk)("col",{width:"35%"}),(0,s.Lk)("col",{width:"35%"}),(0,s.Lk)("col",{width:"30%"})],-1)),t[2]||(t[2]=(0,s.Lk)("thead",null,[(0,s.Lk)("tr",null,[(0,s.Lk)("th",null,"WBC min"),(0,s.Lk)("th",null,"WBC max"),(0,s.Lk)("th",null,"count")])],-1)),(0,s.Lk)("tbody",null,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(u.value,(e=>((0,s.uX)(),(0,s.CE)("tr",{key:e.id},[(0,s.Lk)("td",null,[(0,s.bo)((0,s.Lk)("input",{type:"number","onUpdate:modelValue":t=>e.min=t,class:"form-control form-control-sm"},null,8,Sr),[[l.Jo,e.min]])]),(0,s.Lk)("td",null,[(0,s.bo)((0,s.Lk)("input",{type:"number","onUpdate:modelValue":t=>e.max=t,class:"form-control form-control-sm"},null,8,wr),[[l.Jo,e.max]])]),(0,s.Lk)("td",null,[(0,s.bo)((0,s.Lk)("select",{"onUpdate:modelValue":t=>e.wbcTargetCount=t,class:"form-select form-select-sm"},[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)((0,o.R1)(xt),(e=>((0,s.uX)(),(0,s.CE)("option",{key:e.value,value:+e.value},(0,n.v_)(e.text),9,Rr)))),128))],8,Nr),[[l.u1,e.wbcTargetCount]])])])))),128))])])]),(0,s.Lk)("div",Lr,[(0,s.Lk)("button",{class:"saveBtn",type:"button",onClick:t[0]||(t[0]=e=>h())},"Save")]),p.value?((0,s.uX)(),(0,s.Wv)(ra,{key:0,"is-visible":p.value,type:"setting",message:g.value,onHide:N,onOkConfirm:R},null,8,["is-visible","message"])):(0,s.Q3)("",!0),d.value?((0,s.uX)(),(0,s.Wv)(Pt,{key:1,"is-visible":d.value,type:m.value,message:v.value,onHide:w,"onUpdate:hideAlert":w},null,8,["is-visible","type","message"])):(0,s.Q3)("",!0)],64))}});const _r=Er;var Pr=_r;const Tr={namespaced:!0,state:()=>({id:0,userId:"",password:"",name:"",employeeNo:"",userType:"",subscriptionDate:"",latestDate:""}),mutations:{setUserMutation(e,t){Object.assign(e,t)}},actions:{setUserAction({commit:e},t){e("setUserMutation",t)}}},Ar={namespaced:!0,state:()=>({analysisType:"",wbcDiffVal:"100",stitchCount:""}),mutations:{analysisTypeSet(e,t){e.analysisType=t},wbcDiffValSet(e,t){e.analysisType=t},stitchCountSet(e,t){e.analysisType=t}},actions:{setAnalysisType({commit:e},t){e("analysisTypeSet",t)},setWbcDiffValSet({commit:e},t){e("wbcDiffValSet",t)},setStitchCountSet({commit:e},t){e("stitchCountSet",t)}}},Mr={namespaced:!0,state:()=>({equipmentStatusCode:"",wbcCount:"",slideTime:"",time:"",slotInfo:{input:[],output:[]}}),mutations:{setEquipmentStatusCode(e,t){e.equipmentStatusCode=t},setWbcCount(e,t){e.wbcCount=t},setSlideTime(e,t){e.slideTime=t},setTime(e,t){e.time=t},setSlotInfo(e,t){e.slotInfo=t}},actions:{setWorkingViewInfo({commit:e},t){e("setEquipmentStatusCode",t.equipmentStatusCode),e("setWbcCount",t.wbcCount),e("setSlideTime",t.slideTime),e("setTime",t.time),e("setSlotInfo",t.slotInfo)}}},Dr={namespaced:!0,state:()=>({embeddedStatusJobCmd:"",userStop:!1,isRecoveryRun:!1,isPause:!1,sysInfo:{eqStatCd:"",iCasStat:"",oCasStat:"",jobCmd:"",isDoorOpen:"",oilCount:"",storageSize:"",currentCardCount:"",currentCardName:"",autoStartTimer:0,autoStart:!1},isInit:""}),mutations:{setEmbeddedStatusJobCmd(e,t){e.embeddedStatusJobCmd=t},setUserStop(e,t){e.userStop=t},setIsRecoveryRun(e,t){e.isRecoveryRun=t},setIsPause(e,t){e.isPause=t},setSysInfo(e,t){e.sysInfo=t},setIsInit(e,t){e.isInit=t}},actions:{setEmbeddedStatusInfo({commit:e},t){Object.keys(t).forEach((a=>{"embeddedStatusJobCmd"===a?e("setEmbeddedStatusJobCmd",t[a]):"userStop"===a?e("setUserStop",t[a]):"isRecoveryRun"===a?e("setIsRecoveryRun",t[a]):"isPause"===a?e("setIsPause",t[a]):"sysInfo"===a?e("setSysInfo",t[a]):"isInit"===a&&e("setIsInit",t[a])}))}}},xr={namespaced:!0,state:()=>({slotInfo:[]}),mutations:{setSlotInfo(e,t){e.slotInfo=t}},actions:{setSlotInfo({commit:e},t){e("setSlotInfo",t)}}},Or={namespaced:!0,state:()=>({runningInfo:null,changeSlideState:null,slideBooleanState:null}),mutations:{setRunningInfo(e,t){t&&(e.runningInfo=t)},setChangeSlide(e,t){e.changeSlideState?e.changeSlideState.changeSlide=t:e.changeSlideState={changeSlide:t}},setSlideBoolean(e,t){e.slideBooleanState?e.slideBooleanState.slideIs=t:e.slideBooleanState={slideIs:t}}},actions:{setRunningInfo({commit:e},t){e("setRunningInfo",t)},updateRunningInfo({commit:e},t){t&&t.key&&void 0!==t.value&&e(`set${t.key.charAt(0).toUpperCase()+t.key.slice(1)}`,t.value)},setChangeSlide({commit:e},t){e("setChangeSlide",t)},setSlideBoolean({commit:e},t){e("setSlideBoolean",t)}}},Kr={namespaced:!0,state:()=>({startEmbedded:!1,eqStatCd:0,isRunningState:!1,totalCount:"",embeddedNumber:"",isCompleteAlarm:!1,isErrorAlarm:!1,bfSelectFiles:[],slideProceeding:"",totalSlideTime:"00:00:00",iaRootPath:"",runningSlotId:"",isRequestInProgress:!1,startInfoBoolen:!1,runningInfoBoolen:!1,runningInfoStop:!1,reqArr:[],resFlag:!0,firstLoading:!1,slotIndex:0,viewerCheck:"",runningArr:[],classArr:[{},{},{},{},{},{},{},{},{},{},{},{}],rbcArr:[{},{},{},{},{},{},{},{},{},{},{},{}],processInfo:[{},{},{},{},{},{},{},{},{},{},{},{}],orderList:[{},{},{},{},{},{},{},{},{},{},{},{}],loginSetData:"",siteCd:"",deviceSerialNm:"",clonedWbcInfo:[],clonedRbcInfo:[],moveImgIsBool:!1,classInfoSort:[],chatRunningData:[],cbcLayer:!1,inhaTestCode:"",rbcReData:!1,rbcReDataClass:!1,rbcInfoAfterData:[],resetRbcArr:!1,selectedSampleId:"",classInfoArr:[],rbcReDataCheck:!1,appAlertOpen:!1,dataBasePageReset:!1,resetAnalyzing:!1,testType:"",isNsNbIntegration:"N",analysisType:"",beforeSettingFormattedString:"",afterSettingFormattedString:"",settingChangedChecker:!1,dbListDataFirstNum:0,dbListDataLastNum:0,isTcpConnected:!1,initValData:!1,enteringRouterPath:"",settingType:"",isDownloadOrUploading:!1,isRewindingBelt:!1,rbcImagePageNumber:0,showLISUploadAfterCheckingAll:!1,slideDataReset:""}),mutations:{setStartEmbedded(e,t){e.startEmbedded=t},setEqStatCd(e,t){e.eqStatCd=t},setIsRunningState(e,t){e.isRunningState=t},setTotalCount(e,t){e.totalCount=t},setEmbeddedNumber(e,t){e.embeddedNumber=t},setIsCompleteAlarm(e,t){e.isCompleteAlarm=t},setIsErrorAlarm(e,t){e.isErrorAlarm=t},setBfSelectFiles(e,t){e.bfSelectFiles=t},setSlideProceeding(e,t){e.slideProceeding=t},setTotalSlideTime(e,t){e.totalSlideTime=t},setIaRootPath(e,t){e.iaRootPath=t},setRunningSlotId(e,t){e.runningSlotId=t},setIsRequestInProgress(e,t){e.isRequestInProgress=t},setStartInfoBoolen(e,t){e.startInfoBoolen=t},setRunningInfoBoolen(e,t){e.runningInfoBoolen=t},setRunningInfoStop(e,t){e.runningInfoStop=t},setReqArr(e,t){e.reqArr||(e.reqArr=[]),e.reqArr.push(t)},shiftReqArr(e){e.reqArr.shift()},setReqArrPaste(e,t){e.reqArr=t},setResFlag(e,t){e.resFlag=t},setFirstLoading(e,t){e.firstLoading=t},setSlotIndex(e,t){e.slotIndex=t},setViewerCheck(e,t){e.viewerCheck=t},setRunningArr(e,t){e.runningArr=t},setClassArr(e,t){e.classArr=t},setRbcArr(e,t){e.rbcArr=t},setProcessInfo(e,t){e.processInfo=t},setOrderList(e,t){e.orderList=t},setLoginSetData(e,t){e.loginSetData=t},setDeviceSerialNm(e,t){e.deviceSerialNm=t},setSiteCd(e,t){e.siteCd=t},setClonedWbcInfo(e,t){e.clonedWbcInfo=t},setClonedRbcInfo(e,t){e.clonedRbcInfo=t},setMoveImgIsBool(e,t){e.moveImgIsBool=t},setClassInfoSort(e,t){e.classInfoSort=t},setChatRunningData(e,t){e.chatRunningData=t},setSelectedSampleId(e,t){e.selectedSampleId=t},setCbcLayer(e,t){e.cbcLayer=t},setInhaTestCode(e,t){e.inhaTestCode=t},setRbcReData(e,t){e.rbcReData=t},setRbcReDataClass(e,t){e.rbcReDataClass=t},setResetRbcArr(e,t){e.resetRbcArr=t},setRbcInfoAfterData(e,t){e.rbcInfoAfterData=t},setClassInfoArr(e,t){e.classInfoArr=t},setRbcReDataCheck(e,t){e.rbcReDataCheck=t},setAppAlertOpen(e,t){e.appAlertOpen=t},setDataBasePageReset(e,t){e.dataBasePageReset=t},setResetAnalyzing(e,t){e.resetAnalyzing=t},setTestType(e,t){e.testType=t},setIsNsNbIntegration(e,t){e.isNsNbIntegration=t},setAnalysisType(e,t){e.analysisType=t},setBeforeSettingFormattedString(e,t){e.beforeSettingFormattedString=t},setAfterSettingFormattedString(e,t){e.afterSettingFormattedString=t},setSettingChangedChecker(e,t){e.settingChangedChecker=t},setDbListDataFirstNum(e,t){e.dbListDataFirstNum=t},setDbListDataLastNum(e,t){e.dbListDataLastNum=t},setIsTcpConnected(e,t){e.isTcpConnected=t},setInitValData(e,t){e.initValData=t},setEnteringRouterPath(e,t){e.enteringRouterPath=t},setSettingType(e,t){e.settingType=t},setIsDownloadOrUploading(e,t){e.isDownloadOrUploading=t},setIsRewindingBelt(e,t){e.isRewindingBelt=t},setRbcImagePageNumber(e,t){e.rbcImagePageNumber=t},setShowLISUploadAfterCheckingAll(e,t){e.showLISUploadAfterCheckingAll=t},setSlideDataReset(e,t){e.slideDataReset=t}},actions:{setCommonInfo({commit:e},t){t.hasOwnProperty("startEmbedded")&&e("setStartEmbedded",t.startEmbedded),t.hasOwnProperty("eqStatCd")&&e("setEqStatCd",t.eqStatCd),t.hasOwnProperty("isRunningState")&&e("setIsRunningState",t.isRunningState),t.hasOwnProperty("totalCount")&&e("setTotalCount",t.totalCount),t.hasOwnProperty("embeddedNumber")&&e("setEmbeddedNumber",t.embeddedNumber),t.hasOwnProperty("isCompleteAlarm")&&e("setIsCompleteAlarm",t.isCompleteAlarm),t.hasOwnProperty("isErrorAlarm")&&e("setIsErrorAlarm",t.isErrorAlarm),t.hasOwnProperty("bfSelectFiles")&&e("setBfSelectFiles",t.bfSelectFiles),t.hasOwnProperty("slideProceeding")&&e("setSlideProceeding",t.slideProceeding),t.hasOwnProperty("totalSlideTime")&&e("setTotalSlideTime",t.totalSlideTime),t.hasOwnProperty("iaRootPath")&&e("setIaRootPath",t.iaRootPath),t.hasOwnProperty("runningSlotId")&&e("setRunningSlotId",t.runningSlotId),t.hasOwnProperty("isRequestInProgress")&&e("setIsRequestInProgress",t.isRequestInProgress),t.hasOwnProperty("startInfoBoolen")&&e("setStartInfoBoolen",t.startInfoBoolen),t.hasOwnProperty("runningInfoBoolen")&&e("setRunningInfoBoolen",t.runningInfoBoolen),t.hasOwnProperty("runningInfoStop")&&e("setRunningInfoStop",t.runningInfoStop),t.hasOwnProperty("reqArr")&&e("setReqArr",t.reqArr),t.hasOwnProperty("shiftReqArr")&&e("shiftReqArr"),t.hasOwnProperty("reqArrPaste")&&e("setReqArrPaste",t.reqArr),t.hasOwnProperty("resFlag")&&e("setResFlag",t.resFlag),t.hasOwnProperty("firstLoading")&&e("setFirstLoading",t.firstLoading),t.hasOwnProperty("slotIndex")&&e("setSlotIndex",t.slotIndex),t.hasOwnProperty("viewerCheck")&&e("setViewerCheck",t.viewerCheck),t.hasOwnProperty("runningArr")&&e("setRunningArr",t.runningArr),t.hasOwnProperty("classArr")&&e("setClassArr",t.classArr),t.hasOwnProperty("rbcArr")&&e("setRbcArr",t.rbcArr),t.hasOwnProperty("processInfo")&&e("setProcessInfo",t.processInfo),t.hasOwnProperty("orderList")&&e("setOrderList",t.orderList),t.hasOwnProperty("loginSetData")&&e("setLoginSetData",t.loginSetData),t.hasOwnProperty("siteCd")&&e("setSiteCd",t.siteCd),t.hasOwnProperty("deviceSerialNm")&&e("setDeviceSerialNm",t.deviceSerialNm),t.hasOwnProperty("clonedWbcInfo")&&e("setClonedWbcInfo",t.clonedWbcInfo),t.hasOwnProperty("clonedRbcInfo")&&e("setClonedRbcInfo",t.clonedRbcInfo),t.hasOwnProperty("moveImgIsBool")&&e("setMoveImgIsBool",t.moveImgIsBool),t.hasOwnProperty("classInfoSort")&&e("setClassInfoSort",t.classInfoSort),t.hasOwnProperty("chatRunningData")&&e("setChatRunningData",t.chatRunningData),t.hasOwnProperty("selectedSampleId")&&e("setSelectedSampleId",t.selectedSampleId),t.hasOwnProperty("cbcLayer")&&e("setCbcLayer",t.cbcLayer),t.hasOwnProperty("inhaTestCode")&&e("setInhaTestCode",t.inhaTestCode),t.hasOwnProperty("rbcReData")&&e("setRbcReData",t.rbcReData),t.hasOwnProperty("rbcReDataClass")&&e("setRbcReDataClass",t.rbcReDataClass),t.hasOwnProperty("rbcInfoAfterData")&&e("setRbcInfoAfterData",t.rbcInfoAfterData),t.hasOwnProperty("resetRbcArr")&&e("setResetRbcArr",t.resetRbcArr),t.hasOwnProperty("classInfoArr")&&e("setClassInfoArr",t.classInfoArr),t.hasOwnProperty("rbcReDataCheck")&&e("setRbcReDataCheck",t.rbcReDataCheck),t.hasOwnProperty("appAlertOpen")&&e("setAppAlertOpen",t.appAlertOpen),t.hasOwnProperty("dataBasePageReset")&&e("setDataBasePageReset",t.dataBasePageReset),t.hasOwnProperty("resetAnalyzing")&&e("setResetAnalyzing",t.resetAnalyzing),t.hasOwnProperty("testType")&&e("setTestType",t.testType),t.hasOwnProperty("isNsNbIntegration")&&e("setIsNsNbIntegration",t.isNsNbIntegration),t.hasOwnProperty("analysisType")&&e("setAnalysisType",t.analysisType),t.hasOwnProperty("beforeSettingFormattedString")&&e("setBeforeSettingFormattedString",t.beforeSettingFormattedString),t.hasOwnProperty("afterSettingFormattedString")&&e("setAfterSettingFormattedString",t.afterSettingFormattedString),t.hasOwnProperty("settingChangedChecker")&&e("setSettingChangedChecker",t.settingChangedChecker),t.hasOwnProperty("dbListDataFirstNum")&&e("setDbListDataFirstNum",t.dbListDataFirstNum),t.hasOwnProperty("dbListDataLastNum")&&e("setDbListDataLastNum",t.dbListDataLastNum),t.hasOwnProperty("isTcpConnected")&&e("setIsTcpConnected",t.isTcpConnected),t.hasOwnProperty("initValData")&&e("setInitValData",t.initValData),t.hasOwnProperty("enteringRouterPath")&&e("setEnteringRouterPath",t.enteringRouterPath),t.hasOwnProperty("settingType")&&e("setSettingType",t.settingType),t.hasOwnProperty("isDownloadOrUploading")&&e("setIsDownloadOrUploading",t.isDownloadOrUploading),t.hasOwnProperty("isRewindingBelt")&&e("setIsRewindingBelt",t.isRewindingBelt),t.hasOwnProperty("rbcImagePageNumber")&&e("setRbcImagePageNumber",t.rbcImagePageNumber),t.hasOwnProperty("showLISUploadAfterCheckingAll")&&e("setShowLISUploadAfterCheckingAll",t.showLISUploadAfterCheckingAll),t.hasOwnProperty("slideDataReset")&&e("setSlideDataReset",t.slideDataReset)}}},Br={namespaced:!0,state:()=>({dataBaseSetData:null}),mutations:{setDataBaseSetData(e,t){t&&(e.dataBaseSetData={...e.dataBaseSetData,changeSlide:t.changeSlide??e.dataBaseSetData?.changeSlide,resultCode:t.resultCode??e.dataBaseSetData?.resultCode,resultMsg:t.resultMsg??e.dataBaseSetData?.resultMsg,errorLevel:t.errorLevel??e.dataBaseSetData?.errorLevel,jobCmd:t.jobCmd??e.dataBaseSetData?.jobCmd,processingCode:t.processingCode??e.dataBaseSetData?.processingCode,iCasStat:t.iCasStat??e.dataBaseSetData?.iCasStat,oCasStat:t.oCasStat??e.dataBaseSetData?.oCasStat,cassetId:t.cassetId??e.dataBaseSetData?.cassetId,isRunningState:t.isRunningState??e.dataBaseSetData?.isRunningState,slotInfo:t.slotInfo?t.slotInfo.map((t=>{const a=e.dataBaseSetData?.slotInfo?.find((e=>e?.slotId===t?.slotId));return a?{...a,...t}:t})):e.dataBaseSetData?.slotInfo??[]})}},actions:{setDataBaseSetData({commit:e},t){e("setDataBaseSetData",t)}}},Fr={namespaced:!0,state:()=>({totalSlideTime:"00:00:00",slideTime:"00:00:00"}),mutations:{setTotalSlideTime(e,t){e.totalSlideTime=t},setSlideTime(e,t){e.slideTime=t}},actions:{setTimeInfo({commit:e},t){t.hasOwnProperty("totalSlideTime")&&e("setTotalSlideTime",t.totalSlideTime),t.hasOwnProperty("slideTime")&&e("setSlideTime",t.slideTime)}}},Ur={id:void 0,lock_status:void 0,traySlot:void 0,slotNo:"",barcodeNo:"",patientId:"",patientNm:"",gender:"",birthDay:"",wbcCount:"",slotId:"",orderDttm:"",testType:"",analyzedDttm:"",tactTime:"",maxWbcCount:"",bf_lowPowerPath:[],cassetId:"",isNormal:"",wbcInfo:{},wbcInfoAfter:[],rbcInfo:{},rbcInfoAfter:[],submitState:"",submitOfDate:void 0,submitUserId:"",rbcInfoPosAfter:[],isNsNbIntegration:"",wbcMemo:"",rbcMemo:"",pcIp:"",cbcPatientNo:"",cbcPatientNm:"",cbcSex:"",cbcAge:"",img_drive_root_path:"",hosName:"",abnormalClassInfo:{}},Xr={namespaced:!0,state:()=>({id:void 0,lock_status:void 0,traySlot:void 0,slotNo:"",barcodeNo:"",patientId:"",patientNm:"",gender:"",birthDay:"",wbcCount:"",slotId:"",orderDttm:"",testType:"",analyzedDttm:"",tactTime:"",maxWbcCount:"",bf_lowPowerPath:[],cassetId:"",isNormal:"",wbcInfo:{},wbcInfoAfter:[],rbcInfo:{},rbcInfoAfter:[],submitState:"",submitOfDate:void 0,submitUserId:"",rbcInfoPosAfter:[],isNsNbIntegration:"",wbcMemo:"",rbcMemo:"",pcIp:"",cbcPatientNo:"",cbcPatientNm:"",cbcSex:"",cbcAge:"",img_drive_root_path:"",hosName:"",abnormalClassInfo:{}}),mutations:{setId(e,t){e.id=t},setLockStatus(e,t){e.lock_status=t},setTraySlot(e,t){e.traySlot=t},setSlotNo(e,t){e.slotNo=t},setBarcodeNo(e,t){e.barcodeNo=t},setPatientId(e,t){e.patientId=t},setPatientNm(e,t){e.patientNm=t},setGender(e,t){e.gender=t},setBirthDay(e,t){e.birthDay=t},setWbcCount(e,t){e.wbcCount=t},setSlotId(e,t){e.slotId=t},setOrderDttm(e,t){e.orderDttm=t},setTestType(e,t){e.testType=t},setAnalyzedDttm(e,t){e.analyzedDttm=t},setTactTime(e,t){e.tactTime=t},setMaxWbcCount(e,t){e.maxWbcCount=t},setBfLowPowerPath(e,t){e.bf_lowPowerPath=t},setCassetId(e,t){e.cassetId=t},setIsNormal(e,t){e.isNormal=t},setWbcInfo(e,t){e.wbcInfo=t},setWbcInfoAfter(e,t){e.wbcInfoAfter=t},setRbcInfo(e,t){e.rbcInfo=t},setRbcInfoAfter(e,t){e.rbcInfoAfter=t},setSubmitState(e,t){e.submitState=t},setSubmitOfDate(e,t){e.submitOfDate=t},setSubmitUserId(e,t){e.submitUserId=t},setRbcInfoPosAfter(e,t){e.rbcInfoPosAfter=t},setIsNsNbIntegration(e,t){e.isNsNbIntegration=t},setWbcMemo(e,t){e.wbcMemo=t},setRbcMemo(e,t){e.rbcMemo=t},setPcIp(e,t){e.pcIp=t},setCbcPatientNo(e,t){e.cbcPatientNo=t},setCbcPatientNm(e,t){e.cbcPatientNm=t},setCbcSex(e,t){e.cbcSex=t},setCbcAge(e,t){e.cbcAge=t},setImgDriveRootPath(e,t){e.img_drive_root_path=t},setHosName(e,t){e.hosName=t},setAbnormalClassInfo(e,t){e.abnormalClassInfo=t},resetState(e){Object.assign(e,{...Ur})}},actions:{updateSlideData({commit:e},t){e("setId",t.id),e("setLockStatus",t.lock_status),e("setTraySlot",t.traySlot),e("setSlotNo",t.slotNo),e("setBarcodeNo",t.barcodeNo),e("setPatientId",t.patientId),e("setPatientNm",t.patientNm),e("setGender",t.gender),e("setBirthDay",t.birthDay),e("setWbcCount",t.wbcCount),e("setSlotId",t.slotId),e("setOrderDttm",t.orderDttm),e("setTestType",t.testType),e("setAnalyzedDttm",t.analyzedDttm),e("setTactTime",t.tactTime),e("setMaxWbcCount",t.maxWbcCount),e("setBfLowPowerPath",t.bf_lowPowerPath),e("setCassetId",t.cassetId),e("setIsNormal",t.isNormal),e("setWbcInfo",t.wbcInfo),e("setWbcInfoAfter",t.wbcInfoAfter),e("setRbcInfo",t.rbcInfo),e("setRbcInfoAfter",t.rbcInfoAfter),e("setSubmitState",t.submitState),e("setSubmitOfDate",t.submitOfDate),e("setSubmitUserId",t.submitUserId),e("setRbcInfoPosAfter",t.rbcInfoPosAfter),e("setIsNsNbIntegration",t.isNsNbIntegration),e("setWbcMemo",t.wbcMemo),e("setRbcMemo",t.rbcMemo),e("setPcIp",t.pcIp),e("setCbcPatientNo",t.cbcPatientNo),e("setCbcPatientNm",t.cbcPatientNm),e("setCbcSex",t.cbcSex),e("setCbcAge",t.cbcAge),e("setImgDriveRootPath",t.img_drive_root_path),e("setHosName",t.hosName),e("setAbnormalClassInfo",t.abnormalClassInfo)},resetSlideData({commit:e}){e("resetState")}}};var $r=Xr;const Wr=(0,c.y$)({modules:{userModule:Tr,executeModule:Ar,workingViewModule:Mr,embeddedStatusModule:Dr,orderListModule:xr,runningInfoModule:Or,commonModule:Kr,dataBaseSetDataModule:Br,timeModule:Fr,slideDataModule:$r}});var Hr=Wr;const Gr=async(e,t)=>{if(e&&t){switch(e){case la.cellImageAnalyzed:const e=t,l=e.id;e?.id&&delete e.id;try{const t=await se(e,l);if(t){const e=t?.data;await Hr.dispatch("commonModule/setCommonInfo",{isNsNbIntegration:e?.isNsNbIntegration?"Y":"N"}),await Hr.dispatch("dataBaseSetDataModule/setDataBaseSetData",{isNsNbIntegration:e?.isNsNbIntegration?"Y":"N"}),sessionStorage.setItem("isNsNbIntegration",e.isNsNbIntegration?"Y":"N"),sessionStorage.setItem("wbcPositionMargin",e?.diffWbcPositionMargin),sessionStorage.setItem("rbcPositionMargin",e?.diffRbcPositionMargin),sessionStorage.setItem("pltPositionMargin",e?.diffPltPositionMargin),sessionStorage.setItem("edgeShotType",String(e?.edgeShotType)),sessionStorage.setItem("edgeShotLPCount",String(e?.edgeShotLPCount)),sessionStorage.setItem("edgeShotHPCount",String(e?.edgeShotHPCount)),sessionStorage.setItem("iaRootPath",e?.iaRootPath),sessionStorage.setItem("keepPage",String(e?.keepPage));const a="pb"===window.PROJECT_TYPE?"keepPage":"bmKeepPage";sessionStorage.setItem(a,String(e?.keepPage)),await Hr.dispatch("commonModule/setCommonInfo",{showLISUploadAfterCheckingAll:e?.lisUploadCheckAll}),await Hr.dispatch("commonModule/setCommonInfo",{resetAnalyzing:!0})}}catch(a){console.error(a)}break;case la.rbcDegree:try{const e=[];t.forEach((t=>{t.classInfo.forEach((a=>{e.push({categoryId:t.categoryId,categoryNm:t.categoryNm,classId:a.classId,classNm:a.classNm,degree1:a.degree1,degree2:a.degree2,degree3:a.degree3})}))})),await ne(e)}catch(a){console.error(a)}break;case la.wbcRunningCount:try{await Oe({wbcRunCountItems:t})}catch(a){console.error(a)}break;case la.wbcCustomClass:try{await ce({classArr:t})}catch(a){console.error(a)}break;case la.wbcHotKeys:try{await me({wbcHotKeysItems:t})}catch(a){console.error(a)}break;case la.bfHotKeys:try{await ge({bfHotKeysItems:t})}catch(a){console.error(a)}break;case la.normalRange:try{await be({normalRangeItems:t})}catch(a){console.error(a)}break;case la.classOrder:for(const a in t)t[a].orderIdx=a;try{await Ge(t)}catch(a){console.error(a)}break;case la.imagePrint:try{await he({imagePrintItems:t})}catch(a){console.error(a)}break;case la.lisCode:await we({lisCodeItems:t.lisCodeWbcArr}),await Le({lisCodeItems:t.lisCodeRbcArr}),await Fe({minCountItems:t.minCountArr});break;case la.cbcCode:try{await Pe({cbcCodeItems:t})}catch(a){console.error(a)}break;case la.filePathSet:try{await Me({filePathSetItems:t})}catch(a){console.error(a)}break;default:break}await Hr.dispatch("commonModule/setCommonInfo",{beforeSettingFormattedString:null}),await Hr.dispatch("commonModule/setCommonInfo",{afterSettingFormattedString:null})}},Yr={class:"settingTabSubButtons"},Vr={class:"tab-content"};var jr=(0,s.pM)({__name:"index",setup(e){const t=(0,c.Pj)(),a=(0,o.KR)("cellImageAnalyzed"),l=(0,o.KR)(""),i=(0,o.KR)(!1),r=(0,o.KR)(""),u=(0,o.KR)(""),d=(0,o.KR)(!1),m=(0,o.KR)(""),v=(0,o.KR)(""),p=(0,s.EW)((()=>t.state.commonModule.viewerCheck)),g=(0,s.EW)((()=>t.state.commonModule.settingType)),f=(0,s.EW)((()=>t.state.commonModule.beforeSettingFormattedString)),y=(0,s.EW)((()=>t.state.commonModule.afterSettingFormattedString));(0,s.sV)((async()=>{l.value="bm"===window.PROJECT_TYPE?"bm":"pb"}));const b=e=>{a.value!==e&&(v.value=e,f.value!==y.value?(d.value=!0,m.value=`${g.value} ${U.settingNotSaved}`):a.value=v.value)},I=async e=>{i.value=!0,r.value="success",u.value=e},C=async e=>{i.value=!0,r.value="error",u.value=e},h=()=>{i.value=!1},k=(0,s.EW)((()=>{switch(a.value){case"cellImageAnalyzed":return wi;case"rbcDegree":return Ki;case"deviceControls":return Wi;case"wbcCustomClass":return Qi;case"wbcHotKeys":return er;case"bfHotKeys":return or;case"normalRange":return pr;case"wbcOrder":return Cr;case"wbcRunningCount":return Pr;default:return null}})),S=async()=>{await t.dispatch("commonModule/setCommonInfo",{beforeSettingFormattedString:null}),await t.dispatch("commonModule/setCommonInfo",{afterSettingFormattedString:null}),a.value=v.value,d.value=!1},w=async()=>{d.value=!1;try{await Gr(g.value,JSON.parse(y.value)),await I(U.settingSaveSuccess)}catch(e){await C(U.settingSaveFailure)}};return(e,t)=>((0,s.uX)(),(0,s.CE)(s.FK,null,[(0,s.Lk)("div",null,[(0,s.Lk)("div",Yr,[(0,s.Lk)("button",{onClick:t[0]||(t[0]=e=>b("cellImageAnalyzed")),class:(0,n.C4)({active:"cellImageAnalyzed"===a.value})},"Cell Image Analyzed",2),"viewer"!==p.value?((0,s.uX)(),(0,s.CE)(s.FK,{key:0},["pb"===l.value?((0,s.uX)(),(0,s.CE)("button",{key:0,onClick:t[1]||(t[1]=e=>b("rbcDegree")),class:(0,n.C4)({active:"rbcDegree"===a.value})},"RBC Degree",2)):(0,s.Q3)("",!0),(0,s.Lk)("button",{onClick:t[2]||(t[2]=e=>b("deviceControls")),class:(0,n.C4)({active:"deviceControls"===a.value})},"Device Controls",2),(0,s.Lk)("button",{onClick:t[3]||(t[3]=e=>b("wbcRunningCount")),class:(0,n.C4)({active:"wbcRunningCount"===a.value})},"WBC Running Count",2),(0,s.Lk)("button",{onClick:t[4]||(t[4]=e=>b("wbcCustomClass")),class:(0,n.C4)({active:"wbcCustomClass"===a.value})},(0,n.v_)("pb"===l.value?"WBC":"BM")+" Custom Class ",3),(0,s.Lk)("button",{onClick:t[5]||(t[5]=e=>b("wbcHotKeys")),class:(0,n.C4)({active:"wbcHotKeys"===a.value})},(0,n.v_)("pb"===l.value?"WBC":"BM")+" Hot Keys ",3),"pb"===l.value?((0,s.uX)(),(0,s.CE)("button",{key:1,onClick:t[6]||(t[6]=e=>b("bfHotKeys")),class:(0,n.C4)({active:"bfHotKeys"===a.value})},"BF Hot Keys",2)):(0,s.Q3)("",!0),(0,s.Lk)("button",{onClick:t[7]||(t[7]=e=>b("normalRange")),class:(0,n.C4)({active:"normalRange"===a.value})},"Normal Range",2),(0,s.Lk)("button",{onClick:t[8]||(t[8]=e=>b("wbcOrder")),class:(0,n.C4)({active:"wbcOrder"===a.value})},(0,n.v_)("pb"===l.value?"WBC":"BM")+" Order ",3)],64)):(0,s.Q3)("",!0)]),(0,s.Lk)("div",Vr,[((0,s.uX)(),(0,s.Wv)((0,s.$y)(k.value)))])]),d.value?((0,s.uX)(),(0,s.Wv)(ra,{key:0,"is-visible":d.value,type:"setting",message:m.value,onHide:S,onOkConfirm:w},null,8,["is-visible","message"])):(0,s.Q3)("",!0),i.value?((0,s.uX)(),(0,s.Wv)(Pt,{key:1,"is-visible":i.value,type:r.value,message:u.value,onHide:h,"onUpdate:hideAlert":h},null,8,["is-visible","type","message"])):(0,s.Q3)("",!0)],64))}});const Qr=jr;var qr=Qr;const Jr={class:"layer"},zr={class:"layer-header"},Zr={class:"layer-body"};var ec={__name:"modal",props:["width"],emits:["update:closeLayer"],setup(e,{emit:t}){const a=(0,o.KR)(!1),l=e,i=t,r=()=>{a.value=!1,i("update:closeLayer",!1)};return(0,s.sV)((()=>{console.log(l.width),i("afterOpen")})),(t,a)=>((0,s.uX)(),(0,s.CE)("div",Jr,[(0,s.Lk)("div",{class:"layer-content oil",style:(0,n.Tr)(e.width?`width: ${e.width}px; max-width: none;`:"")},[(0,s.Lk)("div",zr,[(0,s.RG)(t.$slots,"header"),(0,s.Lk)("button",{onClick:r,class:"alertCloseButton"},"Close")]),(0,s.Lk)("div",Zr,[(0,s.RG)(t.$slots,"content")])],4)]))}};const tc=ec;var ac=tc;const lc=e=>"UIMD"===e.toUpperCase()||"uimd"===e.toLowerCase(),sc=e=>"admin"===e,oc=e=>null===e||void 0===e||0===Object.keys(e).length,nc={class:"settingContainer"},ic={class:"searchUserContainer"},rc=["value"],cc={class:"table defaultTable mt20"},uc=["onClick"],dc=["onClick"],mc={class:"editModalContainer"},vc={class:"userInputWrapper"},pc=["disabled"],gc=["value"],fc={class:"userInputWrapper"},yc={class:"userInputWrapper"},bc={class:"userInputWrapper"},Ic={class:"userInputWrapper"},Cc={class:"userInputWrapper"};var hc=(0,s.pM)({__name:"index",setup(e){const t=(0,c.Pj)(),a=(0,s.EW)((()=>t.state.userModule)),i=a.value,r=(0,o.KR)(""),u=(0,o.KR)([]),d=e=>e.replace("T"," ").replace(".000Z",""),m=(0,o.KR)("userId"),v=(0,o.KR)([{value:"userId",text:"User Id"},{value:"name",text:"User Name"}]),p=(0,o.KR)([{value:"normal",text:"normal"},{value:"admin",text:"admin"}]),g=(0,o.KR)(""),f=(0,o.KR)(!1),y=(0,o.KR)({}),b=(0,o.KR)(""),I=(0,s.EW)((()=>d(y.value.subscriptionDate))),C=(0,s.EW)((()=>d(y.value.latestDate))),h=(0,o.KR)(!1),k=(0,o.KR)(""),S=(0,o.KR)("");(0,s.sV)((async()=>{r.value=i.userId,await L()}));const w=(e,t,a)=>{const l=t.toLowerCase();return e.filter((e=>{const t="userId"===a?String(e.userId):e.name;return t.toLowerCase().includes(l)}))},N=async()=>{try{const e=await no(String(r.value));if(e&&e.data){const t=e.data.users||[],a=w(t,g.value,m.value);u.value=a}}catch(e){console.error("An error occurred:",e)}},R=async()=>{try{await ro(y.value,b.value),await L(),f.value=!1;const e=u.value.find((e=>e.userId===r.value));await t.dispatch("userModule/setUserAction",{id:e.id,userId:e.userId,employeeNo:e.employeeNo,latestDate:e.latestDate,password:e.password,subscriptionDate:e.subscriptionDate,userType:e.userType,name:e.name}),sessionStorage.setItem("user",JSON.stringify(u.value.find((e=>e.userId===r.value)))),localStorage.setItem("user",JSON.stringify(u.value.find((e=>e.userId===r.value))))}catch(e){console.error(e)}},L=async()=>{try{const e=await no(String(r.value));e&&e?.data&&(u.value=e.data.users||[])}catch(e){console.error(e)}},E=async e=>{b.value=e;try{const t=await io(e);y.value=t.data.user}catch(t){console.error(t)}},_=async e=>{await E(e),""!==e&&(f.value=!0)},P=()=>{},T=e=>{f.value=e,y.value={},b.value=""},A=()=>{h.value=!1},M=async()=>{h.value=!1;try{await co({userId:b.value}),await L(),b.value===r.value&&(Pw.push("/user/login"),localStorage.removeItem("user"),sessionStorage.removeItem("user"))}catch(e){console.error(e)}},D=e=>{h.value=!0,b.value=e,S.value=`Do you wish to proceed with deleting user ID ${e}?`};return(e,t)=>{const a=(0,s.g2)("font-awesome-icon");return(0,s.uX)(),(0,s.CE)(s.FK,null,[(0,s.Lk)("div",nc,[(0,s.Lk)("div",ic,[(0,s.bo)((0,s.Lk)("select",{"onUpdate:modelValue":t[0]||(t[0]=e=>m.value=e),class:"searchSelect"},[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(v.value,(e=>((0,s.uX)(),(0,s.CE)("option",{key:e.value,value:e.value},(0,n.v_)(e.text),9,rc)))),128))],512),[[l.u1,m.value]]),(0,s.bo)((0,s.Lk)("input",{type:"text","onUpdate:modelValue":t[1]||(t[1]=e=>g.value=e),class:"searchInputBox"},null,512),[[l.Jo,g.value]]),(0,s.bF)(a,{icon:["fas","search"],class:"searchBtn",onClick:N})]),(0,s.Lk)("table",cc,[(0,s.Lk)("thead",null,[(0,s.Lk)("tr",null,[t[10]||(t[10]=(0,s.Lk)("th",null,"No.",-1)),t[11]||(t[11]=(0,s.Lk)("th",null,"User Type",-1)),t[12]||(t[12]=(0,s.Lk)("th",null,"User ID",-1)),t[13]||(t[13]=(0,s.Lk)("th",null,"Name",-1)),t[14]||(t[14]=(0,s.Lk)("th",null,"Employee",-1)),t[15]||(t[15]=(0,s.Lk)("th",null,"Subscription Date",-1)),t[16]||(t[16]=(0,s.Lk)("th",null,"Latest Date",-1)),(0,o.R1)(i).userType.includes("admin")?((0,s.uX)(),(0,s.CE)(s.FK,{key:0},[t[8]||(t[8]=(0,s.Lk)("th",null,"Edit",-1)),t[9]||(t[9]=(0,s.Lk)("th",null,"Delete",-1))],64)):(0,s.Q3)("",!0)])]),(0,s.Lk)("tbody",null,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(u.value,(e=>((0,s.uX)(),(0,s.CE)("tr",{key:e.id},[(0,s.Lk)("td",null,(0,n.v_)(e.id),1),(0,s.Lk)("td",null,(0,n.v_)(e.userType),1),(0,s.Lk)("td",null,(0,n.v_)(e.userId),1),(0,s.Lk)("td",null,(0,n.v_)(e.name),1),(0,s.Lk)("td",null,(0,n.v_)(e.employeeNo),1),(0,s.Lk)("td",null,(0,n.v_)(d(e.subscriptionDate)),1),(0,s.Lk)("td",null,(0,n.v_)(d(e.latestDate)),1),(0,o.R1)(i).userType.includes("admin")?((0,s.uX)(),(0,s.CE)(s.FK,{key:0},[(0,s.Lk)("td",{class:"cursorPointer hoverSizeAction",onClick:t=>_(e.userId)},[(0,s.bF)(a,{icon:["fas","pen-to-square"]})],8,uc),(0,s.Lk)("td",{class:"cursorPointer hoverSizeAction",onClick:t=>D(e.userId)},[(0,s.bF)(a,{icon:["fas","trash"]})],8,dc)],64)):(0,s.Q3)("",!0)])))),128))])])]),f.value?((0,s.uX)(),(0,s.Wv)(ac,{key:0,"onUpdate:closeLayer":T,onAfterOpen:P},{header:(0,s.k6)((()=>t[17]||(t[17]=[(0,s.Lk)("h2",null,"Edit Account",-1)]))),content:(0,s.k6)((()=>[(0,s.Lk)("div",mc,[(0,s.Lk)("div",vc,[t[18]||(t[18]=(0,s.Lk)("label",{class:"userLabel",for:"userType",style:{"line-height":"0"}},"User Type",-1)),(0,s.bo)((0,s.Lk)("select",{id:"userType","onUpdate:modelValue":t[2]||(t[2]=e=>y.value.userType=e),class:"searchSelect inputMiddleWrapper",style:{width:"132px !important"},disabled:!(0,o.R1)(lc)(r.value)},[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(p.value,(e=>((0,s.uX)(),(0,s.CE)("option",{key:e.value,value:e.value},(0,n.v_)(e.text),9,gc)))),128))],8,pc),[[l.u1,y.value.userType]])]),(0,s.Lk)("div",fc,[t[19]||(t[19]=(0,s.Lk)("label",{class:"userLabel",for:"userId"},"User ID",-1)),(0,s.bo)((0,s.Lk)("input",{id:"userId",class:"inputMiddleWrapper disabledInput",type:"text","onUpdate:modelValue":t[3]||(t[3]=e=>y.value.userId=e),disabled:"",readonly:""},null,512),[[l.Jo,y.value.userId]])]),(0,s.Lk)("div",yc,[t[20]||(t[20]=(0,s.Lk)("label",{class:"userLabel",for:"userName"},"Name",-1)),(0,s.bo)((0,s.Lk)("input",{id:"userName",class:"inputMiddleWrapper",type:"text","onUpdate:modelValue":t[4]||(t[4]=e=>y.value.name=e)},null,512),[[l.Jo,y.value.name]])]),(0,s.Lk)("div",bc,[t[21]||(t[21]=(0,s.Lk)("label",{class:"userLabel",for:"employeeNo"},"Employee",-1)),(0,s.bo)((0,s.Lk)("input",{id:"employeeNo",class:"inputMiddleWrapper",type:"text","onUpdate:modelValue":t[5]||(t[5]=e=>y.value.employeeNo=e)},null,512),[[l.Jo,y.value.employeeNo]])]),(0,s.Lk)("div",Ic,[t[22]||(t[22]=(0,s.Lk)("label",{class:"userLabel",for:"subscriptionDate"},"Subscription Date",-1)),(0,s.bo)((0,s.Lk)("input",{id:"subscriptionDate",class:"inputMiddleWrapper disabledInput",type:"text","onUpdate:modelValue":t[6]||(t[6]=e=>I.value=e),disabled:""},null,512),[[l.Jo,I.value]])]),(0,s.Lk)("div",Cc,[t[23]||(t[23]=(0,s.Lk)("label",{class:"userLabel",for:"latestDate"},"Latest Date",-1)),(0,s.bo)((0,s.Lk)("input",{id:"latestDate",class:"inputMiddleWrapper disabledInput",type:"text","onUpdate:modelValue":t[7]||(t[7]=e=>C.value=e),disabled:""},null,512),[[l.Jo,C.value]])])]),(0,s.Lk)("div",{class:"modalBottom"},[(0,s.Lk)("button",{type:"button",class:"alertButton",onClick:R},"Edit")])])),_:1})):(0,s.Q3)("",!0),h.value?((0,s.uX)(),(0,s.Wv)(ra,{key:1,"is-visible":h.value,type:k.value,message:S.value,onHide:A,onOkConfirm:M},null,8,["is-visible","type","message"])):(0,s.Q3)("",!0)],64)}}});const kc=hc;var Sc=kc;const wc={class:"settingImagePrint"},Nc=["value"],Rc={class:"mt10"};var Lc=(0,s.pM)({__name:"ImagePrint",setup(e){const t=(0,c.Pj)(),a=(0,r.rd)(),i=(0,o.KR)([]),u=(0,o.KR)([]),d=(0,o.KR)(""),m=(0,o.KR)(!1),v=(0,o.KR)(""),p=(0,o.KR)(""),g=(0,o.KR)(!1),f=(0,o.KR)(""),y=(0,s.EW)((()=>t.state.commonModule.enteringRouterPath)),b=(0,s.EW)((()=>t.state.commonModule.settingChangedChecker)),I=(0,s.EW)((()=>t.state.commonModule.settingType)),C=(0,o.KR)(!1);(0,s.sV)((async()=>{await S(),await t.dispatch("commonModule/setCommonInfo",{settingType:la.imagePrint})})),(0,s.wB)((()=>u.value),(async e=>{i.value.forEach((t=>{t.checked=e.includes(t.classId)})),await t.dispatch("commonModule/setCommonInfo",{afterSettingFormattedString:JSON.stringify(i.value)}),I.value!==la.imagePrint&&await t.dispatch("commonModule/setCommonInfo",{settingType:la.imagePrint})}),{deep:!0}),(0,s.wB)((()=>b.value),(()=>{h()}));const h=()=>{g.value=!0,f.value=`${I.value} ${U.settingNotSaved}`},k=async()=>{try{let e;if(i.value.forEach((e=>{e.checked=u.value.includes(e.classId)})),"post"!==d.value){const e=await he({imagePrintItems:i.value});return e.data?(w(U.UPDATE_SUCCESSFULLY),await S()):N(U.settingUpdateFailure),await t.dispatch("commonModule/setCommonInfo",{beforeSettingFormattedString:null}),void await t.dispatch("commonModule/setCommonInfo",{afterSettingFormattedString:null})}e=await Ce({imagePrintItems:i.value}),e&&(w(U.settingSaveSuccess),d.value="put",await S(),await t.dispatch("commonModule/setCommonInfo",{beforeSettingFormattedString:null}),await t.dispatch("commonModule/setCommonInfo",{afterSettingFormattedString:null}))}catch(e){console.error(e)}},S=async()=>{try{const e=await ke();if(e&&e.data){const a=e.data;!a||a instanceof Array&&0===a.length?(d.value="post",i.value="bm"===window.PROJECT_TYPE?qt:Qt):(d.value="put",i.value=a,u.value=a.filter((e=>e.checked)).map((e=>e.classId)),C.value=u.value.length===i.value.length),await t.dispatch("commonModule/setCommonInfo",{beforeSettingFormattedString:null}),await t.dispatch("commonModule/setCommonInfo",{afterSettingFormattedString:null})}}catch(e){console.error(e)}},w=e=>{m.value=!0,v.value="success",p.value=e},N=e=>{m.value=!0,v.value="error",p.value=e},R=()=>{m.value=!1},L=()=>{C.value=!C.value,C.value?u.value=i.value.map((e=>e.classId)):u.value=[]},E=async()=>{await t.dispatch("commonModule/setCommonInfo",{beforeSettingFormattedString:null}),await t.dispatch("commonModule/setCommonInfo",{afterSettingFormattedString:null}),g.value=!1,await a.push(y.value)},_=async()=>{await k(),g.value=!1};return(e,t)=>((0,s.uX)(),(0,s.CE)(s.FK,null,[(0,s.Lk)("div",wc,[(0,s.Lk)("button",{class:"imagePrintBtn mb20",type:"button",onClick:L},(0,n.v_)(C.value?"Uncheck All":"Check All"),1),((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(i.value,(e=>((0,s.uX)(),(0,s.CE)("label",{key:e.id},[(0,s.Lk)("div",null,(0,n.v_)(e.fullNm),1),(0,s.Lk)("div",null,[(0,s.bo)((0,s.Lk)("input",{type:"checkbox",value:e.classId,"onUpdate:modelValue":t[0]||(t[0]=e=>u.value=e)},null,8,Nc),[[l.lH,u.value]])])])))),128))]),(0,s.Lk)("div",Rc,[(0,s.Lk)("button",{class:"saveBtn",type:"button",onClick:t[1]||(t[1]=e=>k())},"Save")]),g.value?((0,s.uX)(),(0,s.Wv)(ra,{key:0,"is-visible":g.value,type:"setting",message:f.value,onHide:E,onOkConfirm:_},null,8,["is-visible","message"])):(0,s.Q3)("",!0),m.value?((0,s.uX)(),(0,s.Wv)(Pt,{key:1,"is-visible":m.value,type:v.value,message:p.value,onHide:R,"onUpdate:hideAlert":R},null,8,["is-visible","type","message"])):(0,s.Q3)("",!0)],64))}});const Ec=Lc;var _c=Ec;const Pc={class:"alignDiv"},Tc={class:"mb10"},Ac=["onUpdate:modelValue"],Mc={class:"alignDiv"},Dc={class:"mb10"},xc=["onUpdate:modelValue"],Oc={class:"alignDiv"},Kc={key:0,class:"minCountWrapper"},Bc={key:1,class:"minCountWrapper"},Fc={class:"mt10"};var Uc=(0,s.pM)({__name:"lisCode",setup(e){const t=(0,c.Pj)(),a=(0,r.rd)(),i=(0,o.KR)([]),u=(0,o.KR)([]),d=(0,o.KR)([]),m=(0,o.KR)(""),v=(0,o.KR)(!1),p=(0,o.KR)(""),g=(0,o.KR)(""),f=(0,o.KR)(!1),y=(0,o.KR)(""),b=(0,s.EW)((()=>t.state.commonModule.enteringRouterPath)),I=(0,s.EW)((()=>t.state.commonModule.settingChangedChecker)),C=(0,s.EW)((()=>t.state.commonModule.settingType)),h=(0,o.KR)([]);(0,s.sV)((async()=>{await L(),await S(),await t.dispatch("commonModule/setCommonInfo",{settingType:la.lisCode})})),(0,s.wB)((()=>[i.value,u.value,d.value]),(async()=>{const e={lisCodeWbcArr:i.value,lisCodeRbcArr:u.value,minCountArr:d.value};await t.dispatch("commonModule/setCommonInfo",{afterSettingFormattedString:JSON.stringify(e)}),C.value!==la.lisCode&&await t.dispatch("commonModule/setCommonInfo",{settingType:la.lisCode})}),{deep:!0}),(0,s.wB)((()=>I.value),(()=>{k()}));const k=()=>{f.value=!0,y.value=`${C.value} ${U.settingNotSaved}`},S=async()=>{try{const e=await ue();e?.data&&(h.value=e.data.filter((e=>e.abbreviation&&e.fullNm)),w())}catch(e){console.error("Error fetching WBC custom classes:",e)}},w=async()=>{const e=new Set(h.value.map((e=>e.customNum))),a=new Set(i.value.map((e=>e.classId))),l=new Set(sa.map((e=>String(e.customNum))));i.value=i.value.filter((t=>!(l.has(t.classId)&&!e.has(t.classId))));const s=h.value.filter((e=>!a.has(e.customNum))).map((e=>({fullNm:e.fullNm,classId:e.customNum,key:""})));i.value=[...i.value,...s];const o={lisCodeWbcArr:i.value,lisCodeRbcArr:u.value,minCountArr:d.value};await t.dispatch("commonModule/setCommonInfo",{beforeSettingFormattedString:o}),await t.dispatch("commonModule/setCommonInfo",{afterSettingFormattedString:o})},N=async()=>{try{let e,a,l;if("post"!==m.value){const e=await we({lisCodeItems:i.value}),a=await Le({lisCodeItems:u.value}),l=await Fe({minCountItems:d.value});return e.data&&a.data&&l.data?(E(U.UPDATE_SUCCESSFULLY),dn(),await L()):_(U.settingUpdateFailure),await t.dispatch("commonModule/setCommonInfo",{beforeSettingFormattedString:null}),void await t.dispatch("commonModule/setCommonInfo",{afterSettingFormattedString:null})}e=await Se({lisCodeItems:i.value}),a=await Re({lisCodeItems:u.value}),l=await Be({minCountItems:d.value}),e&&a&&l&&(E(U.settingSaveSuccess),dn(),m.value="put",await L(),await t.dispatch("commonModule/setCommonInfo",{beforeSettingFormattedString:null}),await t.dispatch("commonModule/setCommonInfo",{afterSettingFormattedString:null}))}catch(e){console.error(e)}},R=(e,t)=>{const a=e.target,l=a.value.replace(/[^0-9]/g,"");t?d.value[0].minGPCount=Number(l.trim()):d.value[0].minPACount=Number(l.trim())},L=async()=>{try{const e=await Ne(),t=await Ee(),a=await Ue();if(e&&e.data&&t&&t.data&&a&&a.data){const l=e.data,s=t.data,o=a.data;!l||l instanceof Array&&0===l.length?(m.value="post",i.value=Jt):(m.value="put",i.value=l),!s||s instanceof Array&&0===s.length?(m.value="post",u.value=zt):(m.value="put",u.value=s),!o||o instanceof Array&&0===o.length?(m.value="post",d.value=Zt):(m.value="put",d.value=o)}}catch(e){console.error(e)}},E=e=>{v.value=!0,p.value="success",g.value=e},_=e=>{v.value=!0,p.value="error",g.value=e},P=()=>{v.value=!1},T=async()=>{await t.dispatch("commonModule/setCommonInfo",{beforeSettingFormattedString:null}),await t.dispatch("commonModule/setCommonInfo",{afterSettingFormattedString:null}),f.value=!1,await a.push(b.value)},A=async()=>{await N(),f.value=!1};return(e,t)=>((0,s.uX)(),(0,s.CE)(s.FK,null,[(0,s.Lk)("div",Pc,[t[5]||(t[5]=(0,s.Lk)("p",{class:"mb40"}," [ WBC ] ",-1)),((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(i.value,(e=>((0,s.uX)(),(0,s.CE)("label",{key:e.classId},[(0,s.Lk)("p",Tc,(0,n.v_)(e.fullNm),1),(0,s.bo)((0,s.Lk)("input",{type:"text","onUpdate:modelValue":t=>e.key=t},null,8,Ac),[[l.Jo,e.key]])])))),128))]),(0,s.Lk)("div",Mc,[t[6]||(t[6]=(0,s.Lk)("p",{class:"mt20 mb40"}," [ RBC ] ",-1)),((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(u.value,(e=>((0,s.uX)(),(0,s.CE)("label",{key:e.fullNm},[(0,s.Lk)("p",Dc,(0,n.v_)(e.categoryNm)+" - "+(0,n.v_)(e.fullNm),1),(0,s.bo)((0,s.Lk)("input",{type:"text","onUpdate:modelValue":t=>e.key=t},null,8,xc),[[l.Jo,e.key]])])))),128))]),(0,s.Lk)("div",Oc,[t[9]||(t[9]=(0,s.Lk)("p",{class:"mb20"}," [ Min Count ] ",-1)),(0,s.Lk)("ul",null,[d.value.length>0?((0,s.uX)(),(0,s.CE)("li",Kc,[t[7]||(t[7]=(0,s.Lk)("p",{class:"mb10 mt10"},"Giant Platelet",-1)),(0,s.bo)((0,s.Lk)("input",{type:"text","onUpdate:modelValue":t[0]||(t[0]=e=>d.value[0].minGPCount=e),onInput:t[1]||(t[1]=e=>R(e,!0)),class:"form-control form-control-sm"},null,544),[[l.Jo,d.value[0].minGPCount]])])):(0,s.Q3)("",!0),d.value.length>0?((0,s.uX)(),(0,s.CE)("li",Bc,[t[8]||(t[8]=(0,s.Lk)("p",{class:"mb10 mt10"},"Platelet Aggregation",-1)),(0,s.bo)((0,s.Lk)("input",{type:"text","onUpdate:modelValue":t[2]||(t[2]=e=>d.value[0].minPACount=e),onInput:t[3]||(t[3]=e=>R(e,!1)),class:"form-control form-control-sm"},null,544),[[l.Jo,d.value[0].minPACount]])])):(0,s.Q3)("",!0)])]),(0,s.Lk)("div",Fc,[(0,s.Lk)("button",{class:"saveBtn",type:"button",onClick:t[4]||(t[4]=e=>N())},"Save")]),f.value?((0,s.uX)(),(0,s.Wv)(ra,{key:0,"is-visible":f.value,type:"setting",message:y.value,onHide:T,onOkConfirm:A},null,8,["is-visible","message"])):(0,s.Q3)("",!0),v.value?((0,s.uX)(),(0,s.Wv)(Pt,{key:1,"is-visible":v.value,type:p.value,message:g.value,onHide:P,"onUpdate:hideAlert":P},null,8,["is-visible","type","message"])):(0,s.Q3)("",!0)],64))}});const Xc=Uc;var $c=Xc;const Wc={class:"alignDiv",style:{width:"660px"}},Hc={key:0,class:"pt5"},Gc=["onUpdate:modelValue"],Yc={class:"pos-relative w220 flex-align-center"},Vc=["onUpdate:modelValue"],jc={class:"mt10"};var Qc=(0,s.pM)({__name:"cbcCode",setup(e){const t=(0,c.Pj)(),a=(0,r.rd)(),i=(0,o.KR)([]),u=(0,o.KR)(""),d=(0,o.KR)(!1),m=(0,o.KR)(""),v=(0,o.KR)(""),p=(0,o.KR)(!1),g=(0,o.KR)(""),f=(0,s.EW)((()=>t.state.commonModule.enteringRouterPath)),y=(0,s.EW)((()=>t.state.commonModule.settingChangedChecker)),b=(0,s.EW)((()=>t.state.commonModule.settingType)),C=(0,o.KR)(""),h=(0,o.KR)("00");(0,s.sV)((async()=>{await N(),await w(),await t.dispatch("commonModule/setCommonInfo",{settingType:la.cbcCode})})),(0,s.wB)((()=>i.value),(async e=>{await t.dispatch("commonModule/setCommonInfo",{afterSettingFormattedString:JSON.stringify(e)}),b.value!==la.cbcCode&&await t.dispatch("commonModule/setCommonInfo",{settingType:la.cbcCode})}),{deep:!0}),(0,s.wB)((()=>y.value),(()=>{k()}));const k=()=>{p.value=!0,g.value=`${b.value} ${U.settingNotSaved}`},S=async()=>{try{let e;if("post"!==u.value){const e=await Pe({cbcCodeItems:i.value});return e.data?(P(U.UPDATE_SUCCESSFULLY),await w()):T(U.settingUpdateFailure),await t.dispatch("commonModule/setCommonInfo",{beforeSettingFormattedString:null}),void await t.dispatch("commonModule/setCommonInfo",{afterSettingFormattedString:null})}e=await _e({cbcCodeItems:i.value}),e&&(P(U.settingSaveSuccess),u.value="put",await w(),await t.dispatch("commonModule/setCommonInfo",{beforeSettingFormattedString:null}),await t.dispatch("commonModule/setCommonInfo",{afterSettingFormattedString:null}))}catch(e){console.error(e)}},w=async()=>{try{const e=await Te();if(e&&e.data){const a=e.data;!a||a instanceof Array&&0===a.length?(u.value="post",C.value===I["인하대병원"]?i.value=Xt:i.value=$t):(u.value="put",i.value=a),await t.dispatch("commonModule/setCommonInfo",{beforeSettingFormattedString:JSON.stringify(i.value)}),await t.dispatch("commonModule/setCommonInfo",{afterSettingFormattedString:JSON.stringify(i.value)})}}catch(e){console.error(e)}},N=async()=>{try{const e=await da();C.value=e.data.siteCd}catch(e){console.error(e)}},R=()=>{let e=Math.max(...i.value.map((e=>Number(e.cd))))+1;const t=e.toString().padStart(2,"0"),a={cd:t,classCd:"",fullNm:"Edit CBC Code",isSelected:!0};i.value.push(a)},L=e=>{i.value=i.value.filter((t=>Number(t.cd)!==Number(e)))},E=e=>h.value=e,_=()=>{h.value="00"},P=e=>{d.value=!0,m.value="success",v.value=e,window.scrollTo({top:0,behavior:"smooth"})},T=e=>{d.value=!0,m.value="error",v.value=e},A=()=>{d.value=!1},M=async()=>{await t.dispatch("commonModule/setCommonInfo",{beforeSettingFormattedString:null}),await t.dispatch("commonModule/setCommonInfo",{afterSettingFormattedString:null}),p.value=!1,await a.push(f.value)},D=async()=>{await S(),p.value=!1};return(e,t)=>{const a=(0,s.g2)("font-awesome-icon");return(0,s.uX)(),(0,s.CE)(s.FK,null,[(0,s.Lk)("div",Wc,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(i.value,(e=>((0,s.uX)(),(0,s.CE)("label",{class:"pos-relative",key:e.cd},[h.value!==e.cd?((0,s.uX)(),(0,s.CE)("p",Hc,(0,n.v_)(e.fullNm),1)):(0,s.bo)(((0,s.uX)(),(0,s.CE)("input",{key:1,type:"text","onUpdate:modelValue":t=>e.fullNm=t},null,8,Gc)),[[l.Jo,e.fullNm]]),(0,s.Lk)("div",Yc,[(0,s.bo)((0,s.bF)(a,{onClick:t=>E(e.cd),class:"cursorPointer hoverSizeAction cbc-setting-icon",icon:["fas","pen-to-square"]},null,8,["onClick"]),[[l.aG,h.value!==e.cd]]),(0,s.bo)((0,s.bF)(a,{onClick:_,class:"cursorPointer hoverSizeAction cbc-setting-icon",icon:["fas","square-check"]},null,512),[[l.aG,h.value===e.cd]]),(0,s.bF)(a,{onClick:t=>L(e.cd),class:"cursorPointer hoverSizeAction",style:{"margin-right":"4px"},icon:["fas","trash"]},null,8,["onClick"]),(0,s.bo)((0,s.Lk)("input",{type:"text","onUpdate:modelValue":t=>e.classCd=t},null,8,Vc),[[l.Jo,e.classCd]])])])))),128))]),(0,s.Lk)("button",{class:"cursorPointer",onClick:R},[(0,s.bF)(a,{icon:["fas","plus"]})]),(0,s.Lk)("div",jc,[(0,s.Lk)("button",{class:"saveBtn",type:"button",onClick:t[0]||(t[0]=e=>S())},"Save")]),p.value?((0,s.uX)(),(0,s.Wv)(ra,{key:0,"is-visible":p.value,type:"setting",message:g.value,onHide:M,onOkConfirm:D},null,8,["is-visible","message"])):(0,s.Q3)("",!0),d.value?((0,s.uX)(),(0,s.Wv)(Pt,{key:1,"is-visible":d.value,type:m.value,message:v.value,onHide:A,"onUpdate:hideAlert":A},null,8,["is-visible","type","message"])):(0,s.Q3)("",!0)],64)}}});const qc=Qc;var Jc=qc;const zc={class:"crcDivTitle"},Zc=["onUpdate:modelValue"],eu={key:1,class:"spanTitle"},tu=["onUpdate:modelValue"],au={key:1},lu={class:"crcSel"},su=["onUpdate:modelValue"],ou=["onUpdate:modelValue","onChange"],nu=["value"],iu=["onChange"],ru=["onInput"],cu=["onUpdate:modelValue","disabled"],uu=["onUpdate:modelValue","disabled"],du=["disabled","onUpdate:modelValue"],mu=["disabled","onUpdate:modelValue"],vu=["title","onUpdate:modelValue","onChange"],pu=["title","onUpdate:modelValue","onChange"],gu={key:0,class:"smallBox"},fu=["onUpdate:modelValue"],yu={key:1,class:"crcPercentText"},bu={key:1},Iu=["onClick"],Cu=["onClick"],hu=["onClick"];var ku=(0,s.pM)({__name:"crcCompontent",props:{items:{type:Array,required:!0},moType:{type:String,required:!0},pageName:{type:String,required:!0},masterId:{type:String,required:!0},userType:{type:String,required:!0}},emits:["updateCrc","deleteCrc","updateSelect","changeCrcData"],setup(e,{emit:t}){const a=e,i=t,r=(0,o.KR)([]),c=(0,o.KR)("병원 lis code 매칭 시키는 부분 - 병원에서 사용하는 타이틀로 연동해서 LIS 전송하는 부분"),u=(0,o.KR)("병원 lis 받는 Value 매칭 시키는 부분 - 병원에서 Lis 받을 때 실제 보내야하는 값으로 치환시켜주는 부분 , 구분"),d=(0,o.KR)(null);(0,s.EW)((()=>{const e=[];for(let t=0;t<r.value.length;t+=4)e.push(r.value.slice(t,t+4));return e}));(0,s.sV)((async()=>{r.value=a.items?.filter((e=>e?.morphologyType===a.moType))})),(0,s.wB)(a,(e=>{r.value=e?.items.filter((e=>e?.morphologyType===a.moType))}),{deep:!0});const m=e=>{d.value=e},v=(e,t)=>{const a=JSON.parse(JSON.stringify(t));a.val=e.target.value,i("changeCrcData",a)},p=e=>{const t={...r.value.find((t=>t.id===e))};i("updateCrc",{id:e,updatedItem:t}),d.value=null},g=(e,t)=>{i("deleteCrc",{index:e,id:t})},f=e=>{switch(e){case"RBC":return"RBC Morphology";case"WBC":return"WBC Morphology";case"PLT":return"Platelet Morphology"}},y=e=>e.split(",").map((e=>e.trim())),b=(e,t)=>{"report"===a.pageName&&i("updateSelect",{val:e.target?.value,id:t})};return(t,a)=>((0,s.uX)(),(0,s.CE)(s.FK,null,[(0,s.Lk)("div",zc,(0,n.v_)(f(e.moType)),1),(0,s.Lk)("div",{class:(0,n.C4)({rbcCrcDiv:"RBC"===e.moType})},[(0,s.Lk)("ul",{class:(0,n.C4)({rbcCrcGrid:"RBC"===e.moType})},[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(r.value,((t,i)=>((0,s.uX)(),(0,s.CE)("div",{key:i,class:"grid-item crcItemDiv"},[(0,s.Lk)("p",null,[d.value===t.id?(0,s.bo)(((0,s.uX)(),(0,s.CE)("input",{key:0,class:"smallBox",type:"text","onUpdate:modelValue":e=>t.crcTitle=e},null,8,Zc)),[[l.Jo,t.crcTitle]]):((0,s.uX)(),(0,s.CE)("span",eu,(0,n.v_)(t.crcTitle),1))]),(0,s.Lk)("div",null,[d.value===t.id?(0,s.bo)(((0,s.uX)(),(0,s.CE)("select",{key:0,"onUpdate:modelValue":e=>t.crcType=e,class:"w120"},a[0]||(a[0]=[(0,s.Lk)("option",{value:"select"},"select",-1),(0,s.Lk)("option",{value:"text"},"text",-1),(0,s.Lk)("option",{value:"percent"},"percent",-1)]),8,tu)),[[l.u1,t.crcType]]):"set"===e.pageName&&(0,o.R1)(lc)(e.masterId)?((0,s.uX)(),(0,s.CE)("div",au,(0,n.v_)(t?.crcType),1)):(0,s.Q3)("",!0)]),(0,s.Lk)("div",lu,[d.value===t.id?(0,s.bo)(((0,s.uX)(),(0,s.CE)("input",{key:0,type:"text","onUpdate:modelValue":e=>t.crcContent=e},null,8,su)),[[l.Jo,t.crcContent]]):((0,s.uX)(),(0,s.CE)(s.FK,{key:1},["select"===t?.crcType?((0,s.uX)(),(0,s.CE)(s.FK,{key:0},["report"===e.pageName?(0,s.bo)(((0,s.uX)(),(0,s.CE)("select",{key:0,"onUpdate:modelValue":e=>t.val=e,onChange:e=>b(e,t.id),class:"w120"},[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(y(t?.crcContent),((e,t)=>((0,s.uX)(),(0,s.CE)("option",{key:t,value:e},(0,n.v_)(e),9,nu)))),128))],40,ou)),[[l.u1,t.val]]):(0,o.R1)(lc)(e.masterId)?((0,s.uX)(),(0,s.CE)("select",{key:1,onChange:e=>b(e,t.id),class:"w108"},[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(y(t?.crcContent),((e,t)=>((0,s.uX)(),(0,s.CE)("option",{key:t},(0,n.v_)(e),1)))),128))],40,iu)):(0,s.Q3)("",!0),"Etc"===t.val?((0,s.uX)(),(0,s.CE)("input",{key:2,onInput:e=>v(e,t),type:"text",placeholder:"Etc Text",class:"etcTextInput"},null,40,ru)):(0,s.Q3)("",!0)],64)):"text"===t?.crcType?((0,s.uX)(),(0,s.CE)(s.FK,{key:1},["set"!==e.pageName?(0,s.bo)(((0,s.uX)(),(0,s.CE)("input",{key:0,"onUpdate:modelValue":e=>t.crcContent=e,disabled:"report"!==e.pageName,type:"text",placeholder:"Enter text"},null,8,cu)),[[l.Jo,t.crcContent]]):"set"===e.pageName&&(0,o.R1)(lc)(e.masterId)?(0,s.bo)(((0,s.uX)(),(0,s.CE)("input",{key:1,"onUpdate:modelValue":e=>t.crcContent=e,disabled:"set"===e.pageName,type:"text",placeholder:"Enter text"},null,8,uu)),[[l.Jo,t.crcContent]]):(0,s.Q3)("",!0)],64)):((0,s.uX)(),(0,s.CE)(s.FK,{key:2},["set"!==e.pageName?(0,s.bo)(((0,s.uX)(),(0,s.CE)("input",{key:0,class:"smallInput",disabled:"report"!==e.pageName,"onUpdate:modelValue":e=>t.crcContent=e,type:"text",placeholder:"Enter percentage"},null,8,du)),[[l.Jo,t.crcContent]]):"set"===e.pageName&&(0,o.R1)(lc)(e.masterId)?(0,s.bo)(((0,s.uX)(),(0,s.CE)("input",{key:1,class:"smallInput",disabled:"set"===e.pageName,"onUpdate:modelValue":e=>t.crcContent=e,type:"text",placeholder:"Enter percentage"},null,8,mu)),[[l.Jo,t.crcContent]]):(0,s.Q3)("",!0)],64))],64)),"set"===e.pageName?((0,s.uX)(),(0,s.CE)(s.FK,{key:2},[(0,s.bo)((0,s.Lk)("input",{class:"smallInput",type:"text",title:c.value,placeholder:"lisCodeMatching","onUpdate:modelValue":e=>t.crcCode=e,onChange:e=>p(t.id)},null,40,vu),[[l.Jo,t.crcCode]]),(0,s.bo)((0,s.Lk)("input",{class:"smallInput",type:"text",placeholder:"lisValMatching",title:u.value,"onUpdate:modelValue":e=>t.crcCodeMatching=e,onChange:e=>p(t.id)},null,40,pu),[[l.Jo,t.crcCodeMatching]])],64)):(0,s.Q3)("",!0)]),"percent"===t.crcType?((0,s.uX)(),(0,s.CE)("div",gu,[d.value===t.id?(0,s.bo)(((0,s.uX)(),(0,s.CE)("input",{key:0,type:"text","onUpdate:modelValue":e=>t.crcPercentText=e,class:"crcPercentInput"},null,8,fu)),[[l.Jo,t.crcPercentText]]):((0,s.uX)(),(0,s.CE)("span",yu,(0,n.v_)(t?.crcPercentText),1))])):(0,s.Q3)("",!0),"set"===e.pageName&&(0,o.R1)(lc)(e.masterId)?((0,s.uX)(),(0,s.CE)("div",bu,[d.value!==t.id?((0,s.uX)(),(0,s.CE)("button",{key:0,type:"button",class:"crcBtn",style:{padding:"4px 0"},onClick:e=>m(t.id)},"EDIT",8,Iu)):(0,s.Q3)("",!0),d.value===t.id?((0,s.uX)(),(0,s.CE)("button",{key:1,type:"button",class:"crcBtn",style:{padding:"4px 0"},onClick:e=>p(t.id)},"OK",8,Cu)):(0,s.Q3)("",!0),(0,s.Lk)("button",{type:"button",class:"crcBtn",style:{padding:"4px 0"},onClick:e=>g(i,t.id)},"DEL",8,hu)])):(0,s.Q3)("",!0)])))),128))],2)],2)],64))}});const Su=ku;var wu=Su;const Nu={key:0},Ru={class:"crcWrap flex-column-align-center"},Lu={class:"w30p"},Eu={key:0,class:"flex-align-center-justify-between mb10"},_u={key:0,class:"w30p"},Pu={class:"flex-align-center-justify-between mb20"},Tu={class:"flex-align-center-justify-between mb20"},Au={class:"flex-align-center-justify-between mb20"},Mu={class:"flex-column-align-center mt10"},Du={class:"flex-center mt10",style:{gap:"14px"}},xu=["checked"],Ou=["checked"],Ku=["checked"],Bu={key:1,class:"mt30"},Fu={key:0},Uu={class:"moDivBox mt20"};var Xu=(0,s.pM)({__name:"crc",setup(e){const t=(0,o.KR)(!1),a=(0,o.KR)(""),n=(0,o.KR)(""),i=(0,o.KR)(""),r=(0,o.KR)(""),u=(0,o.KR)([]),d=(0,o.KR)(""),m=(0,o.KR)([]),v=(0,o.KR)(!1),p=(0,o.KR)(""),g=(0,o.KR)(""),f=(0,o.KR)(!1),y=(0,o.KR)(!1),b=(0,o.KR)(!1),I=(0,o.KR)(!1),C=(0,o.KR)(0),h=(0,o.KR)([{checked:!1,name:"remark"},{checked:!1,name:"Comment"},{checked:!1,name:"Recommendation"}]),k=(0,o.KR)(""),S=(0,c.Pj)(),w=(0,s.EW)((()=>S.state.userModule.userId)),N=(0,s.EW)((()=>S.state.userModule.userType));(0,s.sV)((async()=>{await(0,s.dY)(),m.value=await qe();const e=await rt();0!==e.data.length?(f.value=e.data[0].crcMode,y.value=e.data[0]?.lisTwoMode,b.value=e.data[0].crcConnect,C.value=e.data[0].id,h.value=e.data[0].crcRemarkCount,k.value=e.data[0].crcPassWord,I.value=!0):h.value=[{checked:!1,name:"remark"},{checked:!1,name:"Comment"},{checked:!1,name:"Recommendation"}],t.value=!0,t.value&&(u.value=[],u.value=JSON.parse(JSON.stringify(m.value.data)))}));const R=e=>{switch(e){case"0":return"remark";case"1":return"Comment";case"2":return"Recommendation"}},L=e=>{const t=h.value.findIndex((t=>t.name===R(e.target?.value)));h.value[t].checked=e.target?.checked},E=()=>{v.value=!1},_=async e=>{v.value=!0,p.value="success",g.value=e,window.scrollTo({top:0,behavior:"smooth"})},P=()=>{""!==a.value&&""!==n.value&&u.value.push({crcTitle:a.value,crcType:n.value,crcPercentText:i.value,morphologyType:d.value,crcContent:r.value})},T=async({index:e,updatedItem:t})=>{u.value[e]=t,await Qe(u.value)},A=async({index:e,id:t})=>{const a=u.value.findIndex((e=>e.id===t));u.value.splice(a,1),await Je({id:t})},M=async()=>{const e=await rt();lc(w.value)?(I.value&&0!==e.data.length?await ct({id:C.value,crcMode:f.value,crcConnect:b.value,crcRemarkCount:h.value,crcPassWord:k.value,lisTwoMode:y.value}):await it({crcMode:f.value,crcConnect:b.value,crcRemarkCount:h.value,crcPassWord:k.value,lisTwoMode:y.value}),I.value&&0!==m.value.data.length?await Qe(u.value):await je(u.value)):I.value&&0!==m.value.data.length&&(await Qe(u.value),await ct({id:C.value,crcPassWord:k.value})),await _("Success")},D=()=>{f.value=!f.value},x=()=>{y.value=!y.value},O=()=>{b.value=!b.value};return(e,c)=>{const m=(0,s.g2)("font-awesome-icon");return(0,s.uX)(),(0,s.CE)(s.FK,null,[(0,s.Lk)("div",null,[t.value?((0,s.uX)(),(0,s.CE)("div",Nu,[(0,s.Lk)("div",Ru,[(0,s.Lk)("div",Lu,[(0,o.R1)(sc)(N.value)?((0,s.uX)(),(0,s.CE)("div",Eu,[c[6]||(c[6]=(0,s.Lk)("span",null,"CRC Password",-1)),(0,s.bo)((0,s.Lk)("input",{style:{width:"100px"},type:"text",placeholder:"password","onUpdate:modelValue":c[0]||(c[0]=e=>k.value=e)},null,512),[[l.Jo,k.value]])])):(0,s.Q3)("",!0)]),(0,o.R1)(lc)(w.value)?((0,s.uX)(),(0,s.CE)("div",_u,[(0,s.Lk)("div",Pu,[c[7]||(c[7]=(0,s.Lk)("span",null,"CRC Default Mode",-1)),(0,s.bF)(m,{icon:f.value?["fas","toggle-on"]:["fas","toggle-off"],class:"iconSize",onClick:D},null,8,["icon"])]),(0,s.Lk)("div",Tu,[c[8]||(c[8]=(0,s.Lk)("span",null,"CRC LIS Two Mode",-1)),(0,s.bF)(m,{icon:y.value?["fas","toggle-on"]:["fas","toggle-off"],class:"iconSize",onClick:x},null,8,["icon"])]),(0,s.Lk)("div",Au,[c[9]||(c[9]=(0,s.Lk)("span",null,"CRC Connect",-1)),(0,s.bF)(m,{icon:b.value?["fas","toggle-on"]:["fas","toggle-off"],class:"iconSize",onClick:O},null,8,["icon"])]),(0,s.Lk)("div",Mu,[c[13]||(c[13]=(0,s.Lk)("span",null,"CRC Remark Select Count",-1)),(0,s.Lk)("div",Du,[c[10]||(c[10]=(0,s.Lk)("label",{for:"crc-remark"},"Remark",-1)),(0,s.Lk)("input",{id:"crc-remark",type:"checkbox",onChange:L,value:"0",checked:h.value[0].checked},null,40,xu),c[11]||(c[11]=(0,s.Lk)("label",{for:"crc-comment"},"Comment",-1)),(0,s.Lk)("input",{id:"crc-comment",type:"checkbox",onChange:L,value:"1",checked:h.value[1].checked},null,40,Ou),c[12]||(c[12]=(0,s.Lk)("label",{for:"crc-recommendation"},"Recommendation",-1)),(0,s.Lk)("input",{id:"crc-recommendation",type:"checkbox",onChange:L,value:"2",checked:h.value[2].checked},null,40,Ku)])])])):(0,s.Q3)("",!0),(0,o.R1)(lc)(w.value)?((0,s.uX)(),(0,s.CE)("ul",Bu,[(0,s.Lk)("li",null,[c[14]||(c[14]=(0,s.Lk)("p",null,"crcTitle",-1)),(0,s.Lk)("span",null,[(0,s.bo)((0,s.Lk)("input",{type:"text",placeholder:"crcTitle","onUpdate:modelValue":c[1]||(c[1]=e=>a.value=e)},null,512),[[l.Jo,a.value]])])]),(0,s.Lk)("li",null,[c[16]||(c[16]=(0,s.Lk)("p",null,"crcType",-1)),(0,s.Lk)("span",null,[(0,s.bo)((0,s.Lk)("select",{"onUpdate:modelValue":c[2]||(c[2]=e=>n.value=e)},c[15]||(c[15]=[(0,s.Lk)("option",{value:"select"},"select",-1),(0,s.Lk)("option",{value:"text"},"text",-1),(0,s.Lk)("option",{value:"percent"},"percent",-1)]),512),[[l.u1,n.value]])])]),(0,s.Lk)("li",null,[c[17]||(c[17]=(0,s.Lk)("p",null,"CRC Content",-1)),(0,s.Lk)("span",null,[(0,s.bo)((0,s.Lk)("input",{type:"text",placeholder:"crcContent","onUpdate:modelValue":c[3]||(c[3]=e=>r.value=e)},null,512),[[l.Jo,r.value]])])]),"percent"===n.value?((0,s.uX)(),(0,s.CE)("li",Fu,[c[18]||(c[18]=(0,s.Lk)("p",null,"CRC PercentText",-1)),(0,s.Lk)("span",null,[(0,s.bo)((0,s.Lk)("input",{type:"text",placeholder:"crcPercentText","onUpdate:modelValue":c[4]||(c[4]=e=>i.value=e)},null,512),[[l.Jo,i.value]])])])):(0,s.Q3)("",!0),(0,s.Lk)("li",null,[c[20]||(c[20]=(0,s.Lk)("p",null,"Morphology Type",-1)),(0,s.Lk)("span",null,[(0,s.bo)((0,s.Lk)("select",{"onUpdate:modelValue":c[5]||(c[5]=e=>d.value=e)},c[19]||(c[19]=[(0,s.Lk)("option",{value:"RBC"},"RBC",-1),(0,s.Lk)("option",{value:"WBC"},"WBC",-1),(0,s.Lk)("option",{value:"PLT"},"PLT",-1)]),512),[[l.u1,d.value]])])]),(0,s.Lk)("li",null,[(0,s.Lk)("button",{class:"crcWrapBtn",onClick:P},"Add")])])):(0,s.Q3)("",!0)]),(0,s.bF)(wu,{items:u.value,onUpdateCrc:T,onDeleteCrc:A,moType:"RBC",pageName:"set",masterId:w.value,userType:N.value},null,8,["items","masterId","userType"]),(0,s.Lk)("div",Uu,[(0,s.Lk)("div",null,[(0,s.bF)(wu,{items:u.value,onUpdateCrc:T,onDeleteCrc:A,moType:"WBC",pageName:"set",masterId:w.value,userType:N.value},null,8,["items","masterId","userType"])]),(0,s.Lk)("div",null,[(0,s.bF)(wu,{items:u.value,onUpdateCrc:T,onDeleteCrc:A,moType:"PLT",pageName:"set",masterId:w.value,userType:N.value},null,8,["items","masterId","userType"])])])])):(0,s.Q3)("",!0)]),(0,s.Lk)("div",{class:"mt10"},[(0,s.Lk)("button",{class:"saveBtn",type:"button",onClick:M},"Save")]),v.value?((0,s.uX)(),(0,s.Wv)(Pt,{key:0,"is-visible":v.value,type:p.value,message:g.value,onHide:E,"onUpdate:hideAlert":E},null,8,["is-visible","type","message"])):(0,s.Q3)("",!0)],64)}}});const $u=Xu;var Wu=$u;function Hu(e,t){return(0,s.uX)(),(0,s.CE)("div")}var Gu=a(6262);const Yu={},Vu=(0,Gu.A)(Yu,[["render",Hu]]);var ju=Vu;const Qu={class:"alignDiv",style:{"text-align":"center"}},qu=["value"],Ju=["value"],zu=["value"],Zu={class:"mt10"};var ed=(0,s.pM)({__name:"filePathSet",setup(e){const t=(0,c.Pj)(),a=(0,r.rd)(),l=(0,o.KR)([]),n=(0,o.KR)(""),i=(0,o.KR)(!1),u=(0,o.KR)(""),d=(0,o.KR)(""),m=(0,o.KR)(!1),v=(0,o.KR)(""),p=(0,s.EW)((()=>t.state.commonModule.enteringRouterPath)),g=(0,s.EW)((()=>t.state.commonModule.settingChangedChecker)),f=(0,s.EW)((()=>t.state.commonModule.settingType));(0,s.sV)((async()=>{await h(),await t.dispatch("commonModule/setCommonInfo",{settingType:la.filePathSet})})),(0,s.wB)((()=>l.value),(async e=>{await t.dispatch("commonModule/setCommonInfo",{afterSettingFormattedString:JSON.stringify(e)}),f.value!==la.filePathSet&&await t.dispatch("commonModule/setCommonInfo",{settingType:la.filePathSet})}),{deep:!0}),(0,s.wB)((()=>g.value),(()=>{y()}));const y=()=>{m.value=!0,v.value=`${f.value} ${U.settingNotSaved}`},b=(e,t)=>{const a=/^[a-zA-Z0-9]$|F[1-9]|F1[0-2]/;a.test(e.key)||I(e.key)||e.preventDefault();const s=l.value[t].lisHotKey;s.length>=1&&!I(e.key)&&(l.value[t].lisHotKey=""),I(e.key)&&(e.preventDefault(),l.value[t].lisHotKey=e.key)},I=e=>["F1","F2","F3","F4","F5","F6","F7","F8","F9","F10","F11","F12"].includes(e),C=async()=>{try{let e;if("post"!==n.value){const e=await Me({filePathSetItems:l.value});return e.data?(N(U.UPDATE_SUCCESSFULLY),await h()):R(U.settingUpdateFailure),await t.dispatch("commonModule/setCommonInfo",{beforeSettingFormattedString:null}),void await t.dispatch("commonModule/setCommonInfo",{afterSettingFormattedString:null})}e=await Ae({filePathSetItems:l.value}),e&&(N(U.settingSaveSuccess),n.value="put",await h(),await t.dispatch("commonModule/setCommonInfo",{beforeSettingFormattedString:null}),await t.dispatch("commonModule/setCommonInfo",{afterSettingFormattedString:null}))}catch(e){console.error(e)}},h=async()=>{try{const e=await De();if(e&&e.data){const a=e.data;!a||a instanceof Array&&0===a.length?(n.value="post",l.value=ta):(n.value="put",l.value=a),await t.dispatch("commonModule/setCommonInfo",{beforeSettingFormattedString:JSON.stringify(l.value)}),await t.dispatch("commonModule/setCommonInfo",{afterSettingFormattedString:JSON.stringify(l.value)})}}catch(e){console.error(e)}},k=(e,t)=>{l.value[t].lisHotKey=e.target.value},S=(e,t)=>{l.value[t].lisFilePath=e.target.value},w=(e,t)=>{l.value[t].cbcFilePath=e.target.value},N=e=>{i.value=!0,u.value="success",d.value=e},R=e=>{i.value=!0,u.value="error",d.value=e},L=()=>{i.value=!1},E=async()=>{await t.dispatch("commonModule/setCommonInfo",{beforeSettingFormattedString:null}),await t.dispatch("commonModule/setCommonInfo",{afterSettingFormattedString:null}),m.value=!1,await a.push(p.value)},_=async()=>{await C(),m.value=!1};return(e,t)=>((0,s.uX)(),(0,s.CE)(s.FK,null,[(0,s.Lk)("div",Qu,[(0,s.Lk)("ul",null,[(0,s.Lk)("li",null,[t[5]||(t[5]=(0,s.Lk)("p",{class:"mb20"},"LIS Hot Key",-1)),(0,s.Lk)("input",{onKeydown:t[0]||(t[0]=e=>b(e,0)),type:"text",value:l.value[0]?l.value[0].lisHotKey:"",onInput:t[1]||(t[1]=e=>k(e,0))},null,40,qu)]),(0,s.Lk)("li",null,[t[6]||(t[6]=(0,s.Lk)("p",{class:"mb20 mt20"},"LIS File Path",-1)),(0,s.Lk)("input",{type:"text",value:l.value[0]?l.value[0].lisFilePath:"",onInput:t[2]||(t[2]=e=>S(e,0))},null,40,Ju)]),(0,s.Lk)("li",null,[t[7]||(t[7]=(0,s.Lk)("p",{class:"mb20 mt20"},"CBC File Path",-1)),(0,s.Lk)("input",{type:"text",value:l.value[0]?l.value[0].cbcFilePath:"",onInput:t[3]||(t[3]=e=>w(e,0))},null,40,zu)])])]),(0,s.Lk)("div",Zu,[(0,s.Lk)("button",{class:"saveBtn",type:"button",onClick:t[4]||(t[4]=e=>C())},"Save")]),m.value?((0,s.uX)(),(0,s.Wv)(ra,{key:0,"is-visible":m.value,type:"setting",message:v.value,onHide:E,onOkConfirm:_},null,8,["is-visible","message"])):(0,s.Q3)("",!0),i.value?((0,s.uX)(),(0,s.Wv)(Pt,{key:1,"is-visible":i.value,type:u.value,message:d.value,onHide:L,"onUpdate:hideAlert":L},null,8,["is-visible","type","message"])):(0,s.Q3)("",!0)],64))}});const td=ed;var ad=td;const ld={class:"settingTabSubButtons"},sd={key:0};var od=(0,s.pM)({__name:"index",setup(e){const t=(0,c.Pj)(),a=(0,o.KR)(!1);let l=(0,o.KR)("ImagePrint");const i=(0,o.KR)(""),r=(0,o.KR)(!1),u=(0,o.KR)(""),d=(0,o.KR)(""),m=(0,o.KR)(!1),v=(0,o.KR)(""),p=(0,s.EW)((()=>t.state.commonModule.settingType)),g=(0,s.EW)((()=>t.state.commonModule.beforeSettingFormattedString)),f=(0,s.EW)((()=>t.state.commonModule.afterSettingFormattedString));(0,s.KC)((()=>{a.value="bm"===window.PROJECT_TYPE}));const y=e=>{l.value!==e&&(i.value=e,g.value!==f.value?(m.value=!0,v.value=`${p.value} ${U.settingNotSaved}`):l.value=i.value)},b=(0,s.EW)((()=>{switch(l.value){case"ImagePrint":return _c;case"LisCode":return $c;case"CbcCode":return Jc;case"filePathSet":return ad;case"CRC":return Wu;case"ARL":return ju;default:return null}})),I=async e=>{r.value=!0,u.value="success",d.value=e},C=e=>{r.value=!0,u.value="error",d.value=e},h=()=>{r.value=!1},k=async()=>{await t.dispatch("commonModule/setCommonInfo",{beforeSettingFormattedString:null}),await t.dispatch("commonModule/setCommonInfo",{afterSettingFormattedString:null}),l.value=i.value,m.value=!1},S=async()=>{m.value=!1;try{await Gr(p.value,JSON.parse(f.value)),await I(U.settingSaveSuccess)}catch(e){await C(U.settingSaveFailure)}};return(e,t)=>((0,s.uX)(),(0,s.CE)(s.FK,null,[(0,s.Lk)("div",null,[(0,s.Lk)("div",ld,[(0,s.Lk)("button",{onClick:t[0]||(t[0]=e=>y("ImagePrint")),class:(0,n.C4)({active:"ImagePrint"===(0,o.R1)(l)})},"Image Print",2),a.value?(0,s.Q3)("",!0):((0,s.uX)(),(0,s.CE)("div",sd,[(0,s.Lk)("button",{onClick:t[1]||(t[1]=e=>y("LisCode")),class:(0,n.C4)({active:"LisCode"===(0,o.R1)(l)})},"LIS Code",2),(0,s.Lk)("button",{onClick:t[2]||(t[2]=e=>y("CbcCode")),class:(0,n.C4)({active:"CbcCode"===(0,o.R1)(l)})},"CBC Code",2),(0,s.Lk)("button",{onClick:t[3]||(t[3]=e=>y("filePathSet")),class:(0,n.C4)({active:"filePathSet"===(0,o.R1)(l)})},"LIS(CBC) Hot Key & File Path",2),(0,s.Lk)("button",{onClick:t[4]||(t[4]=e=>y("CRC")),class:(0,n.C4)({active:"CRC"===(0,o.R1)(l)})},"Report CRC",2),(0,s.Lk)("button",{onClick:t[5]||(t[5]=e=>y("ARL")),class:(0,n.C4)({active:"ARL"===(0,o.R1)(l)})},"Auto Result Link",2)]))]),(0,s.Lk)("div",{class:(0,n.C4)({"tab-content crc":"CRC"===(0,o.R1)(l),"tab-content":"CRC"!==(0,o.R1)(l)})},[((0,s.uX)(),(0,s.Wv)((0,s.$y)(b.value)))],2)]),m.value?((0,s.uX)(),(0,s.Wv)(ra,{key:0,"is-visible":m.value,type:"setting",message:v.value,onHide:k,onOkConfirm:S},null,8,["is-visible","message"])):(0,s.Q3)("",!0),r.value?((0,s.uX)(),(0,s.Wv)(Pt,{key:1,"is-visible":r.value,type:u.value,message:d.value,onHide:h,"onUpdate:hideAlert":h},null,8,["is-visible","type","message"])):(0,s.Q3)("",!0)],64))}});const nd=od;var id=nd,rd=(0,s.pM)({__name:"index",setup(e){const t=async()=>{await Ve()};return(e,a)=>((0,s.uX)(),(0,s.CE)("div",null,[(0,s.Lk)("ul",{class:"customSettingContainer"},[(0,s.Lk)("li",{class:"mt20"},[a[0]||(a[0]=(0,s.Lk)("p",{class:"mb10"},"QualityCheck",-1)),(0,s.Lk)("button",{type:"button",class:"defaultBtn",onClick:t},"Ok")])])]))}});const cd=rd;var ud=cd;const dd={class:"versionContainer"},md={class:"versionContainer"};var vd=(0,s.pM)({__name:"index",setup(e){const t=(0,o.KR)(!1),a=(0,o.KR)(),l=(0,o.KR)(),i=(0,o.KR)({core:"",deepNet:""}),r=(0,o.KR)({seg:"",cell:""}),c=(0,o.KR)({seg:"",wbc:"",rbcClassify:"",rbcPltCrop:"",singleSeg:""});(0,s.KC)((()=>{t.value="bm"===window.PROJECT_TYPE})),(0,s.sV)((async()=>{await d(),u()}));const u=()=>{a.value=[{key:"Core Version",name:i.value.core},{key:"DeepNet Version",name:i.value.deepNet},{key:"Web Version",name:window.PROJECT_VERSION}],t.value?l.value=[{key:"BM SEG Version",name:r.value.seg},{key:"BM CELL Version",name:r.value.cell}]:l.value=[{key:"PB SEG Version",name:c.value.seg},{key:"PB WBC Version",name:c.value.wbc},{key:"PB RBC CLASSIFY Version",name:c.value.rbcClassify},{key:"PB RBC PLT CROP Version",name:c.value.rbcPltCrop},{key:"PB SINGLE SEG Version",name:c.value.singleSeg}]},d=async()=>{const e="D:\\UIMD_Data\\Backend_INI",t="SW_Config";try{const a=await Eo(`path=${e}&filename=${t}`),l=a.data.data,s=/TCP_VERSION\s*=\s*(.+)/,o=/BACKEND\s*=\s*(.+)/,n=/BM_SEG_ENGINE\s*=\s*(.+)/,u=/BM_CELL_ENGINE\s*=\s*(.+)/,d=/PB_SEG_ENGINE\s*=\s*(.+)/,m=/PB_WBC_ENGINE\s*=\s*(.+)/,v=/PB_RBC_CLASSIFY\s*=\s*(.+)/,p=/PB_RBC_PLT_CROP\s*=\s*(.+)/,g=/PB_RBC_SINGLE_SEG\s*=\s*(.+)/;i.value.deepNet=l.match(s)[1]||"",i.value.core=l.match(o)[1]||"",r.value.seg=l.match(n)[1]||"",r.value.cell=l.match(u)[1]||"",c.value.seg=l.match(d)[1]||"",c.value.wbc=l.match(m)[1]||"",c.value.rbcClassify=l.match(v)[1]||"",c.value.rbcPltCrop=l.match(p)[1]||"",c.value.singleSeg=l.match(g)[1]||""}catch(a){console.error(a)}};return(e,t)=>((0,s.uX)(),(0,s.CE)(s.FK,null,[(0,s.Lk)("div",dd,[t[0]||(t[0]=(0,s.Lk)("h3",{class:"fs12 mb10"},"SW",-1)),(0,s.Lk)("ul",null,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(a.value,((e,t)=>((0,s.uX)(),(0,s.CE)("li",{key:t},[(0,s.Lk)("span",null,(0,n.v_)(e.key),1),(0,s.Lk)("span",null,(0,n.v_)(e.name),1)])))),128))])]),(0,s.Lk)("div",md,[t[1]||(t[1]=(0,s.Lk)("h3",{class:"fs12 mb10"},"Engine",-1)),(0,s.Lk)("ul",null,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(l.value,((e,t)=>((0,s.uX)(),(0,s.CE)("li",{key:t},[(0,s.Lk)("span",null,(0,n.v_)(e.key),1),(0,s.Lk)("span",null,(0,n.v_)(e.name),1)])))),128))])])],64))}});const pd=vd;var gd=pd;const fd={class:"settingWrapDiv"},yd={class:"settingTabBtn"},bd=["onClick"],Id=["onClick"];var Cd=(0,s.pM)({__name:"index",setup(e){const t=(0,c.Pj)(),a=["Login/Account","Analysis/Database","Report","Quality Check","Version"],l=["Login/Account","Analysis/Database","Version"],i=(0,o.KR)(a[0]),r=(0,s.EW)((()=>t.state.commonModule.viewerCheck)),u=(0,o.KR)(!1),d=(0,o.KR)(""),m=(0,o.KR)(""),v=(0,s.EW)((()=>t.state.commonModule.beforeSettingFormattedString)),p=(0,s.EW)((()=>t.state.commonModule.afterSettingFormattedString)),g=(0,s.EW)((()=>t.state.commonModule.settingType)),f=(0,o.KR)(!1),y=(0,o.KR)(""),b=(0,o.KR)(a[0]),I=e=>{i.value!==e&&(b.value=e,v.value!==p.value?(f.value=!0,y.value=`${g.value} ${U.settingNotSaved}`):(i.value=b.value,sessionStorage.setItem("selectedTab",b.value)))},C={"Login/Account":Sc,"Analysis/Database":qr,Report:id,"Quality Check":ud,Version:gd},h={"Login/Account":Sc,Version:gd,"Analysis/Database":qr},k=sessionStorage.getItem("selectedTab");k&&a.includes(k)&&(i.value=k);const S=(0,s.EW)((()=>"viewer"===r.value?h[i.value]:C[i.value])),w=e=>{u.value=!0,d.value="success",m.value=e},N=e=>{u.value=!0,d.value="error",m.value=e},R=()=>{u.value=!1},L=async()=>{await t.dispatch("commonModule/setCommonInfo",{beforeSettingFormattedString:null}),await t.dispatch("commonModule/setCommonInfo",{afterSettingFormattedString:null}),i.value=b.value,f.value=!1},E=async()=>{f.value=!1;try{await Gr(g.value,JSON.parse(p.value)),await w(U.settingSaveSuccess)}catch(e){await N(U.settingSaveFailure)}};return(e,t)=>((0,s.uX)(),(0,s.CE)(s.FK,null,[(0,s.Lk)("div",fd,[(0,s.Lk)("ul",yd,["viewer"===r.value?((0,s.uX)(),(0,s.CE)(s.FK,{key:0},(0,s.pI)(l,(e=>(0,s.Lk)("li",{key:e,class:(0,n.C4)({activeTab:i.value===e}),onClick:t=>I(e)},(0,n.v_)(e),11,bd))),64)):((0,s.uX)(),(0,s.CE)(s.FK,{key:1},(0,s.pI)(a,(e=>(0,s.Lk)("li",{key:e,class:(0,n.C4)({activeTab:i.value===e}),onClick:t=>I(e)},(0,n.v_)(e),11,Id))),64))]),((0,s.uX)(),(0,s.Wv)((0,s.$y)(S.value),{class:"settingWrap"}))]),f.value?((0,s.uX)(),(0,s.Wv)(ra,{key:0,"is-visible":f.value,type:"setting",message:y.value,onHide:L,onOkConfirm:E},null,8,["is-visible","message"])):(0,s.Q3)("",!0),u.value?((0,s.uX)(),(0,s.Wv)(Pt,{key:1,"is-visible":u.value,type:d.value,message:m.value,onHide:R,"onUpdate:hideAlert":R},null,8,["is-visible","type","message"])):(0,s.Q3)("",!0)],64))}});const hd=Cd;var kd=hd;const Sd=Z(),wd=async e=>Sd.httpPost(ee.settings.runningInfo.create,e),Nd=async e=>Sd.httpPut(ee.settings.runningInfo.update,e,"",!0),Rd=async e=>{const t=Object.entries(e).filter((([e,t])=>void 0!==t)).map((([e,t])=>`${encodeURIComponent(e)}=${encodeURIComponent(String(t))}`)).join("&");return Sd.httpGet(ee.settings.runningInfo.get,`${t}`,!0)},Ld=async e=>Sd.httpDelete(ee.settings.runningInfo.delete,e,!0),Ed=async e=>Sd.httpGet(ee.settings.runningInfo.detail,`${e}`,!1),_d=async e=>Sd.httpGet(ee.settings.runningInfo.pageUpDown,`${e}`,!0),Pd=async e=>Sd.httpGet(ee.settings.runningInfo.updatePcIpState,`${e}`,!0),Td=async e=>Sd.httpGet(ee.settings.runningInfo.clearPcIpState,`${e}`,!0),Ad=async()=>Sd.httpGet(ee.settings.runningInfo.removePageAllData,"",!0);a(4603),a(7566),a(8721);var Md=a(3075);const Dd=e=>isNaN(e)?0:e,xd=(e,t)=>{const a=["NR","AR","GP","PA","MC","MA"];let l=0;t.forEach((e=>{Number(e.count)>0&&!a.includes(e.title)&&(l+=Number(e.count))}));let s=null,o=0;return t.forEach(((e,n)=>{let i=Number((Number(e.count)/l*100).toFixed(0));const r=Number((Number(e.count)/l*100).toFixed(2));("BL"===e.title||["LA","IM","MB","AM"].includes(e.title))&&Number(e.count)>0&&r>=0&&r<=1&&(i=1),e.percent=i,a.includes(e.title)||(o+=Number(e.percent),(null===s||Number(s.count)<Number(e.count))&&(s=e)),null!==s&&n+1===t.length&&(s.percent=Number(s.percent)+(100-o))})),t},Od=(e,t)=>{const a=e.filter((e=>"Neutrophil"!==e.name)).map((e=>Math.round(parseFloat(e.percent))||0)).reduce(((e,t)=>e+Number(t)),0);return t.map((e=>"Neutrophil"===e.name?{...e,percent:100-a}:{...e,percent:Math.round(parseFloat(e.percent))}))},Kd=(e,t)=>"bm"===e?t.map((e=>0<parseFloat(e.percent)&&parseFloat(e.percent)<100&&parseFloat(e.percent)%1===0?{...e,percent:Number(e.percent).toFixed(1)}:e)):t,Bd=(e,t)=>{const a=["NR","GP","PA","MA","AR","SM"],l=e.map((e=>{let l=0;return l=Number(e.count)&&"NR"===e.title?Math.ceil(Number(e.count)/Number(t)*100):a.includes(e.title)&&Number(e.count)?Math.round(Number(e.count)/Number(t)*100):Number(e.percent)||0,{...e,percent:l}})),s=l.filter((e=>!a.includes(e.title))),o=Fd(s);return e.map((e=>{const t=o.find((t=>t.title===e.title));return t?{...e,percent:t.percent}:l.find((t=>e.title===t.title))}))},Fd=e=>{const t=e.map((e=>Math.round(e.percent))),a=t.reduce(((e,t)=>e+t),0),l=100-a;if(0!==l){const a=e.map(((e,t)=>({index:t,decimal:e.percent-Math.floor(e.percent)})));a.sort(((e,t)=>t.decimal-e.decimal));for(let e=0;e<Math.abs(l);e++){const s=a[e%a.length].index;t[s]+=l>0?1:-1}}for(let s=0;s<e.length;s++)e[s].percent=t[s];return e},Ud={class:"moveImgIsBool"},Xd={style:{"font-size":"0.8rem",width:"900px",height:"90%","overflow-y":"auto",background:"#fff",color:"#000",position:"absolute",top:"10%",left:"33%","box-sizing":"border-box",padding:"3rem 7rem",border:"2px solid #ccc","border-radius":"10px","z-index":"9999"}},$d={style:{margin:"10px 0","font-size":"1.2rem","font-weight":"600","text-align":"center"}},Wd={style:{display:"flex","flex-direction":"column","justify-content":"space-between"}},Hd={style:{width:"100%","font-size":"0.8rem"}},Gd={style:{"padding-bottom":"5px"}},Yd={style:{"text-align":"left",padding:"5px 0"}},Vd={style:{"padding-bottom":"5px"}},jd={style:{"text-align":"left",padding:"5px 0"}},Qd={style:{"padding-bottom":"5px"}},qd={style:{"text-align":"left",padding:"5px 0"}},Jd={style:{"padding-bottom":"5px"}},zd={style:{"text-align":"left",padding:"5px 0"}},Zd={style:{"padding-bottom":"5px"}},em={style:{"text-align":"left",padding:"5px 0"}},tm={style:{"padding-bottom":"5px"}},am={style:{"text-align":"left",padding:"5px 0"}},lm={style:{"padding-bottom":"5px"}},sm={style:{"text-align":"left",padding:"5px 0"}},om={style:{"padding-bottom":"5px"}},nm={style:{"text-align":"left",padding:"5px 0"}},im={key:0,style:{"margin-top":"20px","border-top":"2px dotted #696969"}},rm={key:1,style:{"margin-top":"20px"}},cm={style:{width:"100%","font-size":"0.8rem"}},um=["rowspan"],dm={style:{"text-align":"left"}},mm={style:{"text-align":"left"}},vm={style:{"text-align":"left"}},pm={style:{"text-align":"left"}},gm={style:{"text-align":"left"}},fm={style:{"text-align":"left"}},ym={style:{"text-align":"left"}},bm={style:{"text-align":"left"}},Im={key:0},Cm={style:{"text-align":"left"}},hm={style:{"text-align":"left"}},km={key:1},Sm={style:{"text-align":"left"}},wm={style:{"text-align":"left"}},Nm={key:0},Rm={style:{"text-align":"left","font-weight":"bold"}},Lm={style:{"text-align":"left","font-weight":"bold"}},Em={key:1},_m={style:{"text-align":"left","font-weight":"bold"}},Pm={style:{"text-align":"left","font-weight":"bold"}},Tm={style:{"text-align":"left",padding:"15px 0"},colspan:"2"},Am={style:{"text-align":"left","padding-top":"15px"},colspan:"4"},Mm={style:{"text-align":"left",outline:"1px solid #252629",padding:"4px"}},Dm={style:{"margin-top":"150px","margin-bottom":"50px","border-top":"2px dotted #696969"}},xm={style:{margin:"10px 0","font-size":"1.2rem","font-weight":"600","text-align":"center"}},Om={style:{width:"100%","font-size":"0.8rem"}},Km={style:{"text-align":"left",padding:"5px 0"}},Bm={style:{"text-align":"left",padding:"5px 0"}},Fm={style:{"text-align":"left",padding:"5px 0"}},Um={style:{"padding-bottom":"5px"}},Xm={style:{"text-align":"left",padding:"5px 0"}},$m={key:0,style:{"text-align":"left","padding-top":"30px","font-weight":"bold"}},Wm={key:0,style:{"padding-top":"5px","padding-bottom":"15px"}},Hm={style:{"text-align":"left",padding:"5px 0",width:"30%"}},Gm={style:{"text-align":"left",padding:"5px 0",width:"45%"}},Ym={style:{"padding-bottom":"5px"}},Vm={colspan:"2",style:{"text-align":"left",padding:"5px 0"}},jm={style:{"text-align":"left",outline:"1px solid #252629",padding:"4px"}},Qm={class:"print",style:{"list-style":"none","padding-left":"0","margin-top":"20px","text-align":"center",display:"flex","flex-direction":"column","align-items":"center","justify-content":"center"}},qm={style:{"font-weight":"bold","font-size":"18px",margin:"10px auto 20px"}},Jm={style:{position:"relative","text-align":"left"}},zm=["src","width","height","onError"];var Zm=(0,s.pM)({__name:"print",emits:["printClose"],setup(e,{emit:t}){const a=window.PROJECT_TYPE,i=(0,c.Pj)(),r=(0,s.EW)((()=>i.state.commonModule.viewerCheck)),u="viewer"===r.value?window.MAIN_API_IP:window.APP_API_BASE_URL,d=(0,o.KR)(null),m=(0,o.KR)([]),g=(0,s.EW)((()=>i.state.commonModule.iaRootPath)),b=(0,s.EW)((()=>i.state.commonModule.siteCd)),C=(0,s.EW)((()=>i.state.slideDataModule)),h=(0,o.KR)(null),k=(0,o.KR)({}),S=(0,o.KR)([]),w=t,N=["12","13","14","15","16"],R=(0,o.KR)([]),L=(0,o.KR)(0),E=(0,o.KR)(0),_=(0,o.KR)(0),P=(0,o.KR)(0),T=(0,o.KR)(0),A=(0,o.KR)(0),M=(0,o.KR)(0),D=(0,o.KR)(0),x=(0,o.KR)(!1);(0,s.sV)((async()=>{await G(),await H(),await J(),"bm"!==a&&(await B(),await O()),await q()}));const O=async()=>{const e=await K();D.value=e?.artifact+e?.doubleNormal},K=async()=>{const e=""!==h.value?.img_drive_root_path&&h.value?.img_drive_root_path?h.value?.img_drive_root_path:g.value,t=`${e}/${h.value?.slotId}/${aa.RBC_CLASS}/${h.value?.slotId}.json`,a=await Ro({fullPath:t}),l=a.data[0].rbcClassList,s={artifact:0,doubleNormal:0};if(l)return l.forEach((e=>{if("03"===e.categoryId)for(const t of e.classInfo)"Artifact"===t.classNm?s.artifact+=1:"DoubleNormal"===t.classNm&&(s.doubleNormal+=1)})),s},B=async()=>{const e=""!==h.value?.img_drive_root_path&&h.value?.img_drive_root_path?h.value?.img_drive_root_path:g.value,t=`${e}/${h.value?.slotId}/${aa.RBC_CLASS}/${h.value?.slotId}_new.json`,a=await Ro({fullPath:t}),l=`${e}/${h.value?.slotId}/${aa.RBC_CLASS}/${h.value?.slotId}.json`,s=await Ro({fullPath:l});if("not file"!==a.data){const e=a?.data;for(const t of s.data[0].rbcClassList)for(const a of e){const e=t.classInfo.findIndex((e=>Number(e.index)===Number(a.index)));if(-1!==e&&t.classInfo.splice(e,1),t.categoryId===a.categoryId){let e={classNm:a.classNm,classId:a.classId,posX:String(a.posX),posY:String(a.posY),width:a.width,height:a.height,index:a.index};t.classInfo.push(e)}}R.value=s.data[0].rbcClassList}else R.value=s?.data[0].rbcClassList;if(!R.value||!Array.isArray(R.value))return void console.error("rbcInfoPathAfter.value is not iterable");let o=0,n=0,i=0,r=0;D.value=0,R.value.forEach((e=>{const t=e.classInfo.length>0?e.classInfo[e.classInfo.length-1].index.replace(/[^\d]/g,""):"";switch(e.categoryId){case v.SIZE.CATEGORY_ID:o=t;break;case v.CHROMIA.CATEGORY_ID:n=t;break;case v.SHAPE.CATEGORY_ID:i=t;for(const t of e.classInfo)p.includes(t.classId)||(D.value+=1);break;case v.INCLUSION_BODY.CATEGORY_ID:r=t;break;default:break}})),L.value=Number(o)+1,E.value=Number(o)+1,_.value=n,P.value=Number(i)+Number(r)+2,h.value.rbcInfoAfter.forEach((e=>{e.classInfo.forEach((e=>{e.originalDegree=0}))})),R.value.forEach((e=>{const t=h.value.rbcInfoAfter.find((t=>t.categoryId===e.categoryId));t&&e.classInfo.forEach((e=>{const a=t.classInfo.find((t=>t.classId===e.classId));a&&a.originalDegree++}))})),await W()},F=(0,o.KR)({}),U=(e,t)=>{F.value[`${e}-${t}`]=!0},X=(e,t)=>{const a=(Number(e)/$(t)*100).toFixed(1);return Number(a)===Math.floor(Number(a))?Math.floor(Number(a)).toString():a},$=e=>{switch(e){case v.SIZE.CATEGORY_ID:return Number(L.value);case v.CHROMIA.CATEGORY_ID:return Number(_.value);case v.SHAPE.CATEGORY_ID:case v.INCLUSION_BODY.CATEGORY_ID:return Number(P.value);default:return Number(L.value)}},W=async()=>{let e=0,t=0;for(const a of R.value){if("01"===a.categoryId){const e=a.classInfo[a.classInfo.length-1].index;T.value=Number(e.replace("S",""))+1}if("04"===a.categoryId)for(const t of a.classInfo)"Platelet"===t.classNm&&(e+=1);else if("05"===a.categoryId)for(const e of a.classInfo)"Malaria"===e.classNm&&(t+=1)}A.value=Math.floor(e/parseFloat(T.value)*1e3),M.value=t},H=async()=>{try{const e=await He();e&&(0===e?.data.length?k.value=[]:k.value=e.data.sort(((e,t)=>Number(e.orderIdx)-Number(t.orderIdx))))}catch(e){console.error(e)}},G=async()=>{try{h.value=C.value,m.value=C.value.wbcInfoAfter}catch(e){console.error(e)}},Y=(e,t)=>"nonWbc"===t?e.filter((e=>N.includes(e.id)&&e.count>0)):e.filter((e=>!N.includes(e.id)&&e.count>0));function j(e,t,l){const s=[...S.value].find((e=>e===String(t)));if(!s)return"";if(!m.value||0===m.value.length)return"";const o=""!==h.value.img_drive_root_path&&h.value.img_drive_root_path?h.value.img_drive_root_path:g.value,n=h.value.slotId||"",i="bm"===a?`${o}/${n}/04_BM_Classification/${t}_${l}`:`${o}/${n}/01_WBC_Classification/${t}_${l}`;return`${u}/images/print?folder=${i}&imageName=${e}`}const Q=e=>e.filter((e=>[...S.value].includes(String(e.id)))),q=async()=>{x.value=!0,cn(),Z();try{const e=d.value;if(!e)throw new Error("프린트할 내용을 찾을 수 없습니다.");const t=Md.Ay.gzip(e.innerHTML,{level:9}),a=await fetch(`${u}/pdf/convert`,{method:"POST",headers:{"Content-Type":"application/octet-stream","Content-Encoding":"gzip"},body:t});if(!a.ok)throw new Error("HTML을 PDF로 변환하는데 실패했습니다.");const l=await a.blob(),s=window.URL.createObjectURL(l),o=/Edg/.test(navigator.userAgent);if(o){const e=document.createElement("a");e.href=s,e.download=`${h.value.barcodeNo}-report`,document.body.appendChild(e),e.click(),document.body.removeChild(e)}else window.open(s,"_blank","width=800,height=500,noopener,noreferrer");window.URL.revokeObjectURL(s),x.value=!1}catch(e){console.error("Error:",e),x.value=!1}finally{un()}},J=async()=>{try{const e=await ke();if(e&&e.data){const t=e.data;S.value=t.filter((e=>e.checked)).map((e=>e.classId)),m.value=m.value.filter((e=>"0"!==e.count));const l=k.value.sort(((e,t)=>Number(e.orderIdx)-Number(t.orderIdx))),s=0!==k.value.length?l:"bm"===a?za:Ja,o=await z(m.value,s);m.value=o,Z()}}catch(e){console.error(e)}},z=(e,t)=>{let a=e.slice();return a.sort(((e,a)=>{const l=t.findIndex((t=>(t.title||t.abbreviation)===(e.title||e.abbreviation))),s=t.findIndex((e=>(e.title||e.abbreviation)===(a.title||a.abbreviation)));return-1===l?1:-1===s?-1:l-s})),e.splice(0,e.length,...a)},Z=async()=>{b.value===I["서울성모병원"]?m.value=Od(m.value,m.value):b.value===I["인하대병원"]?m.value=await xd(h.value,m.value):b.value===I["인천성모병원"]?m.value=Kd(a,m.value):b.value===I["인천길병원"]&&(m.value=Bd(m.value,h.value?.wbcInfo.totalCount))},ee=()=>{w("printClose")};return(e,t)=>((0,s.uX)(),(0,s.CE)(s.FK,null,[(0,s.bo)((0,s.Lk)("div",Ud," Loading Print...",512),[[l.aG,x.value]]),(0,s.Lk)("div",Xd,[(0,s.Lk)("button",{style:{position:"absolute",right:"8px",background:"none",border:"1px solid #000","border-radius":"5px",padding:"7px 25px",top:"5px",cursor:"pointer"},onClick:ee},"Close "),(0,s.Lk)("div",{ref_key:"printContent",ref:d,style:{"margin-top":"20px"}},[(0,s.Lk)("div",null,[(0,s.Lk)("h3",$d,"Analysis Report from UIMD "+(0,n.v_)("bm"===(0,o.R1)(a)?"BM":"PB")+" system",1)]),(0,s.Lk)("div",Wd,[(0,s.Lk)("table",Hd,[t[8]||(t[8]=(0,s.Lk)("colgroup",null,[(0,s.Lk)("col",{style:{width:"30%"}}),(0,s.Lk)("col",{style:{width:"70%"}})],-1)),(0,s.Lk)("tbody",null,[(0,s.Lk)("tr",Gd,[t[0]||(t[0]=(0,s.Lk)("th",{style:{"text-align":"left",padding:"5px 0"}},"Slot ID",-1)),(0,s.Lk)("td",Yd,(0,n.v_)(h.value?.slotId),1)]),(0,s.Lk)("tr",Vd,[t[1]||(t[1]=(0,s.Lk)("th",{style:{"text-align":"left",padding:"5px 0"}},"Ordered date",-1)),(0,s.Lk)("td",jd,(0,n.v_)((0,o.R1)(V)(h.value?.orderDttm)),1)]),(0,s.Lk)("tr",Qd,[t[2]||(t[2]=(0,s.Lk)("th",{style:{"text-align":"left",padding:"5px 0"}},"Signed by ID",-1)),(0,s.Lk)("td",qd,(0,n.v_)(h.value?.submitUserId),1)]),(0,s.Lk)("tr",Jd,[t[3]||(t[3]=(0,s.Lk)("th",{style:{"text-align":"left",padding:"5px 0"}},"Signed date",-1)),(0,s.Lk)("td",zd,(0,n.v_)(h.value?.submitOfDate),1)]),(0,s.Lk)("tr",Zd,[t[4]||(t[4]=(0,s.Lk)("th",{style:{"text-align":"left"}},"Ordered Classification",-1)),(0,s.Lk)("td",em,(0,n.v_)("pb"===(0,o.R1)(a)?(0,o.R1)(f)(h.value?.testType):(0,o.R1)(y)(h.value?.testType)),1)]),(0,s.Lk)("tr",tm,[t[5]||(t[5]=(0,s.Lk)("th",{style:{"text-align":"left",padding:"5px 0"}},"Name",-1)),(0,s.Lk)("td",am,(0,n.v_)(h.value?.patientName),1)]),(0,s.Lk)("tr",lm,[t[6]||(t[6]=(0,s.Lk)("th",{style:{"text-align":"left",padding:"5px 0"}},"Birth",-1)),(0,s.Lk)("td",sm,(0,n.v_)(h.value?.birthDay),1)]),(0,s.Lk)("tr",om,[t[7]||(t[7]=(0,s.Lk)("th",{style:{"text-align":"left",padding:"5px 0"}},"Gender",-1)),(0,s.Lk)("td",nm,(0,n.v_)(""===h.value?.gender?"":"01"===h.value?.gender?"Male":"Female"),1)])])]),"04"===h.value?.testType?((0,s.uX)(),(0,s.CE)("div",im)):(0,s.Q3)("",!0),"04"===h.value?.testType?((0,s.uX)(),(0,s.CE)("div",rm,[t[25]||(t[25]=(0,s.Lk)("h3",{style:{margin:"10px 0","font-size":"1.2rem","font-weight":"600","text-align":"center"}},"RBC classification result",-1)),(0,s.Lk)("table",cm,[t[23]||(t[23]=(0,s.Lk)("colgroup",null,[(0,s.Lk)("col",{style:{width:"20%"}}),(0,s.Lk)("col",{style:{width:"25%"}}),(0,s.Lk)("col",{style:{width:"25%"}}),(0,s.Lk)("col",{style:{width:"15%"}}),(0,s.Lk)("col",{style:{width:"15%"}})],-1)),t[24]||(t[24]=(0,s.Lk)("thead",null,[(0,s.Lk)("tr",{style:{"margin-bottom":"15px","font-size":"18px","font-weight":"normal","padding-bottom":"100px"}},[(0,s.Lk)("th",{style:{"text-align":"left"}},"Category"),(0,s.Lk)("th",{style:{"text-align":"left"}},"Class"),(0,s.Lk)("th",{style:{"text-align":"left"}},"Degree"),(0,s.Lk)("th",{style:{"text-align":"left"}},"Count"),(0,s.Lk)("th",{style:{"text-align":"left"}},"Percent")])],-1)),(0,s.Lk)("tbody",null,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)([h.value.rbcInfoAfter],((e,a)=>((0,s.uX)(),(0,s.CE)(s.FK,{key:a},[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(e,((e,a)=>((0,s.uX)(),(0,s.CE)(s.FK,{key:a},[(0,s.Lk)("tr",null,[(0,s.Lk)("td",{rowspan:e.classInfo.length+("Shape"!==e.categoryNm?1:0),style:{"text-align":"left","vertical-align":"top"}},(0,n.v_)(e.categoryNm),9,um),(0,s.Lk)("td",dm,(0,n.v_)(e.classInfo[0]?.classNm),1),(0,s.Lk)("td",mm,(0,n.v_)(e.classInfo[0]?.degree),1),(0,s.Lk)("td",vm,(0,n.v_)(e.classInfo[0]?.originalDegree),1),(0,s.Lk)("td",pm,(0,n.v_)(X(e.classInfo[0]?.originalDegree,(0,o.R1)(v).SIZE.CATEGORY_ID)),1)]),((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(e.classInfo.slice(1),((a,l)=>((0,s.uX)(),(0,s.CE)(s.FK,{key:l},[(0,s.Lk)("tr",null,[(0,s.Lk)("td",gm,(0,n.v_)(a.classNm),1),(0,s.Lk)("td",fm,(0,n.v_)(a.degree),1),(0,s.Lk)("td",ym,(0,n.v_)(a.originalDegree),1),(0,s.Lk)("td",bm,(0,n.v_)(X(a.originalDegree,(0,o.R1)(v).CHROMIA.CATEGORY_ID)),1)]),"Shape"===e.categoryNm&&l===e.classInfo.slice(1).length-1?((0,s.uX)(),(0,s.CE)("tr",Im,[t[9]||(t[9]=(0,s.Lk)("td",null,null,-1)),t[10]||(t[10]=(0,s.Lk)("td",{style:{"text-align":"left"}},"Others",-1)),t[11]||(t[11]=(0,s.Lk)("td",{style:{"text-align":"left"}},"-",-1)),(0,s.Lk)("td",Cm,(0,n.v_)(D.value),1),(0,s.Lk)("td",hm,(0,n.v_)(X(D.value,(0,o.R1)(v).SHAPE.CATEGORY_ID))+" %",1)])):(0,s.Q3)("",!0),"Inclusion Body"===e.categoryNm&&l===e.classInfo.slice(1).length-1?((0,s.uX)(),(0,s.CE)("tr",km,[t[12]||(t[12]=(0,s.Lk)("td",{style:{"text-align":"left"}},"Malaria",-1)),t[13]||(t[13]=(0,s.Lk)("td",{style:{"text-align":"left"}},"-",-1)),(0,s.Lk)("td",Sm,(0,n.v_)(M.value),1),(0,s.Lk)("td",wm,(0,n.v_)(X(M.value,(0,o.R1)(v).INCLUSION_BODY.CATEGORY_ID)),1)])):(0,s.Q3)("",!0)],64)))),128)),"Shape"!==e.categoryNm&&"Inclusion Body"!==e.categoryNm?((0,s.uX)(),(0,s.CE)("tr",Nm,[t[14]||(t[14]=(0,s.Lk)("td",{style:{"text-align":"left"}},null,-1)),t[15]||(t[15]=(0,s.Lk)("td",{style:{"text-align":"left","font-weight":"bold"}},"Total",-1)),(0,s.Lk)("td",Rm,(0,n.v_)(E.value),1),(0,s.Lk)("td",Lm,(0,n.v_)(X(E.value,(0,o.R1)(v).INCLUSION_BODY.CATEGORY_ID))+" %",1)])):(0,s.Q3)("",!0),"Inclusion Body"==e.categoryNm?((0,s.uX)(),(0,s.CE)("tr",Em,[t[16]||(t[16]=(0,s.Lk)("td",null,null,-1)),t[17]||(t[17]=(0,s.Lk)("td",null,null,-1)),t[18]||(t[18]=(0,s.Lk)("td",{style:{"text-align":"left","font-weight":"bold"}},"Total",-1)),(0,s.Lk)("td",_m,(0,n.v_)(P.value),1),(0,s.Lk)("td",Pm,(0,n.v_)(X(P.value,(0,o.R1)(v).INCLUSION_BODY.CATEGORY_ID))+" %",1)])):(0,s.Q3)("",!0)],64)))),128))],64)))),128)),(0,s.Lk)("tr",null,[t[19]||(t[19]=(0,s.Lk)("th",{style:{"text-align":"left",padding:"15px 0"}},"Others",-1)),t[20]||(t[20]=(0,s.Lk)("th",{style:{"text-align":"left",padding:"15px 0"}},"Platelets",-1)),t[21]||(t[21]=(0,s.Lk)("th",null,null,-1)),(0,s.Lk)("th",Tm,(0,n.v_)(A.value)+" PLT / 1000 RBC",1)]),(0,s.Lk)("tr",null,[t[22]||(t[22]=(0,s.Lk)("th",{style:{"text-align":"left","padding-top":"15px"}},"Comment",-1)),(0,s.bo)((0,s.Lk)("th",Am,[(0,s.Lk)("pre",Mm,(0,n.v_)(h.value?.rbcMemo),1)],512),[[l.aG,h.value?.rbcMemo]])])])])])):(0,s.Q3)("",!0),(0,s.Lk)("div",Dm,[(0,s.Lk)("h3",xm,(0,n.v_)("pb"===(0,o.R1)(a)?"WBC":"BM")+" classification result",1),(0,s.Lk)("table",Om,[t[30]||(t[30]=(0,s.Lk)("colgroup",null,[(0,s.Lk)("col",{style:{width:"30%"}}),(0,s.Lk)("col",{style:{width:"45%"}}),(0,s.Lk)("col",{style:{width:"25%"}})],-1)),t[31]||(t[31]=(0,s.Lk)("thead",null,[(0,s.Lk)("tr",{style:{"margin-bottom":"15px","font-size":"18px","font-weight":"normal","padding-bottom":"100px"}},[(0,s.Lk)("th",{style:{"text-align":"left"}},"Class"),(0,s.Lk)("th",{style:{"text-align":"left"}},"Count"),(0,s.Lk)("th",{style:{"text-align":"left"}},"Percent")])],-1)),(0,s.Lk)("tbody",null,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(Y(m.value,"wbc"),(e=>((0,s.uX)(),(0,s.CE)("tr",{key:e.id,style:{"padding-bottom":"5px"}},[(0,s.Lk)("th",Km,(0,n.v_)(e?.name),1),(0,s.Lk)("td",Bm,(0,n.v_)(e?.count),1),(0,s.Lk)("td",Fm,(0,n.v_)(e?.percent)+" %",1)])))),128)),(0,s.Lk)("tr",Um,[t[26]||(t[26]=(0,s.Lk)("th",{style:{"text-align":"left","font-weight":"bold",padding:"5px 0"}},"Total",-1)),(0,s.Lk)("td",Xm,(0,n.v_)(h.value?.wbcInfo?.totalCount),1),t[27]||(t[27]=(0,s.Lk)("td",{style:{"text-align":"left",padding:"5px 0"}},"100.00%",-1))]),"bm"!==(0,o.R1)(a)?((0,s.uX)(),(0,s.CE)("th",$m,"non-Wbc")):(0,s.Q3)("",!0),((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(Y(m.value,"nonWbc"),(e=>((0,s.uX)(),(0,s.CE)(s.FK,{key:e.id},["bm"!==(0,o.R1)(a)?((0,s.uX)(),(0,s.CE)("tr",Wm,[(0,s.Lk)("td",Hm,(0,n.v_)(e.name),1),(0,s.Lk)("td",Gm,(0,n.v_)(e.count),1),t[28]||(t[28]=(0,s.Lk)("td",{style:{"text-align":"left",padding:"5px 0",width:"25%"}},"-",-1))])):(0,s.Q3)("",!0)],64)))),128)),(0,s.Lk)("tr",Ym,[t[29]||(t[29]=(0,s.Lk)("th",{style:{"text-align":"left",padding:"15px 0"}},"Comment",-1)),(0,s.bo)((0,s.Lk)("td",Vm,[(0,s.Lk)("pre",jm,(0,n.v_)(h.value?.wbcMemo),1)],512),[[l.aG,h.value?.wbcMemo]])])])]),(0,s.Lk)("ul",Qm,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(Q(m.value),(e=>((0,s.uX)(),(0,s.CE)("li",{key:e.id,style:{}},[(0,s.Lk)("div",qm,(0,n.v_)(e?.title)+" ("+(0,n.v_)(e?.count)+") ",1),(0,s.Lk)("ul",{class:(0,n.C4)("wbcImgWrap "+e?.title),style:{"list-style":"none","padding-left":"0","margin-top":"10px","text-align":"left"}},[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(e.images,(t=>((0,s.uX)(),(0,s.CE)("li",{key:t.fileName,style:{display:"inline-block","margin-right":"5px","margin-top":"5px",outline:"1px solid #2c2d2c",cursor:"auto"}},[(0,s.Lk)("div",Jm,[F.value[`${e.id}-${t.fileName}`]?(0,s.Q3)("",!0):((0,s.uX)(),(0,s.CE)("img",{key:0,src:j(t.fileName,e.id,e.title),width:t.width?t.width:"150px",height:t.height?t.height:"150px",onError:a=>U(e.id,t.fileName),style:(0,n.Tr)({filter:t.filter}),class:"cellImg",ref_for:!0,ref:"cellRef"},null,44,zm)),(0,s.Lk)("div",{class:"center-point",style:(0,n.Tr)(t.coordinates)},null,4)])])))),128))],2)])))),128))])])])],512)])],64))}});const ev=Zm;var tv=ev,av=a(1186),lv=a(6679);const sv=lv.J1`
    query GetRunningInfoById($id: Int!) {
        getRunningInfoByIdGQL(id: $id) {
            id
            lock_status
            traySlot
            slotNo
            barcodeNo
            patientId
            patientNm
            gender
            birthDay
            wbcCount
            slotId
            orderDttm
            testType
            analyzedDttm
            tactTime
            maxWbcCount
            cassetId
            isNormal
            wbcInfo {
                wbcInfo {
                    id
                    name
                    count
                    title
                    images {
                        coordinates {
                            display
                        }
                        fileName
                        title
                        filter
                        height
                        width
                    }
                    percent
                }
                totalCount
                maxWbcCount
            }
            wbcInfoAfter {
                id
                name
                count
                title
                images {
                    coordinates {
                        display
                    }
                    fileName
                    title
                    filter
                    height
                    width
                }
                percent
            }
            rbcInfo {
                rbcClass {
                    classInfo {
                        classId
                        classNm
                        degree
                        originalDegree
                    }
                    categoryId
                    categoryNm
                }
                malariaCount
                maxRbcCount
                pltCount
            }
            rbcInfoAfter {
                classInfo {
                    classId
                    classNm
                    degree
                    originalDegree
                    percent
                }
                categoryId
                categoryNm
            }
            submitState
            submitOfDate
            submitUserId
            isNsNbIntegration
            wbcMemo
            rbcMemo
            pcIp
            cbcPatientNo
            cbcPatientNm
            cbcSex
            cbcAge
            img_drive_root_path
            hosName
            abnormalClassInfo {
                classNm
                val
            }
            isAllClassesChecked
        }
    }
`;function ov(e,t={}){const a=(0,o.KR)(e),l=(0,o.Kh)(t);return av.IT(sv,a,l)}const nv={key:0,class:"loaderBackground"},iv={style:{position:"sticky",top:"0"}},rv={key:0},cv=["onClick","onDblclick","data-row-id","onContextmenu"],uv=["onMouseenter","onMouseleave"],dv={key:1},mv={class:"abnormalClassInfoPopup"},vv=["onClick"],pv=["onUpdate:modelValue","checked"],gv={key:1},fv={class:"text-center"},yv={colspan:"13"},bv={class:"nodataimg"},Iv={class:"editOrder"},Cv={class:"flex-column mr12"},hv={class:"flex-column mr12"},kv={class:"flex-column mr12"},Sv={class:"flex-column mr12"},wv={class:"flex-column mr12"},Nv={class:"flex-column mr12"},Rv={class:"flex-column mr12"},Lv={key:0},Ev=["src"];var _v={__name:"listTable",props:["dbData","selectedItemIdFalse","notStartLoading","loadingDelayParents"],setup(e,{emit:t}){const a=e,i=(0,o.KR)(null),r=t,u=(0,o.KR)(""),d=(0,o.KR)(!1),m=(0,o.KR)({}),v=(0,c.Pj)(),p=(0,s.EW)((()=>v.state.userModule)),g=(0,o.KR)(""),I=(0,o.KR)(!1),C=(0,o.KR)(""),h=(0,o.KR)(""),k=(0,o.KR)(""),S=(0,o.KR)(!1),w=((0,o.KR)(!1),e=>{const t=W()(e,"YYYYMMDDHHmmss");return t.format("YYYY-MM-DD HH:mm:ss")}),N=(0,o.KR)(!1),R=(0,o.KR)(""),L=(0,o.KR)({visible:!1,x:0,y:0}),E=(0,o.KR)([]),_=sessionStorage.getItem("user"),P=JSON.parse(_||"{}"),T=(0,o.KR)(""),A=(0,o.KR)({}),M=(0,o.KR)(!1),D=(0,o.KR)(null),x=(0,o.KR)([]),O=(0,o.KR)(!1),K=(0,s.nI)(),B=(0,o.KR)(""),F=(0,s.EW)((()=>v.state.commonModule.iaRootPath)),X=(0,s.EW)((()=>v.state.commonModule.selectedSampleId)),$=(0,s.EW)((()=>v.state.commonModule)),H=(0,o.KR)(!1),G=(0,o.KR)(!1),Y=(0,o.KR)(""),V=(0,o.KR)("");let j;const Q=(0,o.KR)(null),q=(0,o.KR)(!1),J=(0,o.KR)([]),z=(0,o.KR)([]),Z=(0,o.KR)("");(0,s.KC)((()=>{g.value=window.PROJECT_TYPE})),(0,s.sV)((async()=>{k.value=JSON.parse(sessionStorage.getItem("pcIp"));try{T.value=P.id,await Se()}catch(e){console.error(e)}document.addEventListener("click",de),window.addEventListener("keydown",te),window.addEventListener("keyup",ae)}));const ee=(e,t)=>{Z.value=e?t:null};async function te(e){e.ctrlKey&&(H.value=!0),e.shiftKey&&(G.value=!0)}function ae(e){e.ctrlKey||(H.value=!1),e.shiftKey||(G.value=!1)}(0,s.hi)((()=>{document.removeEventListener("click",de)})),(0,s.wB)((()=>a.loadingDelayParents),(e=>{S.value=e})),(0,s.nT)((async()=>{try{if(a.dbData.length>0){await(0,s.dY)(),S.value=!1;const e=a.dbData.filter((e=>e.id===Number(X.value||0))),t=new IntersectionObserver(ge,{root:null,rootMargin:"0px",threshold:.5});if(i.value&&t.observe(i.value),"0"!==u.value&&u.value||(S.value=!1),!0===$.value.dataBasePageReset&&0!==e.length)return await Ie(e[0]),await v.dispatch("commonModule/setCommonInfo",{dataBasePageReset:!1}),void await ce()}}catch(e){console.error("Error during watchEffect execution:",e),S.value=!1}}));const le=()=>{M.value=!1},se=()=>{M.value=!0,ue()},oe=()=>{Le(A.value),ue()},ne=()=>{ke(A.value),ue()},re=()=>{a.dbData.forEach((e=>{e.checked=O.value})),r("checkListItem",a.dbData.filter((e=>e.checked)))},ce=()=>{a.dbData.forEach((e=>{e.checked=!1})),r("checkListItem",a.dbData.filter((e=>e.checked)))},ue=()=>{L.value.x=0,L.value.y=0,L.value.visible=!1},de=e=>{const t=document.querySelector(".context-menu");t&&!t.contains(e.target)&&ue()},me=async(e,t)=>{if(!1!==a.dbData.filter((t=>t.id===e.id)).lock_status){if(await v.dispatch("commonModule/setCommonInfo",{selectedSampleId:e.id}),A.value=e,0!==Object.keys(e?.wbcInfo).length){const t=e?.wbcInfo?.wbcInfo[0],a=t.sort(((e,t)=>e.id-t.id));x.value=a}t&&(L.value.x=t.clientX,L.value.y=t.clientY,L.value.visible=!0)}else fe(U.IDS_ERROR_SELECT_A_TARGET_ITEM)},ve=()=>{const e=Math.min(Number(Y.value),Number(V.value)),t=Math.max(Number(Y.value),Number(V.value)),l=a.dbData;l.forEach((a=>{const l=Number(a.id);l>=e&&l<=t&&(a.checked=!a.checked)})),r("checkListItem",a.dbData.filter((e=>e.checked)))},pe=e=>{e&&(e.checked=!e.checked,r("checkListItem",a.dbData.filter((e=>e.checked))))},ge=(e,t)=>{e.forEach((e=>{e.isIntersecting&&1!==e.intersectionRatio&&r("loadMoreData")}))},fe=e=>{I.value=!0,C.value="success",h.value=e},ye=e=>{I.value=!0,C.value="error",h.value=e},be=()=>{I.value=!1},Ie=async e=>{G.value?Y.value&&(V.value=e.id,ve()):V.value="",H.value&&pe(e),e&&(Y.value=e.id,r("selectItem",e),u.value=e.id,await v.dispatch("commonModule/setCommonInfo",{selectedSampleId:String(e.id)}))},Ce=async e=>{try{const t=await va(),a=t.data,l=sessionStorage.getItem("lastSearchParams")||localStorage.getItem("lastSearchParams")||"",{startDate:s,endDate:o,page:n,searchText:i,nrCount:r,testType:c,wbcInfo:u,wbcTotal:d}=JSON.parse(l),m=s+o+n+i+r+c+u+d,v=`oldPcIp=${a}&newEntityId=${e.id}&newPcIp=${a}&dayQuery=${m}`;await Pd(v).then((e=>{he("SEND_DATA","refreshDb",300)})).catch((e=>{console.error(e)}))}catch(t){console.error(t)}},he=(e,t,a)=>{void 0!==j&&clearTimeout(j),j=window.setTimeout((()=>{K?.appContext.config.globalProperties.$socket.emit("state",{type:"SEND_DATA",payload:"refreshDb"})}),a)},ke=async e=>{if(e.lock_status&&e?.pcIp!==k.value)return;await v.dispatch("commonModule/setCommonInfo",{selectedSampleId:e.id}),await v.dispatch("commonModule/setCommonInfo",{clonedRbcInfo:e.rbcInfo.rbcClass}),await Ce(e);const{result:t,loading:a,error:l}=ov({id:Number(e.id)},{fetchPolicy:"no-cache"});(0,s.wB)(t,(async e=>{e?(await v.dispatch("slideDataModule/updateSlideData",e?.getRunningInfoByIdGQL),await Pw.push("/databaseDetail")):console.log("No result")}))},Se=async()=>{try{const e=await ie(),t=e.data;E.value=t}catch(e){console.error(e)}},we=e=>{d.value=e},Ne=()=>{},Re=async()=>{try{const e={id:m.value.id,barcodeNo:m.value.barcodeNo,patientId:m.value.patientId,patientNm:m.value.patientNm},t=[...a.dbData],l=t.findIndex((e=>e.id===m.value.id));-1!==l&&(t[l]={...t[l],...e});const s=sessionStorage.getItem("lastSearchParams")||localStorage.getItem("lastSearchParams")||"",{startDate:o,endDate:n,page:i,searchText:c,nrCount:u,testType:d,wbcInfo:v,wbcTotal:g}=JSON.parse(s),f=o+n+i+c+u+d+v+g,y=await Nd({userId:Number(p.value.id),runingInfoDtoItems:[t[l]],dayQuery:f});y?(fe("Success"),r("initData"),we()):console.error("백엔드가 디비에 저장 실패함")}catch(e){console.error("Error:",e)}},Le=async e=>{Ee(),m.value=JSON.parse(JSON.stringify(e)),m.value.submitState=["","Ready","checkFirst"].includes(m.value.submitState)?"":m.value.submitState,m.value.testType="bm"!==g.value?f(e?.testType):y(e?.testType);const t=""!==e?.img_drive_root_path&&e?.img_drive_root_path?e?.img_drive_root_path:F.value;B.value=b("barcode_image.jpg",t,e.slotId,aa.BARCODE)},Ee=()=>{d.value=!0},_e=async e=>{console.log("selectedItems",e);try{if(""===u.value)ye(U.IDS_ERROR_SELECT_A_TARGET_ITEM);else{if(e.lock_status)return void ye(U.lockRow);const t=e.map((e=>e.id)),a=e.map((e=>{const t=""!==e?.img_drive_root_path&&e?.img_drive_root_path?e?.img_drive_root_path:sessionStorage.getItem("iaRootPath");return`${t}/${e.slotId}`})),l=sessionStorage.getItem("lastSearchParams")||localStorage.getItem("lastSearchParams")||"",{startDate:s,endDate:o,page:n,searchText:i,nrCount:c,testType:u,wbcInfo:d,wbcTotal:m}=JSON.parse(l),v=s+o+n+i+c+u+d+m,p=window.APP_API_BASE_URL.split(":"),g=`${p[0]}:${p[1]}`,f={ids:t,img_drive_root_path:a,dayQuery:v,apiUrl:g};S.value=!0;const y=await Ld(f);y.success?(fe("Items deleted successfully"),r("refresh")):console.error("Failed to delete items"),S.value=!1}}catch(t){console.error("Error:",t)}S.value=!1},Pe=(e,t)=>{switch(e){case"Ready":return"Ready";case"Submit":return`Submit (${t})`;case"lisCbc":return`LIS (${t})`;default:return"Ready"}},Te=()=>{q.value=!0},Ae=()=>{N.value=!1},Me=async()=>{N.value=!1,await _e(J.value)},De=()=>{N.value=!0,R.value="Would you want delete?",J.value=a.dbData.filter((e=>e.checked)),z.value=a.dbData.find((e=>e.id===u.value)),oc(J.value)&&(J.value=[z.value]),ue(),r("disableSelectItem")};return(t,a)=>{const r=(0,s.g2)("font-awesome-icon");return(0,s.uX)(),(0,s.CE)(s.FK,null,[S.value?((0,s.uX)(),(0,s.CE)("div",nv,a[8]||(a[8]=[(0,s.Lk)("div",{class:"loader"},null,-1),(0,s.Lk)("p",{class:"loadingText"},"Loading...",-1)]))):(0,s.Q3)("",!0),(0,s.Lk)("table",{class:"defaultTable mt20 dbDataTable",ref_key:"scrollableDiv",ref:Q},[a[22]||(a[22]=(0,s.Lk)("colgroup",null,[(0,s.Lk)("col",{width:"7%"}),(0,s.Lk)("col",{width:"2%"}),(0,s.Lk)("col",{width:"7%"}),(0,s.Lk)("col",{width:"4%"}),(0,s.Lk)("col",{width:"6%"}),(0,s.Lk)("col",{width:"8%"}),(0,s.Lk)("col",{width:"8%"}),(0,s.Lk)("col",{width:"8%"}),(0,s.Lk)("col",{width:"12%"}),(0,s.Lk)("col",{width:"10%"}),(0,s.Lk)("col",{width:"6%"}),(0,s.Lk)("col",{width:"12%"}),(0,s.Lk)("col",{width:"4%"})],-1)),(0,s.Lk)("thead",null,[(0,s.Lk)("tr",iv,[a[9]||(a[9]=(0,s.Lk)("th",null,"NO",-1)),(0,s.Lk)("th",null,[(0,s.bo)((0,s.Lk)("input",{type:"checkbox","onUpdate:modelValue":a[0]||(a[0]=e=>O.value=e),onChange:re},null,544),[[l.lH,O.value]])]),a[10]||(a[10]=(0,s.Lk)("th",null,"Type",-1)),a[11]||(a[11]=(0,s.Lk)("th",null,"State",-1)),a[12]||(a[12]=(0,s.Lk)("th",null,"Tray Slot",-1)),a[13]||(a[13]=(0,s.Lk)("th",null,"Barcode NO",-1)),a[14]||(a[14]=(0,s.Lk)("th",null,"Patient ID",-1)),a[15]||(a[15]=(0,s.Lk)("th",null,"Patient Name",-1)),a[16]||(a[16]=(0,s.Lk)("th",null,"Analyzed Date",-1)),a[17]||(a[17]=(0,s.Lk)("th",null,"Tact Time(sec)",-1)),a[18]||(a[18]=(0,s.Lk)("th",null,"Submit",-1)),a[19]||(a[19]=(0,s.Lk)("th",null,"Submit Date",-1)),a[20]||(a[20]=(0,s.Lk)("th",null,"Edit",-1))])]),0!==e.dbData.length?((0,s.uX)(),(0,s.CE)("tbody",rv,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(e.dbData,((e,t)=>((0,s.uX)(),(0,s.CE)("tr",{key:e.id,class:(0,n.C4)({selectedTr:u.value===e.id,submittedTr:"Submit"===e.submitState,lisTr:"lisCbc"===e.submitState,rock:e.lock_status&&e.pcIp!==k.value,checkFirst:"checkFirst"===e.submitState}),onClick:t=>Ie(e),onDblclick:t=>ke(e),ref_for:!0,ref:"firstRow",style:{height:"49px"},"data-row-id":e.id,onContextmenu:(0,l.D$)((t=>me(e,t)),["prevent"]),title:"Double click the row"},[(0,s.Lk)("td",{style:{position:"relative"},onMouseenter:t=>ee(!0,e.id),onMouseleave:t=>ee(!1,e.id)},["N"===e.isNormal?((0,s.uX)(),(0,s.Wv)(r,{key:0,class:"red isNotNormalIcon",icon:["fas","triangle-exclamation"]})):(0,s.Q3)("",!0),(0,s.eW)(" "+(0,n.v_)(t+1)+" ",1),Z.value!==e.id||"N"!==e.isNormal||(0,o.R1)(oc)(e.abnormalClassInfo)?(0,s.Q3)("",!0):((0,s.uX)(),(0,s.CE)("div",dv,[(0,s.Lk)("div",mv,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(e.abnormalClassInfo,((e,t)=>((0,s.uX)(),(0,s.CE)("div",{key:t},[(0,s.Lk)("span",null,(0,n.v_)(e.classNm)+" : "+(0,n.v_)(e.val),1)])))),128))])]))],40,uv),(0,s.Lk)("td",{onClick:t=>pe(e)},[(0,s.bo)((0,s.Lk)("input",{type:"checkbox","onUpdate:modelValue":t=>e.checked=t,checked:e.checked},null,8,pv),[[l.lH,e.checked]])],8,vv),(0,s.Lk)("td",null,(0,n.v_)("bm"!==g.value?(0,o.R1)(f)(e?.testType):(0,o.R1)(y)(e?.testType)),1),(0,s.Lk)("td",null,[(0,s.bF)(r,{icon:["fas",""+(e?.lock_status?"lock":"lock-open")]},null,8,["icon"])]),(0,s.Lk)("td",null,(0,n.v_)(e?.traySlot),1),(0,s.Lk)("td",null,(0,n.v_)(e?.barcodeNo),1),(0,s.Lk)("td",null,(0,n.v_)(e?.patientId),1),(0,s.Lk)("td",null,(0,n.v_)(e?.patientNm),1),(0,s.Lk)("td",null,(0,n.v_)(""===e?.analyzedDttm?"":w(e?.analyzedDttm)),1),(0,s.Lk)("td",null,(0,n.v_)(e?.tactTime),1),(0,s.Lk)("td",null,(0,n.v_)(Pe(e?.submitState,e?.submitUserId)),1),(0,s.Lk)("td",null,(0,n.v_)(""!==e?.submitOfDate&&e?.submitOfDate?w(e?.submitOfDate):""),1),(0,s.Lk)("td",null,["checkFirst"!==e?.submitState&&""!==e?.submitState&&e?.submitState||e.lock_status?(0,s.Q3)("",!0):((0,s.uX)(),(0,s.Wv)(r,{key:0,icon:["fas","pen-to-square"],onClick:t=>Le(e)},null,8,["onClick"]))])],42,cv)))),128)),(0,s.Lk)("tr",null,[(0,s.Lk)("div",{ref_key:"loadMoreRef",ref:i,style:{height:"30px"}},null,512)])])):((0,s.uX)(),(0,s.CE)("tbody",gv,[(0,s.Lk)("tr",fv,[(0,s.Lk)("td",yv,[(0,s.Lk)("p",bv,[(0,s.bF)(r,{icon:["fas","circle-exclamation"]})]),a[21]||(a[21]=(0,s.eW)(" NO Data "))])])]))],512),L.value.visible?((0,s.uX)(),(0,s.CE)("div",{key:1,style:(0,n.Tr)({top:L.value.y-100+"px",left:L.value.x+"px"}),class:"context-menu"},[(0,s.Lk)("ul",null,[(0,s.Lk)("li",{onClick:se},"Print"),(0,s.Lk)("li",{onClick:ne},"Classification"),(0,s.Lk)("li",{onClick:oe},"Edit order data"),(0,s.Lk)("li",{onClick:De},"Delete")])],4)):(0,s.Q3)("",!0),d.value?((0,s.uX)(),(0,s.Wv)(ac,{key:2,"onUpdate:closeLayer":we,onAfterOpen:Ne,width:"400"},{header:(0,s.k6)((()=>a[23]||(a[23]=[(0,s.Lk)("h2",null,"Edit order data",-1)]))),content:(0,s.k6)((()=>[(0,s.Lk)("div",null,[(0,s.Lk)("ul",Iv,[(0,s.Lk)("li",Cv,[a[24]||(a[24]=(0,s.Lk)("label",{for:"testType"},"PB/BF",-1)),(0,s.bo)((0,s.Lk)("input",{id:"testType",class:"inputDisabled",type:"text","onUpdate:modelValue":a[1]||(a[1]=e=>m.value.testType=e),readonly:"",disabled:""},null,512),[[l.Jo,m.value.testType]])]),(0,s.Lk)("li",hv,[a[25]||(a[25]=(0,s.Lk)("label",{for:"traySlot"},"Tray Slot",-1)),(0,s.bo)((0,s.Lk)("input",{id:"traySlot",class:"inputDisabled",type:"text","onUpdate:modelValue":a[2]||(a[2]=e=>m.value.traySlot=e),readonly:"",disabled:""},null,512),[[l.Jo,m.value.traySlot]])]),(0,s.Lk)("li",kv,[a[26]||(a[26]=(0,s.Lk)("label",{for:"barcode"},"BARCODE ID",-1)),(0,s.bo)((0,s.Lk)("input",{id:"barcode",type:"text","onUpdate:modelValue":a[3]||(a[3]=e=>m.value.barcodeNo=e),placeholder:"BARCODE ID"},null,512),[[l.Jo,m.value.barcodeNo]])]),(0,s.Lk)("li",Sv,[a[27]||(a[27]=(0,s.Lk)("label",{for:"patientId"},"PATIENT ID",-1)),(0,s.bo)((0,s.Lk)("input",{id:"patientId",type:"text","onUpdate:modelValue":a[4]||(a[4]=e=>m.value.patientId=e),placeholder:"PATIENT ID"},null,512),[[l.Jo,m.value.patientId]])]),(0,s.Lk)("li",wv,[a[28]||(a[28]=(0,s.Lk)("label",{for:"patientName"},"PATIENT NAME",-1)),(0,s.bo)((0,s.Lk)("input",{id:"patientName",type:"text","onUpdate:modelValue":a[5]||(a[5]=e=>m.value.patientNm=e),placeholder:"PATIENT NAME"},null,512),[[l.Jo,m.value.patientNm]])]),(0,s.Lk)("li",Nv,[a[29]||(a[29]=(0,s.Lk)("label",{for:"analyzedDate"},"Analyzed date",-1)),(0,s.bo)((0,s.Lk)("input",{id:"analyzedDate",class:"inputDisabled",type:"text","onUpdate:modelValue":a[6]||(a[6]=e=>m.value.analyzedDttm=e),readonly:"",disabled:""},null,512),[[l.Jo,m.value.analyzedDttm]])]),(0,s.Lk)("li",Rv,[a[30]||(a[30]=(0,s.Lk)("label",{for:"signedState"},"Signed state",-1)),(0,s.bo)((0,s.Lk)("input",{id:"signedState",class:"inputDisabled",type:"text","onUpdate:modelValue":a[7]||(a[7]=e=>m.value.submitState=e),readonly:"",disabled:""},null,512),[[l.Jo,m.value.submitState]])]),q.value?(0,s.Q3)("",!0):((0,s.uX)(),(0,s.CE)("li",Lv,[a[31]||(a[31]=(0,s.Lk)("p",null,"Barcode Image",-1)),(0,s.Lk)("img",{class:"mt10 w-full br-04",src:B.value,onError:Te},null,40,Ev)]))])]),(0,s.Lk)("div",{class:"modalBottom"},[(0,s.Lk)("button",{class:"alertButton",onClick:Re},"Save")])])),_:1})):(0,s.Q3)("",!0),M.value?((0,s.uX)(),(0,s.Wv)(tv,{key:3,selectItems:A.value,ref_key:"printContent",ref:D,printOnOff:M.value,selectItemWbc:x.value,onPrintClose:le},null,8,["selectItems","printOnOff","selectItemWbc"])):(0,s.Q3)("",!0),I.value?((0,s.uX)(),(0,s.Wv)(Pt,{key:4,"is-visible":I.value,type:C.value,message:h.value,onHide:be,"onUpdate:hideAlert":be},null,8,["is-visible","type","message"])):(0,s.Q3)("",!0),N.value?((0,s.uX)(),(0,s.Wv)(ra,{key:5,"is-visible":N.value,type:"delete",message:R.value,onHide:Ae,onOkConfirm:Me},null,8,["is-visible","message"])):(0,s.Q3)("",!0)],64)}}};const Pv=_v;var Tv=Pv;const Av={key:0},Mv={class:"orderListWrapper",style:{padding:"0"}},Dv={class:"orderListUi"},xv={class:"mb20"},Ov=["src"],Kv={class:"resultInformationContainer",style:{"padding-top":"0"}},Bv={class:"resInfoTopContainer"},Fv={key:0},Uv={class:"resInfoContainer"},Xv={key:0,class:"resInfoWrapper resInfoWrapperLine"},$v={class:"resInfoWrapper mt10 mb20"},Wv={key:0,class:"resInfoWrapper resInfoWrapperLine"};var Hv={__name:"listInfo",props:["selectedItem"],setup(e){const t=(0,c.Pj)(),a=e,i=(0,o.KR)(t.state.commonModule.iaRootPath),r=(0,s.EW)((()=>t.state.commonModule.siteCd)),u=(0,o.KR)(""),d=(0,o.KR)(!1),m=(0,o.KR)(0),v=["NR","GP","PA","AR","MA","SM","OT"],p=(0,o.KR)(""),g=(0,o.KR)({}),f=(0,o.KR)({});(0,s.KC)((()=>{p.value=window.PROJECT_TYPE})),(0,s.sV)((async()=>{await h(),d.value=!1,i.value&&(u.value=E("barcode_image.jpg"))})),(0,s.wB)((()=>a.selectedItem),(e=>{0!==Object.keys(e).length&&(d.value=!1,k(),b(),i.value&&(u.value=E("barcode_image.jpg",e)))}));const y=e=>{let t="";const a=e.find((e=>"NE"===e.title));return t=a?"Y":"N",t},b=async()=>{if(!g.value||0===g.value.length||!Array.isArray(g.value))return void(f.value=a.selectedItem.wbcInfoAfter);const e=g.value.sort(((e,t)=>Number(e.orderIdx)-Number(t.orderIdx))),t=0!==g.value.length?e:"bm"===p.value?za:Ja,l=C(a.selectedItem.wbcInfoAfter,t);f.value=l},C=(e,t)=>{let a=e.slice();return a.sort(((e,a)=>{const l=t.findIndex((t=>(t.title||t.abbreviation)===(e.title||e.abbreviation))),s=t.findIndex((e=>(e.title||e.abbreviation)===(a.title||a.abbreviation)));return-1===l?1:-1===s?-1:l-s}))},h=async()=>{try{const e=await He();e&&(0===e?.data.length?g.value=[]:g.value=e.data.sort(((e,t)=>Number(e.orderIdx)-Number(t.orderIdx))))}catch(e){console.error(e)}},k=async()=>{m.value=a.selectedItem.wbcInfoAfter.reduce(((e,t)=>v.includes(t.title)?e:e+Number(t.count)),0);for(const e of a.selectedItem.wbcInfoAfter)if("bm"===window.PROJECT_TYPE){if("OT"!==e.title){const t=(Number(e.count)/Number(m.value)*100).toFixed(1);e.percent=Number(t)===Math.floor(Number(t))?Math.floor(Number(t)).toString():t}}else{const t=w(r.value,a.selectedItem?.testType);t.includes(e.title)||(e.percent=S(e.count,m.value)),r.value===I["서울성모병원"]?f.value=await Od(a.selectedItem.wbcInfoAfter,a.selectedItem.wbcInfoAfter):r.value===I["인하대병원"]?f.value=await xd(a.selectedItem,a.selectedItem.wbcInfoAfter):r.value===I["인천성모병원"]?f.value=await Kd(p.value,a.selectedItem.wbcInfoAfter):r.value===I["인천길병원"]&&(f.value=await Bd(a.selectedItem.wbcInfoAfter,a.selectedItem.wbcInfo.totalCount))}},S=(e,t)=>{const a=(Number(e)/Number(t)*100).toFixed(1);return Number(a)===Math.floor(Number(a))?Math.floor(Number(a)).toString():a},w=(e,t)=>{e||""!==e||(e="0000",t="01");const a={"0006":{includesStr:["AR","NR","GP","PA","MC","MA","SM","NE","GP","PA","OT"],includesStr2:["NR","AR","MC","MA","SM","NE","GP","PA","OT"]}},l=a[e]||{includesStr:["AR","NR","GP","PA","MC","SM","MA","GP","PA","OT"],includesStr2:["NR","AR","MC","MA","SM","GP","PA","OT"]};return"01"===t||"04"===t?l.includesStr:l.includesStr2},N=e=>e&&e.length>0&&!v.includes(e),R=e=>e&&e.length>0&&v.includes(e),L="viewer"===sessionStorage.getItem("viewerCheck")?window.MAIN_API_IP:window.APP_API_BASE_URL;function E(e){const t=""!==a.selectedItem?.img_drive_root_path&&a.selectedItem?.img_drive_root_path?a.selectedItem?.img_drive_root_path:i.value;return`${L}/images?folder=${t+"/"+a.selectedItem.slotId+"/"+aa.BARCODE+"/"}&imageName=${e}`}const _=()=>{d.value=!0};return(t,a)=>0!==Object.keys(e.selectedItem).length?((0,s.uX)(),(0,s.CE)("div",Av,[(0,s.Lk)("div",null,[a[1]||(a[1]=(0,s.Lk)("h3",{class:"orderTitle hh3title"},"Order Information",-1)),(0,s.Lk)("div",Mv,[(0,s.Lk)("ul",Dv,[(0,s.Lk)("li",null,[a[0]||(a[0]=(0,s.Lk)("span",{class:"mb10"},"Order ID:",-1)),(0,s.Lk)("span",xv,(0,n.v_)(e.selectedItem?.slotId),1)]),(0,s.Lk)("li",null,"NS, NB Integration: "+(0,n.v_)(y(e.selectedItem.wbcInfoAfter)),1)]),(0,s.Lk)("div",null,[(0,s.bo)((0,s.Lk)("img",{onError:_,src:u.value,style:{width:"200px",height:"120px",float:"right"}},null,40,Ov),[[l.aG,!d.value&&r.value!==(0,o.R1)(I)["고대구로병원"]]])])])]),(0,s.Lk)("div",Kv,[a[6]||(a[6]=(0,s.Lk)("h3",{class:"mt20 mb10 hh3title"},"Result Information",-1)),(0,s.Lk)("ul",Bv,["01"===e.selectedItem?.testType||"04"===e.selectedItem?.testType||"bm"===p.value?((0,s.uX)(),(0,s.CE)("li",Fv,[(0,s.Lk)("div",Uv,[a[5]||(a[5]=(0,s.Lk)("li",{class:"resInfoWrapper mb10"},[(0,s.Lk)("p",null,"Class"),(0,s.Lk)("p",null,"Count"),(0,s.Lk)("p",null,"Percent")],-1)),((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(f.value,(e=>((0,s.uX)(),(0,s.CE)(s.FK,{key:e.title},[N(e.title)&&e.count>0?((0,s.uX)(),(0,s.CE)("li",Xv,[(0,s.Lk)("p",null,(0,n.v_)(e.title),1),(0,s.Lk)("p",null,(0,n.v_)(e.count),1),(0,s.Lk)("p",null,(0,n.v_)((0,o.R1)(Dd)(e.percent)+"%"),1)])):(0,s.Q3)("",!0)],64)))),128)),(0,s.Lk)("li",$v,[a[2]||(a[2]=(0,s.Lk)("p",null,"Total",-1)),(0,s.Lk)("p",null,(0,n.v_)(m.value),1),a[3]||(a[3]=(0,s.Lk)("p",null,"100%",-1))]),((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(f.value,(e=>((0,s.uX)(),(0,s.CE)(s.FK,{key:e.title},[R(e.title)&&e.count>0?((0,s.uX)(),(0,s.CE)("li",Wv,[(0,s.Lk)("p",null,(0,n.v_)(e.title),1),(0,s.Lk)("p",null,(0,n.v_)(e.count),1),a[4]||(a[4]=(0,s.Lk)("p",null,"-",-1))])):(0,s.Q3)("",!0)],64)))),128))])])):(0,s.Q3)("",!0)])])])):(0,s.Q3)("",!0)}};const Gv=Hv;var Yv=Gv;const Vv={class:"listTableImageContainer"},jv={key:0,class:"dbPBImageContainer"},Qv=["src","onError","onClick"],qv={key:1};var Jv=(0,s.pM)({__name:"listWbcImg",props:["dbData","selectedItem"],setup(e){const t=e,a=(0,c.Pj)(),i=(0,o.KR)(a.state.commonModule.iaRootPath),r=(0,s.EW)((()=>a.state.commonModule.viewerCheck)),u="viewer"===r.value?window.MAIN_API_IP:window.APP_API_BASE_URL,d=(0,o.KR)([]),m=(0,o.KR)({}),v=(0,o.KR)("");(0,s.sV)((()=>{d.value=[],f()})),(0,s.wB)((()=>t.selectedItem),(()=>{d.value=[],f()}),{deep:!0});const p=e=>{v.value===e?v.value="":v.value=e},g=e=>v.value===e;function f(){t.selectedItem?.wbcInfo&&0!==Object.keys(t.selectedItem?.wbcInfo).length&&(d.value=t.selectedItem?.wbcInfo?.wbcInfo[0]?.reduce(((e,t)=>(t.images&&t.images.length>0&&e.push({id:t.id,images:t.images,title:t.title}),e)),[])||[])}function y(e,a,l){const{selectedItem:s}=t;if(!s?.wbcInfo?.wbcInfo||0===s?.wbcInfo?.wbcInfo.length)return"";const o=s.slotId||"",n=""!==s?.img_drive_root_path&&s?.img_drive_root_path?s?.img_drive_root_path:i.value,r=`${n}/${o}/01_WBC_Classification/${a}_${l}`;return`${u}/images/getImageRealTime?folder=${r}&imageName=${e}`}function b(e,t){m.value[`${e}-${t}`]=!0}return(e,t)=>((0,s.uX)(),(0,s.CE)("div",Vv,[t[0]||(t[0]=(0,s.Lk)("h3",{class:"mb10 hh3title infoImageTitle mt10"},"WBC Images",-1)),d.value.length>0?((0,s.uX)(),(0,s.CE)("div",jv,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(d.value,(e=>((0,s.uX)(),(0,s.CE)(s.FK,{key:e.id},[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(e.images,(t=>(0,s.bo)(((0,s.uX)(),(0,s.CE)("img",{key:t.fileName,class:(0,n.C4)(["dbRightImages",["dbRightImages",{"selected-image":g(`${e.id}-${t.fileName}`)}]]),src:y(t.fileName,e.id,e.title),onError:a=>b(e.id,t.fileName),onClick:a=>p(`${e.id}-${t.fileName}`)},null,42,Qv)),[[l.aG,!m.value[`${e.id}-${t.fileName}`]]]))),128))],64)))),128))])):((0,s.uX)(),(0,s.CE)("div",qv,"No images available"))]))}});const zv=Jv;var Zv=zv;const ep={class:"mt30 listTableImageContainer"},tp={key:0,class:"dbBMImageContainer"},ap=["src","onError"],lp={key:1};var sp=(0,s.pM)({__name:"listBmImg",props:["dbData","selectedItem"],setup(e){const t=e,a=(0,c.Pj)(),n=(0,s.EW)((()=>a.state.commonModule.iaRootPath)),i=(0,s.EW)((()=>a.state.commonModule.viewerCheck)),r="viewer"===i.value?window.MAIN_API_IP:window.APP_API_BASE_URL,u=(0,o.KR)([]),d=(0,o.KR)({});function m(){t.selectedItem?.wbcInfo&&0!==Object.keys(t.selectedItem?.wbcInfo).length&&(u.value=t.selectedItem?.wbcInfo?.wbcInfo[0]?.reduce(((e,t)=>(t.images&&t.images.length>0&&e.push({id:t.id,images:t.images,title:t.title}),e)),[])||[])}function v(e,a,l){const{selectedItem:s}=t;if(!s?.wbcInfo?.wbcInfo||0===s?.wbcInfo?.wbcInfo.length)return"";const o=s.slotId||"",i=""!==s?.img_drive_root_path&&s?.img_drive_root_path?s?.img_drive_root_path:n.value,c=`${i}/${o}/04_BM_Classification/${a}_${l}`;return`${r}/images?folder=${c}&imageName=${e}`}function p(e,t){d.value[`${e}-${t}`]=!0}return(0,s.sV)((()=>{m()})),(0,s.wB)((()=>t.selectedItem),(()=>{m()})),(e,t)=>((0,s.uX)(),(0,s.CE)("div",ep,[t[0]||(t[0]=(0,s.Lk)("h3",{class:"mb10 hh3title infoImageTitle mt10"},"BM Images",-1)),u.value.length>0?((0,s.uX)(),(0,s.CE)("div",tp,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(u.value,(e=>((0,s.uX)(),(0,s.CE)(s.FK,{key:e.id},[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(e.images,(t=>(0,s.bo)(((0,s.uX)(),(0,s.CE)("img",{key:t.fileName,class:"dbRightImages",src:v(t.fileName,e.id,e.title),onError:a=>p(e.id,t.fileName)},null,40,ap)),[[l.aG,!d.value[`${e.id}-${t.fileName}`]]]))),128))],64)))),128))])):((0,s.uX)(),(0,s.CE)("div",lp,"No images available"))]))}});const op=sp;var np=op;const ip=Z(),rp=async e=>ip.httpPost(ee.excel.execute,e),cp=Z(),up=async e=>cp.httpPost(ee.filesystem.post,e,""),dp=async e=>cp.httpPost(ee.filesystem.copy,e,""),mp=async e=>cp.httpPost(ee.filesystem.cleanup,e,""),vp=async e=>cp.httpPost(ee.filesystem.existsFile,e,""),pp=async e=>cp.httpGet(ee.filesystem.fileSearch,`${e}`,!0),gp=async e=>cp.httpDelete(ee.filesystem.delete,e,!1),fp=async e=>cp.httpGet(ee.filesystem.createDirectory,`${e}`,!0),yp=async e=>cp.httpPost(ee.filesystem.fileCreate,e,""),bp=async e=>cp.httpPost(ee.filesystem.cbcSaveData,e,""),Ip=async e=>cp.httpGet(ee.settings.folders.get,`${e}`,!0),Cp=async e=>cp.httpGet(ee.filesystem.errLogsRead,`${e}`,!0),hp=(0,c.Pj)(),kp=(0,s.EW)((()=>hp.state.userModule)),Sp=(0,s.EW)((()=>hp.state.slideDataModule)),wp=async(e,t,a,l)=>{console.log("인하대 CBC 데이터 받기 - inhaCbc cbcFilePathSetArr",e);let s="",o=!1,n=[],i="",r="",c="",u="",d="",m=[];if(""===e)return s=U.UPLOAD_PLEASE_CBC,{cbcWorkList:n,errMessage:s,cbcPatientNo:i,cbcPatientNm:r,cbcSex:c,cbcAge:u,inhaTestCode:d,loading:o};if(e.includes("http"))try{const l=window.APP_API_BASE_URL||"http://192.168.0.131:3002",v={machine:"ADUIMD",episode:t.barcodeNo,baseUrl:`${e}/api/MifMain/Order`},p=await z.A.post(`${l}/cbc/executePostCurl`,v),g=p.data.replace(/\\"/g,'"'),f=JSON.parse(g);console.log(f[0]);const y=f[0],b="D:\\UIMD_Data\\UI_Log\\CBC_IA",I=await Eo(`path=${b}&filename=${t?.barcodeNo}`);if(I?.data?.success&&"0"!==y?.returnCode){console.log(I?.data?.data),m=JSON.parse(I?.data?.data?.toString());const[{cbcPatientNo:e,cbcPatientNm:t,cbcSex:a,cbcAge:l,testCode:i}]=m;return await hp.dispatch("commonModule/setCommonInfo",{inhaTestCode:i}),n=m,{cbcWorkList:n,errMessage:s,cbcPatientNo:e,cbcPatientNm:t,cbcSex:a,cbcAge:l,inhaTestCode:d,loading:o}}if("0"!==y?.returnCode)return s=y?.returnCode,o=!1,{cbcWorkList:n,errMessage:s,cbcPatientNo:i,cbcPatientNm:r,cbcSex:c,cbcAge:u,inhaTestCode:d,loading:o};{i=y?.regNo,r=y?.name,c=y?.sex,u=y?.age,d=y?.testCode,await hp.dispatch("commonModule/setCommonInfo",{inhaTestCode:y?.testCode});const e=y.testCode.split(",");e.forEach((e=>{const t=e.split("|"),l=t[0],s=t[1],o=t[2],i=a.find((e=>e.classCd===l));if(i){const e={classNm:i.fullNm,count:s||0,unit:o||"",cbcPatientNo:y?.regNo,cbcPatientNm:y?.name,cbcSex:y?.sex,cbcAge:y?.age,testCode:y.testCode};n.push(e)}}))}const C={filePath:`D:\\UIMD_Data\\UI_Log\\CBC_IA\\${t?.barcodeNo}.txt`,data:n};await bp(C),o=!1}catch(v){console.error(v.message+" : no CBC result"),o=!1,s=v.message}return{cbcWorkList:n,errMessage:s,cbcPatientNo:i,cbcPatientNm:r,cbcSex:c,cbcAge:u,inhaTestCode:d,loading:o}},Np=async(e,t,a,l,s,o,n,i,r)=>{console.log("Lis 업로드 로직 시작"),console.log("인하대 테스트 wbcInfoAfter",e),console.log("인하대 테스트 rbcInfoAfter",t),console.log("인하대 테스트 barcodeNo",a);let c="",u=!1;if(""===l)return c=U.UPLOAD_PLEASE_LIS,{errMessage:c};let d="";const m=s.split(","),v=[];m.forEach((e=>{if(e.length>0){const t=e.split("|"),a=t[0];let l=t[1],s="";"L0210"===a&&(l+="5"),"H1151"===a?(s+="H9511|"+l+"|",v.push(s)):"H1152"===a?(s+="H9512|"+l+"|",v.push(s)):"H1153"===a?(s+="H9513|"+l+"|",v.push(s)):"H1154"===a?(s+="H9514|"+l+"|",v.push(s)):"H1155"===a?(s+="H9515|"+l+"|",v.push(s)):"H1165"===a?(s+="H9510|"+l+"|",v.push(s)):"H1162"===a?(s+="H9570|"+l+"|",v.push(s)):"H1101"!==a&&"H1102"!==a&&"H1103"!==a&&"H1104"!==a&&"H1105"!==a&&"H1106"!==a&&"H1121"!==a&&"H1122"!==a&&"H1123"!==a||(s+=a+"|"+l+"|",v.push(s))}}));let p="";v.forEach((function(e){p+=e+","})),d+=p,console.log("tmpList 가공 매칭 후",JSON.stringify(v)),console.log("inhaTestSendCode.value cbc 값 얻어와서 매칭 시킨 후 변경된 배열",p),console.log("inhaTestSendCode.value",p),o.forEach((function(t,a){""!==t.LIS_CD&&e.forEach((function(e){Number(t.IA_CD)===Number(e.id)&&("H9600"===t.LIS_CD||"H9365"===t.LIS_CD||"H9366"===t.LIS_CD?Number(e.count>0)?d+=t.LIS_CD+"|1|,":"NS"!==e.title||"LY"!==e.title||"EO"!==e.title||"BA"!==e.title||"MO"!==e.title?d+=t.LIS_CD+"| |,":d+=t.LIS_CD+"|0.0|,":"13"===t.IA_CD||"14"===t.IA_CD?Number(e.count)>Number(t.MIN_COUNT)?d+=t.LIS_CD+"|"+e.percent+"|,":d+=t.LIS_CD+"| |,":Number(e.percent)>0?d+=t.LIS_CD+"|"+e.percent+"|,":"NS"!==e.title||"LY"!==e.title||"EO"!==e.title||"BA"!==e.title||"MO"!==e.title?d+=t.LIS_CD+"| |,":d+=t.LIS_CD+"|0.0|,")}))}));let g="";n.forEach((function(e){""!==e.LIS_CD&&t.forEach((function(t){e.IA_CATEGORY_CD===t.categoryId&&e.IA_CLASS_CD===t.classId&&("H9531"===e.LIS_CD||"H9535"===e.LIS_CD||"H9594"===e.LIS_CD||"H9571"===e.LIS_CD||"H9574"===e.LIS_CD||"H9595"===e.LIS_CD?(0===Number(t.degree)?t.degree=" ":t.degree="0",g+=e.LIS_CD+"|"+t.degree+"|,",d+=e.LIS_CD+"|"+t.degree+"|,"):(0===Number(t.degree)&&(t.degree=" "),g+=e.LIS_CD+"|"+t.degree+"|,",d+=e.LIS_CD+"|"+t.degree+"|,"))}))}));let f=g;f=f.replace("H9531","H9571"),f=f.replace("H9532","H9572"),f=f.replace("H9533","H9573"),f=f.replace("H9535","H9574"),f=f.replace("H9536","H9575"),f=f.replace("H9537","H9576"),f=f.replace("H9534","H9577"),f=f.replace("H9538","H9578"),f=f.replace("H9542","H9518"),f=f.replace("H9544","H9520"),f=f.replace("H9546","H9517"),f=f.replace("H9548","H9519"),f=f.replace("H9550","H9522"),f=f.replace("H9552","H9521"),f=f.replace("H9554","H9525"),f=f.replace("H9556","H9524"),f=f.replace("H9558","H9526"),f=f.replace("H9560","H9523"),f=f.replace("H9562","H9528"),f=f.replace("H9564","H9530"),f=f.replace("H9594","H9595"),d+=g,d+=f,console.log("rbc wbc 최종 resultStr 값",d);try{const e=window.APP_API_BASE_URL||"http://192.168.0.131:3002",t={baseUrl:`${l}/api/MifMain/File`,machine:"ADUIMD",episode:a,result:d},s=await z.A.post(`${e}/cbc/executePostCurl`,t),o=s.data.replace(/\\"/g,'"'),n=JSON.parse(o);console.log(n[0]);const m=n[0];if(console.log("res 최종값",s),"0"===m?.returnCode){const e=`D:\\UIMD_Data\\UI_Log\\LIS_IA\\${i?.barcodeNo}.txt`,t={filePath:e,data:n},a=W()().local();if(await bp(t),i?.id){const e={submitState:"lisCbc",submitOfDate:a.format(),submitUserId:kp.value.userId},t={id:Sp.value.id,...e};await Rp(t,!0,r)}u=!0,c=U.IDS_MSG_SUCCESS}else c=m?.message}catch(y){c=y.message}return{errMessage:c,lisBtnColor:u}},Rp=async(e,t,a)=>{let l="",s="";try{const o=sessionStorage.getItem("lastSearchParams")||localStorage.getItem("lastSearchParams")||"",{startDate:n,endDate:i,page:r,searchText:c,nrCount:u,testType:d,wbcInfo:m,wbcTotal:v}=JSON.parse(o),p=n+i+r+c+u+d+m+v,g=await Nd({userId:Number(a),runingInfoDtoItems:[e],dayQuery:p});if(g){t||(s="success");const a=e;l=a.wbcMemo}else console.error("백엔드가 디비에 저장 실패함")}catch(o){console.error("Error:",o)}return{wbcMemo:l,message:s}},Lp=async()=>{let e=[],t=[];try{const a=await Xe(),l=await Ee();if(a&&a.data&&l&&l.data){const s=a.data,o=l.data,n=await Ue();if(s){const t=[];for(const{classId:e,fullNm:a,id:l,key:o}of s){const l=()=>{switch(e){case"13":return n.data[0].minGPCount;case"14":return n.data[0].minPACount;default:return 0}};t.push({CD_NM:a,IA_CD:e,LIS_CD:o,MIN_COUNT:l})}e=t}if(o){const e=[];for(const t of o)e.push({CATEGORY_NM:t.categoryNm,CLASS_NM:t?.fullNm,IA_CATEGORY_CD:t?.categoryId,IA_CLASS_CD:t?.classId,LIS_CD:t?.key});t=e}}}catch(a){console.error(a)}return{lisCodeWbcArr:e,lisCodeRbcArr:t}},Ep=async()=>{let e="",t="";try{const a=await De();a&&a.data&&0!==a.data.length&&(e=a.data[0].lisFilePath,t=a.data[0].lisHotKey)}catch(a){console.error(a)}return{lisFilePathSetArr:e,lisHotKey:t}},_p=async()=>{let e="";try{const t=await De();if(t&&t.data){const a=t?.data;e=a[0]?.cbcFilePath}}catch(t){console.error(t)}return e},Pp=async()=>{let e=[];try{const t=await Te();t&&t.data&&(e=t.data)}catch(t){console.error(t)}return e},Tp=(e,t,a)=>{const l=parseFloat(e.find((e=>"MCV"===e.classNm))?.count),s=parseFloat(e.find((e=>"MCHC"===e.classNm))?.count),o=parseFloat(e.find((e=>"HGB"===e.classNm))?.count),n=parseFloat(e.find((e=>"WBC"===e.classNm))?.count),i=parseFloat(e.find((e=>"PLT"===e.classNm))?.count),r=parseFloat(e.find((e=>"EO"===e.classNm))?.count),c=parseFloat(e.find((e=>"NEUT"===e.classNm))?.count),u=parseFloat(e.find((e=>"LYMPH"===e.classNm))?.count),d=parseFloat(e.find((e=>"MONO"===e.classNm))?.count),m=parseFloat(e.find((e=>"RBC"===e.classNm))?.count),v=[];return"F"===t&&o<=10.9||"M"===t&&o<=12.4?(r>=.51&&v.push({code:"NNA, Eosinophilia"}),n>=10.1?i<=451?v.push({code:"NNA, WBC(H), PLT(H)"}):v.push({code:"NNA, WBC(H)"}):n<=3.9?v.push({code:"NNA, WBC(L)"}):i>=451?v.push({code:"NNA, PLT(H)"}):i<=149?v.push({code:"NNA, PLT(L)"}):v.push({code:"Normocytic normochromic anemia"})):(n<3.9&&v.push({code:"WBC(L)"}),n<3.9&&i<149&&v.push({code:"WBC(L), PLT(L)"}),i<149&&v.push({code:"PLT(L)"}),i>451&&v.push({code:"PLT(H), mild"}),n>=10.1&&(i<=451?v.push({code:"WBC(H), PLT(H)"}):v.push({code:"WBC(H)"}))),("F"===t&&o<=10.9||"M"===t&&o<=12.4)&&l<=79.9&&s<=32.4&&(i<=149&&n<=3.9&&v.push({code:"IDA, WBC(L), PLT(H)"}),n>=10.1?v.push({code:"IDA, WBC(H)"}):n<=3.9?v.push({code:"IDA, WBC(L)"}):i>=451?v.push({code:"IDA, PLT(H)"}):i<=149?v.push({code:"IDA, PLT(L)"}):v.push({code:"Iron deficiency anemia"})),l<=79.9&&s<=32.4&&v.push({code:"Iron depleted state"}),l>=105.1&&(n>10.1?v.push({code:"M.A, WBC(H)"}):i<149?v.push({code:"M.A, PLT(L)"}):v.push({code:"Macrocytic anemia"})),("F"===t&&m>=5.21||"M"===t&&m>=5.81)&&("F"===t&&o>=16.1||"M"===t&&o>=16.6)&&v.push({code:"RBC(H),Hb(H)"}),n>10.1&&c>8.51&&v.push({code:"Neutrophilia"}),(Number(a)>12&&u>4.01||Number(a)<=12&&u>9.01)&&v.push({code:"Lymphocytosis"}),u<1.49&&v.push({code:"Lymphocytopenia"}),r>.51&&v.push({code:"Eosinophilia"}),d>1.1&&v.push({code:"Monocytosis"}),("F"===t&&o<=10.9||"M"===t&&o<=12.4)&&n<3.9&&i<149&&v.push({code:"Pancytopenia, mild"}),n>10.1&&v.push({code:"Chronic inflammation"}),v},Ap=async e=>{const t=await _p(),a=`folderPath=${t}`,l=await Ip(a);let s=[];if(Array.isArray(l)&&(s=l.filter((t=>t.split("_")[0]===e))),0===s.length)return;const o=s.reduce(((e,t)=>{const a=Mp(t),l=Mp(e);return a>l?t:e}));return`${o.split(".")[0]}`},Mp=e=>{const t=e.match(/_(\d{4}-\d{2}-\d{2}|\d{8})/);if(!t)return null;let a=t[1];return a.includes("-")||(a=`${a.substring(0,4)}-${a.substring(4,6)}-${a.substring(6,8)}`),new Date(a)};function Dp(e,t,a){return Tp(e,t,a)}function xp(e,t,a,l,s){const o=[];for(const u of a)o.push(...u.classInfo);const n=[],i={Spherocyte:[0,5],Ovalocyte:[0,5],TearDropCell:[0,5],Acanthocyte:[0,5],"Target Cell":[0,5],Schistocyte:[0,1],"Howell-Jolly Body":[0,2]};for(const u of o){const e=parseFloat(u.percent),t=i[u.classNm];t&&(e<t[0]||e>t[1])&&n.push({classNm:u.classNm,value:e,normalRangeFirst:t[0],normalRangeLast:t[1]})}const r={WBC:[4,10],RBC:[3.7,5.2],HGB:[11,16],HCT:[32,44],MCV:[80,105],MCHC:[32.5,36],RDWCV:[0,15],PLT:[150,450],RET:[0,5]};"M"===l&&(r["RBC"]=[4,5.8],r["HGB"]=[12.5,16.5],r["HCT"]=[40,52]);for(const u of e){const e=parseFloat(u.count),t=r[u.classNm];t&&(e<t[0]||e>t[1])&&n.push({classNm:u.classNm,value:e,normalRangeFirst:t[0],normalRangeLast:t[1]})}const c={NB:[0,6],LR:[0,10]};for(const u of t){const e=parseFloat(u.percent),t=c[u.title]||[0,10];(e<t[0]||e>t[1])&&n.push({classNm:u.title,value:e,normalRangeFirst:t[0],normalRangeLast:t[1]})}return n}const Op=async(e,t)=>{const a=await Ap(e),l=await _p(),s=await _o(`path=${l}&filename=${a}`),o=[];let n="",i="";if(s.data.success){const e=await Po(s.data.data);e?.data?.segments?.forEach((e=>{const t=e?.fields?.[2]?.value?.[0]?.[0]?.value?.[0],a=e?.fields?.[4]?.value?.[0]?.[0]?.value?.[0]||"0",l=e?.fields?.[2]?.value?.[0]?.[0]?.value?.[0].match(/%/g)?.[0]||"",s=t?t.replace(/[^\w\s]/gi,""):"";if("OBX"===e.name.trim()){const e={classNm:s,count:a,unit:l};o.push(e)}else"PID"===e.name.trim()&&(n=e?.fields[6].value[0][0].value[0],i=e?.fields[7].value[0][0].value[0])}))}return{cbcData:o,cbcSex:n,cbcAge:i}},Kp=async(e,t,a)=>{const l=await Ap(e),s=await _p(),o=await _o(`path=${s}&filename=${l}`);let n="",i="";if(o.data.success){const e=await Po(o.data.data);e?.data?.segments?.forEach((e=>{"PID"===e.name.trim()&&(n=e.fields[2].value[0][0].value[0],i=e.fields[4].value[0][0].value[0])}))}const r={sendingApp:"PBIA",sendingFacility:"PBIA",receivingApp:"LIS",receivingFacility:"LIS",dateTime:H(),security:"",messageType:["ADT","R02"],messageControlId:e,processingId:"P",hl7VersionId:"2.5",customData:t,pidData:{patientId:n,patientName:i}},c=await Ao(r);if(c)return await Bp(c,e,a)},Bp=async(e,t,a)=>{const l={apiKey:"M0ZGODgyREY4NzUxMkY4RTM0MERDRkMyRkQ1MDM3OEU=",interfaceId:"01",dataText:e.data},s=await z.A.post(`${a}`,l,{headers:{"Content-Type":"application/json"}});return 200===s?.data.code?"Success":"Lis Send Fail"},Fp=async e=>{const t={apiKey:"M0ZGODgyREY4NzUxMkY4RTM0MERDRkMyRkQ1MDM3OEU=",interfaceId:"01",workDate:e},a=await z.A.post("http://121.169.55.132:8081/api/interface/worklists",t,{headers:{"Content-Type":"application/json"}});return 200===a?.data.code?{data:a?.data,code:a?.data.code}:{data:null,code:a?.data.code}},Up=async(e,t,a)=>{const l={apiKey:"M0ZGODgyREY4NzUxMkY4RTM0MERDRkMyRkQ1MDM3OEU=",interfaceId:"01",reqNoList:e??[],workDateStart:t,workDateEnd:a},s=await z.A.post("http://121.169.55.132:8081/api/interface/patnames",l,{headers:{"Content-Type":"application/json"}});return 200===s?.data.code?{data:s?.data,code:s?.data.code}:{data:null,code:s?.data.code}},Xp={key:0,class:"popup-modal-overlay"},$p={class:"popup-modal-content"},Wp={class:"popup-modal-header"},Hp={class:"popup-modal-body"},Gp={class:"popup-data-table"};var Yp=(0,s.pM)({__name:"PopupTable",props:{isOpen:{type:Boolean},workList:{}},emits:["update:isOpen"],setup(e,{emit:t}){const a=e,l=t,i=(0,o.KR)([]),r=(0,o.KR)([]),c=(0,o.KR)(null),u=(0,o.KR)(new Date),d=(0,o.KR)(!1),m=(0,o.KR)("");(0,s.wB)((()=>a.workList),(e=>{i.value=e})),(0,s.wB)((()=>u.value),(async(e,t)=>{const a=W()(e).format("YYYY-MM-DD"),{data:l,code:s}=await Fp(a);200===Number(s)?i.value=l:await v("불러오기에 실패했습니다")}));const v=async e=>{d.value=!0,m.value=e},p=e=>e.toISOString().split("T")[0],g=()=>{l("update:isOpen",!1)};return(e,t)=>e.isOpen?((0,s.uX)(),(0,s.CE)("div",Xp,[(0,s.Lk)("div",$p,[(0,s.Lk)("div",Wp,[(0,s.bF)((0,o.R1)(Go.A),{modelValue:u.value,"onUpdate:modelValue":t[0]||(t[0]=e=>u.value=e),format:p,class:"date-picker",ref_key:"datepicker",ref:c},null,8,["modelValue"])]),(0,s.Lk)("div",Hp,[(0,s.Lk)("table",Gp,[t[1]||(t[1]=(0,s.Lk)("thead",null,[(0,s.Lk)("tr",{style:{position:"sticky",top:"0"}},[(0,s.Lk)("th",null,"No."),(0,s.Lk)("th",null,"접수일자"),(0,s.Lk)("th",null,"검사일자"),(0,s.Lk)("th",null,"접수번호"),(0,s.Lk)("th",null,"결과코드"),(0,s.Lk)("th",null,"환자명"),(0,s.Lk)("th",null,"검사여부")])],-1)),(0,s.Lk)("tbody",null,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(r.value,((e,t)=>((0,s.uX)(),(0,s.CE)("tr",{key:t},[(0,s.Lk)("td",null,(0,n.v_)(t+1),1),(0,s.Lk)("td",null,(0,n.v_)(e.reqDate),1),(0,s.Lk)("td",null,(0,n.v_)(e.testDate),1),(0,s.Lk)("td",null,(0,n.v_)(e.receiptNo),1),(0,s.Lk)("td",null,(0,n.v_)(e.resultCode),1),(0,s.Lk)("td",null,(0,n.v_)(e.patientName),1),(0,s.Lk)("td",null,(0,n.v_)(e.testYn),1)])))),128))])])]),(0,s.Lk)("div",{class:"popup-modal-footer"},[(0,s.Lk)("button",{class:"popup-btn-close",onClick:g}," CLOSE ")])])])):(0,s.Q3)("",!0)}});const Vp=Yp;var jp=Vp;const Qp={key:0,class:"loaderBackgroundForLogin"},qp={class:"titleH3"},Jp={class:"listBoxTable"},zp={class:"filterListDiv"},Zp={class:"search-container"},eg={class:"settingDatePickers"},tg={key:0,class:"filterDivBox"},ag={key:0,class:"nrCount"},lg={class:"wbcTotal"},sg={class:"wbcInfoFilter"},og={class:"wbcInfoFilter"},ng=["id","onUpdate:modelValue"],ig=["for"],rg={class:"lastTestType"},cg=["checked"],ug=["checked"],dg=["checked"],mg=["checked"],vg=["checked"],pg=["checked"],gg={class:"listBox"},fg=100;var yg=(0,s.pM)({__name:"index",setup(e){const t=(0,c.Pj)(),a=(0,r.rd)(),i=(0,o.KR)([]),u=(0,o.KR)(!1),d=(0,o.KR)(""),m=new Date,g=new Date(m);g.setDate(m.getDate()-29);const f=(0,o.KR)(g),y=(0,o.KR)(new Date),b=(0,o.KR)(""),C=(0,o.KR)("barcodeNo"),h=(0,o.KR)(1),k=(0,o.KR)(1),S=(0,o.KR)({}),w=(0,o.KR)([]),N=(0,o.KR)([]),R=(0,o.KR)(0),L=(0,o.KR)("00"),E=(0,o.KR)("all"),_=(0,o.KR)(!1),P=(0,o.KR)(!1),T=(0,s.nI)(),A=(0,o.KR)(""),M=(0,o.KR)(""),D=(0,o.KR)([]),x=(0,o.KR)(t.state.commonModule.iaRootPath),O=(0,s.EW)((()=>t.state.commonModule.viewerCheck)),K="viewer"===O.value?window.MAIN_API_IP:window.APP_API_BASE_URL,B=(0,s.EW)((()=>t.state.commonModule.siteCd)),F=(0,o.KR)(!1),U=(0,o.KR)(!1),X=(0,o.KR)(!1),$=(0,o.KR)(!1),H=(0,o.KR)(null),G=(0,o.KR)(!1),Y=(0,o.KR)([]),V=(0,o.KR)(0),j=(0,o.KR)(0),Q=(0,o.KR)(0),J=(0,o.KR)(0),z=(0,o.KR)(0),Z=(0,o.KR)(0),ee=(0,o.KR)(0),te=(0,o.KR)(0),ae=(0,o.KR)([]),le=(0,o.KR)([]),se=(0,o.KR)([]),oe=(0,o.KR)(null),ne=(0,o.KR)(""),re=(0,o.KR)(!1),ce=(0,o.KR)({}),ue=(0,o.KR)("");let de=Date.now();const me={value:!1};async function ve(e){F.value=!0,$.value=!1,await Ad(),await Se()}(0,s.KC)((async()=>{P.value="bm"===window.PROJECT_TYPE})),(0,s.sV)((async()=>{F.value||await Se(),document.addEventListener("click",Ie),H.value&&H.value.focus(),$.value=!0,T?.appContext.config.globalProperties.$socket.on("stateVal",ve),document.addEventListener("keydown",ye)}));const pe=()=>{f.value=new Date,y.value=new Date,Ee()},ge=e=>{if(!e.data)return;const t=Date.now(),a=t-de;me.value=a<50,de=t,me.value&&(ne.value+=e.data,oe.value&&clearTimeout(oe.value),oe.value=setTimeout((()=>{const e=ne.value.trim();e!==ue.value&&(b.value=e,ue.value=e),ne.value="",Ee()}),fg))},fe=async()=>{const e=W()(m).format("YYYY-MM-DD"),{data:t,code:a}=await Fp(e);200===Number(a)?(ce.value=t,re.value=!0):await Me("불러오기에 실패했습니다")},ye=e=>{"/dataBase"===a.currentRoute.value.path&&("Enter"!==e.key&&"Tab"!==e.key||setTimeout((()=>{if(H.value){H.value.focus(),b.value=b.value.trim();const e=b.value.trim();e!==ue.value&&(ue.value=e)}}),10))},be=()=>{H.value&&Ee()};(0,s.xo)((()=>{document.removeEventListener("click",Ie)}));const Ie=e=>{const t=document.querySelector(".filterDivBox"),a=document.querySelector(".classificationListBtn");a&&a.contains(e.target)||t&&!t.contains(e.target)&&(_.value=!1)},Ce=()=>{_.value=!_.value},he=e=>{L.value=L.value===e?"":e},ke=()=>{const e=w.value?.filter((e=>e.checked)).map((e=>e.title));N.value=e??[]},Se=async()=>{U.value=!0;const e=Re();oc(e)?await Le("mounted",1):(h.value=e.page||1,C.value=e.searchType||"barcodeNo",b.value=e.searchText||"",f.value=new Date(e.startDate)||new Date,y.value=new Date(e.endDate)||new Date,R.value=e.nrCount,E.value=e.wbcTotal,L.value=e.testType,N.value=e.wbcInfo??[],w.value=w.value.map((t=>e.wbcInfo.includes(t.title)?{...t,checked:!0}:t)),await Le("search"))},we=async e=>{S.value=e},Ne=()=>{const e={page:h.value,prevPage:k.value,searchType:C.value,searchText:b.value,startDate:q(f.value),endDate:q(y.value),nrCount:R.value,wbcTotal:E.value,wbcInfo:N.value,testType:L.value};sessionStorage.setItem("lastSearchParams",JSON.stringify(e)),localStorage.setItem("lastSearchParams",JSON.stringify(e))},Re=()=>{const e=sessionStorage.getItem("lastSearchParams");return e?JSON.parse(e):{}},Le=async(e,l)=>{"search"===e?(D.value=[],X.value=!0,$.value=!0,h.value=1):(X.value=!1,$.value=!1);let s=0;s="loadMoreData"===e?h.value:"loadPrevData"===e?k.value:h.value;const o={page:"mounted"!==e?s:Number(l),pageSize:20,startDay:""===b.value?q(f.value):"",endDay:""===b.value?q(y.value):"",barcodeNo:"barcodeNo"===C.value?b.value:void 0,patientId:"patientId"===C.value?b.value:void 0,patientNm:"patientNm"===C.value?b.value:void 0,nrCount:R.value};""===A.value&&(A.value=o.page),0!==N.value.length&&(o.title=N.value),"00"!==L.value&&""!==L.value&&(o.testType=L.value),""!==E.value&&"all"!==E.value&&(o.wbcCountOrder=E.value);try{const l=await Rd(o);if(Ne(),1===h.value&&0===l.data.data.length)return U.value=!1,void(i.value=[]);if(l&&l.data){A.value=o.page,M.value=o;const t=l.data.data;if(0===t.length)1===h.value?h.value=1:h.value-=1,0===t.length&&"1"===String(l.data?.page)&&(i.value=t);else{if("search"===e?i.value=t:t.forEach((e=>{const t=i.value.findIndex((t=>t.id===e.id));-1!==t?i.value[t]=e:i.value.push(e)})),0===w.value.length){const e=i.value[0]?.wbcInfo?.wbcInfo[0];w.value=e.map((e=>N.value.includes(e.title)?{...e,checked:!0}:{...e,checked:!1}))}""!==E.value&&"all"!==E.value||(i.value=i.value.sort(((e,t)=>{const a=W()(e.analyzedDttm,"YYYYMMDDHHmmssSSS"),l=W()(t.analyzedDttm,"YYYYMMDDHHmmssSSS");return l.diff(a)}))),0!==i.value.length||(h.value-=1)}}if(I["SD의학연구소"]===B.value&&i.value.length>0){const e=i.value.map((e=>e.barcodeNo))??[],t=W()(f.value).format("YYYY-MM-DD"),a=W()(y.value).format("YYYY-MM-DD");try{const{data:l,code:s}=await Up(e,t,a);200===s&&(i.value=i.value.map((e=>{const t=l.data.find((t=>t.reqNo===e.barcodeNo));if(oc(t))return e;{const a={...e,patientNm:t.patName};return a}})))}catch(n){console.error(`SD 환자정보 조회 실패: ${n}`)}}if(i.value.length>0){const{path:e}=a.currentRoute.value;"/dataBase"===e&&(await t.dispatch("commonModule/setCommonInfo",{dbListDataFirstNum:Number(i.value[0].id)}),await t.dispatch("commonModule/setCommonInfo",{dbListDataLastNum:Number(i.value[i.value.length-1].id)}))}}catch(r){console.error(r)}},Ee=()=>{i.value=[];const e=y.value.getTime()-f.value.getTime(),t=e/864e5;t>31?Me("You cannot select a period of more than 31 days."):Le("search")},_e=()=>{Le("search")},Pe=async()=>{S.value={}},Te=async()=>{h.value+=1,await Le("loadMoreData")},Ae=async()=>{k.value=Re().prevPage,k.value-=1,k.value<=0||await Le("loadPrevData")},Me=async e=>{u.value=!0,d.value=e},De=()=>{u.value=!1},xe=async()=>{0!==D.value.length?(G.value=!0,await Ke(D.value),await Oe()):await Me("Select an Item")},Oe=async()=>{const e="01"===D.value[0].testType||"04"===D.value[0].testType?"01_WBC_Classification":"05_BF_Classification",t=""!==S.value?.img_drive_root_path&&S.value?.img_drive_root_path?S.value?.img_drive_root_path:x.value,a=D.value.map((a=>`${t}\\${a.slotId}\\${e}`));try{const e=await rp(a);"Application executed successfully"===e.data.message?await Me("Excel created"):await Me("Excel create failed")}catch(l){console.error(l),await Me("Excel create failed")}finally{G.value=!1}},Ke=async e=>{if(P.value)return;let t={},a={};for(const l of e){if("04"!==l.testType)continue;const e=await Ed(String(l.id));await $e();const s=e.data;se.value=s.rbcInfo.rbcClass,le.value=s.rbcInfoAfter,await Ue(s),await Xe(),await We(se.value),Be(se.value,le.value)&&await We(le.value);const o={before:{},after:{}};for(const a of se.value){let e={};const l=a.categoryId,o=le.value.filter((e=>e.categoryId===l))[0];for(const t of a.classInfo){const a=t.classId,l=o.classInfo.filter((e=>e.classId===a))[0],n={[t.classNm]:{degree:t.degree,count:Number(l.originalDegree)}};e={...e,...n},"Basophilic Stippling"===t.classNm&&(e={...e,Malaria:{degree:"-",count:Number(s.rbcInfo.malariaCount)}})}"Shape"===a.categoryNm&&(e={...e,Others:{degree:"-",count:Number(V.value)}}),t={...t,[a.categoryNm]:e},"Inclusion Body"===a.categoryNm&&(t={...t,Others:{Platelet:{degree:"-",count:Number(s.rbcInfo.pltCount)}}})}for(const t of le.value){let e={};for(const a of t.classInfo){const t={[a.classNm]:{degree:a.degree,count:Number(a.originalDegree)}};e={...e,...t},"Basophilic Stippling"===a.classNm&&(e={...e,Malaria:{degree:"-",count:Number(s.rbcInfo.malariaCount)}})}"Shape"===t.categoryNm&&(e={...e,Others:{degree:"-",count:Number(V.value)}}),a={...a,[t.categoryNm]:e},"Inclusion Body"===t.categoryNm&&(a={...a,Others:{Platelet:{degree:"-",count:Number(s.rbcInfo.pltCount)}}})}o.before=t,o.after=a,await Fe(s.slotId,o)}},Be=(e,t)=>{for(let a=0;a<e.length;a++){const l=e[a],s=t[a];for(let e=0;e<l.classInfo.length;e++){const t=l.classInfo[e],a=s.classInfo[e];if(String(t.degree)!==String(a.degree))return!1}}return!0},Fe=async(e,t)=>{const a=JSON.stringify(t),l=(new TextEncoder).encode(a),s=Md.Ay.deflate(l),o=new Blob([s],{type:"application/octet-stream"}),n=new FormData;n.append("file",o,"RBC.json");const i=""!==S.value?.img_drive_root_path&&S.value?.img_drive_root_path?S.value?.img_drive_root_path:x.value,r=`${i}/${e}/RBC_Analysis.json`;try{await fetch(`${K}/jsonReader/upload?filePath=${r}`,{method:"POST",body:n})}catch(c){console.error("Error:",c),Me("Excel print failed"),G.value=!1}},Ue=async e=>{const t=""!==e?.img_drive_root_path&&e?.img_drive_root_path?e?.img_drive_root_path:x.value,a=`${t}/${e?.slotId}/${aa.RBC_CLASS}/${e?.slotId}_new.json`,l=await Ro({fullPath:a}),s=`${t}/${e?.slotId}/${aa.RBC_CLASS}/${e?.slotId}.json`,o=await Ro({fullPath:s});if("not file"!==l.data){const e=l?.data;for(const t of o.data[0].rbcClassList)for(const a of e){const e=t.classInfo.findIndex((e=>Number(e.index)===Number(a.index)));if(-1!==e&&t.classInfo.splice(e,1),t.categoryId===a.categoryId){let e={classNm:a.classNm,classId:a.classId,posX:String(a.posX),posY:String(a.posY),width:a.width,height:a.height,index:a.index};t.classInfo.push(e)}}Y.value=o.data[0].rbcClassList}else Y.value=o?.data[0].rbcClassList;if(!Y.value||!Array.isArray(Y.value))return void console.error("rbcInfoPathAfter.value is not iterable");let n=0,i=0,r=0,c=0;V.value=0,Y.value.forEach((e=>{switch(e.categoryId){case v.SIZE.CATEGORY_ID:n=e.classInfo.length;break;case v.CHROMIA.CATEGORY_ID:i=e.classInfo.length;break;case v.SHAPE.CATEGORY_ID:r=e.classInfo.length;for(const t of e.classInfo)p.includes(t.classId)||(V.value+=1);break;case v.INCLUSION_BODY.CATEGORY_ID:c=e.classInfo.length;break;default:break}})),z.value=Number(n),Z.value=Number(n),ee.value=i,te.value=Number(r)+Number(c)},Xe=async()=>{if(!le.value||!Array.isArray(le.value))return;if(!se.value||!Array.isArray(se.value))return;if(!Y.value||!Array.isArray(Y.value))return;for(const a of le.value)for(const e of a.classInfo){let t=0;for(const l of Y.value)for(const s of l.classInfo)s.classNm.replace(/\s+/g,"")===e.classNm.replace(/\s+/g,"")&&l.categoryId===a.categoryId&&t++;e.originalDegree=t}let e=0,t=0;for(const a of Y.value){if("01"===a.categoryId){const e=a.classInfo[a.classInfo.length-1].index;j.value=Number(e.replace("S",""))+1}if("04"===a.categoryId)for(const t of a.classInfo)"Platelet"===t.classNm&&(e+=1);else if("05"===a.categoryId)for(const e of a.classInfo)"Malaria"===e.classNm&&(t+=1)}Q.value=Math.floor(e/parseFloat(j.value)*1e3),J.value=t},$e=async()=>{try{const e=await ie(),t=e.data;ae.value=t}catch(e){console.error(e)}},We=async e=>{if(P.value)return;let t=z.value,a=Z.value,l=ee.value;Array.isArray(se.value)&&(e.forEach((e=>{e.classInfo.forEach((s=>{ae.value&&ae.value.forEach((o=>{if(o.categoryId===e.categoryId&&o.classId===s.classId){const e=Number(s.originalDegree);let n=0;n="01"===o.categoryId?Number((e/a*100).toFixed(2)):"02"===o.categoryId?Number((e/l*100).toFixed(2)):Number((e/t*100).toFixed(2)),isNaN(n)&&(n=0);const i=e=>s.degree=e;return n<Number(o.degree1)?void i("0"):n<Number(o.degree2)?void i("1"):n<Number(o.degree3)?void i("2"):void i("3")}}))}))})),e.forEach((e=>{e.classInfo.forEach((s=>{ae.value&&ae.value.forEach((o=>{if(o.categoryId===e.categoryId&&o.classId===s.classId){const e=Number(s.originalDegree);let n=0;n="01"===o.categoryId?Number((e/a*100).toFixed(2)):"02"===o.categoryId?Number((e/l*100).toFixed(2)):Number((e/t*100).toFixed(2)),isNaN(n)&&(n=0);const i=e=>s.degree=e;n<Number(o.degree1)?i("0"):n<Number(o.degree2)?i("1"):n<Number(o.degree3)?i("2"):i("3")}}))}))})),e.forEach((e=>{e.classInfo.forEach((t=>{if("01"===e.categoryId&&("01"===t.classId&&(e.classInfo[0].degree="1"),["02","03"].includes(t.classId)&&Number(t.degree)>0&&(e.classInfo[0].degree="0")),"02"===e.categoryId&&("01"===t.classId&&(e.classInfo[0].degree="1"),["02","03"].includes(t.classId)&&Number(t.degree)>0&&(e.classInfo[0].degree="0")),"03"===e.categoryId&&("01"===t.classId&&(e.classInfo[0].degree="1",e.classInfo[1].degree="0"),"01"!==t.classId&&"02"!==t.classId)){var a=Number(e.classInfo[1].degree);Number(t.degree)>a&&(e.classInfo[0].degree="0",e.classInfo[1].degree=t.degree)}}))})))},He=()=>{f.value=g,y.value=new Date,b.value="",R.value=0,E.value="all",L.value="00",N.value=[],w.value=[],sessionStorage.removeItem("lastSearchParams"),localStorage.removeItem("lastSearchParams"),Ee()},Ge=e=>{D.value=e};return(e,t)=>{const a=(0,s.g2)("font-awesome-icon");return(0,s.uX)(),(0,s.CE)(s.FK,null,[G.value?((0,s.uX)(),(0,s.CE)("div",Qp,t[13]||(t[13]=[(0,s.Lk)("div",{class:"loaderForLogin"},null,-1),(0,s.Lk)("p",{class:"loadingTextLogin"},"Loading...",-1)]))):(0,s.Q3)("",!0),(0,s.Lk)("div",null,[(0,s.Lk)("h3",qp,[t[14]||(t[14]=(0,s.eW)(" Classification List ")),(0,s.Lk)("button",{onClick:(0,l.D$)(Ce,["stop"]),class:"classificationListBtn"},[_.value?((0,s.uX)(),(0,s.Wv)(a,{key:1,icon:["fas","caret-up"]})):((0,s.uX)(),(0,s.Wv)(a,{key:0,icon:["fas","caret-up"],flip:"vertical"}))])]),(0,s.Lk)("div",Jp,[(0,s.Lk)("div",zp,[(0,s.Lk)("div",null,[(0,s.bo)((0,s.Lk)("select",{"onUpdate:modelValue":t[0]||(t[0]=e=>C.value=e),class:"searchSelect"},t[15]||(t[15]=[(0,s.Lk)("option",{value:"barcodeNo"},"Barcode No",-1),(0,s.Lk)("option",{value:"patientId"},"Patient ID",-1),(0,s.Lk)("option",{value:"patientNm"},"Patient Name",-1)]),512),[[l.u1,C.value]]),(0,s.Lk)("div",Zp,[(0,s.bF)(a,{icon:["fas","magnifying-glass"],class:"search-icon"}),(0,s.bo)((0,s.Lk)("input",{type:"text","onUpdate:modelValue":t[1]||(t[1]=e=>b.value=e),placeholder:"Search",class:"searchInputBox",onKeydown:(0,l.jR)(be,["enter"]),ref_key:"barcodeInput",ref:H,onInput:ge},null,544),[[l.Jo,b.value]])]),t[16]||(t[16]=(0,s.eW)()),(0,s.Lk)("div",eg,[(0,s.bF)((0,o.R1)(Go.A),{modelValue:f.value,"onUpdate:modelValue":t[2]||(t[2]=e=>f.value=e)},null,8,["modelValue"]),(0,s.bF)((0,o.R1)(Go.A),{modelValue:y.value,"onUpdate:modelValue":t[3]||(t[3]=e=>y.value=e)},null,8,["modelValue"])]),(0,s.Lk)("button",{class:"searchClass",onClick:pe},"Today"),(0,s.Lk)("button",{class:"searchClass",onClick:He},"Clear"),(0,s.Lk)("button",{type:"button",class:"searchClass",onClick:Ee},"Search"),"main"===O.value?((0,s.uX)(),(0,s.CE)(s.FK,{key:0},[(0,s.bo)((0,s.Lk)("button",{onClick:fe,class:"searchClass",style:{left:"12%"}},"Patient List",512),[[l.aG,(0,o.R1)(I)["SD의학연구소"]===B.value]]),(0,s.bF)(a,{icon:["fas","file-csv"],onClick:xe,class:"excelIcon"})],64)):(0,s.Q3)("",!0)]),_.value?((0,s.uX)(),(0,s.CE)("div",tg,[P.value?(0,s.Q3)("",!0):((0,s.uX)(),(0,s.CE)("div",ag,[t[17]||(t[17]=(0,s.Lk)("span",null,"NR Count",-1)),(0,s.bo)((0,s.Lk)("input",{type:"text","onUpdate:modelValue":t[4]||(t[4]=e=>R.value=e)},null,512),[[l.Jo,R.value]])])),(0,s.Lk)("div",lg,[t[19]||(t[19]=(0,s.Lk)("span",null,"WBC Total",-1)),(0,s.bo)((0,s.Lk)("select",{"onUpdate:modelValue":t[5]||(t[5]=e=>E.value=e)},t[18]||(t[18]=[(0,s.Lk)("option",{value:"all"},"Do Not Select",-1),(0,s.Lk)("option",null,"DESC",-1),(0,s.Lk)("option",null,"ASC",-1)]),512),[[l.u1,E.value]])]),(0,s.Lk)("div",sg,[(0,s.Lk)("span",null,(0,n.v_)(P.value?"BM":"WBC")+" Info Filter",1),(0,s.Lk)("ul",og,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(w.value,((e,t)=>((0,s.uX)(),(0,s.CE)("li",{key:t},[(0,s.bo)((0,s.Lk)("input",{type:"checkbox",id:"checkbox_"+t,"onUpdate:modelValue":t=>e.checked=t,onChange:ke},null,40,ng),[[l.lH,e.checked]]),(0,s.Lk)("label",{for:"checkbox_"+t},(0,n.v_)(e.title),9,ig)])))),128))])]),(0,s.Lk)("div",rg,[t[26]||(t[26]=(0,s.Lk)("span",null,"Test Type",-1)),(0,s.Lk)("div",null,[(0,s.Lk)("label",null,[(0,s.Lk)("input",{type:"checkbox",value:"00",onChange:t[6]||(t[6]=e=>he("00")),checked:"00"===L.value},null,40,cg),t[20]||(t[20]=(0,s.Lk)("span",null,"All",-1))]),P.value?(0,s.Q3)("",!0):((0,s.uX)(),(0,s.CE)(s.FK,{key:0},[(0,s.Lk)("label",null,[(0,s.Lk)("input",{type:"checkbox",value:"01",onChange:t[7]||(t[7]=e=>he("01")),checked:"01"===L.value},null,40,ug),t[21]||(t[21]=(0,s.Lk)("span",null,"Diff",-1))]),(0,s.Lk)("label",null,[(0,s.Lk)("input",{type:"checkbox",value:"04",onChange:t[8]||(t[8]=e=>he("04")),checked:"04"===L.value},null,40,dg),t[22]||(t[22]=(0,s.Lk)("span",null,"PBS",-1))])],64)),P.value?((0,s.uX)(),(0,s.CE)(s.FK,{key:1},[(0,s.Lk)("label",null,[(0,s.Lk)("input",{type:"checkbox",value:"02",onChange:t[9]||(t[9]=e=>he("02")),checked:"02"===L.value},null,40,mg),t[23]||(t[23]=(0,s.Lk)("span",null,"Wedge",-1))]),(0,s.Lk)("label",null,[(0,s.Lk)("input",{type:"checkbox",value:"04",onChange:t[10]||(t[10]=e=>he("04")),checked:"04"===L.value},null,40,vg),t[24]||(t[24]=(0,s.Lk)("span",null,"Biopsy",-1))]),(0,s.Lk)("label",null,[(0,s.Lk)("input",{type:"checkbox",value:"06",onChange:t[11]||(t[11]=e=>he("06")),checked:"06"===L.value},null,40,pg),t[25]||(t[25]=(0,s.Lk)("span",null,"Squash",-1))])],64)):(0,s.Q3)("",!0)])])])):(0,s.Q3)("",!0)]),((0,s.uX)(),(0,s.Wv)(s.PR,null,[(0,s.bF)(Tv,{loadingDelayParents:U.value,dbData:i.value,onLoadMoreData:Te,onLoadPrevData:Ae,onInitData:Se,onSelectItem:we,onRefresh:_e,onCheckListItem:Ge,onDisableSelectItem:Pe,selectedItemIdFalse:X.value,notStartLoading:$.value},null,8,["loadingDelayParents","dbData","selectedItemIdFalse","notStartLoading"])],1024))]),(0,s.Lk)("div",gg,[(0,s.bF)(Yv,{dbData:i.value,selectedItem:S.value},null,8,["dbData","selectedItem"]),P.value?(0,s.Q3)("",!0):((0,s.uX)(),(0,s.Wv)(Zv,{key:0,dbData:i.value,selectedItem:S.value},null,8,["dbData","selectedItem"])),P.value?((0,s.uX)(),(0,s.Wv)(np,{key:1,dbData:i.value,selectedItem:S.value},null,8,["dbData","selectedItem"])):(0,s.Q3)("",!0)])]),(0,s.bF)(jp,{isOpen:re.value,"onUpdate:isOpen":t[12]||(t[12]=e=>re.value=e),workList:ce.value},null,8,["isOpen","workList"]),u.value?((0,s.uX)(),(0,s.Wv)(Pt,{key:1,"is-visible":u.value,message:d.value,onHide:De,"onUpdate:hideAlert":De},null,8,["is-visible","message"])):(0,s.Q3)("",!0)],64)}}});const bg=yg;var Ig=bg;const Cg=[{id:"none",text:"None"},{id:"line",text:"Line"},{id:"cross",text:"Cross"},{id:"circle",text:"Circle"}],hg=[{categoryId:"01",classId:"01"},{categoryId:"01",classId:"02"},{categoryId:"01",classId:"03"}],kg=[{categoryId:"02",classId:"01"},{categoryId:"02",classId:"02"},{categoryId:"02",classId:"03"}],Sg=[{categoryId:"03",classId:"01"},{categoryId:"03",classId:"03"},{categoryId:"03",classId:"04"},{categoryId:"03",classId:"05"},{categoryId:"03",classId:"06"},{categoryId:"03",classId:"07"},{categoryId:"03",classId:"08"},{categoryId:"03",classId:"09"},{categoryId:"03",classId:"10"},{categoryId:"03",classId:"11"}],wg=[{categoryId:"05",classId:"01"},{categoryId:"05",classId:"02"},{categoryId:"05",classId:"03"}],Ng=[{categoryId:"04",classId:"01"}],Rg=[...hg,...kg,...Sg,...wg,...Ng],Lg=lv.J1`
    mutation UpdateRunningInfo($updateDto: UpdateRuningInfoDto!) {
        updateRunningInfoGQL(updateDto: $updateDto) {
            id
            isNormal
            abnormalClassInfo {
                classNm
                val
            }
            pcIp
            lock_status
            wbcInfoAfter {
                id
                name
                count
                title
                images {
                    coordinates {
                        display
                    }
                    fileName
                    title
                    filter
                    height
                    width
                }
                percent
            }
        }
    }
`,Eg=lv.J1`
    mutation UpdateRunningInfo($updateDto: UpdateRuningInfoDto!) {
        updateRunningInfoGQL(updateDto: $updateDto) {
            id
            submitState
            submitOfDate
            submitUserId
        }
    }
`,_g=lv.J1`
    mutation UpdateRunningInfo($updateDto: UpdateRuningInfoDto!) {
        updateRunningInfoGQL(updateDto: $updateDto) {
            id
            wbcMemo
            rbcMemo
        }
    }
`,Pg=lv.J1`
    mutation UpdateRunningInfo($updateDto: UpdateRuningInfoDto!) {
        updateRunningInfoGQL(updateDto: $updateDto) {
            id
            rbcInfoAfter {
                classInfo {
                    classId
                    classNm
                    degree
                    originalDegree
                    percent
                }
                categoryId
                categoryNm
            }
        }
    }
`;function Tg(e={}){return av.n_(Lg,e)}function Ag(e={}){return av.n_(Eg,e)}function Mg(e={}){return av.n_(_g,e)}function Dg(e={}){return av.n_(Pg,e)}const xg=async(e,t)=>{const a={runingInfoDtoItems:[t]},{mutate:l,loading:s,error:o,onDone:n}=e({variables:{updateDto:a}});return await l()},Og={class:"createdRbc"},Kg={class:"mt10 flex-justify-between"},Bg={class:"leftWbcInfo rbcClass"},Fg={class:"pos-relative"},Ug={key:1,class:"memoModal"},Xg={class:"categoryNm"},$g={key:0,class:"mt18 mb14 liTitle"},Wg=["onClick"],Hg={style:{"margin-left":"12px","margin-top":"2px"}},Gg={class:"classNmRbc"},Yg={key:0,class:"mt18 mb14 liTitle flex-justify-start-align-center w-fit",style:{top:"-4px"}},Vg=["onClick"],jg={key:0},Qg={key:0},qg=["onClick"],Jg={key:0},zg={class:"degree analysis"},Zg={key:0,class:"mt18 mb14 liTitle"},ef={key:0},tf={key:0,class:"rbcSapn"},af={key:1,class:"rbcSapnDown"},lf={key:1},sf={key:0,class:"rbcSapn"},of={key:1,class:"rbcSapn"},nf={key:2,class:"rbcSapnDown"},rf={key:3,class:"rbcSapnDown"},cf={key:2},uf={key:3},df={key:4},mf={class:"rbcPercent"},vf={key:0,class:"mt18 mb14 liTitle"},pf={key:0},gf={key:1},ff={key:2,class:"defaultText"},yf={key:3,class:"defaultText"},bf={key:4},If={key:5,class:"underline"},Cf={class:"rbcPercent mr1"},hf={key:0,class:"mt18 mb14 liTitle"},kf={key:0},Sf={key:1},wf={key:2,class:"defaultText"},Nf={key:3,class:"defaultText"},Rf={key:4},Lf={class:"categories rbcClass"},Ef={class:"classNmRbc"},_f={key:0},Pf={class:"degree analysis"},Tf={style:{width:"130px"}},Af={key:0,class:"memoModal bottom text-left staticMemoModal"};var Mf=(0,s.pM)({__name:"rbcClass",props:["rbcInfo","type","allCheckClear","isCommitChanged","notCanvasClickVal"],setup(e,{emit:t}){const a=e=>e?.categoryNm,i=(0,o.KR)([]),u=e,d=(0,o.KR)([]),m=(0,o.KR)([]),g=(0,o.KR)(0),f=(0,o.KR)(0),y=(0,o.KR)(""),b=(0,o.KR)(50),I=(0,o.KR)(!1),C=(0,c.Pj)(),h=(0,o.KR)(!1),k=(0,o.KR)(""),S=(0,o.KR)(""),w=(0,o.KR)(!1),N=(0,o.KR)(""),R=(0,o.KR)(""),L=(0,s.EW)((()=>C.state.userModule)),E=(0,o.KR)(!1),_=(0,o.KR)([]),P=t,T=(0,o.KR)(""),A=(0,r.rd)(),M=(0,o.KR)(!1),D=(0,o.KR)([]),x=(0,o.KR)("Macrocyte"),O=(0,o.KR)({"01":!0,"02":!0,"03":!0,"05":!0,"04":!0}),K=(0,o.KR)([]),B=(0,o.KR)(0),F=(0,s.EW)((()=>C.state.commonModule.iaRootPath)),$=(0,o.KR)(!1),H=(0,s.EW)((()=>C.state.commonModule.rbcReData)),G=(0,s.EW)((()=>C.state.commonModule.resetRbcArr)),Y=(0,s.EW)((()=>C.state.commonModule.rbcImagePageNumber)),V=(0,s.EW)((()=>C.state.slideDataModule)),j=(0,o.KR)([]),Q=(0,o.KR)(0),q=(0,o.KR)(0),z=(0,o.KR)(0),Z=(0,o.KR)(0),ee=(0,o.KR)(0),te=(0,s.EW)((()=>C.state.commonModule.rbcReDataCheck)),ae=(0,o.KR)(null);let le;const se=(0,o.KR)(""),oe=(0,o.KR)(window.PROJECT_TYPE),ne=(0,o.KR)(0),re=(0,o.KR)([]),ce=(0,o.KR)({confirm:!1,memo:!1});(0,s.sV)((async()=>{await(0,s.dY)(),await C.dispatch("commonModule/setCommonInfo",{rbcImagePageNumber:0});const{path:e}=A.currentRoute.value;y.value=V.value?.rbcMemo,g.value=V.value?.rbcInfo.pltCount,f.value=V.value?.rbcInfo.malariaCount,y.value=V.value?.rbcMemo,T.value=V.value?.rbcInfo.maxRbcCount,se.value=V.value?.submitState,M.value="/report"===e,D.value=[],ue(),await pe(Y.value),await he(V.value),await ke()})),(0,s.wB)((()=>u.isCommitChanged),(()=>{se.value="Submit"})),(0,s.wB)((()=>u.allCheckClear),(e=>{i.value=[],_.value=[]}),{deep:!0}),(0,s.wB)((()=>Y.value),(async e=>{await pe(e),await ke()}));const ue=()=>{if(D.value=[],!V.value?.rbcInfo)return;const e=V.value?.rbcInfo.rbcClass||V.value?.rbcInfo;if(e)for(const t of e)t.classInfo.forEach((e=>{"Normal"!==e.classNm&&D.value.push({...e,categoryId:t.categoryId})}));D.value.push({categoryId:"04",classId:"01",classNm:"Platelet"},{categoryId:"05",classId:"03",classNm:"Malaria"})};(0,s.wB)((()=>V.value.id),(async(e,t)=>{await(0,s.dY)(),await pe(Y.value),await Ke(),await Be(m.value),g.value=V.value?.pltCount,f.value=V.value?.malariaCount,y.value=V.value?.rbcMemo,se.value=V.value?.submitState,ue(),O.value={"01":!0,"02":!0,"03":!0,"04":!0,"05":!0},await ke()}),{deep:!0}),(0,s.wB)((()=>G),(async e=>{e&&(await C.dispatch("commonModule/setCommonInfo",{resetRbcArr:!1}),await pe(Y.value),await ke())}),{deep:!0}),(0,s.wB)((()=>u.allCheckClear),(()=>{i.value=[],_.value=[],O.value={"01":!0,"02":!0,"03":!0,"04":!0,"05":!0}}),{deep:!0}),(0,s.wB)((()=>H),(async e=>{e&&(clearTimeout(le),le=setTimeout((async()=>{$.value=!1,await pe(Y.value),await ke(),await Ke()}),1e3))}),{deep:!0});const de=(e,t,a)=>a.find((a=>a.categoryId===e&&a.classId===t)),me=(e,t,a,l)=>{u.notCanvasClickVal||de(e,t,Rg)&&(ve(e,t,a),Ce(a,l,e,t))},ve=(e,t,a)=>{const l=`${e}-${t}`,s=i.value.includes(l),o=i.value.filter((e=>e.startsWith(v.OTHERS.CATEGORY_ID)));if(s)i.value=i.value.filter((e=>e!==l));else if(e===v.OTHERS.CATEGORY_ID)i.value.push(l);else{const t=i.value.map((e=>e.split("-")[0])),a=t.some((e=>"03"===e||"05"===e))&&("03"===e||"05"===e);t.includes(e)||a?i.value.push(l):(i.value=[l],o.length>0&&(i.value=[...i.value,...o]))}const n={"01":hg,"02":kg,"03":Sg,"04":Ng,"05":wg};if(n[e]&&e!==v.OTHERS.CATEGORY_ID){const e=new Set(i.value);for(const t of Object.keys(O.value)){const a=t===v.SHAPE.CATEGORY_ID||t===v.INCLUSION_BODY.CATEGORY_ID?[...Sg,...wg].map((e=>`${e.categoryId}-${e.classId}`)):n[t].map((e=>`${e.categoryId}-${e.classId}`)),l=a.every((t=>e.has(t)));O.value[t]=!l||!l}}Ne(a,!s,e,t)},pe=async e=>{const t=""!==V.value?.img_drive_root_path&&V.value?.img_drive_root_path?V.value?.img_drive_root_path:F.value,a=`${t}/${V.value.slotId}/${aa.RBC_CLASS}/${V.value.slotId}_new_${Y.value}.json`,l=await Ro({fullPath:a}),s=`${t}/${V.value.slotId}/${aa.RBC_CLASS}/${V.value.slotId}.json`;if(re.value=await Ro({fullPath:s}),"not file"!==l.data){const t=l?.data;for(const a of re.value.data[e].rbcClassList)for(const e of t){const t=a.classInfo.findIndex((t=>t.index===e.index));if(-1!==t&&a.classInfo.splice(t,1),a.categoryId===e.categoryId){let t={classNm:e.classNm,classId:e.classId,posX:String(e.posX),posY:String(e.posY),width:e.width,height:e.height,index:e.index};a.classInfo.push(t)}}K.value=re.value?.data[e].rbcClassList}else 0!==re.value?.data.length&&re.value?.data[e]?K.value=re.value?.data[e].rbcClassList:K.value=[];if(!K.value||!Array.isArray(K.value))return;let o=0,n=0,i=0,r=0;ne.value=0,K.value.forEach((e=>{switch(e.categoryId){case v.SIZE.CATEGORY_ID:o=e.classInfo.length;break;case v.CHROMIA.CATEGORY_ID:n=e.classInfo.length;break;case v.SHAPE.CATEGORY_ID:i=e.classInfo.length;for(const t of e.classInfo)p.includes(t.classId)||(ne.value+=1);break;case v.INCLUSION_BODY.CATEGORY_ID:r=e.classInfo.length;break;default:break}})),B.value=Number(o),Q.value=Number(o),q.value=n,z.value=Number(r),Z.value=Number(i),ee.value=Number(i)+Number(r)},ge=(e,t)=>{const a=(Number(e)/fe(t)*100).toFixed(1);return isNaN(a)?"-":Number(a)===Math.floor(Number(a))?Math.floor(Number(a)).toString():a},fe=e=>{switch(e){case v.SIZE.CATEGORY_ID:return Number(B.value);case v.CHROMIA.CATEGORY_ID:return Number(q.value);case v.SHAPE.CATEGORY_ID:case v.INCLUSION_BODY.CATEGORY_ID:return Number(ee.value);default:return Number(B.value)}},ye=async()=>{const e=JSON.parse(JSON.stringify(d.value));if(!Array.isArray(e))return;const t=e.find((e=>e.categoryNm===x.value));if(t)b.value=t.sensitivity||50;else{for(const t of e){const e=t.classInfo.find((e=>e.classNm===x.value));if(e)return void(b.value=e.sensitivity||50)}b.value=50}},be=()=>{null!==ae.value&&clearTimeout(ae.value)};(0,s.wB)(te,(e=>{be(),null!==ae.value&&clearInterval(ae.value),ae.value=window.setInterval((()=>{e&&Ie()}),800)}),{deep:!0});const Ie=async()=>{$.value=!0,await Se(x.value),await C.dispatch("commonModule/setCommonInfo",{rbcReData:!1});const e={jobCmd:"RBC_RE_CLASSIFICATION",sensitivity:Number(b.value),reqDttm:J().embedStatus.settings.reqDttm,reqUserId:L.value.userId||"",className:x.value.replace(/\s/g,""),slotId:V.value?.slotId,anyWay:"true"};Nt.publish("childEmitSocketData",e)},Ce=(e,t,a,l)=>{if("Normal"===e)return;const s=JSON.parse(JSON.stringify(d.value));for(const o of s)for(const t of o?.classInfo)t.classNm===e&&t.classId===l&&(b.value=t.sensitivity||50);x.value=e},he=async e=>{E.value=!1,P("isBeforeUpdate",!1);const t=V.value;m.value=t.rbcInfo?.rbcClass?t.rbcInfo.rbcClass:t,d.value=V.value?.rbcInfoAfter,await ye()},ke=async()=>{if(!m.value||!Array.isArray(m.value))return;if(!K.value||!Array.isArray(K.value))return;for(const a of m.value)for(const e of a.classInfo){let t=0;for(const l of K.value)for(const s of l.classInfo)s.classId===e.classId&&l.categoryId===a.categoryId&&t++;e.originalDegree=t,e.percent=ge(t,a.categoryId)}T.value=0;let e=0,t=0;for(const a of K.value)if(a.categoryId!==v.SHAPE.CATEGORY_ID&&a.categoryId!==v.INCLUSION_BODY.CATEGORY_ID||(T.value+=Number(a.classInfo.length)),a.categoryId===v.OTHERS.CATEGORY_ID)for(const t of a.classInfo)t.classId===v.OTHERS.PLATELET&&(e+=1);else if(a.categoryId===v.INCLUSION_BODY.CATEGORY_ID)for(const e of a.classInfo)e.classId===v.INCLUSION_BODY.MALARIA&&(t+=1);g.value=Math.floor(e/parseFloat(T.value)*1e3),f.value=t},Se=async e=>{let t=JSON.parse(JSON.stringify(d.value));for(const s of t)if(s.categoryNm===e)s.sensitivity=b.value;else{const t=s?.classInfo?.findIndex((t=>t.classNm===e));-1!==t&&void 0!==t&&s?.classInfo&&(s.classInfo[t].sensitivity=b.value)}d.value=t;const a={rbcInfoAfter:t},l={...V.value,...a};await xg(Dg,{id:l.id,rbcInfoAfter:l.rbcInfoAfter}),await C.dispatch("slideDataModule/updateSlideData",l)},we=(e,t)=>{if(u.notCanvasClickVal)return;const a=t===v.SHAPE.CATEGORY_ID||t===v.INCLUSION_BODY.CATEGORY_ID?[...Sg,...wg]:Rg.filter((e=>e.categoryId===t)),l=i.value.some((e=>e.startsWith(v.OTHERS.CATEGORY_ID)))?[...a,...Ng]:a,s=m.value.flatMap((e=>{const a=e.classInfo.filter((t=>de(e.categoryId,t.classId,l))).map((t=>({classNm:t.classNm,categoryId:e.categoryId,classId:t.classId})));return t===e.categoryId&&e.categoryId===v.INCLUSION_BODY.CATEGORY_ID&&a.push({classNm:"Malaria",categoryId:"05",classId:"03"}),a}));t===v.OTHERS.CATEGORY_ID&&s.push({classNm:"Platelet",categoryId:"04",classId:"01"});const o=l.map((e=>`${e.categoryId}-${e.classId}`));if(e){const e=i.value.some((e=>e.startsWith(t)));i.value=e?[...new Set([...i.value,...o])]:o}else i.value=i.value.filter((e=>e.startsWith(v.OTHERS.CATEGORY_ID)||!o.includes(e)));for(const i of s)Ne(i.classNm,e,i.categoryId,i.classId);const n=["01","02","03","04","05"];for(const i of n)O.value[i]=!0;e&&(t===v.SHAPE.CATEGORY_ID||t===v.INCLUSION_BODY.CATEGORY_ID?(O.value[v.SHAPE.CATEGORY_ID]=!1,O.value[v.INCLUSION_BODY.CATEGORY_ID]=!1):O.value[t]=!1)},Ne=(e,t,a,l)=>{if(u.notCanvasClickVal)return;const s={classNm:e,categoryId:a,classId:l};t?(_.value.push(s),_.value=_.value.filter((e=>i.value.includes(`${e.categoryId}-${e.classId}`)))):_.value=_.value.filter((t=>!(t.classNm===e&&t.classId===l&&t.categoryId===a))),P("classInfoArrUpdate",_.value)};(0,s.wB)(H,(async(e,t)=>{e&&Re()}),{deep:!0});const Re=()=>{P("classInfoArrUpdateRe",_.value)},Le=async(e,t,a,l=!1)=>{if("report"===u.type)return;const s=JSON.parse(JSON.stringify(d.value)).map((s=>(s.categoryNm===e.categoryNm&&(s.classInfo=s.classInfo.map((e=>(e.classNm===t.classNm&&(e.degree=String(l?0===Number(e.degree)?1:0:a)),e)))),s)));d.value=s;const o={rbcInfoAfter:s},n={...V.value,...o};await C.dispatch("commonModule/setCommonInfo",{rbcInfoAfterData:s}),await C.dispatch("slideDataModule/updateSlideData",n);const i=await xg(Dg,{id:n.id,rbcInfoAfter:n.rbcInfoAfter});i&&0!==i?.data?.updateRunningInfoGQL[0].length&&(await pe(Y.value),await ke(),await Ke())},Ee=()=>{I.value=!I.value},_e=()=>{I.value=!1},Pe=async()=>{const e=y.value.replaceAll("\r\n","<br>"),t={rbcMemo:e},a={...V.value,...t},l=await xg(Mg,{id:a.id,wbcMemo:a.wbcMemo,rbcMemo:a.rbcMemo});l&&0!==l?.data?.updateRunningInfoGQL[0].length&&(y.value=a.rbcMemo,Te("Success")),I.value=!1},Te=e=>{h.value=!0,k.value="success",S.value=e,window.scrollTo({top:0,behavior:"smooth"})},Ae=()=>{h.value=!1},Me=()=>{"Submit"!==se.value&&(w.value=!0,R.value=U.IDS_MSG_CONFIRM_SLIDE)},De=()=>{Oe(),w.value=!1},xe=()=>{w.value=!1},Oe=async()=>{const e=W()().local(),t={submitState:"Submit",submitOfDate:e.format(),submitUserId:L.value.userId},a={...V.value,...t};await xg(Ag,{id:a.id,submitState:a.submitState,submitOfDate:a.submitOfDate,submitUserId:a.submitUserId}),P("submitStateChanged","Submit")},Ke=async()=>{try{const e=await ie(),t=e.data;j.value=t}catch(e){console.error(e)}},Be=async e=>{if("bm"===oe.value)return;let t=B.value,a=Q.value,l=q.value;Array.isArray(m.value)&&(e.forEach((e=>{e.classInfo.forEach((s=>{j.value&&j.value.forEach((o=>{if(o.categoryId===e.categoryId&&o.classId===s.classId){const e=Number(s.originalDegree);let n=0;n=o.categoryId===v.SIZE.CATEGORY_ID?Number((e/a*100).toFixed(2)):o.categoryId===v.CHROMIA.CATEGORY_ID?Number((e/l*100).toFixed(2)):Number((e/t*100).toFixed(2)),isNaN(n)&&(n=0);const i=e=>s.degree=e;return n<Number(o.degree1)?void i("0"):n<Number(o.degree2)?void i("1"):n<Number(o.degree3)?void i("2"):void i("3")}}))}))})),e.forEach((e=>{e.classInfo.forEach((s=>{j.value&&j.value.forEach((o=>{if(o.categoryId===e.categoryId&&o.classId===s.classId){const e=Number(s.originalDegree);let n=0;n=o.categoryId===v.SIZE.CATEGORY_ID?Number((e/a*100).toFixed(2)):o.categoryId===v.CHROMIA.CATEGORY_ID?Number((e/l*100).toFixed(2)):Number((e/t*100).toFixed(2)),isNaN(n)&&(n=0);const i=e=>s.degree=e;n<Number(o.degree1)?i("0"):n<Number(o.degree2)?i("1"):n<Number(o.degree3)?i("2"):i("3")}}))}))})),e.forEach((e=>{e.classInfo.forEach((t=>{if(e.categoryId===v.SIZE.CATEGORY_ID&&(t.classId===v.SIZE.NORMAL&&(e.classInfo[0].degree="1"),[v.SIZE.MACROCYTE,v.SIZE.MICROCTYE].includes(t.classId)&&Number(t.degree)>0&&(e.classInfo[0].degree="0")),e.categoryId===v.CHROMIA.CATEGORY_ID&&(t.classId===v.CHROMIA.NORMAL&&(e.classInfo[0].degree="1"),[v.CHROMIA.HYPERCHROMIC,v.CHROMIA.HYPOCHROMIC].includes(t.classId)&&Number(t.degree)>0&&(e.classInfo[0].degree="0")),e.categoryId===v.SHAPE.CATEGORY_ID&&(t.classId===v.SHAPE.NORMAL&&(e.classInfo[0].degree="1",e.classInfo[1].degree="0"),t.classId!==v.SHAPE.NORMAL&&t.classId!==v.SHAPE.POLIKILOCYTOSIS)){var a=Number(e.classInfo[1].degree);Number(t.degree)>a&&(e.classInfo[0].degree="0",e.classInfo[1].degree=t.degree)}}))})))},Fe=(e,t)=>{ce.value[e]=t};return(t,r)=>{const c=(0,s.g2)("font-awesome-icon");return(0,s.uX)(),(0,s.CE)(s.FK,null,[(0,s.bo)((0,s.Lk)("div",Og," Creating a new RBC classification ...",512),[[l.aG,$.value]]),(0,s.Lk)("div",null,[(0,s.Lk)("div",Kg,[r[11]||(r[11]=(0,s.Lk)("h3",{class:"wbcClassInfoLeft"},"RBC Classification",-1)),(0,s.Lk)("ul",Bg,[(0,s.Lk)("li",Fg,["report"!==e.type?((0,s.uX)(),(0,s.Wv)(c,{key:0,icon:["fas","comment-dots"],onClick:Ee,onMouseenter:r[0]||(r[0]=e=>Fe("memo",!0)),onMouseleave:r[1]||(r[1]=e=>Fe("memo",!1))})):(0,s.Q3)("",!0),I.value?((0,s.uX)(),(0,s.CE)("div",Ug,[(0,s.bo)((0,s.Lk)("textarea",{"onUpdate:modelValue":r[2]||(r[2]=e=>y.value=e)},null,512),[[l.Jo,y.value]]),(0,s.Lk)("button",{class:"memoModalBtn",onClick:Pe},"OK"),(0,s.Lk)("button",{class:"memoModalBtn",onClick:_e},"CANCEL")])):(0,s.Q3)("",!0),(0,s.bF)(rn,{isVisible:ce.value.memo,className:"mb08",position:"top",type:"",message:(0,o.R1)(X).TOOLTIP.MEMO},null,8,["isVisible","message"])]),(0,s.Lk)("li",{class:(0,n.C4)(["pos-relative",{submitted:"Submit"===se.value}]),onClick:Me},[(0,s.bF)(c,{icon:["fas","square-check"],onMouseenter:r[3]||(r[3]=e=>Fe("confirm",!0)),onMouseleave:r[4]||(r[4]=e=>Fe("confirm",!1))}),(0,s.bF)(rn,{isVisible:ce.value.confirm,className:"mb08",position:"top",type:"",message:(0,o.R1)(X).TOOLTIP.CONFIRM},null,8,["isVisible","message"])],2)])]),((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)([m.value],((t,u)=>((0,s.uX)(),(0,s.CE)(s.FK,{key:u},[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(t,((t,m)=>((0,s.uX)(),(0,s.CE)("div",{key:m,class:"categories rbcClass"},[(0,s.Lk)("ul",Xg,[0===m?((0,s.uX)(),(0,s.CE)("li",$g,"Category")):(0,s.Q3)("",!0),(0,s.Lk)("li",{onClick:e=>we(O.value[t?.categoryId],t?.categoryId),class:"flex-column cursorPointer",style:{"padding-top":"6px"}},[(0,s.Lk)("span",null,(0,n.v_)(a(t)),1),(0,s.Lk)("span",Hg,[(0,s.bo)((0,s.bF)(c,{class:"rbc-allCheck-eye-font rbc-check-eye-font",icon:["fas","eye"],color:"#29C7CA"},null,512),[[l.aG,"report"!==e.type&&!O.value[t?.categoryId]&&"05"!==t?.categoryId]]),(0,s.bo)((0,s.bF)(c,{class:"rbc-allCheck-eye-font rbc-check-eye-font",icon:["fas","eye-slash"]},null,512),[[l.aG,"report"!==e.type&&O.value[t?.categoryId]&&"05"!==t?.categoryId]])])],8,Wg)]),(0,s.Lk)("ul",Gg,[0===m?((0,s.uX)(),(0,s.CE)("li",Yg,r[12]||(r[12]=[(0,s.Lk)("p",{style:{"padding-top":"2px"}},"Class",-1)]))):(0,s.Q3)("",!0),((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(t?.classInfo,((a,u)=>((0,s.uX)(),(0,s.CE)(s.FK,{key:`${t?.categoryId}-${a?.classId}`},[(0,s.Lk)("li",{onClick:e=>me(t?.categoryId,a?.classId,a?.classNm,t?.categoryNm),class:"flex-align-center cursorPointer"},[(0,s.Lk)("span",null,(0,n.v_)("TearDropCell"===a?.classNm?"TearDrop Cell":a?.classNm),1),de(t?.categoryId,a?.classId,(0,o.R1)(Rg))&&"report"!==e.type?((0,s.uX)(),(0,s.CE)("div",jg,[(0,s.bo)((0,s.bF)(c,{icon:["fas","eye"],class:"rbc-check-eye-font",color:"#29C7CA"},null,512),[[l.aG,!M.value&&i.value.includes(`${t?.categoryId}-${a?.classId}`)]]),(0,s.bo)((0,s.bF)(c,{icon:["fas","eye-slash"],class:"rbc-check-eye-font"},null,512),[[l.aG,!M.value&&!i.value.includes(`${t?.categoryId}-${a?.classId}`)]])])):(0,s.Q3)("",!0)],8,Vg),u===t?.classInfo.length-1&&"03"===t?.categoryId?((0,s.uX)(),(0,s.CE)("li",Qg,r[13]||(r[13]=[(0,s.Lk)("span",null,"Others",-1)]))):(0,s.Q3)("",!0),u===t?.classInfo.length-1&&"05"===t?.categoryId?((0,s.uX)(),(0,s.CE)("li",{key:1,onClick:e=>me("05","03",a?.classNm,t?.categoryNm),class:"flex-align-center"},[r[14]||(r[14]=(0,s.Lk)("span",null,"Malaria",-1)),"report"!==e.type?((0,s.uX)(),(0,s.CE)("div",Jg,[(0,s.bo)((0,s.bF)(c,{icon:["fas","eye"],class:"rbc-check-eye-font",color:"#29C7CA",onChange:r[5]||(r[5]=e=>Ne("Malaria",e.target.checked,"05","03"))},null,512),[[l.aG,!M.value&&i.value.includes("05-03")]]),(0,s.bo)((0,s.bF)(c,{icon:["fas","eye-slash"],class:"rbc-check-eye-font",onChange:r[6]||(r[6]=e=>Ne("Malaria",e.target.checked,"05","03"))},null,512),[[l.aG,!M.value&&!i.value.includes("05-03")]])])):(0,s.Q3)("",!0)],8,qg)):(0,s.Q3)("",!0)],64)))),128))]),(0,s.Lk)("ul",zg,[0===m?((0,s.uX)(),(0,s.CE)("li",Zg,r[15]||(r[15]=[(0,s.Lk)("p",null,"Degree",-1),(0,s.Lk)("p",{class:"rbcDegree-span-wrapper"},[(0,s.Lk)("span",null,"0"),(0,s.Lk)("span",null,"1+"),(0,s.Lk)("span",null,"2+"),(0,s.Lk)("span",null,"3+")],-1)]))):(0,s.Q3)("",!0),((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(t?.classInfo,((e,a)=>((0,s.uX)(),(0,s.CE)(s.FK,{key:`${t.categoryId}-${e.classId}`},["01"!==e?.classId||"05"===t?.categoryId||"01"!==d.value[m]?.classInfo[a].classId||"05"===d.value[m]?.categoryId?((0,s.uX)(),(0,s.CE)("li",ef,["01"!==e?.classId||"05"===t?.categoryId?((0,s.uX)(),(0,s.CE)("span",tf,[((0,s.uX)(),(0,s.CE)(s.FK,null,(0,s.pI)(4,(t=>(0,s.bF)(c,{icon:["fac","half-circle-up"],key:t,class:(0,n.C4)({degreeActive:t<Number(e?.degree)+2||0,"degree0-img":t>=Number(e?.degree)+1||0}),onClick:e=>Le(d.value[m],d.value[m]?.classInfo[a],t-1,!1)},null,8,["class","onClick"]))),64))])):(0,s.Q3)("",!0),"01"!==d.value[m]?.classInfo[a]?.classId||"05"===d.value[m]?.categoryId?((0,s.uX)(),(0,s.CE)("span",af,[((0,s.uX)(),(0,s.CE)(s.FK,null,(0,s.pI)(4,(e=>(0,s.bF)(c,{icon:["fac","half-circle-down"],key:e+"-down",class:(0,n.C4)({degreeActive:e<Number(d.value[m]?.classInfo[a]?.degree)+2||0,"degree0-img":e>=Number(d.value[m]?.classInfo[a]?.degree)+1||0}),onClick:t=>Le(d.value[m],d.value[m]?.classInfo[a],e-1,!1)},null,8,["class","onClick"]))),64))])):(0,s.Q3)("",!0)])):((0,s.uX)(),(0,s.CE)("li",lf,["0"===e.degree?((0,s.uX)(),(0,s.CE)("span",sf,[(0,s.bF)(c,{icon:["fac","half-circle-up"]})])):((0,s.uX)(),(0,s.CE)("span",of,[(0,s.bF)(c,{icon:["fac","half-circle-up"],class:"degreeActive"})])),"0"===d.value[m]?.classInfo[a]?.degree?((0,s.uX)(),(0,s.CE)("span",nf,[(0,s.bF)(c,{onClick:e=>Le(d.value[m],d.value[m]?.classInfo[a],"0",!0),icon:["fac","half-circle-down"]},null,8,["onClick"])])):((0,s.uX)(),(0,s.CE)("span",rf,[(0,s.bF)(c,{onClick:e=>Le(d.value[m],d.value[m]?.classInfo[a],"1",!0),icon:["fac","half-circle-down"],class:"degreeActive"},null,8,["onClick"])]))])),a===t?.classInfo.length-1&&"03"===d.value[m]?.categoryId?((0,s.uX)(),(0,s.CE)("li",cf," - ")):(0,s.Q3)("",!0),a===t?.classInfo.length-1&&"05"===d.value[m]?.categoryId?((0,s.uX)(),(0,s.CE)("li",uf," - ")):(0,s.Q3)("",!0),a===t?.classInfo.length-1?((0,s.uX)(),(0,s.CE)("div",df,[((0,s.uX)(),(0,s.CE)(s.FK,null,(0,s.pI)(["01","02","05"],(e=>(0,s.bo)((0,s.Lk)("div",{key:e,class:"underline"}," Total "),[[l.aG,d.value[m].categoryId===e]]))),64))])):(0,s.Q3)("",!0)],64)))),128))]),(0,s.Lk)("ul",mf,[0===m?((0,s.uX)(),(0,s.CE)("li",vf,"Count")):(0,s.Q3)("",!0),((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(t?.classInfo,((e,a)=>((0,s.uX)(),(0,s.CE)(s.FK,{key:`${u}-${m}-${a}`},["Poikilocyte"!==e?.classNm?((0,s.uX)(),(0,s.CE)("li",pf,(0,n.v_)(Number(e?.originalDegree)||0),1)):((0,s.uX)(),(0,s.CE)("li",gf,"-")),a===t?.classInfo.length-1&&"03"===t?.categoryId?((0,s.uX)(),(0,s.CE)("li",ff,(0,n.v_)(Number(ne.value)||0),1)):(0,s.Q3)("",!0),a===t?.classInfo.length-1&&"05"===t?.categoryId?((0,s.uX)(),(0,s.CE)("li",yf,(0,n.v_)(Number(f.value)||0),1)):(0,s.Q3)("",!0),a===t?.classInfo.length-1?((0,s.uX)(),(0,s.CE)("div",bf,[((0,s.uX)(),(0,s.CE)(s.FK,null,(0,s.pI)(["01","02"],(e=>(0,s.bo)((0,s.Lk)("div",{key:e,class:"underline"},(0,n.v_)(Number(Q.value)||0),1),[[l.aG,d.value[m].categoryId===e]]))),64))])):(0,s.Q3)("",!0),a===t?.classInfo.length-1&&"05"===d.value[m]?.categoryId?((0,s.uX)(),(0,s.CE)("div",If,(0,n.v_)(Number(ee.value)||0),1)):(0,s.Q3)("",!0)],64)))),128))]),(0,s.Lk)("ul",Cf,[0===m?((0,s.uX)(),(0,s.CE)("li",hf,"Percent")):(0,s.Q3)("",!0),((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(t?.classInfo,((e,a)=>((0,s.uX)(),(0,s.CE)(s.FK,{key:`${u}-${m}-${a}`},["Poikilocyte"!==e?.classNm?((0,s.uX)(),(0,s.CE)("li",kf,(0,n.v_)(Number(e?.percent)||0),1)):((0,s.uX)(),(0,s.CE)("li",Sf,"-")),a===t?.classInfo.length-1&&"03"===d.value[m]?.categoryId?((0,s.uX)(),(0,s.CE)("li",wf,(0,n.v_)(ge(ne.value,(0,o.R1)(v).SHAPE.CATEGORY_ID)||0),1)):(0,s.Q3)("",!0),a===t?.classInfo.length-1&&"05"===d.value[m]?.categoryId?((0,s.uX)(),(0,s.CE)("li",Nf,(0,n.v_)(ge(f.value,(0,o.R1)(v).INCLUSION_BODY.CATEGORY_ID)||0),1)):(0,s.Q3)("",!0),a===t?.classInfo.length-1?((0,s.uX)(),(0,s.CE)("div",Rf,[((0,s.uX)(),(0,s.CE)(s.FK,null,(0,s.pI)(["01","02","05"],(e=>(0,s.bo)((0,s.Lk)("div",{key:e,class:"underline"}," 100% "),[[l.aG,d.value[m]?.categoryId===e]]))),64))])):(0,s.Q3)("",!0)],64)))),128))])])))),128))],64)))),128)),(0,s.Lk)("div",null,[(0,s.Lk)("div",Lf,[r[17]||(r[17]=(0,s.Lk)("ul",{class:"categoryNm"},[(0,s.Lk)("li",null,"Others")],-1)),(0,s.Lk)("ul",Ef,[(0,s.Lk)("li",{onClick:r[9]||(r[9]=e=>me("04","01","Platelet","Others")),style:{"padding-top":"0"},class:"flex-align-center"},[r[16]||(r[16]=(0,s.Lk)("span",null,"Platelet",-1)),"report"!==e.type?((0,s.uX)(),(0,s.CE)("div",_f,[(0,s.bo)((0,s.bF)(c,{icon:["fas","eye"],class:"rbc-check-eye-font",color:"#29C7CA",onChange:r[7]||(r[7]=e=>Ne("Platelet",e.target.checked,"04","01"))},null,512),[[l.aG,!M.value&&i.value.includes("04-01")]]),(0,s.bo)((0,s.bF)(c,{icon:["fas","eye-slash"],class:"rbc-check-eye-font",onChange:r[8]||(r[8]=e=>Ne("Platelet",e.target.checked,"04","01"))},null,512),[[l.aG,!M.value&&!i.value.includes("04-01")]])])):(0,s.Q3)("",!0)])]),(0,s.Lk)("ul",Pf,[(0,s.Lk)("li",Tf,(0,n.v_)(g.value||0)+" PLT / 1000 RBC",1)]),r[18]||(r[18]=(0,s.Lk)("ul",{class:"rbcPercent"},null,-1)),r[19]||(r[19]=(0,s.Lk)("ul",{class:"rbcPercent"},null,-1))])]),"/report"===(0,o.R1)(A).currentRoute.value.path?((0,s.uX)(),(0,s.CE)("div",Af,[(0,s.bo)((0,s.Lk)("textarea",{class:"staticTextArea","onUpdate:modelValue":r[10]||(r[10]=e=>y.value=e)},null,512),[[l.Jo,y.value]]),(0,s.Lk)("button",{class:"memoModalBtn",onClick:Pe},"Save")])):(0,s.Q3)("",!0)]),h.value?((0,s.uX)(),(0,s.Wv)(Pt,{key:0,"is-visible":h.value,type:k.value,message:S.value,onHide:Ae,"onUpdate:hideAlert":Ae},null,8,["is-visible","type","message"])):(0,s.Q3)("",!0),w.value?((0,s.uX)(),(0,s.Wv)(ra,{key:1,"is-visible":w.value,type:N.value,message:R.value,onHide:xe,onOkConfirm:De},null,8,["is-visible","type","message"])):(0,s.Q3)("",!0)],64)}}});const Df=Mf;var xf=Df,Of=a(4791),Kf=a.n(Of);const Bf=Z(),Ff=async e=>Bf.httpGet(ee.images.move,e,!0),Uf=async e=>Bf.httpPost(ee.images.moveClassImage,e,"",!1,window.VIEWER_CHECK),Xf={key:0},$f=["src","onClick","onDragstart","onDblclick"],Wf=["src","onClick","onDragstart","onDblclick"],Hf={key:1},Gf={class:"wbcModal"},Yf={class:"wbcModalImageContent"},Vf=["src"];var jf=(0,s.pM)({__name:"Malaria",props:["selectItems"],setup(e){const t=e,a=sessionStorage.getItem("iaRootPath")||aa.IA_ROOT_PATH,i=window.APP_API_BASE_URL||"http://192.168.0.115:3002",r=(0,o.KR)([]),c=(0,o.KR)([]),u=(0,o.KR)([]),d=(0,o.KR)("");let m=(0,o.KR)(null),v=(0,o.KR)([]);const p=(0,o.KR)(!1),g=(0,o.KR)(!1),f=(0,o.KR)("150px"),y=(0,o.KR)("150px");async function b(e,l){const s=t.selectItems.slotId||"",o=""!==t.selectItems?.img_drive_root_path&&t.selectItems?.img_drive_root_path?t.selectItems?.img_drive_root_path:a,n=`${o}/${s}/${aa.RBC_CLASS}/${e}`;try{const e=await fetch(`${i}/folders?folderPath=${n}`);if(!e.ok)throw p.value=!1,new Error("Network response was not ok");{const t=await e.json();l.value=t.map((e=>`${i}/folders?folderPath=${n}/${e}`)),p.value=!0}}catch(r){console.error(r)}}(0,s.sV)((async()=>{await b(aa.MALARIA,r),await b(aa.NO_MALARIA,c),document.body.addEventListener("click",w)}));const I=e=>{e.target.classList.contains("wbc-modal-content")&&(g.value=!1)},C=()=>{g.value=!1},h=(e,t,a)=>{"malaria"===e&&(d.value=t,g.value=!0)},k=()=>{let e=Math.min(parseFloat(f.value)+50,400),t=Math.min(parseFloat(y.value)+50,400);f.value=`${e}px`,y.value=`${t}px`},S=()=>{let e=Math.max(parseFloat(f.value)-50,150),t=Math.max(parseFloat(y.value)-50,150);f.value=`${e}px`,y.value=`${t}px`};function w(e){const t=e.target;t.closest(".item-image")||(u.value=[])}function N(e,t,a,l){const s={section:e,imgName:t,index:a};if(u.value.length>0&&u.value[u.value.length-1].section!==e)u.value=[s];else if(l.shiftKey&&null!==m.value){const t=Math.min(m.value,a),l=Math.max(m.value,a);for(let a=t;a<=l;a++){const t=u.value.findIndex((e=>e.index===a));-1===t&&u.value.push({section:e,imgName:"malaria"===e?r.value[a]:c.value[a],index:a})}}else if(l.ctrlKey&&null!==m.value)u.value.push(s);else{const e=u.value.findIndex((e=>e.imgName===t));-1!==e?u.value.splice(e,1):u.value=[s]}m.value=a}function R(e,t){return u.value.some((e=>e.imgName===t))}function L(e,t,a){u.value.length>0?v.value=u.value:v.value=[{section:e,imgName:t,index:a}]}function E(e){for(const t of v.value)e!==t.section&&_(e,t.imgName)}async function _(e,l){const s=t.selectItems.slotId||"",o=""!==t.selectItems?.img_drive_root_path&&t.selectItems?.img_drive_root_path?t.selectItems?.img_drive_root_path:a,n=`${o}/${s}/${aa.RBC_CLASS}`,i="malaria"===e?`${n}/${aa.NO_MALARIA}`:`${n}/${aa.MALARIA}`,d="malaria"===e?`${n}/${aa.MALARIA}`:`${n}/${aa.NO_MALARIA}`,m=l.split("/"),v=m[m.length-1],p=await Ff(`sourceFolder=${i}&destinationFolder=${d}&imageName=${v}`);if(p){const t="malaria"===e?c.value.findIndex((e=>e===l)):r.value.findIndex((e=>e===l));"malaria"===e?(c.value.splice(t,1),r.value.push(l)):(r.value.splice(t,1),c.value.push(l))}u.value=[]}return(e,t)=>((0,s.uX)(),(0,s.CE)(s.FK,null,[p.value?((0,s.uX)(),(0,s.CE)("div",Xf,[(0,s.Lk)("div",null,[t[4]||(t[4]=(0,s.Lk)("h1",{class:"malariaTitle"},"Malaria O",-1)),(0,s.Lk)("div",{class:"malariaWrapper",onDrop:t[0]||(t[0]=e=>E("malaria")),onDragover:t[1]||(t[1]=(0,l.D$)((()=>{}),["prevent"]))},[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(r.value,((e,t)=>((0,s.uX)(),(0,s.CE)("img",{key:"malaria-"+t,src:e,class:(0,n.C4)(["item-image",{selected:R("malaria",e)}]),alt:"malaria-image",onClick:a=>N("malaria",e,t,a),onDragstart:a=>L("malaria",e,t),onDblclick:a=>h("malaria",e,t)},null,42,$f)))),128))],32)]),(0,s.Lk)("div",null,[t[5]||(t[5]=(0,s.Lk)("h1",{class:"malariaTitle"},"Malaria X",-1)),(0,s.Lk)("div",{class:"malariaWrapper",onDrop:t[2]||(t[2]=e=>E("noMalaria")),onDragover:t[3]||(t[3]=(0,l.D$)((()=>{}),["prevent"]))},[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(c.value,((e,t)=>((0,s.uX)(),(0,s.CE)("img",{key:"noMalaria-"+t,src:e,class:(0,n.C4)(["item-image",{selected:R("noMalaria",e)}]),alt:"noMalaria-image",onClick:a=>N("noMalaria",e,t,a),onDragstart:a=>L("noMalaria",e,t),onDblclick:a=>h("malaria",e,t)},null,42,Wf)))),128))],32)])])):((0,s.uX)(),(0,s.CE)("div",Hf,t[6]||(t[6]=[(0,s.Lk)("span",null,"Malaria Images do not exist.",-1)]))),(0,s.bo)((0,s.Lk)("div",Gf,[(0,s.Lk)("div",{class:"wbc-modal-content",onClick:I},[(0,s.Lk)("span",{class:"wbcClose",onClick:C},"×"),(0,s.Lk)("div",Yf,[(0,s.Lk)("img",{src:d.value,style:(0,n.Tr)({width:f.value,height:y.value}),class:"modal-image"},null,12,Vf)]),(0,s.Lk)("div",{class:"buttons"},[(0,s.Lk)("button",{onClick:k},"+"),(0,s.Lk)("button",{onClick:S},"-")])])],512),[[l.aG,g.value]])],64))}});const Qf=jf;var qf=Qf,Jf=a.p+"media/complete.c019a1cf.wav",zf=a.p+"media/error.427a90ee.mp3";const Zf=new Audio(zf),ey=new Audio(Jf),ty=e=>`${e}/folders?folderPath=D:/UIMD_Data/Res/uimdFe/images/`,ay={class:"rbc-container imgList"},ly={class:"btn-container_img_list"},sy={class:"btn-imgsetbox_img_list",ref:"imgSetWrap"},oy={class:"imgSet_img_list"},ny={class:"flex-align-center"},iy={class:"flex-align-center"},ry={class:"flex-align-center"},cy={class:"ruler_box_img_list"},uy=["onClick"],dy={class:"tiling-viewer_img_list-box_img_list"},my={key:2},vy={class:"categoryNm"},py={class:"classNmRbc"},gy=["onClick"],fy={class:"categories"},yy={class:"classNmRbc"};var by=(0,s.pM)({__name:"rbcImageList",props:["rbcInfo","selectItems","type","classInfoArr","isBefore"],setup(e,{emit:t}){const a=(0,o.KR)(!1),i=(0,o.KR)(""),r=(0,o.KR)(""),u=e,d=(0,o.KR)("lowMag");let m=(0,o.KR)(null);const v=(0,o.KR)(!1),p=(0,o.KR)(100),g=(0,o.KR)([0,0,0]),f=(0,o.KR)(!1),y=(0,o.KR)(!1),b=(0,o.KR)(null),I=(0,o.KR)("None"),C=(0,o.KR)(!1),h=(0,o.KR)(56e-5),k=(0,o.KR)({prevPosX:0,prevPosY:0,posX:0,posY:0,left:0,top:0,width:50,height:50}),S=(0,o.KR)(5),w=(0,o.KR)(0),N=((0,o.KR)(150),(0,o.KR)(null)),R=(0,o.KR)(!0),L=(0,o.KR)([]),E=(0,c.Pj)(),_=(0,s.EW)((()=>E.state.commonModule.viewerCheck)),P="viewer"===_.value?window.MAIN_API_IP:window.APP_API_BASE_URL,T=(0,s.EW)((()=>E.state.commonModule.iaRootPath)),A=(0,o.KR)([]),M=(0,o.KR)([]),D=(0,o.KR)(null),x=(0,o.KR)([]),O=(0,o.KR)([]),K=(0,o.KR)(0),B=(0,o.KR)(0),F=t,U=(0,o.KR)([]),X=(0,s.EW)((()=>E.state.commonModule.rbcReData)),$=(0,s.EW)((()=>E.state.commonModule.classInfoArr)),W=(0,s.EW)((()=>E.state.commonModule.rbcImagePageNumber)),H=(0,o.KR)("0"),G=(0,o.KR)("0"),Y=(0,o.KR)([]),V=((0,o.KR)(!1),(0,o.KR)("RBC")),j=(0,o.KR)(0),Q=(0,o.KR)(330);(0,s.sV)((async()=>{await E.dispatch("commonModule/setCommonInfo",{rbcImagePageNumber:0}),await(0,s.dY)(),await re(),await Ee(),document.addEventListener("click",te),U.value=u.selectItems.rbcInfo.rbcClass?u.selectItems.rbcInfo.rbcClass:u.selectItems.rbcInfo}));const q=async e=>{const t=""!==u.selectItems?.img_drive_root_path&&u.selectItems?.img_drive_root_path?u.selectItems?.img_drive_root_path:T.value,a=`${t}/${u.selectItems.slotId}/02_RBC_Image/${e}.dzi`,l=await Lo({filePath:a});return await J(`${e}`,l)},J=(e,t)=>{const a=new DOMParser,l=a.parseFromString(t,"application/xml"),s=l.getElementsByTagName("Size")[0],o=l.getElementsByTagName("Image")[0],n=o.getAttribute("TileSize"),i=s.getAttribute("Width"),r=s.getAttribute("Height");return{fileName:e,width:Number(i),height:Number(r),tileSize:Number(n)}},z=async(e,t,a)=>{const l=document.getElementsByClassName("overlayElement");if(0===l.length)return void le("Nothing has been selected");let s=A.value.find((t=>t.categoryId===e));s||(s={categoryId:e,classInfo:[]},A.value.push(s));let o=[];for(const n of O.value)for(const l of A.value){if(n.categoryId===l.categoryId){const s=l.classInfo.findIndex((e=>String(e.index)===n.index));-1!==s&&(o.push({categoryId:e,classNm:a,classId:t,posX:n.posX,posY:n.posY,width:n.width,height:n.height,index:String(n.index)}),l.classInfo.splice(s,1))}l.categoryId===e&&l.classInfo.push({classNm:a,classId:t,posX:n.posX,posY:n.posY,width:n.width,height:n.height,index:String(n.index)})}await Z(),await ee(o),await ie(M.value)},Z=async()=>{const e=document.getElementsByClassName("overlayElement"),t=Array.from(e);t.forEach((e=>{m.value.removeOverlay(e)})),C.value=!1},ee=async e=>{const t=""!==u.selectItems?.img_drive_root_path&&u.selectItems?.img_drive_root_path?u.selectItems?.img_drive_root_path:T.value,a=`${t}/${u.selectItems?.slotId}/${aa.RBC_CLASS}/${u.selectItems?.slotId}_new_${W.value}.json`,l=await Ro({fullPath:a});let s=[];if("not file"!==l.data){const a=`${t}/${u.selectItems?.slotId}/${aa.RBC_CLASS}/${u.selectItems?.slotId}_new_${W.value}.json`,l=await Ro({fullPath:a});s=[...l.data,...e]}else s=e;const o=JSON.stringify(s),n=(new TextEncoder).encode(o),i=Md.Ay.deflate(n),r=new Blob([i],{type:"application/octet-stream"}),c=new FormData;c.append("file",r,`${u.selectItems?.slotId}_new_${W.value}.json`);const d=`${t}/${u.selectItems?.slotId}/${aa.RBC_CLASS}/${u.selectItems?.slotId}_new_${W.value}.json`;try{const e=await fetch(`${P}/jsonReader/upload?filePath=${d}`,{method:"POST",body:c});await e.json()}catch(m){console.error("Error:",m)}},te=e=>{const t=document.querySelector(".rbc-select-box");t&&!t.contains(e.target)&&(C.value=!1)};(0,s.wB)((()=>u.classInfoArr),(e=>{if(L.value=e,0===e.length)return Z(),void ne();const t=document.querySelectorAll("ol.overlayElement"),a=new Set(e.map((e=>e.classNm)));t.forEach((e=>{const t=e.getAttribute("data-class-nm");a.has(t)||(console.log("Removing <ol> with data-class-nm:",t),m.value.removeOverlay(e))})),oe(e,W.value)}),{deep:!0}),(0,s.wB)($,(async(e,t)=>{if(X.value)return 0===e.length?(Z(),void ne()):(await oe(e,W.value),await E.dispatch("commonModule/setCommonInfo",{rbcReData:!1}),void await E.dispatch("commonModule/setCommonInfo",{classInfoArr:[]}))}),{deep:!0});const ae=e=>{u.isBefore||0===M.value.length||(C.value=!0,e.currentTarget instanceof HTMLElement&&(K.value=e.clientX,B.value=e.clientY-300))},le=e=>{a.value=!0,i.value="error",r.value=e},se=()=>{a.value=!1},oe=async(e,t)=>{const a=""!==u.selectItems?.img_drive_root_path&&u.selectItems?.img_drive_root_path?u.selectItems?.img_drive_root_path:T.value,l=`${a}/${u.selectItems.slotId}/${aa.RBC_CLASS}/${u.selectItems.slotId}_new_${W.value}.json`,s=await Ro({fullPath:l}),o=`${a}/${u.selectItems.slotId}/${aa.RBC_CLASS}/${u.selectItems.slotId}.json`,n=await Ro({fullPath:o});if("not file"!==s.data){const e=s?.data;for(const a of n.data[t].rbcClassList)for(const t of e){const e=a.classInfo.findIndex((e=>String(e.index)===String(t.index)));if(-1!==e&&a.classInfo.splice(e,1),a.categoryId===t.categoryId){let e={classNm:t.classNm,classId:t.classId,posX:String(t.posX),posY:String(t.posY),width:t.width,height:t.height,index:String(t.index)};a.classInfo.push(e)}}A.value=n.data[t].rbcClassList}else A.value=n?.data[t].rbcClassList;M.value=e,0===e.length?ne():await ie(e)};(0,s.wB)((()=>u.selectItems),(async e=>{await(0,s.dY)();const t=document.getElementById("tiling-viewer_img_list");t&&(t.innerHTML="",m.value&&m.value.destroy(),d.value="lowMag",await re())}));const ne=()=>{const e=D.value;if(!e)return console.error("Canvas element를 찾을 수 없습니다."),null;const t=e.getContext("2d");return t?(t.clearRect(0,0,e.width,e.height),t.beginPath(),x.value=[],t):(console.error("2D context를 가져올 수 없습니다."),null)},ie=async e=>{const t={Normal:"red",Macrocyte:"#ff4600",Microcyte:"#4C0290",Hyperchromic:"FF0090",Hypochromic:"#4C0290",Poikilocyte:"orange","Target Cell":"navy","Burr Cell":"purple",Acanthocyte:"#1E90FF",Ovalocyte:"#800080",Schistocyte:"magenta","Sickle Cell":"#3CB371",Stomatocyte:"#FFFF00","TearDrop Cell":"#4682B4",Spherocyte:"#FF6347","Howell-Jolly Body":"#FF4500","Basophilic Stippling":"#DDA0DD",Malaria:"black",Platelet:"#C71585"},a=ne();a?(e.forEach((e=>{A.value.forEach((l=>{l.classInfo.forEach((s=>{if(s.classId===e.classId&&l.categoryId===e.categoryId){a.lineWidth=3,a.strokeStyle=`${t[e.classNm]||"black"}`;let l,o,n,i,r=new Path2D;s?.width?(l=s.width,o=s.height,n=s.posX,i=s.posY):(l=Number(s.x2)-Number(s.x1),o=Number(s.y2)-Number(s.y1),n=Number(s.x1),i=Number(s.y1));let c={categoryId:e.categoryId,classNm:e.classNm,classId:e.classId,posX:n,posY:i,width:l,height:o,index:String(s.index)};r.rect(n,i,l,o),x.value.push(c),a.stroke(r)}}))}))})),await E.dispatch("commonModule/setCommonInfo",{resetRbcArr:!0})):console.error("Canvas context 초기화 실패")},re=async()=>{if(void 0===u.selectItems.slotId)return;const e=""!==u.selectItems?.img_drive_root_path&&u.selectItems?.img_drive_root_path?u.selectItems?.img_drive_root_path:T.value;try{const t=`${e}/${u.selectItems.slotId}/${aa.RBC_IMAGE}`,a=await ce(t);if(0!==a.length){m.value=Kf()({id:"tiling-viewer_img_list",animationTime:.4,navigatorSizeRatio:.25,showNavigator:!0,sequenceMode:!0,defaultZoomLevel:1,prefixUrl:ty(P),tileSources:a,showReferenceStrip:!1,gestureSettingsMouse:{clickToZoom:!1},minZoomLevel:1,zoomPerScroll:1.2,viewportMargins:{top:0,left:0,bottom:0,right:0},visibilityRatio:1});const e=a[0]?.maxZoomLevel||15;m.value.viewport.maxZoomLevel=e,new(Kf().MouseTracker)({element:m.value.element,moveHandler:function(e){const t=document.getElementById("magCanvas");if(t&&m.value.element.removeChild(t),!y.value)return;const{canvas:a}=m.value.drawer,l=document.createElement("canvas"),s=l.getContext("2d");if(D.value=l,s){const t=200,o=200,n=5;l.id="magCanvas",l.width=t,l.height=o,l.style.position="absolute",l.style.left=e.position.x-t/2+"px",l.style.top=e.position.y-o/2+"px",l.style.border="1px solid",l.style.borderRadius="50%",l.style.width=`${t}px`,l.style.height=`${o}px`,l.style.zIndex="0",m.value.element.appendChild(l),s.drawImage(a,e.position.x-t/2/n,e.position.y-o/2/n,t/n,o/n,0,0,t,o),l.style.visibility=e.position.y<=0||e.position.x<=0?"hidden":"visible"}}});const t=document.createElement("canvas");m.value.addOverlay({element:t,location:new(Kf().Rect)(0,0,1,1)});t.id="myCanvas",D.value=t,m.value.addHandler("open",(function(e){t.width=e.source.Image.Size.Width,t.height=e.source.Image.Size.Height}));const l=m.value.buttons.buttons.find((e=>"Toggle full page"===e.tooltip));l&&l.element.addEventListener("click",(async()=>{m.value.isFullPage()?(await document.exitFullscreen(),m.value.setFullPage(!1)):m.value.setFullPage(!0)})),m.value.addHandler("full-page",(async e=>{e.fullPage?m.value.element.style.backgroundColor="black":(m.value.element.style.backgroundColor="",await document.documentElement.requestFullscreen())})),m.value.addHandler("page",(async e=>{const l=e.page,s=a[l]?.maxZoomLevel||15,o=!Y.value[l].includes("RBC_Image");m.value.viewport.maxZoomLevel=s,o?(V.value="PLT",Q.value=1e3):(V.value="RBC",Q.value=330,await E.dispatch("commonModule/setCommonInfo",{rbcImagePageNumber:l})),await Se(),ke(b),F("notCanvasClick",o),t.parentElement!==m.value.container&&m.value.addOverlay({element:t,location:new(Kf().Rect)(0,0,1,1)}),F("unChecked")})),m.value.addHandler("zoom",(()=>{"None"!==I.value&&ke(I.value)})),m.value.addHandler("canvas-click",(async e=>{if(e.originalEvent.ctrlKey||await Z(),e.originalEvent.shiftKey){const t=m.value.viewport.pointFromPixel(e.position),a={x:t.x*m.value.source.width,y:t.y*m.value.source.height},l=e=>{const t=e.width,l=e.height;return a.x>=Number(e.posX)&&a.x<=Number(e.posX)+t&&a.y>=Number(e.posY)&&a.y<=Number(e.posY)+l};let s="";for(const e of x.value)if("Normal"!==e.classNm&&l(e)){s=e.classNm;break}for(const e of x.value)if("Normal"!==e.classNm&&s===e.classNm){O.value.push(e);const t=document.createElement("ol");t.className="overlayElement",t.id="overlayElement",t.setAttribute("data-category-id",e.categoryId),t.setAttribute("data-class-nm",e.classNm),t.style.width=`${e.width}px`,t.style.backgroundColor="lightgreen",t.style.height=`${e.height}px`,t.style.position="absolute",t.style.opacity="0.5";const a=parseFloat(e.posX),l=parseFloat(e.posY),s=m.value.viewport.imageToViewportRectangle(a,l,e.width,e.height);m.value.addOverlay({element:t,location:s})}}else{const t=m.value.viewport.pointFromPixel(e.position),a={x:t.x*m.value.source.width,y:t.y*m.value.source.height};for(const l of x.value){const t=l,s=t.width,o=t.height;if(a.x>=Number(t.posX)&&a.x<=Number(t.posX)+s&&a.y>=Number(t.posY)&&a.y<=Number(t.posY)+o){const n=l.categoryId,i="lightgreen";if(e.originalEvent.ctrlKey){const e=document.querySelector(`.overlayElement[data-class-posX="${t.posX}"][data-class-posY="${t.posY}"]`);if(e)return;O.value.push(l);const a=document.createElement("ol");a.className="overlayElement",a.id="overlayElement",a.setAttribute("data-category-id",n),a.setAttribute("data-class-nm",l.classNm),a.setAttribute("data-class-posY",t.posY),a.setAttribute("data-class-posX",t.posX),a.style.width=`${l.width}px`,a.style.backgroundColor=i,a.style.height=`${l.height}px`,a.style.position="absolute",a.style.opacity="0.5";const s=parseFloat(t.posX),o=parseFloat(t.posY),r=m.value.viewport.imageToViewportRectangle(s,o,t.width,t.height);m.value.addOverlay({element:a,location:r})}else if(a.x>=Number(t.posX)&&a.x<=Number(t.posX)+s&&a.y>=Number(t.posY)&&a.y<=Number(t.posY)+o){const e=l.categoryId,a="lightgreen",s=A.value.find((t=>t.categoryId===e))?.classInfo.find((e=>e.index===l.index));if(s){O.value=[l];const s=document.getElementById("overlayElement");s&&m.value.removeOverlay(s);const o=document.querySelector(`.overlayElement[data-category-id="${e}"][data-class-nm="${l.classNm}"]`);if(o){const e=parseFloat(t.posX),a=parseFloat(t.posY),l=m.value.viewport.imageToViewportRectangle(e,a,t.width,t.height);m.value.updateOverlay(o,l)}else{const s=document.createElement("ol");s.className="overlayElement",s.id="overlayElement",s.setAttribute("data-category-id",e),s.setAttribute("data-class-nm",l.classNm),s.style.width=`${l.width}px`,s.style.backgroundColor=a,s.style.height=`${l.height}px`,s.style.position="absolute",s.style.opacity="0.5";const o=parseFloat(t.posX),n=parseFloat(t.posY),i=m.value.viewport.imageToViewportRectangle(Number(o),Number(n),Number(l.width),Number(l.height));m.value.addOverlay({element:s,location:i})}}}break}}}}))}}catch(t){console.error("Error:",t)}},ce=async e=>{const t=`${P}/folders?folderPath=${e}`,a=await fetch(t);if(a.ok){const t=await a.json(),l=[];Y.value=[];for(const a of t)if(a.endsWith("_files")){const t=ue(a);Y.value.push(t);const{width:s,height:o,tileSize:n}=await q(t);l.push({Image:{xmlns:"http://schemas.microsoft.com/deepzoom/2009",Url:`${P}/folders?folderPath=${e}/${a}/`,Format:"jpg",Overlap:"1",TileSize:n,Size:{Width:s,Height:o}},maxZoomLevel:a.includes("RBC")?15:170}),G.value=s,H.value=o}return R.value=!0,l}throw R.value=!1,new Error("Network response was not ok")},ue=e=>{const t="_files",a=e.indexOf(t);return-1!==a?e.substring(0,a):e},de=e=>{switch(e){case"lowMag":d.value="lowMag";break;case"malaria":d.value="malaria",v.value=!1;break}"malaria"!==d.value&&(re(),F("notCanvasClick",!1))},me=()=>{v.value=!v.value},ve=e=>{const t=e?.target?.value,a=g.value[0],l=g.value[1],s=g.value[2],o=document.getElementById("tiling-viewer_img_list");o&&(o.style.filter=`\n      opacity(0.9)\n      drop-shadow(0 0 10px rgb(${a}, ${l}, ${s}))\n      brightness(${t}%)\n    `)},pe=()=>{const e=g.value[0],t=g.value[1],a=g.value[2],l=p.value,s=document.getElementById("tiling-viewer_img_list"),o=`rgb(${e}, ${t}, ${a})`;s&&(s.style.filter=`\n      opacity(0.9)\n      drop-shadow(0 0 0 ${o})\n      brightness(${l}%)\n    `)},ge=()=>{const e=p.value;g.value=[0,0,0];const t=document.getElementById("tiling-viewer_img_list");t&&(t.style.filter=`\n      opacity(0.9)\n      drop-shadow(0 0 10px rgb(0,0,0))\n      brightness(${e}%)\n    `)},fe=()=>{p.value=100,pe()},ye=()=>{f.value=!f.value,m.value.addHandler("zoom",be),f.value?be():Ce()},be=()=>{if(Ce(),f.value){const e=m.value.world.getItemAt(0).getContentSize().y,t=m.value.world.getItemAt(0).getContentSize().x,a=m.value.viewport.getZoom(),l=Math.round(Q.value/a),s=Math.min(t,e)/l;for(let o=1;o<l;o++){const a=o*s;Ie(a,0,1,e,"rgba(128, 128, 128, 0.2)"),Ie(0,a,t,1,"rgba(128, 128, 128, 0.2)")}}},Ie=(e,t,a,l,s)=>{const o=document.createElement("div");o.className="grid-line",o.style.position="absolute",o.style.left=`${e}px`,o.style.top=`${t}px`,o.style.width=`${a}px`,o.style.height=`${l}px`,o.style.background=s,o.style.userSelect="none",o.style.pointerEvents="none",m.value.container.appendChild(o)},Ce=()=>{const e=document.querySelectorAll(".grid-line");e.forEach((e=>e.remove()))},he=e=>{switch(e.text){case"None":I.value="None";break;case"Line":I.value="Line";break;case"Cross":I.value="Cross";break;case"Circle":I.value="Circle";break}ke(e)},ke=e=>{const t=document.getElementById("tiling-viewer_img_list");if(j.value=m.value.viewport.viewportToImageZoom(m.value.viewport.getZoom()),t instanceof HTMLElement){const a=document.getElementById("rulerOverlay");a instanceof HTMLElement&&t.removeChild(a);const l=document.createElement("div");l.id="rulerOverlay",l.style.position="absolute",l.style.display="flex",l.style.justifyContent="center",l.style.alignItems="center",l.style.width=0,l.style.height=0,l.style.zIndex="9999999",0===k.value.left?l.style.left=m.value.container.clientWidth/2-w.value/2+"px":l.style.left=k.value.left+"px",0===k.value.top?l.style.top=m.value.container.clientHeight/2-w.value/2+"px":l.style.top=k.value.top+"px",k.value.left<0&&(k.value.left=0),k.value.top<0&&(k.value.top=0),we(l,S,e),t.appendChild(l);let s=!1;l.onmousedown=function(e){k.value.prevPosX=e.clientX,k.value.prevPosY=e.clientY,k.value.left<=30&&(k.value.left=31),k.value.top<=80&&(k.value.top=81),s=!0},l.onmouseup=function(){s=!1},l.onwheel=function(t){t.deltaY<0?S.value<20&&we(l,++S.value,e):S.value>1&&we(l,--S.value,e)};const o=document.getElementById("tiling-viewer_img_list");o instanceof HTMLElement&&(o.onmousemove=function(e){s&&(k.value.posX=k.value.prevPosX-e.clientX,k.value.posY=k.value.prevPosY-e.clientY,k.value.prevPosX=e.clientX,k.value.prevPosY=e.clientY,l.style.left=l.offsetLeft-k.value.posX+"px",l.style.top=l.offsetTop-k.value.posY+"px",k.value.left=l.offsetLeft-k.value.posX,k.value.top=l.offsetTop-k.value.posY)})}},Se=async()=>{v.value=!1,I.value="None",await Ee()},we=(e,t,a)=>{let l;"object"===typeof t&&(t=t.value),null!==document.getElementById("rulerTitle")&&e.removeChild(document.getElementById("rulerTitle")),l="PLT"===V.value?Number(h.value)*j.value:(V.value,Number(h.value)/10*4*j.value);const s=t>1?1+l*(t-1):1;"PLT"===V.value?w.value=.001*t/Number(h.value)*j.value*s:(V.value,w.value=.001*t/(Number(h.value)/10*4)*j.value*s);const o=document.createElement("div");if(o.id="rulerTitle",o.style.color="#212121",o.style.fontSize="16px",o.style.display="flex",o.style.position="relative",o.style.alignItems="center",o.style.justifyContent="center",o.style.flexDirection="column","line"===a.id||"Line"===a)o.innerHTML='<div class="rulerTitleWrapper">'+t+' μm</div><svg width="'+w.value+'" height="'+w.value+'" xmlns="http://www.w3.org/2000/svg" class="rbcRulerDiv"><line x1="0%" y1="50%" x2="100%" y2="50%" stroke="#212121" stroke-width="5%"/><line x1="0%" y1="60%" x2="0%" y2="40%" stroke="#212121" stroke-width="5%"/><line x1="100%" y1="60%" x2="100%" y2="40%" stroke="#212121" stroke-width="5%"/></svg>',e.appendChild(o);else if("cross"===a.id||"Cross"===a)o.innerHTML='<div class="rulerTitleWrapper">'+t+' μm</div><svg width="'+w.value+'" height="'+w.value+'" xmlns="http://www.w3.org/2000/svg" class="rbcRulerDiv"><line x1="0%" y1="50%" x2="100%" y2="50%" stroke="#212121" stroke-width="5%"/><line x1="0%" y1="60%" x2="0%" y2="40%" stroke="#212121" stroke-width="5%"/><line x1="100%" y1="60%" x2="100%" y2="40%" stroke="#212121" stroke-width="5%"/><line x1="50%" y1="0%" x2="50%" y2="100%" stroke="#212121" stroke-width="5%"/><line x1="60%" y1="0%" x2="40%" y2="0%" stroke="#212121" stroke-width="5%"/><line x1="60%" y1="100%" x2="40%" y2="100%" stroke="#212121" stroke-width="5%"/></svg>',e.appendChild(o);else if("circle"===a.id||"Circle"===a)o.innerHTML='<div class="rulerTitleWrapper">'+t+' μm</div><svg width="'+w.value+'" height="'+w.value+'" xmlns="http://www.w3.org/2000/svg" class="rbcRulerDiv"><circle cx="50%" cy="50%" r="50%" stroke="#212121" fill="transparent" stroke-width="5%" opacity="1"  /></svg>',e.appendChild(o);else{const e=document.getElementById("rulerOverlay");if(null!==e){const t=document.getElementById("tiling-viewer_img_list");t?.removeChild(e)}}},Ne=()=>{const e=document.getElementById("rulerOverlay");if(e.style.transition="left 0.5s ease-in-out, top 0.5s ease-in-out",!e)return;e.style.left=m.value.container.clientWidth/2+"px",e.style.top=m.value.container.clientHeight/2+"px";const t=()=>{e.style.transition="none",e.removeEventListener("transitionend",t)};e.addEventListener("transitionend",t),k.value.prevPosX=e.offsetLeft,k.value.prevPosY=e.offsetTop,k.value.left=e.offsetLeft-k.value.prevPosX,k.value.top=e.offsetTop-k.value.prevPosY,Re()},Re=()=>{const e="PLT"===V.value,t=(V.value,e?Number(h.value):Number(h.value)/10*4),a=t*j.value,l=S.value>5?1+a*(S.value-5):1;w.value=.001*S.value/(t*j.value*l)},Le=()=>{if(y.value=!y.value,!y.value){const e=document.getElementById("magCanvas");e&&m.value.element.removeChild(e)}},Ee=async()=>{const e="D:\\UIMD_Data\\Backend_INI",t="100a"===window.MACHINE_VERSION?"Teaching_Config_100A":"Teaching_Config";try{const a=await Eo(`path=${e}&filename=${t}`),l=a.data.data,s=/X_RESOLUTION\s*=\s*(.+)/;h.value=l.match(s)[1]??h.value}catch(a){console.error(a)}};return(t,c)=>{const u=(0,s.g2)("font-awesome-icon");return(0,s.uX)(),(0,s.CE)(s.FK,null,[(0,s.Lk)("div",ay,[(0,s.Lk)("div",ly,[(0,s.Lk)("div",null,[(0,s.Lk)("button",{onClick:c[0]||(c[0]=e=>de("lowMag")),class:(0,n.C4)(["tab-btn_img_list",{active:"lowMag"===d.value,inactive:"lowMag"!==d.value}])},"Low magnification ",2),(0,s.Lk)("button",{onClick:c[1]||(c[1]=e=>de("malaria")),class:(0,n.C4)(["tab-btn_img_list",{active:"malaria"===d.value,inactive:"malaria"!==d.value}])},"Malaria ",2)]),(0,s.Lk)("div",sy,[(0,s.bo)((0,s.Lk)("button",{class:"darkButton",onClick:me},"IMG Setting",512),[[l.aG,"malaria"!==d.value]]),(0,s.bo)((0,s.Lk)("div",oy,[(0,s.Lk)("div",null,[(0,s.bF)(u,{icon:["fas","sun"]}),(0,s.Lk)("span",null,"Brightness "+(0,n.v_)(p.value),1),(0,s.bo)((0,s.Lk)("input",{type:"range",min:"50",max:"120","onUpdate:modelValue":c[2]||(c[2]=e=>p.value=e),onInput:ve},null,544),[[l.Jo,p.value]]),(0,s.Lk)("button",{class:"resetBtn",onClick:fe},"Brightness Reset")]),(0,s.Lk)("div",null,[(0,s.bF)(u,{icon:["fas","palette"]}),(0,s.Lk)("span",null,"RGB [ "+(0,n.v_)(`${g.value[0]} , ${g.value[1]}, ${g.value[2]}`)+" ]",1),(0,s.Lk)("div",ny,[c[8]||(c[8]=(0,s.Lk)("label",null,"R",-1)),(0,s.bo)((0,s.Lk)("input",{type:"range",min:"0",max:"255","onUpdate:modelValue":c[3]||(c[3]=e=>g.value[0]=e),onInput:pe},null,544),[[l.Jo,g.value[0]]])]),(0,s.Lk)("div",iy,[c[9]||(c[9]=(0,s.Lk)("label",null,"G",-1)),(0,s.bo)((0,s.Lk)("input",{type:"range",min:"0",max:"255","onUpdate:modelValue":c[4]||(c[4]=e=>g.value[1]=e),onInput:pe},null,544),[[l.Jo,g.value[1]]])]),(0,s.Lk)("div",ry,[c[10]||(c[10]=(0,s.Lk)("label",null,"B",-1)),(0,s.bo)((0,s.Lk)("input",{type:"range",min:"0",max:"255","onUpdate:modelValue":c[5]||(c[5]=e=>g.value[2]=e),onInput:pe},null,544),[[l.Jo,g.value[2]]])]),(0,s.Lk)("button",{class:"resetBtn",onClick:ge},"RGB Reset")]),(0,s.Lk)("div",null,[(0,s.bF)(u,{icon:["fas","th"]}),c[11]||(c[11]=(0,s.Lk)("span",null,"Grid",-1)),(0,s.bF)(u,{icon:f.value?["fas","toggle-on"]:["fas","toggle-off"],onClick:ye},null,8,["icon"])]),(0,s.Lk)("div",null,[(0,s.Lk)("div",null,[(0,s.bF)(u,{icon:["fas","ruler"]}),c[12]||(c[12]=(0,s.Lk)("span",null,"Ruler",-1)),"None"!==I.value?((0,s.uX)(),(0,s.Wv)(u,{key:0,onClick:Ne,icon:["fas","arrows-to-dot"],class:"hoverSizeAction cursorPointer"})):(0,s.Q3)("",!0)]),(0,s.Lk)("div",cy,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)((0,o.R1)(Cg),(e=>((0,s.uX)(),(0,s.CE)("button",{class:(0,n.C4)(["tab-ruler-btn_img_list",{active:I.value===e.text,inactive:I.value!==e.text}]),onClick:t=>he(e),key:e.id},(0,n.v_)(e.text),11,uy)))),128))])]),(0,s.Lk)("div",null,[(0,s.bF)(u,{icon:["fas","magnifying-glass"]}),c[13]||(c[13]=(0,s.Lk)("span",null,"Zoom",-1)),(0,s.bF)(u,{icon:y.value?["fas","toggle-on"]:["fas","toggle-off"],onClick:Le},null,8,["icon"])])],512),[[l.aG,v.value]])],512)]),(0,s.Lk)("div",dy,["malaria"===d.value?((0,s.uX)(),(0,s.Wv)(qf,{key:0,selectItems:e.selectItems},null,8,["selectItems"])):"malaria"!==d.value&&R.value?((0,s.uX)(),(0,s.CE)("div",{key:1,ref_key:"tilingViewerLayer",ref:N,id:"tiling-viewer_img_list",onContextmenu:(0,l.D$)(ae,["prevent"])},null,544)):((0,s.uX)(),(0,s.CE)("div",my,c[14]||(c[14]=[(0,s.Lk)("span",null,"Tile does not exist.",-1)])))])]),C.value?((0,s.uX)(),(0,s.CE)("div",{key:0,class:"rbc-select-box",style:(0,n.Tr)({left:`${K.value}px`,top:`${B.value}px`})},[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)([U.value],((e,t)=>((0,s.uX)(),(0,s.CE)(s.FK,{key:t},[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(e,((e,a)=>(0,s.bo)(((0,s.uX)(),(0,s.CE)("div",{key:a,class:"categories"},[(0,s.Lk)("ul",vy,[(0,s.Lk)("li",null,(0,n.v_)(e.categoryNm),1)]),(0,s.Lk)("ul",py,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(e?.classInfo,((l,o)=>((0,s.uX)(),(0,s.CE)(s.FK,{key:`${t}-${a}-${o}`},["Poikilocyte"!==l.classNm?((0,s.uX)(),(0,s.CE)("li",{key:0,onClick:t=>z(e.categoryId,l.classId,l.classNm)},[(0,s.Lk)("span",null,(0,n.v_)(l?.classNm),1)],8,gy)):(0,s.Q3)("",!0),"Basophilic Stippling"===l.classNm?((0,s.uX)(),(0,s.CE)("li",{key:1,onClick:c[6]||(c[6]=e=>z("05","03","Malaria"))},c[15]||(c[15]=[(0,s.Lk)("span",null,"Malaria",-1)]))):(0,s.Q3)("",!0)],64)))),128))])],512)),[[l.aG,"Shape"===e?.categoryNm||"Inclusion Body"===e.categoryNm]]))),128)),(0,s.Lk)("div",fy,[c[17]||(c[17]=(0,s.Lk)("ul",{class:"categoryNm"},[(0,s.Lk)("li",null,"Others")],-1)),(0,s.Lk)("ul",yy,[(0,s.Lk)("li",{onClick:c[7]||(c[7]=e=>z("04","01","Platelet"))},c[16]||(c[16]=[(0,s.Lk)("span",null,"Platelets",-1)]))])])],64)))),128))],4)):(0,s.Q3)("",!0),a.value?((0,s.uX)(),(0,s.Wv)(Pt,{key:1,"is-visible":a.value,type:i.value,message:r.value,onHide:se,"onUpdate:hideAlert":se},null,8,["is-visible","type","message"])):(0,s.Q3)("",!0)],64)}}});const Iy=by;var Cy=Iy;const hy={class:"wbcMenu"},ky={class:"menuIco"},Sy={class:"menuIco"},wy={class:"menuIco"},Ny={class:"wbcMenuBottom"},Ry=["disabled"],Ly=["disabled"];var Ey=(0,s.pM)({__name:"classInfoMenu",props:["isNext","changeSlideByLisUpload"],setup(e,{emit:t}){const a=t,l=(0,o.KR)(!1),i=(0,o.KR)(""),u=(0,o.KR)(""),d=(0,o.KR)("bm"),m=(0,o.KR)(null),v=(0,o.KR)([]),p=(0,s.nI)(),g=(0,c.Pj)(),f=(0,s.EW)((()=>g.state.commonModule.selectedSampleId)),y=(0,r.lq)(),b=(0,o.KR)([]),I=(0,s.EW)((()=>g.state.commonModule.cbcLayer)),C=(0,o.KR)(!1);let h;const k=(0,o.KR)(!1),S=e,w=(0,o.KR)(""),N=(0,o.KR)(!0),R=(0,o.KR)("");let L;const E=(0,s.EW)((()=>g.state.commonModule.testType)),_=(0,s.EW)((()=>g.state.commonModule.dbListDataFirstNum)),P=(0,s.EW)((()=>g.state.commonModule.dbListDataLastNum));(0,s.wB)(S.isNext,(e=>{e&&F("down")})),(0,s.wB)((()=>S.changeSlideByLisUpload),(e=>{F("up")})),(0,s.KC)((async()=>{d.value=window.PROJECT_TYPE,await T(),N.value=!1;const e="bm"===d.value?"bmKeepPage":"keepPage";R.value=JSON.parse(JSON.stringify(sessionStorage.getItem(e)))})),(0,s.sV)((async()=>{k.value=!0;const e=await va();w.value=e.data})),(0,s.hi)((async()=>{k.value&&await M(),await g.dispatch("commonModule/setCommonInfo",{cbcLayer:!1})}));const T=async()=>{try{const{result:e,loading:t,error:a}=ov({id:Number(f.value)},{fetchPolicy:"no-cache"});(0,s.wB)(e,(e=>{if(e){g.dispatch("slideDataModule/updateSlideData",e?.getRunningInfoByIdGQL);const t=e?.getRunningInfoByIdGQL;m.value=t,g.dispatch("commonModule/setCommonInfo",{testType:m.value.testType}),v.value=t}else console.log("No result")}))}catch(e){console.error(e),m.value=null,v.value=null}},A=()=>{l.value=!1},M=async()=>{const e=sessionStorage.getItem("lastSearchParams")||localStorage.getItem("lastSearchParams")||"",{startDate:t,endDate:a,page:l,searchText:s,nrCount:o,testType:n,wbcInfo:i,wbcTotal:r}=JSON.parse(e),c=t+a+l+s+o+n+i+r,u=`oldPcIp=${w.value}&dayQuery=${c}`;await Td(u).then((e=>{O("SEND_DATA","refreshDb",300)})).catch((e=>{console.error("2 err",e)}))},D=async e=>{try{const e=sessionStorage.getItem("lastSearchParams")||localStorage.getItem("lastSearchParams")||"",{startDate:t,endDate:a,page:l,searchText:s,nrCount:o,testType:n,wbcInfo:i,wbcTotal:r}=JSON.parse(e),c=t+a+l+s+o+n+i+r,u=`oldPcIp=${w.value}&newEntityId=${v.value?.id}&newPcIp=${w.value}&dayQuery=${c}`;await Pd(u).then((e=>{O("SEND_DATA","refreshDb",300)})).catch((e=>{console.error("3 err",e)}))}catch(t){console.error(t)}},x=async()=>{try{const e=await He();e&&(0===e?.data.length?b.value=[]:b.value=e.data.sort(((e,t)=>Number(e.orderIdx)-Number(t.orderIdx))))}catch(e){console.error(e)}},O=(e,t,a)=>{void 0!==L&&clearTimeout(L),L=window.setTimeout((()=>{p?.appContext.config.globalProperties.$socket.emit("state",{type:"SEND_DATA",payload:"refreshDb"})}),a)},K=e=>{Pw.push(e),k.value=!1};async function B(e,t,a){try{const t=sessionStorage.getItem("lastSearchParams")||localStorage.getItem("lastSearchParams")||"",{startDate:l,endDate:s,page:o,searchText:n,nrCount:i,testType:r,wbcInfo:c,wbcTotal:u,searchType:d}=JSON.parse(t),m=l+s+o+n+i+r+c+u,p=""===n?l:"",f=""===n?s:"",y="barcodeNo"===d?n:void 0,b=[`id=${e}`,`type=${a}`,`dayQuery=${m}`,`title=${c}`,`startDay=${p}`,`endDay=${f}`];y&&b.push(`barcodeNo=${y}`),i&&b.push(`nrCount=${i}`),r&&"00"!==r&&b.push(`testType=${r}`);const I=b.join("&"),C=await _d(I);if(null!==C.data){v.value=C.data;const e=await va();if(C.data.pcIp!==e.data&&C.data.lock_status)return;await g.dispatch("slideDataModule/updateSlideData",C.data),await g.dispatch("commonModule/setCommonInfo",{selectedSampleId:String(C.data?.id)})}}catch(l){console.error(l)}}const F=async e=>{if("up"===e){if(_.value===m.value?.id)return l.value=!0,i.value="success",void(u.value="This is the first page. Navigation to other pages is not possible.")}else if(P.value===m.value?.id)return l.value=!0,i.value="success",void(u.value="This is the last page. Navigation to other pages is not possible.");await g.dispatch("commonModule/setCommonInfo",{cbcLayer:!1}),void 0!==h&&clearTimeout(h),C.value=!0,await x(),await U(e,m.value?.id),h=window.setTimeout((()=>{C.value=!1}),700)},U=async(e,t)=>{const a=await B(t,"1",e);if(v.value?.lock_status)return l.value=!0,i.value="success",void(u.value="Someone else is editing.");await X(a?.id,a)},X=async(e,t)=>{if(!v.value)return;m.value=v.value;const a=0===v.value?.wbcInfoAfter.length?v.value?.wbcInfo?.wbcInfo[0]:v.value?.wbcInfoAfter;await $(a,v.value)},$=async(e,t)=>{("pb"===d.value&&"01"===m.value?.testType&&W("/databaseRbc")||!R.value||"false"===R.value)&&K("/databaseDetail"),a("refreshClass",t),k.value=!0,await D(t)},W=e=>y.path===e,H=()=>{g.dispatch("commonModule/setCommonInfo",{cbcLayer:!I.value})};return(e,t)=>{const a=(0,s.g2)("font-awesome-icon");return(0,s.uX)(),(0,s.CE)(s.FK,null,[(0,s.Lk)("div",hy,[(0,s.Lk)("ul",null,[["bm","pb"].includes(d.value)?((0,s.uX)(),(0,s.CE)(s.FK,{key:0},["pb"!==d.value||"04"===E.value&&"pb"===d.value?((0,s.uX)(),(0,s.CE)("li",{key:0,class:(0,n.C4)({onRight:W("bm"===d.value?"/databaseWhole":"/databaseRbc")}),onClick:t[0]||(t[0]=e=>K("bm"===d.value?"/databaseWhole":"/databaseRbc"))},[(0,s.Lk)("p",ky,[(0,s.bF)(a,{icon:["fas","virus"]})]),(0,s.Lk)("p",null,(0,n.v_)("bm"===d.value?"WHOLE":"RBC"),1)],2)):(0,s.Q3)("",!0),(0,s.Lk)("li",{class:(0,n.C4)({onRight:W("/databaseDetail")}),onClick:t[1]||(t[1]=e=>K("/databaseDetail"))},[(0,s.Lk)("p",Sy,[(0,s.bF)(a,{icon:["fas","disease"]})]),(0,s.Lk)("p",null,(0,n.v_)("bm"===d.value?"BM CELL":"WBC"),1)],2),N.value?(0,s.Q3)("",!0):((0,s.uX)(),(0,s.CE)("li",{key:1,class:(0,n.C4)({onRight:W("/report")}),onClick:t[2]||(t[2]=e=>K("/report"))},[(0,s.Lk)("p",wy,[(0,s.bF)(a,{icon:["fas","clipboard"]})]),t[5]||(t[5]=(0,s.Lk)("p",null,"REPORT",-1))],2))],64)):(0,s.Q3)("",!0)]),"bm"!==d.value?((0,s.uX)(),(0,s.CE)("div",{key:0,onClick:H,class:(0,n.C4)({onRight:I.value,cbcLi:!0})},[(0,s.bF)(a,{icon:["fas","desktop"]}),t[6]||(t[6]=(0,s.Lk)("p",null,"LIS-CBC",-1))],2)):(0,s.Q3)("",!0),(0,s.Lk)("div",Ny,[(0,s.Lk)("button",{onClick:t[3]||(t[3]=e=>F("up")),disabled:C.value},[(0,s.bF)(a,{icon:["fas","circle-up"]})],8,Ry),(0,s.Lk)("button",{onClick:t[4]||(t[4]=e=>F("down")),disabled:C.value},[(0,s.bF)(a,{icon:["fas","circle-down"]})],8,Ly)])]),l.value?((0,s.uX)(),(0,s.Wv)(Pt,{key:0,"is-visible":l.value,type:i.value,message:u.value,onHide:A,"onUpdate:hideAlert":A},null,8,["is-visible","type","message"])):(0,s.Q3)("",!0)],64)}}});const _y=Ey;var Py=_y,Ty=a(8990);const Ay=Z(),My=async e=>Ay.httpPost(ee.lisSend.ywmcLisPostSend,e),Dy=async e=>Ay.httpPost(ee.lisSend.saveComment,e),xy=async e=>Ay.httpGet(ee.lisSend.cbcImgGet,`${e}`,!0),Oy=async(e,t)=>{const a=` http://128.9.1.11/spo/CpSVL?target_command=ihes.spo.cp.cmd.RetrieveUimdURLCMD&smp_no=${e}`,l=await z.A.get(a),s=[];console.log(l);const o=l.reduce(((e,t)=>t.exam_ymd_unit>e?t.exam_ymd_unit:e),l.exam_ymd_unit),n=l.filter((e=>e.exam_ymd_unit===o)),i=void 0===l.find((e=>"H3"===e.slip.trim()))?"H1":"H3";n.forEach((function(e){t.forEach((function(t){if(t?.classCd===e?.exam_cd.trim()){const a={classNm:t.fullNm,count:e?.text_rslt+e?.numeric_rslt,unit:e?.unit,textVal:e?.text_rslt,numVal:e?.numeric_rslt,spc:e?.spc,day:e?.exam_ymd_unit};s.push(a)}}))}));const r={filePath:`D:\\UIMD_Data\\UI_Log\\CBC_IA\\${e}.txt`,data:s};return await bp(r),{data:s,cbcDataVal:l,slip:i}},Ky=async e=>{const t=await My(e);return t?"Update successful":"Lis Send Fail"},By={class:"cbcDiv"},Fy={key:0,class:"loaderBackground cbc"},Uy={class:"titleCbc"},Xy={class:"flex-column-align-start ml10"},$y={key:0,class:"fs08"},Wy={key:1,class:"fs08"},Hy={key:1,class:"cbcPopUpContainer"},Gy={class:"flex-justify-between"},Yy={class:"cbcPopUpWrapper"},Vy=["onClick"],jy={key:1,class:"cbcDivWarp"},Qy={class:"cbcTable"},qy={key:2,class:"cbcDivWarp"},Jy={class:"cbcTable"},zy={key:0},Zy={key:3,class:"cbcDivWarp"},eb={class:"cbcTable"},tb={key:4};var ab=(0,s.pM)({__name:"lisCbc",props:["selectItems"],setup(e){const t=(0,c.Pj)(),a=e,l=(0,o.KR)([]),i=(0,o.KR)(""),r=(0,o.KR)(""),u=(0,o.KR)(""),d=(0,o.KR)(!1),m=(0,o.KR)(""),v=(0,o.KR)(""),p=(0,o.KR)(""),g=(0,s.EW)((()=>t.state.userModule)),f=(0,s.EW)((()=>t.state.commonModule.deviceSerialNm)),y=(0,s.EW)((()=>t.state.commonModule.siteCd)),b=((0,s.EW)((()=>t.state.commonModule.selectedSampleId)),(0,o.KR)([])),C=(0,o.KR)([]),h=(0,o.KR)(!1),k=(0,o.KR)(""),S=(0,o.KR)(""),w=(0,o.KR)(!1),N=(0,o.KR)([]),R=(0,o.KR)(""),L=(0,o.KR)(!1),E=(0,s.EW)((()=>t.state.commonModule.iaRootPath)),_=(0,o.KR)(""),P=(0,s.EW)((()=>t.state.slideDataModule));(0,s.wB)(a.selectItems,(async e=>{C.value=e,p.value=await _p(),b.value=await Pp(),L.value||await O(C.value)}),{deep:!0}),(0,s.sV)((async()=>{a.selectItems&&(R.value=a.selectItems.barcodeNo),L.value=!1,C.value=a.selectItems,p.value=await _p(),b.value=await Pp(),p.value&&""!==p.value&&await O(C.value)}));const T=async()=>{if(await x(),0===N.value.length)return;const e=N.value.reduce(((e,t)=>{const a=Mp(t),l=Mp(e);return a>l?t:e}));R.value=`${e.split(".")[0]}`},A=async()=>{w.value=!w.value,await x()},M=async e=>{L.value=!0,R.value=`${e.split(".")[0]}`,await T(),await X(`${e.split(".")[0]}`),await K(),w.value=!1},D=()=>{w.value=!1},x=async()=>{if(!a.selectItems)return;const e=`folderPath=${p.value}`,t=await Ip(e);let l=[];Array.isArray(t)&&(l=t.filter((e=>e.split("_")[0]===a.selectItems.barcodeNo))),N.value=l},O=async e=>{switch(d.value=!0,y.value){case I["서울성모병원"]:await G(e);break;case I["고대안암병원"]:await Y();break;case I["인천길병원"]:await Y();break;case I["삼광의료재단"]:break;case I["인하대병원"]:await F();break;case I["SD의학연구소"]:await T(),await X(R.value);break;case I["원주기독병원"]:await B();break;case I["NONE"]:case I["UIMD"]:await T(),await X(R.value);break;default:await X(R.value);break}await K()},K=async()=>{if(C.value){C.value.cbcPatientNo=i.value,C.value.cbcPatientNm=r.value,C.value.cbcSex=u.value,C.value.cbcAge=m.value,C.value.hosName=v.value;const e={cbcPatientNo:i.value,cbcPatientNm:r.value,cbcSex:u.value,cbcAge:m.value,hosName:v.value},t={...P.value,...e};await V([t])}},B=async()=>{const{data:e,cbcDataVal:t,slip:s}=await Oy(a?.selectItems?.barcodeNo,b.value);l.value=e,i.value=t?.pt_no,r.value=t?.pt_nm,u.value=t?.sex,m.value=t?.age,d.value=!1,_.value=s},F=async()=>{const{cbcWorkList:e,errMessage:t,cbcPatientNo:s,cbcPatientNm:o,cbcSex:n,cbcAge:c,loading:v}=await wp(p.value,a.selectItems,b.value,"cbcRead");""!==t&&H(t),l.value=e,i.value=s,r.value=o,u.value=n,m.value=c,d.value=v},X=async e=>{if(""===p.value)return void W(U.UPLOAD_PLEASE_CBC);if(p.value.includes("http")){const e={url:p.value,barcodeNo:a.selectItems.barcodeNo,userId:g.value.userId,deviceBarcode:f.value},t=e.url+"?barcodeNo="+e.barcodeNo+"&deviceBarcode="+f.value+"&userid="+e.userId;await z.A.get(t).then((async function(e){const t=await Po(e.data);l.value=[],t.data?.segments.forEach((function(e){"OBX"===e.name.trim()?b.value.forEach((function(t){if(t.classCd===e.fields[3].value[0][0].value[0]){var a={classNm:t.cd,count:e.fields[5].value[0][0].value[0],unit:e.fields[6].value[0][0].value[0]};l.value.push(a)}})):"PID"===e.name.trim()&&(i.value=e.fields[1].value[0][0].value[0],r.value=e.fields[4].value[0][0].value[0],u.value=e.fields[6].value[0][0].value[0],m.value=e.fields[7].value[0][0].value[0])})),d.value=!1})).catch((function(e){console.error(e.message),d.value=!1}))}else await $(e);const t={filePath:`D:\\UIMD_Data\\UI_Log\\CBC_IA\\${a.selectItems?.barcodeNo}.txt`,data:l.value};await bp(t)},$=async e=>{const t=""!==a.selectItems?.img_drive_root_path&&a.selectItems?.img_drive_root_path?a.selectItems?.img_drive_root_path:E.value,s={directoryPath:`${p.value}`,keyword:a.selectItems?.barcodeNo};let o="",n="";const c=await vp(s);if("NoFile"===c.data){const e=`directoryPath=${t}\\${a.selectItems?.slotId}&searchString=${a.selectItems?.barcodeNo}`;try{const t=await pp(e);t.data&&Array.isArray(t.data)&&t.data.length>0&&(o=t.data[0].split(".")[0])}catch(f){console.error("Error fetching file list:",f)}n=`${t}\\${a.selectItems?.slotId}`}else o=e,n=p.value;const g=await _o(`path=${n}&filename=${o}`);if(g.data.success){const s={source:`${p.value}\\${e}.hl7`,destination:`${t}\\${a.selectItems?.slotId}`},o={directoryPath:`${p.value}`,keyword:a.selectItems?.barcodeNo};await dp(s),await mp(o);const n=await Po(g.data.data);l.value=[],console.log(n?.data?.segments),n?.data?.segments?.forEach((e=>{if("OBX"===e.name.trim())b.value.forEach((t=>{const a=e?.fields?.[2]?.value?.[0]?.[0]?.value?.[0],s=e?.fields?.[4]?.value?.[0]?.[0]?.value?.[0]||"0",o=e?.fields?.[2]?.value?.[0]?.[0]?.value?.[0].match(/%/g)?.[0]||"";if(t.classCd===a){const e=l.value.some((e=>e.classNm===t.fullNm));if(!e){const e={classNm:t.fullNm,count:s,unit:o};l.value.push(e)}}}));else if("FLG"===e.name.trim()){console.log("asas");const t=e?.fields?.[2]?.value?.[0]?.[0]?.value?.[0],a={classNm:"FLG",count:t,unit:""};l.value.push(a)}else"PID"===e.name.trim()&&(i.value=e.fields[1].value[0][0].value[0],r.value=e.fields[4].value[0][0].value[0],u.value=e.fields[6].value[0][0].value[0],m.value=e.fields[7].value[0][0].value[0],v.value=e?.fields[10]?.value[0][0]?.value[0])})),d.value=!1}else console.error(g.data.message),d.value=!1},W=e=>{h.value=!0,k.value="error",S.value=e},H=e=>{h.value=!0,k.value="success",S.value=e},G=async e=>{let t=window.APP_API_BASE_URL||"http://192.168.0.131:3002";z.A.get(`${t}/cbc/lisCbcMarys`,{params:{submit_id:"TRLII00124",business_id:"li",instcd:"012",bcno:e.barcodeNo},headers:{"Content-Type":"application/json"}}).then((function(e){const t=e.data?.data,s=JSON.parse((0,Ty.xml2json)(t,{compact:!0}));l.value=s.root.spcworklist.worklist;const o={filePath:`D:\\UIMD_Data\\UI_Log\\CBC_IA\\${a.selectItems?.barcodeNo}.txt`,data:l.value};bp(o),d.value=!1})).catch((function(e){console.error(e.message),d.value=!1}))},Y=async()=>{const e=await Eo(`path=${p.value}&filename=${a.selectItems.barcodeNo}`);if(e.data.success){let t=JSON.parse(JSON.stringify(e.data.data));const s=["SPC_NO","BLCL_DT","PT_NO","PT_NM","SEX","AGE","SCAT_WDF","SCAT_WNR","DIST_RBC","DIST_WDF(FSC)","DIST_PLT"];t=t.split("\n"),t.forEach((e=>{const[t,a]=e.split("\t").map((e=>e.trim()));if(s.includes(t.trim()))switch(t){case"PT_NO":i.value=a;break;case"PT_NM":r.value=a;break;case"SEX":u.value=a;break;case"AGE":m.value=a;break}else{const e=t.includes("%")?"%":"";l.value.push({classNm:t,count:a,unit:e})}}));const o={filePath:`D:\\UIMD_Data\\UI_Log\\CBC_IA\\${a.selectItems?.barcodeNo}.txt`,data:l.value};await bp(o)}d.value=!1};async function V(e){try{const t=sessionStorage.getItem("lastSearchParams")||localStorage.getItem("lastSearchParams")||"",{startDate:a,endDate:l,page:s,searchText:o,nrCount:n,testType:i,wbcInfo:r,wbcTotal:c}=JSON.parse(t),u=a+l+s+o+n+i+r+c,d=await Nd({userId:Number(g.value.id),runingInfoDtoItems:e,dayQuery:u});d||console.error("백엔드가 디비에 저장 실패함")}catch(t){console.error("Error:",t)}}return(e,t)=>{const a=(0,s.g2)("font-awesome-icon");return(0,s.uX)(),(0,s.CE)("div",By,[d.value?((0,s.uX)(),(0,s.CE)("div",Fy,t[0]||(t[0]=[(0,s.Lk)("div",{class:"loader"},null,-1),(0,s.Lk)("p",{class:"loadingText"},"Loading...",-1)]))):(0,s.Q3)("",!0),(0,s.Lk)("h1",Uy,[t[3]||(t[3]=(0,s.Lk)("span",null,"CBC + DIFF",-1)),(0,s.Lk)("div",Xy,[l.value[0]?.day?((0,s.uX)(),(0,s.CE)("p",$y,"exam_ymd_unit : "+(0,n.v_)(l.value[0]?.day),1)):(0,s.Q3)("",!0),""!==_.value?((0,s.uX)(),(0,s.CE)("p",Wy,"slip : "+(0,n.v_)(_.value),1)):(0,s.Q3)("",!0)]),y.value===(0,o.R1)(I)["SD의학연구소"]||""===y.value?((0,s.uX)(),(0,s.CE)("span",{key:0,class:"ml10",onClick:A},[(0,s.bF)(a,{icon:["fas","rectangle-list"],class:"cursorPointer"})])):(0,s.Q3)("",!0),w.value?((0,s.uX)(),(0,s.CE)("div",Hy,[(0,s.Lk)("div",Gy,[t[1]||(t[1]=(0,s.Lk)("p",null,null,-1)),t[2]||(t[2]=(0,s.Lk)("h3",null,"List",-1)),(0,s.bF)(a,{icon:["fas","xmark"],style:{color:"#ffffff"},onClick:D,class:"cbcDataListCloseBtn"})]),(0,s.Lk)("ul",Yy,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(N.value,((e,t)=>((0,s.uX)(),(0,s.CE)("li",{key:t,onClick:t=>M(e),class:"cbcPopUpItem"},(0,n.v_)(e),9,Vy)))),128))])])):(0,s.Q3)("",!0)]),"0002"===y.value&&0!==l.value.length?((0,s.uX)(),(0,s.CE)("div",jy,[(0,s.Lk)("table",Qy,[t[4]||(t[4]=(0,s.Lk)("colgroup",null,[(0,s.Lk)("col",{width:"50%"}),(0,s.Lk)("col",{width:"50%"})],-1)),((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(l.value,(e=>((0,s.uX)(),(0,s.CE)("tr",{key:e.id},[(0,s.Lk)("td",null,(0,n.v_)(e.tclsscrnnm._cdata),1),(0,s.Lk)("td",null,(0,n.v_)(e.inptrslt._cdata),1)])))),128))])])):"0007"===y.value&&0!==l.value.length?((0,s.uX)(),(0,s.CE)("div",qy,[(0,s.Lk)("table",Jy,[t[5]||(t[5]=(0,s.Lk)("colgroup",null,[(0,s.Lk)("col",{width:"50%"}),(0,s.Lk)("col",{width:"50%"})],-1)),((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(l.value,(e=>((0,s.uX)(),(0,s.CE)("tr",{key:e.id},[(0,s.Lk)("td",null,(0,n.v_)(e.classNm),1),(0,s.Lk)("td",null,[(0,s.eW)((0,n.v_)(e.count)+" ",1),""!==e.cham?((0,s.uX)(),(0,s.CE)("span",zy," ("+(0,n.v_)(e.cham)+") ",1)):(0,s.Q3)("",!0),(0,s.eW)(" "+(0,n.v_)(e.unit),1)])])))),128))])])):0!==l.value.length?((0,s.uX)(),(0,s.CE)("div",Zy,[(0,s.Lk)("table",eb,[t[6]||(t[6]=(0,s.Lk)("colgroup",null,[(0,s.Lk)("col",{width:"50%"}),(0,s.Lk)("col",{width:"50%"})],-1)),((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(l.value,(e=>((0,s.uX)(),(0,s.CE)("tr",{key:e.id},[(0,s.Lk)("td",null,(0,n.v_)(e.classNm),1),(0,s.Lk)("td",null,(0,n.v_)(e.count)+" "+(0,n.v_)(e.unit),1)])))),128))])])):(0,s.Q3)("",!0),0===l.value.length?((0,s.uX)(),(0,s.CE)("div",tb," No Data ")):(0,s.Q3)("",!0)])}}});const lb=ab;var sb=lb;const ob={class:"topClintInfo"},nb={key:0},ib={key:1},rb={key:2},cb={key:0},ub={key:1},db={key:4},mb={key:5},vb={key:6};var pb=(0,s.pM)({__name:"detailHeader",props:["testType","barcodeNo","cbcPatientNo","patientName","hospitalName","cbcPatientName","cbcSex","cbcAge","analyzedDttm","slideData"],setup(e,{emit:t}){const a=e,l=t,i=(0,c.Pj)(),r=(0,s.EW)((()=>i.state.commonModule.iaRootPath)),u=(0,s.EW)((()=>i.state.slideDataModule)),d=(0,o.KR)(!1),m=(0,o.Kh)({slideStatus:!1}),v=(0,o.KR)(""),p=(0,o.KR)("");(0,s.wB)((()=>a.slideData),(e=>{e.cbcPatientNm&&""!==e.cbcPatientNm&&e.cbcPatientNm===e.patientNm||l("updateSlideDataByCBCData",e)})),(0,s.KC)((()=>{d.value="bm"===window.PROJECT_TYPE})),(0,s.sV)((async()=>{const e=r.value,t=d.value?"04_BM_Classification":"01_WBC_Classification",a=`${e}/${u.value.slotId}/${t}/Slide_Condition.json`,l=await Ro({fullPath:a});v.value=l?.data?.condition,p.value=l?.data?.description}));const g=(e,t)=>{m[e]=t};return(t,a)=>((0,s.uX)(),(0,s.CE)("div",ob,[(0,s.Lk)("ul",null,[(0,s.Lk)("li",null,(0,n.v_)(e.testType),1),e.barcodeNo?((0,s.uX)(),(0,s.CE)("li",nb,(0,n.v_)(e.barcodeNo),1)):(0,s.Q3)("",!0),e.analyzedDttm?((0,s.uX)(),(0,s.CE)("li",ib,(0,n.v_)((0,o.R1)(G)(e.analyzedDttm)),1)):(0,s.Q3)("",!0),e.cbcPatientNo?((0,s.uX)(),(0,s.CE)("li",rb,(0,n.v_)(e.cbcPatientNo),1)):(0,s.Q3)("",!0),e.cbcPatientName||e.patientName?((0,s.uX)(),(0,s.CE)(s.FK,{key:3},[e.cbcPatientName?((0,s.uX)(),(0,s.CE)("li",cb,(0,n.v_)(e.cbcPatientName),1)):e.patientName?((0,s.uX)(),(0,s.CE)("li",ub,(0,n.v_)(e.patientName),1)):(0,s.Q3)("",!0)],64)):(0,s.Q3)("",!0),e.cbcSex?((0,s.uX)(),(0,s.CE)("li",db,(0,n.v_)(e.cbcSex),1)):(0,s.Q3)("",!0),e.cbcAge?((0,s.uX)(),(0,s.CE)("li",mb,(0,n.v_)(e.cbcAge),1)):(0,s.Q3)("",!0),e.hospitalName?((0,s.uX)(),(0,s.CE)("li",vb,(0,n.v_)(e.hospitalName),1)):(0,s.Q3)("",!0),v.value?((0,s.uX)(),(0,s.CE)("li",{key:7,class:"slideStatus",onMouseenter:a[0]||(a[0]=e=>g("slideStatus",!0)),onMouseleave:a[1]||(a[1]=e=>g("slideStatus",!1))},[(0,s.eW)(" Slide Condition : "+(0,n.v_)(v.value)+" ",1),(0,s.bF)(rn,{isVisible:m.slideStatus,className:"mb08",position:"bottom",type:"",message:`${p.value}`},null,8,["isVisible","message"])],32)):(0,s.Q3)("",!0)])]))}});const gb=pb;var fb=gb;const yb={key:0,class:"wbcContent"};var bb=(0,s.pM)({__name:"listDetailRbc",setup(e){const t=(0,o.KR)({}),a=(0,c.Pj)(),l=(0,o.KR)(null),i=(0,o.KR)([]),r=(0,o.KR)(!1),u=(0,o.KR)(!1),d=(0,s.EW)((()=>a.state.commonModule.cbcLayer)),m=(0,s.EW)((()=>a.state.commonModule.selectedSampleId)),v=(0,o.KR)(!1),p=(0,o.KR)(!1),g=(0,o.KR)(!1),y=(0,s.EW)((()=>a.state.slideDataModule));(0,s.sV)((async()=>{v.value=!1,await I(),await b()}));const b=async()=>{l.value=t.value},I=async()=>{try{t.value=y.value}catch(e){console.error(e),t.value=null}v.value=!0},C=e=>{u.value=e},h=async e=>{l.value=e,t.value=e,r.value=!r.value,await a.dispatch("commonModule/setCommonInfo",{rbcImagePageNumber:0})},k=e=>{i.value=e},S=async e=>{const{result:o,loading:n,error:i}=ov({id:Number(m.value)},{fetchPolicy:"no-cache"});(0,s.wB)(o,(s=>{if(s){a.dispatch("slideDataModule/updateSlideData",s?.getRunningInfoByIdGQL),console.log("listDetailRbc",s?.getRunningInfoByIdGQL);const o=s?.getRunningInfoByIdGQL;a.dispatch("commonModule/setCommonInfo",{testType:t.value.testType}),t.value=o,l.value=o;let n=[];n=e,a.dispatch("commonModule/setCommonInfo",{classInfoArr:n})}else console.log("No result")}))},w=()=>{r.value=!r.value},N=e=>{g.value=e};return(e,a)=>((0,s.uX)(),(0,s.CE)(s.FK,null,[(0,s.bF)(Py,{onRefreshClass:h}),v.value?((0,s.uX)(),(0,s.CE)("div",yb,[(0,s.bF)(fb,{testType:(0,o.R1)(f)(t.value?.testType),barcodeNo:t.value?.barcodeNo,cbcPatientNo:t.value?.cbcPatientNo,patientName:t.value?.patientName,hospitalName:t.value?.hosName,cbcPatientName:t.value?.cbcPatientNm,cbcSex:t.value?.cbcSex,cbcAge:t.value?.cbcAge,analyzedDttm:t.value?.analyzedDttm},null,8,["testType","barcodeNo","cbcPatientNo","patientName","hospitalName","cbcPatientName","cbcSex","cbcAge","analyzedDttm"]),d.value?((0,s.uX)(),(0,s.Wv)(sb,{key:0,selectItems:t.value},null,8,["selectItems"])):(0,s.Q3)("",!0),(0,s.Lk)("div",{class:(0,n.C4)("databaseWbcRight shadowBox pos-relative"+(d.value?" cbcLayer":""))},[(0,s.bF)(xf,{allUnCheck:p.value,onIsBeforeUpdate:C,onClassInfoArrUpdate:k,onClassInfoArrUpdateRe:S,type:"listTable",allCheckClear:r.value,rbcInfo:l.value,notCanvasClickVal:g.value},null,8,["allUnCheck","allCheckClear","rbcInfo","notCanvasClickVal"])],2),(0,s.Lk)("div",{class:(0,n.C4)("databaseWbcLeft"+(d.value?" cbcLayer":""))},[(0,s.bF)(Cy,{onNotCanvasClick:N,onUnChecked:w,isBefore:u.value,classInfoArr:i.value,selectItems:t.value,type:"listTable",rbcInfo:l.value},null,8,["isBefore","classInfoArr","selectItems","rbcInfo"])],2)])):(0,s.Q3)("",!0)],64))}});const Ib=bb;var Cb=Ib;const hb="li",kb="012",Sb="H59",wb=[{id:"01",title:"NS",name:"Neutrophil-Segmented",cd:"LHR10501"},{id:"02",title:"ME",name:"Metamyelocyte",cd:"LHR10507"},{id:"03",title:"MY",name:"Myelocyte",cd:"LHR10508"},{id:"04",title:"PR",name:"Promyelocyte",cd:"LHR10509"},{id:"05",title:"LY",name:"Lymphocyte",cd:"LHR10503"},{id:"61",title:"LR",name:"Reactive lymphocyte",cd:"LHR10544"},{id:"62",title:"LA",name:"Abnormal lymphocyte",cd:"LHR10543"},{id:"07",title:"MO",name:"Monocyte",cd:"LHR10504"},{id:"08",title:"EO",name:"Eosinophil",cd:"LHR10505"},{id:"09",title:"BA",name:"Basophil",cd:"LHR10506"},{id:"10",title:"BL",name:"Blast",cd:"LHR10510"},{id:"11",title:"PC",name:"Plasma cell",cd:"LHR10517"}],Nb=e=>{const t=new Set;return e.filter((e=>!t.has(e.id)&&(t.add(String(e.id)),!0)))};var Rb=(0,s.pM)({__name:"ToastNotification",props:{message:{type:String,required:!0},duration:{type:Number,default:3e3},position:{type:String,default:"bottom-right"},messageType:{type:String}},setup(e){const t=e,a=(0,o.KR)(!0);return(0,s.sV)((()=>{setTimeout((()=>{a.value=!1}),t.duration)})),(0,s.wB)(t,(e=>{a.value=!0,setTimeout((()=>{a.value=!1}),e.duration)})),(t,l)=>a.value?((0,s.uX)(),(0,s.CE)("div",{key:0,class:(0,n.C4)(["toast-notification",[e.position,e.messageType]])},[(0,s.Lk)("p",null,(0,n.v_)(e.message),1)],2)):(0,s.Q3)("",!0)}});const Lb=Rb;var Eb=Lb;const _b=["src"],Pb={key:1,class:"mt10",style:{height:"209.5px"}},Tb={key:2,class:"mt10",style:{height:"209.5px"}},Ab={class:"mt10 mb10 flex-justify-between"},Mb={class:"wbcClassInfoLeft"},Db={class:"leftWbcInfo"},xb={key:0,class:"memoModal"},Ob={class:"wbcClassScroll"},Kb=["onDragstart","onDrop"],Bb=["onClick"],Fb={style:{display:"flex","justify-content":"space-evenly"}},Ub={class:"grayText w20 text-left"},Xb={class:"grayText w50 text-left"},$b={style:{display:"flex","justify-content":"space-evenly"}},Wb={class:"wbcClassDbDiv classTotalColor"},Hb={class:"nth1Child"},Gb={class:"classInfoWbc"},Yb={class:"w20 text-left"},Vb={class:"classInfoWbc"},jb={class:"w20 text-left"},Qb={key:0},qb=["onDragstart","onDrop"],Jb=["onClick"],zb={class:"grayText"},Zb={key:1},eI=["onClick"],tI={class:"categoryNm",style:{cursor:"default"}},aI={key:0,class:"mb10 liTitle",style:{cursor:"default"}},lI={class:"w-fit",style:{cursor:"default"}},sI={style:{width:"29%"}},oI={key:0,class:"mb10 liTitle"},nI={class:"grayText",style:{cursor:"default","padding-left":"-20px"}},iI={class:"degree",style:{width:"27%"}},rI={key:0,class:"mb10 liTitle"},cI={key:2,class:"memoModal bottom text-left staticMemoModal"};var uI=(0,s.pM)({__name:"classInfo",props:["wbcInfo","selectItems","type","isCommitChanged","classCompareShow","isAllClassesChecked"],setup(e,{emit:t}){const a=e,i=(0,c.Pj)(),u=(0,s.EW)((()=>i.state.userModule)),d=t,m=(0,r.rd)(),v=(0,o.KR)(!0),p=(0,o.KR)(a.selectItems),g=(0,s.EW)((()=>i.state.commonModule.iaRootPath)),f=(0,s.EW)((()=>i.state.commonModule.inhaTestCode)),y=(0,s.EW)((()=>i.state.commonModule.deviceSerialNm)),C=(0,s.EW)((()=>i.state.commonModule.siteCd)),h=(0,s.EW)((()=>i.state.slideDataModule)),k=(0,o.KR)(""),S=(0,o.KR)(""),w=(0,o.KR)(""),N=(0,o.KR)(!1),R=(0,o.KR)([]),L=(0,o.KR)([]),E=(0,o.KR)([]),_=(0,o.KR)(""),P=(0,o.KR)(U.TOAST_MSG_SUCCESS),T=(0,o.KR)(!1),A=(0,o.KR)(-1),M=(0,o.KR)(0),D=(0,o.KR)(!1),x=(0,o.KR)(""),O=(0,o.KR)(""),K=(0,o.KR)(!1),B=(0,o.KR)(""),F=(0,o.KR)(""),$=(0,o.KR)([]),G=(0,o.KR)(!1),Y=(0,o.KR)(0),V=(0,o.KR)(0),j=(0,o.KR)(""),Q=(0,o.KR)([]),q=(0,o.KR)([]),J=(0,o.KR)([]),Z=(0,o.KR)(!1),ee=(0,o.KR)(!1),te=(0,o.KR)(!1),ae=(0,o.KR)(""),le=(0,o.KR)([]),se=(0,o.KR)([]),oe=(0,o.KR)([]),ne=(0,o.KR)(""),ie=(0,o.KR)(!1),re=(0,o.KR)(!1),ce=(0,o.KR)({barcodeCopy:!1,memo:!1,confirm:!1,classMoveLock:!1,beforeCountPercent:!1,afterCountPercent:!1,lisUpload:!1});(0,s.KC)((async()=>{Z.value=!1,G.value="bm"===window.PROJECT_TYPE;const e=await rt();0!==e.data.length&&(ie.value=e.data[0].crcConnect)})),(0,s.sV)((async()=>{if(window.removeEventListener("keydown",de),window.removeEventListener("keyup",me),window.addEventListener("keydown",de),window.addEventListener("keyup",me),await(0,s.dY)(),await Ue(),await ze(),await ve(),!G.value){const{lisCodeWbcArr:e,lisCodeRbcArr:t}=await Lp();se.value=e,oe.value=t;const{lisFilePathSetArr:a,lisHotKey:l}=await Ep();q.value=a,ne.value=l,ae.value=await _p(),le.value=await Pp()}Z.value=!1})),(0,s.hi)((()=>{window.removeEventListener("keydown",de),window.removeEventListener("keyup",me)})),(0,s.wB)((()=>a.isCommitChanged),(()=>{p.value.submitState="Submit"})),(0,s.wB)(u.value,(e=>{S.value=e.id})),(0,s.wB)((()=>a.wbcInfo),(e=>{if(window.removeEventListener("keydown",de),window.removeEventListener("keyup",me),window.addEventListener("keydown",de),window.addEventListener("keyup",me),0!==Object.keys(e).length){Xe(e),w.value=a.selectItems?.wbcMemo;const t=""!==a.selectItems?.img_drive_root_path&&a.selectItems?.img_drive_root_path?a.selectItems?.img_drive_root_path:g.value;k.value=b("barcode_image.jpg",t,a.selectItems?.slotId,aa.BARCODE),i.dispatch("commonModule/setCommonInfo",{testType:a.selectItems.testType})}}));const de=e=>{if("/report"===m.currentRoute.value.path)return;const t=e.key;re.value||t.toUpperCase()!==ne.value.toUpperCase()||(e.preventDefault(),re.value=!0,Se())},me=e=>{"/report"!==m.currentRoute.value.path&&re.value&&(re.value=!1)},ve=async()=>{if(oc(a.selectItems))return;""===f.value&&C.value===I["인하대병원"]&&await wp(ae.value,a.selectItems,le.value,"lisUpload"),w.value=a.selectItems?.wbcMemo;const e=""!==a.selectItems?.img_drive_root_path&&a.selectItems?.img_drive_root_path?a.selectItems?.img_drive_root_path:g.value;k.value=b("barcode_image.jpg",e,a.selectItems?.slotId,aa.BARCODE),a.selectItems?.submitState&&(te.value="lisCbc"===a.selectItems.submitState)},pe=()=>{K.value=!0,F.value=U.IDS_MSG_UPLOAD_LIS,j.value="lisCbc"},ge=e=>{d("scrollEvent",e)},fe=()=>G.value?"BM Classification":"WBC Classification",ye=(e,t)=>{A.value=e,M.value=t.clientY-t.target.getBoundingClientRect().top},be=(e,t)=>{if(T.value&&(t.preventDefault(),-1!==A.value)){const t=R.value.splice(A.value,1)[0];R.value.splice(e,0,t),A.value=-1,qe()}},Ie=()=>{T.value=!T.value},Ce=async()=>{const e=document.createElement("textarea");e.value=a.selectItems.barcodeNo,document.body.appendChild(e),e.select(),document.execCommand("copy"),document.body.removeChild(e),P.value=U.TOAST_MSG_SUCCESS,at(U.TOAST_MSG_BAR_CODE_SUCCESS)},he=()=>{ee.value=!0,K.value=!0,F.value=U.IDS_MSG_CONFIRM_SLIDE,j.value="commit"},ke=()=>{"commit"===j.value?De():Se(),K.value=!1},Se=async()=>{switch(C.value){case I["서울성모병원"]:Ne();break;case I["인하대병원"]:await Ee();break;case I["인천길병원"]:await Le();break;case I["고대안암병원"]:Re();break;case I["NONE"]:case I["UIMD"]:await we();break}},we=async()=>{const e=wb,{wbcInfoAfter:t}=a.selectItems??{};let l=window.APP_API_BASE_URL||"http://192.168.0.131:3002";z.A.get(`${l}/cbc/liveTest`,{params:{baseUrl:"http://emr012.cmcnu.or.kr/cmcnu/.live",submit_id:"TRLII00124",business_id:"li",instcd:"012"},headers:{"Content-Type":"application/json"}}).then((async function(a){const l=a.data.trim(),s=JSON.parse((0,Ty.xml2json)(l,{compact:!0})),o=s.root.spcworklist.worklist,n=["LHR10501","LHR10502","LHR10503","LHR10504","LHR10505","LHR10506"],r=o.filter((function(e){return"LHR100"===e.testcd._cdata}));t.forEach((function(t){t.testcd="",e.forEach((function(e){String(t.id)===String(e.id)&&(t.testcd=e.cd)}))}));let c=[];t.forEach((function(e){n.forEach((function(t){(e.testcd===t||Number(e.count)>0&&""!==e.testcd)&&c.push({testcd:e.testcd,percent:e.percent,name:e.name})}))}));const d=new Set(c.map((e=>e.testcd)));c=Array.from(d).map((e=>c.find((t=>t.testcd===e))));const m=c.filter((e=>"Neutrophil"!==e.name)).map((e=>Math.round(parseFloat(e.percent)))).reduce(((e,t)=>e+t),0),v=c.map((e=>"Neutrophil"===e.name?{...e,percent:100-m}:{...e,percent:Math.round(parseFloat(e.percent))}));c=v;const p=c.filter((e=>"LHR10501"===e.testcd));if(p.length>0&&r.length>0){const e=(Number(r[0].inptrslt._cdata)*p[0].percent/100).toFixed(2);c.push({testcd:"LHR10599",percent:e,name:"ANC 계산"})}const g=W()().local(),f={submitState:"lisCbc",submitOfDate:g.format(),submitUserId:u.value.userId};te.value=!0;const y={...h.value,...f};await xg(Ag,{id:y.id,submitState:y.submitState,submitOfDate:y.submitOfDate,submitUserId:y.submitUserId}),await i.dispatch("slideDataModule/updateSlideData",y)})).catch((function(e){console.error("error.config",e.config),Ze(e.message)}))},Ne=()=>{const e=wb,{barcodeNo:t,wbcInfoAfter:l}=a.selectItems??{};let s=window.APP_API_BASE_URL||"http://192.168.0.131:3002";z.A.get(`${s}/cbc/lisCbcMarys`,{params:{submit_id:"TRLII00124",business_id:"li",instcd:"012",bcno:t,baseUrl:"http://emr012.cmcnu.or.kr/cmcnu/.live"},headers:{"Content-Type":"application/json"}}).then((async function(a){const o=a.data.data.trim(),n=JSON.parse((0,Ty.xml2json)(o,{compact:!0})),r=n.root.spcworklist.worklist,c=["LHR10501","LHR10502","LHR10503","LHR10504","LHR10505","LHR10506"],d=r.filter((function(e){return"LHR100"===e.testcd._cdata}));l.forEach((function(t){t.testcd="",e.forEach((function(e){String(t.id)===String(e.id)&&(t.testcd=e.cd)}))}));let m=[];l.forEach((function(e){c.forEach((function(t){(e.testcd===t||Number(e.count)>0&&""!==e.testcd)&&m.push({testcd:e.testcd,percent:e.percent})}))}));const v=new Set(m.map((e=>e.testcd)));m=Array.from(v).map((e=>m.find((t=>t.testcd===e))));const p=m.filter((e=>"Neutrophil"!==e.name)).map((e=>Math.round(parseFloat(e.percent)))).reduce(((e,t)=>e+t),0),g=m.map((e=>"Neutrophil"===e.name?{...e,percent:100-p}:{...e,percent:Math.round(parseFloat(e.percent))}));m=g;const f=m.filter((e=>"LHR10501"===e.testcd));if(f.length>0&&d.length>0){const e=(Number(d[0].inptrslt._cdata)*f[0].percent/100).toFixed(2);m.push({testcd:"LHR10599",percent:e,name:"ANC 계산"})}const y=`D:\\UIMD_Data\\UI_Log\\CBCLookUP\\${t}.txt`,b={filePath:y,data:{cbcJson:n,cbcWorkList:r}};await bp(b),Ae(u.value.employeeNo).then((function(e){if("succ"===e){const e={empNo:u.value.employeeNo,barcodeNo:t,wbcInfo:m},a=new Date,o=`${a.getFullYear()}`;let c=`${a.getMonth()+1}`;1===c.length&&(c=`0${c}`);let d=`${a.getDate()}`;1===d.length&&(d=`0${d}`);const v=String.fromCharCode(23),p=String.fromCharCode(23,23),g=String.fromCharCode(3),y=e.wbcInfo.filter((e=>null!==e.testcd&&""!==e.testcd)).map((e=>`${e.testcd}${v}${e.percent}${p}${o}${c}${d}${g}`)).join(""),b={submit_id:"TXLII00101",business_id:hb,ex_interface:`${e.empNo}|${kb}`,instcd:kb,userid:e.empNo,eqmtcd:Sb,bcno:e.barcodeNo,result:y,testcont:"MANUAL DIFFERENTIAL COUNT RESULT",testcontcd:"01",execdeptcd:"H1",baseUrl:"http://emr012.cmcnu.or.kr/cmcnu/.live"};z.A.get(`${s}/cbc/lisCbcMarys`,{params:b,headers:{"Content-Type":"application/json"}}).then((async function(e){const a=e.data.data,s=JSON.parse((0,Ty.xml2json)(a,{compact:!0})),o=s.root.ResultFlag.resultflag._text,c={empNo:u.value.employeeNo,barcodeNo:t,wbcTemp:m,frontendSendData:b,processSendData:y,uimdDefaultData:l,nsPercentItem:f,cbcJson:n,cbcWorkList:r},d=`D:\\UIMD_Data\\UI_Log\\LISFinalReport\\${t}.txt`,v={filePath:d,data:{frontendData:c,lisLastReportVal:e}};if(await bp(v),"Y"===o){const e=W()().local(),t={submitState:"lisCbc",submitOfDate:e.format(),submitUserId:u.value.userId};te.value=!0;const a={...h.value,...t};await xg(Ag,{id:a.id,submitState:a.submitState,submitOfDate:a.submitOfDate,submitUserId:a.submitUserId}),await i.dispatch("slideDataModule/updateSlideData",a)}else{const e=s.root.ResultFlag.error2._text.indexOf("!"),t=-1!==e?s.root.ResultFlag.error2._text.substring(0,e+1):s.root.ResultFlag.error2._text,a="1"===s.root.ResultFlag.error2._text?"LIS 전송이 실패 했습니다.":t;Ze(a)}})).catch((function(e){Ze(e.message)}))}else Ze(U.IDS_ERROR_PLEASE_CONFIRM_YOUR_USER_ID)}))})).catch((function(e){console.error("error.config",e.config),Ze(e.message)}))},Re=()=>{const e=_e();Pe(e)},Le=async()=>{const e=q.value,t=await fp(`path=${e}`);if(t){const e={sendingApp:"PBIA",sendingFacility:"PBIA",receivingApp:"LIS",receivingFacility:"LIS",dateTime:H(),security:"",messageType:["ADT","R02"],messageControlId:a.selectItems?.barcodeNo,processingId:"P",hl7VersionId:"2.5",selectedItem:{},wbcInfo:Bd(a.selectItems?.wbcInfoAfter,a.selectItems?.wbcInfo.totalCount),result:se.value},t=await To(e);if(t)if(q.value.includes("http"))await Te(t);else{const e={filepath:`${q.value}\\${a.selectItems.barcodeNo}.hl7`,msg:t};try{await Mo(e),P.value=U.TOAST_MSG_SUCCESS,at(U.IDS_MSG_SUCCESS);const t=W()().local(),a={submitState:"lisCbc",submitOfDate:t.format(),submitUserId:u.value.userId};te.value=!0;const l={...h.value,...a};await xg(Ag,{id:l.id,submitState:l.submitState,submitOfDate:l.submitOfDate,submitUserId:l.submitUserId}),await i.dispatch("slideDataModule/updateSlideData",l),d("uploadLisChangeSlide",I["인천길병원"])}catch(l){Ze(l.response.data.message)}}}},Ee=async()=>{await wp(ae.value,a.selectItems,le.value,"lisUpload");const{errMessage:e,lisBtnColor:t}=await Np(a.selectItems?.wbcInfoAfter,a.selectItems?.rbcInfoAfter,a.selectItems?.barcodeNo,q.value,f.value,se.value,oe.value,a.selectItems,u.value.id);""!==e&&(P.value=U.TOAST_MSG_ERROR,at(e)),te.value=t||!1},_e=()=>{let e=`H|\\^&||||||||||P||${a.selectItems?.barcodeNo}\n`,t=0,l=0,s=0;if(a.selectItems?.wbcInfoAfter.forEach((e=>{["02","03","04","10"].includes(e.id)&&(l+=Number(e.percent)),"72"===e.id&&(s=Number(e.percent))})),l>0&&s<6){const e=(e,t)=>{const l=a.selectItems?.wbcInfoAfter.find((t=>t.id===e));l&&(l.percent=t)};e("71",(Number(a.selectItems?.wbcInfoAfter.find((e=>"71"===e.id))?.percent)+s).toString()),e("72","0")}const o=(a,l)=>{""!==a.LIS_CD&&(["01","71","05","07","08","09"].includes(l.id)||Number(l.percent)>0)&&(e+=`R|${++t}|^^^^${a.LIS_CD}|${l.count}|||||||^${u.value.name}\n`,e+=`R|${++t}|^^^^${a.LIS_CD}%|${l.percent}|%||||||^${u.value.name}\n`)};return Q.value.forEach((e=>{a.selectItems?.wbcInfoAfter.forEach((t=>{e.IA_CD===t.id&&o(e,t)}))})),e+="L|1|N"},Pe=async e=>{const t=`D:\\UIMD_Data\\UI_Log\\LIS_IA\\${a.selectItems?.barcodeNo}.txt`,l={filePath:t,data:e};if(await bp(l),q.value.includes("http"))await Te(e);else{const t=q.value,l=await fp(`path=${t}`);if(l){const l={path:t,filename:`${a.selectItems?.barcodeNo}.lst2msg`,content:e},s=await yp(l);if(s){const e=W()().local(),t={submitState:"lisCbc",submitOfDate:e.format(),submitUserId:u.value.userId},a={...h.value,...t};await xg(Ag,{id:a.id,submitState:a.submitState,submitOfDate:a.submitOfDate,submitUserId:a.submitUserId}),await i.dispatch("slideDataModule/updateSlideData",a),P.value=U.TOAST_MSG_SUCCESS,at(U.IDS_MSG_SUCCESS),D.value||d("nextPage")}else Ze("lisCbc file err")}}},Te=async e=>{const t={barcodeNo:a.selectItems?.barcodeNo,userId:u.value.name,deviceBarcode:y.value,resultMsg:e,baseUrl:q.value};try{let e=window.APP_API_BASE_URL||"http://192.168.0.131:3002";const a=await z.A.post(`${e}/cbc/executePostCurl`,t);"E000"===a.data.errorCode?(P.value=U.TOAST_MSG_SUCCESS,at(U.IDS_MSG_SUCCESS)):Ze(a.data.errorMessage)}catch(l){Ze(l.message)}},Ae=async e=>new Promise(((t,a)=>{if(C.value===I["서울성모병원"]){let l=window.APP_API_BASE_URL||"http://192.168.0.131:3002";z.A.get(`${l}/cbc/lisCbcMarys`,{params:{submit_id:"TRLII00104",business_id:"li",instcd:"012",userid:e,baseUrl:"http://emr012.cmcnu.or.kr/cmcnu/.live"},headers:{"Content-Type":"application/json"}}).then((function(e){const a=e.data.data,l=JSON.parse((0,Ty.xml2json)(a,{compact:!0})),s=l.root.getUsernm.usernm._text;t(null===s||""===s?"fail":"succ")})).catch((function(e){console.error("checkUserAuth :"+e.message),a(new Error(e.message))}))}})),Me=()=>{K.value=!1},De=async()=>{const e=W()().local(),t={submitState:"Submit",submitOfDate:e.format(),submitUserId:u.value.userId},a={...h.value,...t};await xg(Ag,{id:a.id,submitState:a.submitState,submitOfDate:a.submitOfDate,submitUserId:a.submitUserId}),await i.dispatch("slideDataModule/updateSlideData",a),p.value.submitState="Submit",d("submitStateChanged","Submit")},xe=async()=>{const e=w.value.replaceAll("\r\n","<br>"),t={wbcMemo:e},a={...h.value,...t},l=await xg(Mg,{id:a.id,wbcMemo:a.wbcMemo,rbcMemo:a.rbcMemo});await i.dispatch("slideDataModule/updateSlideData",a),l&&0!==l?.data?.updateRunningInfoGQL[0].length&&(P.value=U.TOAST_MSG_SUCCESS,at("Success"),w.value=a.wbcMemo),N.value=!1},Oe=()=>{N.value=!N.value},Ke=()=>{N.value=!1},Be=e=>"Artifact(Smudge)"===e&&C.value===I["고대안암병원"]?"Artifact":e,Fe=(e,t)=>{let a=JSON.parse(JSON.stringify(e));return a.sort(((e,a)=>{const l=t.findIndex((t=>(t.title||t.abbreviation)===(e.title||e.abbreviation))),s=t.findIndex((e=>(e.title||e.abbreviation)===(a.title||a.abbreviation)));return-1===l?1:-1===s?-1:l-s})),a},Ue=async()=>{try{const e=await He();e&&(0===e?.data.length?$.value=[]:$.value=e.data.sort(((e,t)=>Number(e.orderIdx)-Number(t.orderIdx))))}catch(e){console.error(e)}},Xe=async e=>{await Ue();const t=h.value;p.value=t;const l=p.value.wbcInfoAfter.filter((e=>90<=Number(e.id)&&Number(e.id)<=95));p.value.wbcInfoAfter=e;const s=J.value.filter((e=>""!==e.abbreviation&&""!==e.fullNm));let o=Nb(p.value.wbcInfo.wbcInfo[0]||[]),n=Nb(p.value?.wbcInfoAfter||t.wbcInfo.wbcInfo[0]||[]);if(o=Nb(o),n=Nb(n),s.length>0&&0===l.length){for(const a of s)if(n.find((e=>e.id!=a.customNum))){const e={id:String(a.customNum),name:a.fullNm,count:"0",title:a.abbreviation,images:[]};o.push(e),n.push(e)}}else if(s.length>0&&l.length>0)for(const a of l)if(n.find((e=>e.id!=a.id))){const e={id:String(a.id),name:a.name,count:"0",title:a.title,images:[]};o.push(e),n.push(a)}o=o.reduce(((e,t)=>(e.some((e=>String(e.id)===String(t.id)))||e.push(t),e)),[]),n=n.reduce(((e,t)=>(e.some((e=>String(e.id)===String(t.id)))||e.push(t),e)),[]);const i=0!==$.value.length?$.value:"bm"===window.PROJECT_TYPE?el:Za,r=0!==$.value.length?$.value:"bm"===window.PROJECT_TYPE?za:Ja;L.value=n,E.value=o;const c=We(n,"wbc"),u=We(o,"wbc");Qe("before",u),Qe("after",c);for(const a of u)Ye(a,Y.value);for(const a of c)Ye(a,V.value);const d=G.value?"bm":"pb";C.value===I["서울성모병원"]?(E.value=Od(u,E.value),L.value=Od(c,L.value)):C.value===I["인하대병원"]?(L.value=await xd(p.value,L.value),E.value=await xd(p.value,E.value)):C.value===I["인천성모병원"]?(L.value=Kd(d,L.value),E.value=Kd(p.value,E.value)):C.value===I["인천길병원"]&&(L.value=Bd(L.value,a.selectItems?.wbcInfo.totalCount),E.value=Bd(E.value,a.selectItems?.wbcInfo.totalCount)),R.value=[],L.value=Fe(L.value,r),E.value=Fe(E.value,i);for(const[a,m]of E.value.entries()){const e=L.value[a];if(!e)continue;const t=$e(m,e),l={id:m.id,name:m.name,title:m.title,count:{before:m.count,after:e.count},images:{before:m.images,after:e.images},percent:{before:m.percent,after:e.percent},isChanged:t};R.value.push(l)}},$e=(e,t)=>{if(Number(e.count)!==Number(t.count))return!0;const a=e.images.slice().map((e=>e.fileName)),l=t.images.slice().map((e=>e.fileName)),s=new Set(a),o=new Set(l);if(s.size!==o.size)return!0;{const e=[...s].every((e=>o.has(e)));return!e}},We=(e,t)=>{const a=["NR","GP","PA","AR","MA","SM"];return"nonWbc"===t?e.filter((e=>a.includes(e.title))):e.filter((e=>!a.includes(e.title)))},Ye=(e,t)=>{if(G.value&&"OT"!==e.title){const a=(Number(e.count)/Number(t)*100).toFixed(1);e.percent=Number(a)===Math.floor(Number(a))?Math.floor(Number(a)).toString():a}else{if(C.value===I["인하대병원"])return;const a=je(C.value,p.value?.testType);if(!a.includes(e.title)){const a=(Number(e.count)/Number(t)*100).toFixed(1);e.percent=Number(a)===Math.floor(Number(a))?Math.floor(Number(a)).toString():a}}},Ve=e=>{const t=je(C.value,p.value?.testType);return!t.includes(e)},je=(e,t)=>{e||""!==e||(e="0000",t="01");const a={"0006":{includesStr:["AR","NR","GP","PA","MC","MA","SM","NE","GP","PA","OT"],includesStr2:["NR","AR","MC","MA","SM","NE","GP","PA","OT"]}},l=a[e]||{includesStr:["AR","NR","GP","PA","MC","SM","MA","GP","PA","OT"],includesStr2:["NR","AR","MC","MA","SM","GP","PA","OT"]};return"01"===t||"04"===t?l.includesStr:l.includesStr2},Qe=(e,t)=>{"before"===e?Y.value=0:"after"===e&&(V.value=0),t.forEach((t=>{if(G.value)"OT"!==t.title&&("before"===e?Y.value+=Number(t.count):V.value+=Number(t.count));else{const a=je(C.value,p.value?.testType),l=a.includes(t.title);l||("before"===e?Y.value+=Number(t.count):V.value+=Number(t.count))}}))};async function qe(){let e=JSON.parse(JSON.stringify([...L.value])),t=0;e.forEach((e=>{e.images.forEach((e=>{if(G.value)"OT"!==e.title&&(t+=1);else{const a=je(C.value,p.value?.testType);a.includes(e.title)||(t+=1)}}))})),e.forEach((l=>{Ye(l,t);const s=G.value?"bm":"pb";C.value===I["서울성모병원"]?L.value=Od(e,L.value):C.value===I["인하대병원"]?L.value=xd(p.value,L.value):C.value===I["인천성모병원"]?L.value=Kd(s,L.value):C.value===I["인천길병원"]&&(L.value=Bd(L.value,a.selectItems?.wbcInfo.totalCount))})),p.value.wbcInfoAfter=e,await i.dispatch("commonModule/setCommonInfo",{classInfoSort:[...L.value]});const l=Fe($.value,R.value);l.forEach(((e,t)=>{e.orderIdx=t})),h.value&&(h.value.wbcInfoAfter=e),await Ge(l),await Je(h.value),d("classOrderChanged"),await i.dispatch("commonModule/setCommonInfo",{classInfoSort:[]})}async function Je(e){try{await xg(Tg,{id:e.id,isNormal:e.isNormal,abnormalClassInfo:e.abnormalClassInfo,pcIp:e.pcIp,lock_status:e.lock_status,wbcInfoAfter:e.wbcInfoAfter,submitState:e.submitState}),await i.dispatch("slideDataModule/updateSlideData",e)}catch(t){console.error("Error:",t)}}const ze=async()=>{try{const e=await ue();J.value=e.data}catch(e){console.error(e)}},Ze=e=>{D.value=!0,x.value="error",O.value=e},et=()=>{D.value=!1},tt=()=>{Z.value=!0},at=e=>{_.value=e,setTimeout((()=>{_.value=""}),1500)},lt=(e,t)=>{ce.value[e]=t},st=e=>"0019"===e?"center":"top";return(t,a)=>{const i=(0,s.g2)("font-awesome-icon");return(0,s.uX)(),(0,s.CE)(s.FK,null,["report"===e.type||Z.value||C.value===(0,o.R1)(I)["고대구로병원"]?"report"!==e.type&&Z.value?((0,s.uX)(),(0,s.CE)("div",Pb)):"report"!==e.type?((0,s.uX)(),(0,s.CE)("div",Tb)):(0,s.Q3)("",!0):((0,s.uX)(),(0,s.CE)("img",{key:0,class:"mt10",onError:tt,src:k.value},null,40,_b)),(0,s.Lk)("div",Ab,[(0,s.Lk)("h3",Mb,(0,n.v_)(fe()),1),(0,s.Lk)("ul",Db,[(0,s.Lk)("li",{class:"pos-relative",onMouseenter:a[0]||(a[0]=e=>lt("barcodeCopy",!0)),onMouseleave:a[1]||(a[1]=e=>lt("barcodeCopy",!1))},[(0,s.bF)(i,{onClick:Ce,icon:["fas","copy"],class:"hoverSizeAction"}),(0,s.bF)(rn,{isVisible:ce.value.barcodeCopy,className:"mb08",position:"top",type:"",message:(0,o.R1)(X).TOOLTIP.BARCODE_COPY},null,8,["isVisible","message"])],32),"report"!==e.type?((0,s.uX)(),(0,s.CE)("li",{key:0,class:"pos-relative",onMouseenter:a[3]||(a[3]=e=>lt("memo",!0)),onMouseleave:a[4]||(a[4]=e=>lt("memo",!1))},[(0,s.bF)(i,{icon:["fas","comment-dots"],onClick:Oe,class:"hoverSizeAction"}),(0,s.bF)(rn,{isVisible:ce.value.memo,className:"mb08",position:"top",type:"",message:(0,o.R1)(X).TOOLTIP.MEMO},null,8,["isVisible","message"]),N.value?((0,s.uX)(),(0,s.CE)("div",xb,[(0,s.bo)((0,s.Lk)("textarea",{"onUpdate:modelValue":a[2]||(a[2]=e=>w.value=e)},null,512),[[l.Jo,w.value]]),(0,s.Lk)("button",{class:"memoModalBtn",onClick:xe},"OK"),(0,s.Lk)("button",{class:"memoModalBtn",onClick:Ke},"CANCEL")])):(0,s.Q3)("",!0)],32)):(0,s.Q3)("",!0),(0,s.Lk)("li",{onClick:he,class:(0,n.C4)(["pos-relative",{submitted:"Submit"===p.value?.submitState}]),onMouseenter:a[5]||(a[5]=e=>lt("confirm",!0)),onMouseleave:a[6]||(a[6]=e=>lt("confirm",!1))},[(0,s.bF)(i,{icon:["fas","square-check"],class:"hoverSizeAction"}),(0,s.bF)(rn,{isVisible:ce.value.confirm,className:"mb08",position:"top",type:"",message:(0,o.R1)(X).TOOLTIP.CONFIRM},null,8,["isVisible","message"])],34),!ie.value&&v.value?((0,s.uX)(),(0,s.CE)("li",{key:1,onClick:pe,class:(0,n.C4)(["pos-relative",{submitted:"lisCbc"===p.value?.submitState||te.value}]),onMouseenter:a[7]||(a[7]=e=>lt("lisUpload",!0)),onMouseleave:a[8]||(a[8]=e=>lt("lisUpload",!1))},[(0,s.bF)(i,{icon:["fas","upload"],class:"hoverSizeAction"}),(0,s.bF)(rn,{isVisible:ce.value.lisUpload,className:"mb08",position:"top",type:"",message:(0,o.R1)(X).TOOLTIP.LIS_UPLOAD},null,8,["isVisible","message"])],34)):(0,s.Q3)("",!0),(0,s.Lk)("li",{class:"pos-relative",onMouseenter:a[9]||(a[9]=e=>lt("classMoveLock",!0)),onMouseleave:a[10]||(a[10]=e=>lt("classMoveLock",!1))},[T.value?(0,s.Q3)("",!0):((0,s.uX)(),(0,s.Wv)(i,{key:0,icon:["fas","lock"],onClick:Ie,class:"hoverSizeAction"})),T.value?((0,s.uX)(),(0,s.Wv)(i,{key:1,icon:["fas","lock-open"],onClick:Ie,class:"hoverSizeAction"})):(0,s.Q3)("",!0),(0,s.bF)(rn,{isVisible:ce.value.classMoveLock,className:"mb08",position:"top",type:"",message:(0,o.R1)(X).TOOLTIP.CLASS_MOVE},null,8,["isVisible","message"])],32)])]),(0,s.Lk)("div",Ob,[a[17]||(a[17]=(0,s.Fv)('<ul class="nth1Child classAttribute"><li>Class</li><li class="wbcTitleText"><p class="firstP">Before</p><p>(Count | Percent)</p></li><li class="wbcTitleText"><p class="firstP">After</p><p>(Count | Percent)</p></li></ul>',1)),((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(R.value,((e,t)=>((0,s.uX)(),(0,s.CE)("div",{key:e.id,class:"wbcClassDbDiv",draggable:"true",onDragstart:e=>ye(t,e),onDragover:a[11]||(a[11]=(0,l.D$)((()=>{}),["prevent"])),onDrop:e=>be(t,e)},[Ve(e.title)?((0,s.uX)(),(0,s.CE)("ul",{key:0,class:(0,n.C4)({nth1Child:!0,cursorMove:T.value}),onClick:t=>ge(e.id),title:"BLUE text: changed element"},[(0,s.Lk)("li",null,(0,n.v_)(e?.name),1),(0,s.Lk)("li",Fb,[(0,s.Lk)("span",Ub,(0,n.v_)(Number(e.count.before)||0),1),(0,s.Lk)("span",Xb,(0,n.v_)(Number(e?.percent.before)?e?.percent.before+"%":"0"),1)]),(0,s.Lk)("li",$b,[(0,s.Lk)("span",{class:(0,n.C4)(["w20","text-left",e.isChanged&&"blueText"])},(0,n.v_)(Number(e?.count.after)||0),3),(0,s.Lk)("span",{class:(0,n.C4)(["w50","text-left",e.isChanged&&"blueText"])},(0,n.v_)(Number(e?.percent.after)?e?.percent.after+"%":"0"),3)])],10,Bb)):(0,s.Q3)("",!0)],40,Kb)))),128)),(0,s.Lk)("div",Wb,[(0,s.Lk)("ul",Hb,[a[16]||(a[16]=(0,s.Lk)("li",null,"Total",-1)),(0,s.Lk)("li",Gb,[(0,s.Lk)("span",Yb,(0,n.v_)(Number(Y.value)||0),1),a[14]||(a[14]=(0,s.Lk)("span",{class:"w50 text-left"},"100%",-1))]),(0,s.Lk)("li",Vb,[(0,s.Lk)("span",jb,(0,n.v_)(Number(V.value)||0),1),a[15]||(a[15]=(0,s.Lk)("span",{class:"w50 text-left"},"100%",-1))])])]),G.value?((0,s.uX)(),(0,s.CE)("div",Qb,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(R.value,((e,t)=>((0,s.uX)(),(0,s.CE)("div",{key:e.id,class:"wbcClassDbDiv mb20",draggable:"true",onDragstart:e=>ye(t,e),onDragover:a[12]||(a[12]=(0,l.D$)((()=>{}),["prevent"])),onDrop:e=>be(t,e)},["OT"===e?.title?((0,s.uX)(),(0,s.CE)("ul",{key:0,class:"nth1Child",onClick:t=>ge(e.id)},[(0,s.Lk)("li",null,(0,n.v_)(e?.name),1),(0,s.Lk)("li",zb,(0,n.v_)(Number(e?.count.before)||0),1),(0,s.Lk)("li",{class:(0,n.C4)(e.isChanged&&"blueText")},(0,n.v_)(Number(e?.count.after)||0),3)],8,Jb)):(0,s.Q3)("",!0)],40,qb)))),128))])):(0,s.Q3)("",!0),G.value?(0,s.Q3)("",!0):((0,s.uX)(),(0,s.CE)("div",Zb,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(We(R.value,"nonWbc"),((e,t)=>(0,s.bo)(((0,s.uX)(),(0,s.CE)("div",{key:t,class:"categories",onClick:t=>ge(e.id)},[(0,s.Lk)("ul",tI,[0===t?((0,s.uX)(),(0,s.CE)("li",aI,"non-WBC")):(0,s.Q3)("",!0),(0,s.Lk)("li",lI,(0,n.v_)(Be(e.name)),1)]),(0,s.Lk)("ul",sI,[0===t?((0,s.uX)(),(0,s.CE)("li",oI)):(0,s.Q3)("",!0),(0,s.Lk)("li",nI,(0,n.v_)(Number(e?.count.before)||0),1)]),(0,s.Lk)("ul",iI,[0===t?((0,s.uX)(),(0,s.CE)("li",rI)):(0,s.Q3)("",!0),(0,s.Lk)("li",{class:(0,n.C4)(e.isChanged&&"blueText"),style:{cursor:"default"}},(0,n.v_)(Number(e?.count.after)||0),3)])],8,eI)),[[l.aG,"0006"!==p.value?.siteCd&&"SM"!==e?.title]]))),128))])),"/report"===(0,o.R1)(m).currentRoute.value.path?((0,s.uX)(),(0,s.CE)("div",cI,[(0,s.bo)((0,s.Lk)("textarea",{class:"staticTextArea","onUpdate:modelValue":a[13]||(a[13]=e=>w.value=e)},null,512),[[l.Jo,w.value]]),(0,s.Lk)("button",{class:"memoModalBtn",onClick:xe},"Save")])):(0,s.Q3)("",!0)]),D.value?((0,s.uX)(),(0,s.Wv)(Pt,{key:3,"is-visible":D.value,type:x.value,message:O.value,onHide:et,"onUpdate:hideAlert":et},null,8,["is-visible","type","message"])):(0,s.Q3)("",!0),_.value?((0,s.uX)(),(0,s.Wv)(Eb,{key:4,message:_.value,messageType:P.value,duration:1500,position:st(C.value)},null,8,["message","messageType","position"])):(0,s.Q3)("",!0),K.value?((0,s.uX)(),(0,s.Wv)(ra,{key:5,"is-visible":K.value,type:B.value,message:F.value,onHide:Me,onOkConfirm:ke},null,8,["is-visible","type","message"])):(0,s.Q3)("",!0)],64)}}});const dI=uI;var mI=dI;const vI={class:"mb20"};var pI=(0,s.pM)({__name:"PassWordCheck",props:{crcPassWord:{type:String,required:!0}},emits:["returnPassWordCheck","passWordClose"],setup(e,{emit:t}){const a=e,n=t,i=(0,o.KR)(""),r=()=>{i.value===a.crcPassWord?n("returnPassWordCheck",!0):n("returnPassWordCheck",!1)},c=()=>{n("passWordClose")};return(e,t)=>{const a=(0,s.g2)("font-awesome-icon");return(0,s.uX)(),(0,s.CE)("div",{class:"passWordCheckBack",onClick:c},[(0,s.Lk)("div",{class:"passWordCheck",onClick:t[1]||(t[1]=(0,l.D$)((()=>{}),["stop"]))},[(0,s.Lk)("p",vI,[(0,s.bF)(a,{icon:["fas","lock"]})]),t[2]||(t[2]=(0,s.Lk)("p",{class:"adminText"},"Admin Password",-1)),t[3]||(t[3]=(0,s.Lk)("p",null," Please enter the administrator password. ",-1)),(0,s.bo)((0,s.Lk)("input",{type:"password","onUpdate:modelValue":t[0]||(t[0]=e=>i.value=e),class:"mt40 lockInput"},null,512),[[l.Jo,i.value]]),(0,s.Lk)("button",{onClick:r,class:"mt10 lockBtn cursorPointer"},"OK"),(0,s.Lk)("button",{onClick:c,class:"mt10 noLockBtn cursorPointer"},"Close")])])}}});const gI=pI;var fI=gI;const yI={class:"crcPopUpDiv remark"},bI={style:{position:"relative",height:"100%",width:"100%"}},II={class:"headerRemark topLine"},CI={class:"remarkDefaultTable"},hI=["value"],kI={key:0},SI={key:1,class:"text-left"},wI={key:2},NI=["innerHTML"],RI={key:4},LI=["onClick"],EI={key:5},_I=["onClick"],PI=["onClick"],TI={class:"mt20 remarkBottomFix"},AI={class:"text-left fs10 fw-bold mb10"},MI={class:"remarkBottomBtnGroup mb10"},DI={class:"flex-justify-between"};var xI=(0,s.pM)({__name:"remark",props:{crcDefaultMode:{type:Boolean,required:!0},type:{type:String,required:!0},crcPassWord:{type:String}},emits:["cancel","listUpdated"],setup(e,{emit:t}){const a=e,i=(0,c.Pj)(),r=t,u=(0,o.KR)(""),d=(0,o.KR)(U.TOAST_MSG_SUCCESS),m=(0,o.KR)([]),v=(0,o.KR)([]),p=(0,o.KR)(""),g=(0,o.KR)(""),f=(0,o.KR)("Code"),y=(0,o.KR)(null),b=(0,o.KR)(""),I=(0,o.KR)(""),C=(0,o.KR)(""),h=(0,o.KR)(!1),k=(0,o.KR)(""),S=(0,o.KR)(!1),w=(0,o.KR)(!1);(0,s.EW)((()=>i.state.commonModule.siteCd));(0,s.KC)((async()=>{h.value=a.crcDefaultMode,k.value=a.crcPassWord||"",S.value=!1,await N("mounted")}));const N=async e=>{let t=[];t="remark"===a.type?await Ze():"comment"===a.type?await ft():await dt(),m.value=t?.data||[],"mounted"!==e&&(d.value=U.TOAST_MSG_SUCCESS,B("Search completed."))},R=()=>{w.value=!1},L=e=>{e?(S.value=!0,w.value=!1,d.value=U.TOAST_MSG_SUCCESS,B("Admin verification is complete. Please click the button again.")):(S.value=!1,w.value=!1,d.value=U.TOAST_MSG_ERROR,B("The administrator password is incorrect."))},E=async()=>{try{if(""===C.value)return void await N();let e={};"Code"===f.value?e.code=C.value:"Content"===f.value&&(e.remarkAllContent=C.value);let t=[];t="remark"===a.type?await et(e):"comment"===a.type?await yt(e):await mt(e),m.value=t?.data||[],0===m.value.length?(d.value=U.TOAST_MSG_SUCCESS,B("No results found.")):(d.value=U.TOAST_MSG_SUCCESS,B("Search completed."))}catch(e){d.value=U.TOAST_MSG_ERROR,B("Search failed."),console.error("Error during search:",e)}},_=async()=>{if(!p.value||!g.value)return d.value=U.TOAST_MSG_ERROR,void B("code와 content를 입력해주세요.");try{"remark"===a.type?await ze({code:p.value,remarkAllContent:g.value.replace(/(?:\r\n|\r|\n)/g,"<br>")}):"comment"===a.type?await gt({code:p.value,remarkAllContent:g.value.replace(/(?:\r\n|\r|\n)/g,"<br>")}):await ut({code:p.value,remarkAllContent:g.value.replace(/(?:\r\n|\r|\n)/g,"<br>")}),p.value="",g.value="",await N(),await T()}catch(e){d.value=U.TOAST_MSG_ERROR,B("Failed to add remark")}},P=async e=>{try{"remark"===a.type?await at({id:e}):"comment"===a.type?await It({id:e}):await pt({id:e}),d.value=U.TOAST_MSG_SUCCESS,B("delete Success"),await N()}catch(t){console.error("Failed to delete remark:",t)}},T=async()=>{await(0,s.dY)();const e=document.querySelector(".crcPopUpDiv.remark");e&&(e.scrollTop=e.scrollHeight)},A=(e,t)=>{y.value=e,b.value=t.code,I.value=t.remarkAllContent.replaceAll("<br>","\r\n")},M=async e=>{if(!b.value||!I.value)return d.value=U.TOAST_MSG_ERROR,void B("코드와 내용을 입력해주세요.");try{"remark"===a.type?await tt([{id:e,code:b.value,remarkAllContent:I.value.replace(/(?:\r\n|\r|\n)/g,"<br>")}]):"comment"===a.type?await bt([{id:e,code:b.value,remarkAllContent:I.value.replace(/(?:\r\n|\r|\n)/g,"<br>")}]):await vt([{id:e,code:b.value,remarkAllContent:I.value.replace(/(?:\r\n|\r|\n)/g,"<br>")}]),y.value=null,await N(),d.value=U.TOAST_MSG_SUCCESS,B("save Success")}catch(t){console.error("Failed to update remark:",t)}},D=()=>{y.value=null},x=e=>{switch(e){case"reco":return"Recommendation";case"comment":return"Comment";case"remark":return"Remark"}},O=()=>{const e=m.value.filter((e=>v.value.includes(e.id)));d.value=U.TOAST_MSG_SUCCESS,B("Remark Add Success"),r("listUpdated",e,a.type)},K=()=>{r("cancel")},B=e=>{u.value=e,setTimeout((()=>{u.value=""}),2e3)};return(t,a)=>{const o=(0,s.g2)("font-awesome-icon");return(0,s.uX)(),(0,s.CE)(s.FK,null,[(0,s.Lk)("div",yI,[(0,s.Lk)("div",bI,[(0,s.Lk)("div",II,[a[8]||(a[8]=(0,s.Lk)("span",null,"Search Type",-1)),(0,s.bo)((0,s.Lk)("select",{"onUpdate:modelValue":a[0]||(a[0]=e=>f.value=e)},a[7]||(a[7]=[(0,s.Lk)("option",{value:"Code"},"Code",-1),(0,s.Lk)("option",{value:"Content"},"Content",-1)]),512),[[l.u1,f.value]]),(0,s.bo)((0,s.Lk)("input",{type:"text","onUpdate:modelValue":a[1]||(a[1]=e=>C.value=e)},null,512),[[l.Jo,C.value]]),(0,s.Lk)("button",{type:"button",onClick:E},"Search")]),(0,s.Lk)("table",CI,[a[9]||(a[9]=(0,s.Lk)("colgroup",null,[(0,s.Lk)("col",{width:"5%"}),(0,s.Lk)("col",{width:"20%"}),(0,s.Lk)("col",{width:"*"}),(0,s.Lk)("col",{width:"20%"})],-1)),a[10]||(a[10]=(0,s.Lk)("thead",null,[(0,s.Lk)("tr",null,[(0,s.Lk)("th"),(0,s.Lk)("th",null,"Name"),(0,s.Lk)("th",null,"Content"),(0,s.Lk)("th",null,"Action")])],-1)),(0,s.Lk)("tbody",null,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(m.value,((e,t)=>((0,s.uX)(),(0,s.CE)("tr",{key:t},[(0,s.Lk)("td",null,[(0,s.bo)((0,s.Lk)("input",{type:"checkbox","onUpdate:modelValue":a[2]||(a[2]=e=>v.value=e),value:e.id},null,8,hI),[[l.lH,v.value]])]),y.value===t?((0,s.uX)(),(0,s.CE)("td",kI,[(0,s.bo)((0,s.Lk)("input",{"onUpdate:modelValue":a[3]||(a[3]=e=>b.value=e),type:"text"},null,512),[[l.Jo,b.value]])])):((0,s.uX)(),(0,s.CE)("td",SI,(0,n.v_)(e?.code),1)),y.value===t?((0,s.uX)(),(0,s.CE)("td",wI,[(0,s.bo)((0,s.Lk)("textarea",{class:"remarkTextArea table","onUpdate:modelValue":a[4]||(a[4]=e=>I.value=e),maxlength:"1000"},null,512),[[l.Jo,I.value]])])):((0,s.uX)(),(0,s.CE)("td",{key:3,class:"text-left",innerHTML:e?.remarkAllContent},null,8,NI)),y.value===t?((0,s.uX)(),(0,s.CE)("td",RI,[(0,s.Lk)("button",{class:"crcDefaultBtn",onClick:t=>M(e.id)},"Save",8,LI),(0,s.Lk)("button",{class:"crcDefaultBtn ml10",onClick:D},"Cancel")])):((0,s.uX)(),(0,s.CE)("td",EI,[(0,s.Lk)("button",{onClick:a=>A(t,e)},[(0,s.bF)(o,{icon:["fas","pen-to-square"]})],8,_I),(0,s.Lk)("button",{onClick:t=>P(e.id),class:"ml10"},[(0,s.bF)(o,{icon:["fas","trash"]})],8,PI)]))])))),128))])]),(0,s.Lk)("div",TI,[(0,s.Lk)("p",AI,"Add New "+(0,n.v_)(x(e.type)),1),(0,s.Lk)("div",MI,[(0,s.Lk)("div",DI,[(0,s.bo)((0,s.Lk)("input",{"onUpdate:modelValue":a[5]||(a[5]=e=>p.value=e),type:"text",placeholder:"code",class:"firstInput"},null,512),[[l.Jo,p.value]]),(0,s.Lk)("button",{onClick:_,class:"crcDefaultBtn ml10"},"Add")]),(0,s.bo)((0,s.Lk)("textarea",{"onUpdate:modelValue":a[6]||(a[6]=e=>g.value=e),placeholder:"content",class:"remarkTextArea",maxlength:"1000"},null,512),[[l.Jo,g.value]])]),(0,s.Lk)("div",null,[(0,s.Lk)("button",{class:"crcDefaultBtn",onClick:O},"OK"),(0,s.Lk)("button",{onClick:K,class:"ml10 crcDefaultBtn"},"CANCEL")])])])]),u.value?((0,s.uX)(),(0,s.Wv)(Eb,{key:0,message:u.value,messageType:d.value,duration:1500,position:"bottom-right"},null,8,["message","messageType"])):(0,s.Q3)("",!0),w.value?((0,s.uX)(),(0,s.Wv)(fI,{key:1,crcPassWord:k.value,onReturnPassWordCheck:L,onPassWordClose:R},null,8,["crcPassWord"])):(0,s.Q3)("",!0)],64)}}});const OI=xI;var KI=OI;const BI={class:"codeDiv"},FI={class:"moDivBox mt20"},UI={key:0,class:"mt20"},XI={class:"crcDivTitle"},$I={class:"remarkUlList"},WI=["onUpdate:modelValue"],HI={key:1,class:"mt20"},GI={class:"crcDivTitle"},YI={class:"remarkUlList"},VI=["onUpdate:modelValue"],jI={key:2,class:"mt20"},QI={class:"crcDivTitle"},qI={class:"remarkUlList"},JI=["onUpdate:modelValue"],zI={class:"mt20"};var ZI=(0,s.pM)({__name:"crcAdd",props:{crcSetArrP:{type:Array,required:!0},addEditType:{type:String},editItem:{type:Object,default:()=>({})}},emits:["closeIsCrcAdd","refresh"],setup(e,{emit:t}){const a=e,n=t,i=(0,o.KR)({code:"",crcContent:{wbc:[],rbc:[],plt:[]},crcRemark:[],crcRecommendation:[]}),r=(0,o.KR)(""),c=(0,o.KR)(U.TOAST_MSG_SUCCESS),u=(0,o.KR)(!1),d=(0,o.KR)(""),m=(0,o.KR)(""),v=(0,o.KR)(""),p=(0,o.KR)([]),g=(0,o.KR)(!1),f=(0,o.KR)([]),y=(0,o.KR)([]),b=(0,o.KR)(!1),I=(0,o.KR)(!1),C=(0,o.KR)([]),h=(0,o.KR)([]),k=(0,o.KR)(""),S=(0,o.KR)(!1);(0,s.KC)((async()=>{if(p.value=JSON.parse(JSON.stringify(a.crcSetArrP)),"edit"===a.addEditType){v.value=a.editItem.code;const e=["plt","rbc","wbc"];e.forEach((e=>{a.editItem.crcContent[e].forEach((e=>{const t=p.value.find((t=>t.crcTitle===e.crcTitle&&t.crcType===e.crcType));t&&("select"===t.crcType?t.val=e.crcContent:t.crcContent=e.crcContent)}))})),f.value=a.editItem.crcRemark||[],y.value=a.editItem.crcRecommendation||[],C.value=a.editItem.crcComment||[],f.value=f.value.map((e=>({...e,remarkAllContent:R(e.remarkAllContent)}))),C.value=C.value.map((e=>({...e,remarkAllContent:R(e.remarkAllContent)}))),y.value=y.value.map((e=>({...e,remarkAllContent:R(e.remarkAllContent)})))}else{p.value=(await qe()).data;for(const e of p.value)"select"===e.crcType&&(e?.val||(e.val=e.crcContent.split(",")[0]))}const e=await rt();0!==e.data.length&&(b.value=e.data[0].crcMode,h.value=e.data[0].crcRemarkCount,k.value=e.data[0].crcPassWord)}));const w=()=>{u.value=!1},N=(e,t,a,l,s=null,o)=>{const n={crcTitle:a,crcContent:l,crcType:t,id:o};"percent"===t&&(n.crcPercentText=s),e.push(n)},R=e=>e.replaceAll("<br>","\r\n"),L=async()=>{if(""===v.value)return c.value=U.TOAST_MSG_ERROR,void await T("Please enter the code.");for(const e of p.value){const{morphologyType:t,crcType:a,crcTitle:l,crcContent:s,crcPercentText:o,val:n,id:r}=e,c=i.value.crcContent[t.toLowerCase()]||[];"select"===a?N(c,a,l,n,null,r):N(c,a,l,s,o,r),i.value.crcContent[t.toLowerCase()]=c}i.value.code=v.value,i.value.crcRemark=f.value,i.value.crcComment=C.value,i.value.crcRecommendation=y.value,c.value=U.TOAST_MSG_SUCCESS,await T("Success"),await lt(i.value),n("refresh"),n("closeIsCrcAdd")},E=e=>{const t=p.value.find((t=>t.id===e.id));t.val=e.val},_=()=>{n("closeIsCrcAdd")},P=async()=>{for(const t of p.value){const{morphologyType:e,crcType:a,crcTitle:l,crcContent:s,crcPercentText:o,val:n,id:r}=t,c=i.value.crcContent[e.toLowerCase()]||[];"select"===a?N(c,a,l,n,null,r):N(c,a,l,s,o,r),i.value.crcContent[e.toLowerCase()]=c}try{await ot([{id:a.editItem.id,crcRemark:f.value,crcRecommendation:y.value,crcComment:C.value,crcContent:i.value.crcContent,code:v.value}]),c.value=U.TOAST_MSG_SUCCESS,await T("Edit completed."),n("refresh"),n("closeIsCrcAdd")}catch(e){c.value=U.TOAST_MSG_ERROR,await T("Failed to update item")}},T=async e=>{r.value=e,setTimeout((()=>{r.value=""}),1500)},A=e=>{switch(e){case"remark":g.value=!0;break;case"comment":S.value=!0;break;case"recommendation":I.value=!0;break}},M=e=>{switch(e){case"remark":g.value=!1;break;case"comment":S.value=!1;break;case"recommendation":I.value=!1;break}},D=e=>{0===e.value.length&&e.value.push({code:"",id:0,remarkAllContent:"",remarkContent:""})},x=(e,t)=>{for(const a of e)0===t.value[0].remarkAllContent.length||(t.value[0].remarkAllContent+="\r\r"),t.value[0].remarkAllContent+=R(a.remarkAllContent)},O=(e,t)=>{switch(D(y),D(f),D(C),t){case"remark":x(e,f),M("remark");break;case"comment":x(e,C),M("comment");break;case"reco":x(e,y),M("recommendation");break}},K=e=>{if(0!==h.value.length)return h.value[e].checked};return(t,a)=>((0,s.uX)(),(0,s.CE)(s.FK,null,[(0,s.Lk)("div",{onClick:_,class:"crcAddBack"}),(0,s.Lk)("div",{class:"crcPopUpDiv crcAdd",onClick:a[4]||(a[4]=(0,l.D$)((()=>{}),["stop"]))},[(0,s.Lk)("div",BI,[a[8]||(a[8]=(0,s.Lk)("span",null,"Code",-1)),(0,s.bo)((0,s.Lk)("input",{type:"text",class:"codeInput","onUpdate:modelValue":a[0]||(a[0]=e=>v.value=e)},null,512),[[l.Jo,v.value]])]),(0,s.Lk)("div",null,[(0,s.bF)(wu,{items:p.value,onUpdateSelect:E,moType:"RBC",pageName:"report"},null,8,["items"]),(0,s.Lk)("div",FI,[(0,s.Lk)("div",null,[(0,s.bF)(wu,{items:p.value,onUpdateSelect:E,moType:"WBC",pageName:"report"},null,8,["items"])]),(0,s.Lk)("div",null,[(0,s.bF)(wu,{items:p.value,onUpdateSelect:E,moType:"PLT",pageName:"report"},null,8,["items"])])]),K(0)?((0,s.uX)(),(0,s.CE)("div",UI,[(0,s.Lk)("div",XI,[a[9]||(a[9]=(0,s.Lk)("span",null,"Remark",-1)),(0,s.Lk)("button",{class:"reSelect",onClick:a[1]||(a[1]=e=>A("remark"))},"Remark Select")]),(0,s.Lk)("div",$I,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(f.value,((e,t)=>((0,s.uX)(),(0,s.CE)("div",{key:t},[(0,s.bo)((0,s.Lk)("textarea",{"onUpdate:modelValue":t=>e.remarkAllContent=t},null,8,WI),[[l.Jo,e.remarkAllContent]])])))),128))])])):(0,s.Q3)("",!0),K(1)?((0,s.uX)(),(0,s.CE)("div",HI,[(0,s.Lk)("div",GI,[a[10]||(a[10]=(0,s.Lk)("span",null," Comment ",-1)),(0,s.Lk)("button",{class:"reSelect",onClick:a[2]||(a[2]=e=>A("comment"))},"Comment Select")]),(0,s.Lk)("div",YI,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(C.value,((e,t)=>((0,s.uX)(),(0,s.CE)("div",{key:t},[(0,s.bo)((0,s.Lk)("textarea",{"onUpdate:modelValue":t=>e.remarkAllContent=t},null,8,VI),[[l.Jo,e.remarkAllContent]])])))),128))])])):(0,s.Q3)("",!0),K(2)?((0,s.uX)(),(0,s.CE)("div",jI,[(0,s.Lk)("div",QI,[a[11]||(a[11]=(0,s.Lk)("span",null," Recommendation ",-1)),(0,s.Lk)("button",{class:"reSelect",onClick:a[3]||(a[3]=e=>A("recommendation"))},"Recommendation Select")]),(0,s.Lk)("div",qI,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(y.value,((e,t)=>((0,s.uX)(),(0,s.CE)("div",{key:t},[(0,s.bo)((0,s.Lk)("textarea",{"onUpdate:modelValue":t=>e.remarkAllContent=t},null,8,JI),[[l.Jo,e.remarkAllContent]])])))),128))])])):(0,s.Q3)("",!0)]),(0,s.Lk)("div",zI,["add"===e.addEditType?((0,s.uX)(),(0,s.CE)("button",{key:0,class:"crcDefaultBtn",type:"button",onClick:L},"Save")):((0,s.uX)(),(0,s.CE)("button",{key:1,class:"crcDefaultBtn",type:"button",onClick:P},"Edit")),(0,s.Lk)("button",{class:"crcDefaultBtn ml10",type:"button",onClick:_},"Close")])]),r.value?((0,s.uX)(),(0,s.Wv)(Eb,{key:0,message:r.value,messageType:c.value,duration:1500,position:"bottom-right"},null,8,["message","messageType"])):(0,s.Q3)("",!0),g.value?((0,s.uX)(),(0,s.Wv)(KI,{key:1,onCancel:a[5]||(a[5]=e=>M("remark")),onListUpdated:O,type:"remark",crcDefaultMode:b.value,crcPassWord:k.value},null,8,["crcDefaultMode","crcPassWord"])):(0,s.Q3)("",!0),S.value?((0,s.uX)(),(0,s.Wv)(KI,{key:2,onCancel:a[6]||(a[6]=e=>M("comment")),onListUpdated:O,type:"comment",crcDefaultMode:b.value,crcPassWord:k.value},null,8,["crcDefaultMode","crcPassWord"])):(0,s.Q3)("",!0),I.value?((0,s.uX)(),(0,s.Wv)(KI,{key:3,onCancel:a[7]||(a[7]=e=>M("recommendation")),onListUpdated:O,type:"reco",crcDefaultMode:b.value,crcPassWord:k.value},null,8,["crcDefaultMode","crcPassWord"])):(0,s.Q3)("",!0),u.value?((0,s.uX)(),(0,s.Wv)(Pt,{key:4,"is-visible":u.value,type:d.value,message:m.value,onHide:w,"onUpdate:hideAlert":w},null,8,["is-visible","type","message"])):(0,s.Q3)("",!0)],64))}});const eC=ZI;var tC=eC;const aC={class:"tab-content crcDiv reportCrcDiv"},lC={class:"text-left mb10"},sC={class:"crcListContentUl"},oC={class:"crcListContentHeader"},nC=["onClick"],iC=["value"],rC={class:"crcListDiv"},cC=["onClick"],uC=["onClick"],dC={key:0,class:"crcListBottomLine"},mC={key:0,class:"crcListRow"},vC={key:1,class:"crcListRow"},pC={key:2,class:"crcListRow"},gC={key:3,class:"mt10"},fC=["innerHTML"],yC={key:4,class:"mt10"},bC=["innerHTML"],IC={key:5,class:"mt10"},CC=["innerHTML"],hC={class:"reportDivAdd"};var kC=(0,s.pM)({__name:"crcList",props:{crcArr:{type:Array,required:!0},crcPassWord:{type:String}},emits:["refresh"],setup(e,{emit:t}){const a=e,i=t,r=(0,o.KR)(!1),c=(0,o.KR)(""),u=(0,o.KR)(""),d=(0,o.KR)(0),m=(0,o.KR)(""),v=(0,o.KR)(U.TOAST_MSG_SUCCESS),p=(0,o.KR)(!1),g=(0,o.KR)([]),f=(0,o.KR)([]),y=(0,o.KR)([]),b=(0,o.KR)(null),I=(0,o.KR)(""),C=(0,o.KR)(""),h=(0,o.KR)(!1),k=(0,o.KR)(!1);(0,s.KC)((async()=>{C.value=a.crcPassWord||""})),(0,s.sV)((async()=>{await(0,s.dY)(),await N()}));const S=async()=>{r.value=!1},w=async()=>{"check"===u.value?await M():await T(d.value),r.value=!1},N=async()=>{const e=(await st()).data;g.value=e,y.value=new Array(e.length).fill(!1)},R=e=>{e?(h.value=!0,k.value=!1,v.value=U.TOAST_MSG_SUCCESS,K("Admin verification is complete. Please click the button again.")):(h.value=!1,k.value=!1,v.value=U.TOAST_MSG_ERROR,K("The administrator password is incorrect."))},L=()=>{k.value=!1},E=()=>{p.value=!0,I.value="add"},_=()=>{p.value=!1},P=e=>{p.value=!0,I.value="edit",b.value={...e}},T=async e=>{try{await nt({id:e}),v.value=U.TOAST_MSG_SUCCESS,K("It s been deleted."),await N()}catch(t){console.error("Failed to delete item:",t)}},A=(e,t)=>{if("check"===e){if(0===f.value.length)return v.value=U.TOAST_MSG_ERROR,void K("Please select the item to delete.");u.value="check"}else d.value=t,u.value="";r.value=!0,c.value="Are you sure you want to delete it?"},M=async()=>{try{await Promise.all(f.value.map((e=>nt({id:e})))),await N(),f.value=[],v.value=U.TOAST_MSG_SUCCESS,K("It s been deleted.")}catch(e){v.value=U.TOAST_MSG_ERROR,K("Failed to delete selected items")}},D=e=>{const t=e.target.checked;f.value=t?g.value.map((e=>e.id)):[]},x=e=>{y.value[e]=!y.value[e]},O=()=>{i("refresh"),N()},K=e=>{m.value=e,setTimeout((()=>{m.value=""}),1500)};return(t,a)=>{const o=(0,s.g2)("font-awesome-icon");return(0,s.uX)(),(0,s.CE)(s.FK,null,[(0,s.Lk)("div",aC,[(0,s.Lk)("div",lC,[(0,s.Lk)("button",{class:"crcBtn",onClick:E}," Add "),(0,s.Lk)("button",{class:"crcBtn ml10",onClick:a[0]||(a[0]=e=>A("check"))}," Check Delete ")]),(0,s.Lk)("ul",sC,[(0,s.Lk)("li",oC,[(0,s.Lk)("input",{type:"checkbox",onChange:a[1]||(a[1]=e=>D(e))},null,32),a[4]||(a[4]=(0,s.Lk)("span",null,"All Check",-1))]),((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(g.value,((e,t)=>((0,s.uX)(),(0,s.CE)("li",{key:t,class:"crcListContent"},[(0,s.Lk)("span",{class:"crcListSpan",onClick:e=>x(t)},[(0,s.bo)((0,s.Lk)("input",{type:"checkbox","onUpdate:modelValue":a[2]||(a[2]=e=>f.value=e),value:e.id,onClick:a[3]||(a[3]=(0,l.D$)((()=>{}),["stop"]))},null,8,iC),[[l.lH,f.value]]),(0,s.Lk)("span",null,(0,n.v_)(e.code),1),(0,s.Lk)("div",rC,[(0,s.Lk)("button",{onClick:(0,l.D$)((t=>P(e)),["stop"]),class:"hoverSizeAction"},[(0,s.bF)(o,{icon:["fas","pen-to-square"]})],8,cC),(0,s.Lk)("button",{onClick:(0,l.D$)((t=>A("",e.id)),["stop"]),class:"hoverSizeAction"},[(0,s.bF)(o,{icon:["fas","trash"]})],8,uC)]),(0,s.bF)(o,{icon:y.value[t]?["fas","caret-up"]:["fas","sort-down"],class:(0,n.C4)(y.value[t]?["sortDownBig","caret-up"]:["sortDownBig","sort-down"])},null,8,["icon","class"])],8,nC),y.value[t]?((0,s.uX)(),(0,s.CE)("div",dC,[e.crcContent.rbc&&e.crcContent.rbc.length>0?((0,s.uX)(),(0,s.CE)("div",mC,[a[5]||(a[5]=(0,s.Lk)("span",{class:"smCrcTitle"},"RBC Morphology",-1)),((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(e.crcContent.rbc,(e=>((0,s.uX)(),(0,s.CE)("p",{key:e.crcTitle},(0,n.v_)(e.crcTitle)+": "+(0,n.v_)(e.crcContent),1)))),128))])):(0,s.Q3)("",!0),e.crcContent.wbc&&e.crcContent.wbc.length>0?((0,s.uX)(),(0,s.CE)("div",vC,[a[6]||(a[6]=(0,s.Lk)("span",{class:"smCrcTitle"},"WBC Morphology",-1)),((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(e.crcContent.wbc,(e=>((0,s.uX)(),(0,s.CE)("p",{key:e.crcTitle},(0,n.v_)(e.crcTitle)+": "+(0,n.v_)(e.crcContent),1)))),128))])):(0,s.Q3)("",!0),e.crcContent.plt&&e.crcContent.plt.length>0?((0,s.uX)(),(0,s.CE)("div",pC,[a[7]||(a[7]=(0,s.Lk)("span",{class:"smCrcTitle"},"PLT Morphology",-1)),((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(e.crcContent.plt,(e=>((0,s.uX)(),(0,s.CE)("p",{key:e.crcTitle},(0,n.v_)(e.crcTitle)+": "+(0,n.v_)(e.crcContent),1)))),128))])):(0,s.Q3)("",!0),e.crcRemark&&e.crcRemark.length>0?((0,s.uX)(),(0,s.CE)("div",gC,[a[8]||(a[8]=(0,s.Lk)("span",{class:"smCrcTitle"},"Remark",-1)),((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(e.crcRemark,(e=>((0,s.uX)(),(0,s.CE)("pre",{class:"pre-wrap",key:e.id,innerHTML:e?.remarkAllContent},null,8,fC)))),128))])):(0,s.Q3)("",!0),e.crcComment&&e.crcComment.length>0?((0,s.uX)(),(0,s.CE)("div",yC,[a[9]||(a[9]=(0,s.Lk)("span",{class:"smCrcTitle"},"Comment",-1)),((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(e.crcComment,(e=>((0,s.uX)(),(0,s.CE)("pre",{class:"pre-wrap",key:e.id,innerHTML:e?.remarkAllContent},null,8,bC)))),128))])):(0,s.Q3)("",!0),e.crcRecommendation&&e.crcRecommendation.length>0?((0,s.uX)(),(0,s.CE)("div",IC,[a[10]||(a[10]=(0,s.Lk)("span",{class:"smCrcTitle"},"Recommendation",-1)),((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(e.crcRecommendation,(e=>((0,s.uX)(),(0,s.CE)("pre",{class:"pre-wrap",key:e.id,innerHTML:e?.remarkAllContent},null,8,CC)))),128))])):(0,s.Q3)("",!0)])):(0,s.Q3)("",!0)])))),128))])]),((0,s.uX)(),(0,s.Wv)(s.Im,{to:"body"},[(0,s.Lk)("div",hC,[p.value?((0,s.uX)(),(0,s.Wv)(tC,{key:0,crcSetArrP:e.crcArr,onCloseIsCrcAdd:_,onRefresh:O,addEditType:I.value,editItem:b.value},null,8,["crcSetArrP","addEditType","editItem"])):(0,s.Q3)("",!0)])])),r.value?((0,s.uX)(),(0,s.Wv)(ra,{key:0,"is-visible":r.value,message:c.value,type:"delete",onHide:S,onOkConfirm:w},null,8,["is-visible","message"])):(0,s.Q3)("",!0),m.value?((0,s.uX)(),(0,s.Wv)(Eb,{key:1,message:m.value,duration:1500,position:"bottom-right"},null,8,["message"])):(0,s.Q3)("",!0),k.value?((0,s.uX)(),(0,s.Wv)(fI,{key:2,crcPassWord:C.value,onReturnPassWordCheck:R,onPassWordClose:L},null,8,["crcPassWord"])):(0,s.Q3)("",!0)],64)}}});const SC=kC;var wC=SC,NC=a(2022);const RC={style:{"list-style":"none",padding:"0"}},LC={style:{"font-weight":"bold",color:"#e63946"}},EC={style:{color:"#e76f51"}},_C={style:{color:"#6c757d"}};var PC=(0,s.pM)({__name:"cellStatusDashBoard",props:["autoNomarlCheck"],setup(e){NC.t1.register(NC.A6,NC.E8,NC.FN,NC.PP,NC.kc,NC.m_,NC.s$,NC.hE,NC.ZT,NC.No);const t=e;return(0,s.sV)((()=>{const e=t.autoNomarlCheck.map((e=>e.classNm)),a=t.autoNomarlCheck.map((e=>({x:e.classNm,y:[e.normalRangeFirst,e.normalRangeLast]}))),l=t.autoNomarlCheck.map((e=>e.value)),s={labels:e,datasets:[{label:"정상 범위",data:a,backgroundColor:"#007bff",borderColor:"#007bff",borderWidth:1,barThickness:30},{label:"측정 값",data:l,type:"line",borderColor:"#1DDDE0",backgroundColor:"#1DDDE0",borderWidth:0,pointRadius:3,pointBackgroundColor:"#1DDDE0"}]},o={type:"bar",data:s,options:{responsive:!0,plugins:{legend:{position:"top"}},scales:{x:{grid:{display:!1},ticks:{color:"#333",font:{size:12}}},y:{beginAtZero:!0,grid:{color:"rgba(200, 200, 200, 0.3)",borderDash:[5,5]},ticks:{color:"#333",font:{size:12}}}}}};new NC.t1(document.getElementById("abnormalChart"),o)})),(t,a)=>((0,s.uX)(),(0,s.CE)("div",null,[a[1]||(a[1]=(0,s.Lk)("canvas",{id:"abnormalChart",width:"400",height:"200",class:"abnormalChart"},null,-1)),(0,s.Lk)("ul",RC,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(e.autoNomarlCheck,((e,t)=>((0,s.uX)(),(0,s.CE)("li",{key:t,class:"normalCheckList"},[(0,s.Lk)("span",LC,(0,n.v_)(e.classNm),1),a[0]||(a[0]=(0,s.eW)(" 값이 비정상입니다: ")),(0,s.Lk)("span",EC,(0,n.v_)(e.value),1),(0,s.Lk)("small",_C,"(정상 범위: "+(0,n.v_)(e.normalRangeFirst)+" - "+(0,n.v_)(e.normalRangeLast)+")",1)])))),128))])]))}});const TC=PC;var AC=TC,MC=(a(6573),a(8100),a(7936),a(7467),a(4732),a(9577),a(4979),a(354)),DC=a.n(MC);const xC={class:"resultCode"},OC={class:"flex-align-center gap14"},KC={class:"resultImgBody"},BC={class:"resultImage-split-wrapper"},FC={class:"resultImg-crcTitle"},UC={class:"resultImg-crcTitle"},XC={class:"resultImage-wbcPlt-container"},$C={class:"resultImgBody"},WC={class:"resultImage-wrapper"},HC={class:"resultImg-crcTitle"},GC={class:"resultImg-crcTitle"},YC={class:"resultImgBody"},VC={class:"resultImage-wrapper"},jC={class:"resultImg-crcTitle"},QC={class:"resultImg-crcTitle"},qC={class:"resultImage-remark-container"},JC={key:0},zC={class:"resultImage-mainTitle resultImage-mainTitleWithFont"},ZC={class:"fs08 pre-wrap"},eh={key:1},th={class:"resultImage-mainTitle resultImage-mainTitleWithFont"},ah={class:"fs08 pre-wrap"},lh={key:2},sh={class:"resultImage-mainTitle resultImage-mainTitleWithFont"},oh={class:"fs08 pre-wrap"},nh={class:"resultImage-wbcImgArea-container"},ih={class:"resultImage-mainTitle resultImage-mainTitleWithFont"},rh={class:"resultImage-wbcImgArea-wrapper"},ch={key:0},uh=["src"];var dh=(0,s.pM)({__name:"resultImage",props:["nowCrcData","recoList","commentList","captureAndConvertOk","barcodeNo","selectWbcImgArr","slotId","patientNm"],setup(e,{emit:t}){const a=e,l=(0,o.KR)([]),i=(0,o.KR)([]),r=(0,o.KR)([]),u=(0,o.KR)(null),d=t,m=(0,s.EW)((()=>i.value.slice(0,4))),v=(0,s.EW)((()=>i.value.slice(4))),p=(0,s.EW)((()=>l.value.slice(0,4))),g=(0,s.EW)((()=>l.value.slice(4))),f=(0,s.EW)((()=>r.value.slice(0,4))),y=(0,s.EW)((()=>r.value.slice(4))),b=(0,o.KR)([]),I=(0,o.KR)(""),C=(0,o.KR)(U.TOAST_MSG_SUCCESS),h=(0,c.Pj)(),k=(0,s.EW)((()=>h.state.commonModule.iaRootPath)),S=(0,o.KR)(""),w="viewer"===sessionStorage.getItem("viewerCheck")?window.MAIN_API_IP:window.APP_API_BASE_URL;(0,s.wB)((()=>[i.value,l.value,r.value]),(async()=>{i.value.length&&l.value.length&&r.value.length&&(await(0,s.dY)(),await R())})),(0,s.sV)((async()=>{await N()})),(0,s.KC)((()=>{S.value=window.PROJECT_TYPE}));const N=async()=>{i.value=a.nowCrcData?.crcContent?.rbc||[],l.value=a.nowCrcData?.crcContent?.wbc||[],r.value=a.nowCrcData?.crcContent?.plt||[],b.value=a.nowCrcData||[]},R=async()=>{if(u.value){const e=await DC()(u.value,{useCORS:!0,allowTaint:!0}),t=e.toDataURL("image/png"),a=atob(t.split(",")[1]),l=new ArrayBuffer(a.length),s=new Uint8Array(l);for(let n=0;n<a.length;n++)s[n]=a.charCodeAt(n);const o=_(l);await P(o),d("resetBool",!0)}},L=e=>{const t=E(e),a=URL.createObjectURL(t);return new Promise(((e,l)=>{const s=new Image;s.onload=()=>{const l=s.width,o=s.height,n=t.size;URL.revokeObjectURL(a),e({width:l,height:o,size:n})},s.onerror=e=>{URL.revokeObjectURL(a),l(e)},s.src=a}))},E=e=>{const t=[];for(let l=0;l<e.length;l+=2)t.push(parseInt(e.substr(l,2),16));const a=new Uint8Array(t);return new Blob([a],{type:"image/png"})},_=e=>{const t=new Uint8Array(e);let a="";for(let l=0;l<t.length;l++)a+=("0"+t[l].toString(16)).slice(-2);return a},P=async e=>{const t=`smp_no=${a.barcodeNo}`,l=(await xy(t))?.data;if(l){const{width:t,height:a,size:s}=await L(e),o={size:s,image_rslt:e,width:t,height:a,rslt_stus:"F",exam_ymd_unit:l[0]?.exam_ymd_unit,slip:l[0]?.slip,wrk_no:l[0]?.wrk_no,exam_cd:l[0]?.exam_cd,spc:l[0]?.spc},n=await Ky(o);"Update successful"===n?(C.value=U.TOAST_MSG_SUCCESS,T("Success")):(C.value=U.TOAST_MSG_ERROR,T("Lis fail"))}},T=e=>{I.value=e,setTimeout((()=>{I.value=""}),1500)};function A(e,t,l,s,o){if(!a.selectWbcImgArr||0===a.selectWbcImgArr.length)return"";const n=a.slotId||"",i=`${k.value}/${n}/${M(S.value)}/${t}_${l}`;let r="";return r="getImageRealTime"===s||"pb"===S.value?`${w}/images/getImageRealTime?folder=${i}&imageName=${e}`:`${w}/images?folder=${i}&imageName=${e}`,r}const M=e=>"bm"===e?"04_BM_Classification":"pb"===e?"01_WBC_Classification":void 0;return(t,a)=>{const l=(0,s.g2)("font-awesome-icon");return(0,s.uX)(),(0,s.CE)(s.FK,null,[(0,s.Lk)("div",{class:"resultImage",ref_key:"crcReport",ref:u},[(0,s.Lk)("h1",xC,(0,n.v_)(e.nowCrcData.code),1),a[7]||(a[7]=(0,s.Lk)("h2",{class:"resultImage-mainTitle"},"Information",-1)),(0,s.Lk)("div",OC,[(0,s.Lk)("h3",null,(0,n.v_)(e.barcodeNo??""),1),(0,s.Lk)("h3",null,(0,n.v_)(e.patientNm??""),1)]),(0,s.Lk)("div",KC,[a[0]||(a[0]=(0,s.Lk)("h2",{class:"resultImage-mainTitle"},"RBC Morphology",-1)),(0,s.Lk)("ul",BC,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(m.value,((e,t)=>((0,s.uX)(),(0,s.CE)("li",{key:"rbc-left"+t,class:"flex-justify-start-align-center"},[(0,s.Lk)("h3",FC,(0,n.v_)(e?.crcTitle),1),(0,s.Lk)("p",null,(0,n.v_)(e?.crcContent),1)])))),128)),((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(v.value,((e,t)=>((0,s.uX)(),(0,s.CE)("li",{key:"rbc-right"+t,class:"flex-justify-start-align-center"},[(0,s.Lk)("h3",UC,(0,n.v_)(e?.crcTitle),1),(0,s.Lk)("p",null,(0,n.v_)(e?.crcContent),1)])))),128))])]),(0,s.Lk)("div",XC,[(0,s.Lk)("div",$C,[a[1]||(a[1]=(0,s.Lk)("h2",{class:"resultImage-mainTitle"},"WBC Morphology",-1)),(0,s.Lk)("ul",WC,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(p.value,((e,t)=>((0,s.uX)(),(0,s.CE)("li",{key:"wbc-left"+t,class:"flex-justify-start-align-center"},[(0,s.Lk)("h3",HC,(0,n.v_)(e?.crcTitle),1),(0,s.Lk)("p",null,(0,n.v_)(e?.crcContent),1)])))),128)),((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(g.value,((e,t)=>((0,s.uX)(),(0,s.CE)("li",{key:"wbc-right"+t,class:"flex-justify-start-align-center"},[(0,s.Lk)("h3",GC,(0,n.v_)(e?.crcTitle),1),(0,s.Lk)("p",null,(0,n.v_)(e?.crcContent),1)])))),128))])]),(0,s.Lk)("div",YC,[a[2]||(a[2]=(0,s.Lk)("h2",{class:"resultImage-mainTitle"},"PLT Morphology",-1)),(0,s.Lk)("ul",VC,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(f.value,((e,t)=>((0,s.uX)(),(0,s.CE)("li",{key:"plt-left"+t,class:"flex-justify-start-align-center"},[(0,s.Lk)("h3",jC,(0,n.v_)(e?.crcTitle),1),(0,s.Lk)("p",null,(0,n.v_)(e?.crcContent),1)])))),128)),((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(y.value,((e,t)=>((0,s.uX)(),(0,s.CE)("li",{key:"plt-right"+t,class:"flex-justify-start-align-center"},[(0,s.Lk)("h3",QC,(0,n.v_)(e?.crcTitle),1),(0,s.Lk)("p",null,(0,n.v_)(e?.crcContent),1)])))),128))])])]),(0,s.Lk)("div",qC,[0!==e.nowCrcData.crcComment.length&&e.nowCrcData.crcComment[0].remarkAllContent.length>0?((0,s.uX)(),(0,s.CE)("div",JC,[(0,s.Lk)("h2",zC,[(0,s.bF)(l,{icon:["fas","message"]}),a[3]||(a[3]=(0,s.Lk)("span",null,"Comment",-1))]),(0,s.Lk)("pre",ZC,(0,n.v_)(e.nowCrcData?.crcComment[0]?.remarkAllContent),1)])):(0,s.Q3)("",!0),0!==e.nowCrcData.crcRecommendation.length&&e.nowCrcData.crcRecommendation[0].remarkAllContent.length>0?((0,s.uX)(),(0,s.CE)("div",eh,[(0,s.Lk)("h2",th,[(0,s.bF)(l,{icon:["fas","message"]}),a[4]||(a[4]=(0,s.Lk)("span",null,"Recommendation",-1))]),(0,s.Lk)("pre",ah,(0,n.v_)(e.nowCrcData?.crcRecommendation[0]?.remarkAllContent),1)])):(0,s.Q3)("",!0),0!==e.nowCrcData.crcRemark.length&&e.nowCrcData.crcRemark[0].remarkAllContent.length>0?((0,s.uX)(),(0,s.CE)("div",lh,[(0,s.Lk)("h2",sh,[(0,s.bF)(l,{icon:["fas","message"]}),a[5]||(a[5]=(0,s.Lk)("span",null,"Remark",-1))]),(0,s.Lk)("pre",oh,(0,n.v_)(e.nowCrcData?.crcRemark[0]?.remarkAllContent),1)])):(0,s.Q3)("",!0)]),(0,s.Lk)("div",nh,[(0,s.Lk)("h2",ih,[(0,s.bF)(l,{icon:["fas","image"]}),a[6]||(a[6]=(0,s.Lk)("span",null,"WBC Images",-1))]),(0,s.Lk)("ul",rh,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(e.selectWbcImgArr,(e=>((0,s.uX)(),(0,s.CE)("li",{key:e.id},["0"!==e?.count&&0!==e?.count?((0,s.uX)(),(0,s.CE)("div",ch,[(0,s.Lk)("img",{src:A(e.image.fileName,e.item.id,e.item.title,"")},null,8,uh)])):(0,s.Q3)("",!0)])))),128))])])],512),I.value?((0,s.uX)(),(0,s.Wv)(Eb,{key:0,message:I.value,messageType:C.value,duration:1500,position:"bottom-right"},null,8,["message","messageType"])):(0,s.Q3)("",!0)],64)}}});const mh=dh;var vh=mh;const ph={class:"isAutoCBCMatchingDiv"},gh={key:0},fh=["onClick"],yh={key:1,class:"chooseDiv"};var bh=(0,s.pM)({__name:"autoCBCMatching",props:["isAutoCBCMatchingArr"],emits:["codeSelect","codeClose"],setup(e,{emit:t}){const a=t,l=e=>{a("codeSelect",e)},o=()=>{a("codeClose")};return(t,a)=>((0,s.uX)(),(0,s.CE)("div",ph,[a[0]||(a[0]=(0,s.Lk)("p",null,"Choose the code, please. ",-1)),0!==e.isAutoCBCMatchingArr.length?((0,s.uX)(),(0,s.CE)("ul",gh,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(e.isAutoCBCMatchingArr,((e,t)=>((0,s.uX)(),(0,s.CE)("li",{key:t,onClick:t=>l(e.code)},(0,n.v_)(e.code),9,fh)))),128))])):((0,s.uX)(),(0,s.CE)("div",yh," There are no matching values. ")),(0,s.Lk)("button",{class:"chooseBtn",onClick:o},"Close")]))}});const Ih=bh;var Ch=Ih;const hh={class:"IsWbcImageSelect"},kh={class:"pos-relative"},Sh={key:0},wh={class:"mt10",style:{"margin-left":"4px"}},Nh={class:"smallName"},Rh=["src","onClick"];var Lh=(0,s.pM)({__name:"wbcImageSelect",props:["selectItems"],emits:["closeWbcSelect","selectWbcImgSend"],setup(e,{emit:t}){const a=(0,s.EW)((()=>i.state.commonModule.iaRootPath)),l=(0,o.KR)(""),i=(0,c.Pj)(),r="viewer"===sessionStorage.getItem("viewerCheck")?window.MAIN_API_IP:window.APP_API_BASE_URL,u=e,d=t,m=(0,o.KR)([]);(0,o.KR)(!1);(0,s.KC)((()=>{l.value=window.PROJECT_TYPE}));const v=()=>{d("closeWbcSelect")},p=(e,t)=>{g(e,t)?m.value=m.value.filter((a=>a.image!==e||a.item!==t)):m.value.push({image:e,item:t})},g=(e,t)=>m.value.some((a=>a.image===e&&a.item===t)),f=()=>{d("selectWbcImgSend",m.value)};function y(e,t,s,o,n){if(!u.selectItems?.wbcInfoAfter||0===u.selectItems?.wbcInfoAfter.length)return"";const i=u.selectItems.slotId||"",c=`${a.value}/${i}/${b(l.value)}/${t}_${s}`;let d="";return d="getImageRealTime"===o||"pb"===l.value?`${r}/images/getImageRealTime?folder=${c}&imageName=${e}`:`${r}/images?folder=${c}&imageName=${e}`,d}const b=e=>"bm"===e?"04_BM_Classification":"pb"===e?"01_WBC_Classification":void 0;return(t,a)=>((0,s.uX)(),(0,s.CE)("div",hh,[(0,s.Lk)("div",kh,[a[0]||(a[0]=(0,s.Lk)("h1",{class:"wbcImageSelect-title"},"WBC images",-1)),(0,s.Lk)("ul",null,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(e.selectItems?.wbcInfoAfter,(e=>((0,s.uX)(),(0,s.CE)("li",{key:e.id},["0"!==e?.count&&0!==e?.count?((0,s.uX)(),(0,s.CE)("div",Sh,[(0,s.Lk)("p",wh,[(0,s.eW)((0,n.v_)(e?.title)+" ",1),(0,s.Lk)("span",Nh,"("+(0,n.v_)(e.name)+")",1)]),((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(e.images,((t,a)=>((0,s.uX)(),(0,s.CE)("img",{key:a,src:y(t.fileName,e.id,e.title,""),onClick:a=>p(t,e),class:(0,n.C4)([{selected:g(t,e)},"cursorPointer"])},null,10,Rh)))),128))])):(0,s.Q3)("",!0)])))),128))])]),(0,s.Lk)("div",{class:"fixedWbcBottom"},[(0,s.Lk)("button",{class:"crcBtn crcBtnWithBg",onClick:f},"Save"),(0,s.Lk)("button",{class:"crcBtn crcBtnWithBg",onClick:v},"Close")])]))}});const Eh=Lh;var _h=Eh;const Ph={key:0,class:"crcReport"},Th={class:"tabs"},Ah={key:0,class:"tab-content crcDiv reportCrcDiv"},Mh={class:"text-left crcMenu mb10"},Dh={class:"autocomplete-container ml10"},xh={key:0,class:"autocomplete-list"},Oh=["onClick"],Kh={class:"moDivBox mt10"},Bh={key:1,class:"mt20"},Fh={class:"crcDivTitle"},Uh={class:"remarkUlList"},Xh=["onUpdate:modelValue"],$h={key:2,class:"mt20"},Wh={class:"crcDivTitle"},Hh={class:"remarkUlList"},Gh=["onUpdate:modelValue"],Yh={key:3,class:"mt20"},Vh={class:"crcDivTitle"},jh={class:"remarkUlList"},Qh=["onUpdate:modelValue"],qh={key:4,class:"mt20"},Jh={class:"crcDivTitle"},zh={class:"remarkUlList"},Zh={key:2,class:"tab-content crcDiv reportCrcDiv dashboard"};var ek=(0,s.pM)({__name:"crcResultCodes",props:{crcDataVal:{type:Array,required:!0},selectItems:{type:Array}},setup(e){const t=(0,o.KR)([]),a=e,i=(0,c.Pj)(),r=(0,o.KR)(""),u=(0,o.KR)(U.TOAST_MSG_SUCCESS),d=(0,o.KR)(""),m=(0,o.KR)(!1),v=(0,o.KR)(!1),p=(0,o.KR)(!1),g=(0,o.KR)(1),f=(0,o.KR)([]),y=(0,o.KR)([]),b=(0,o.KR)([]),C=(0,o.KR)(!1),h=(0,o.KR)([]),k=(0,o.KR)(""),S=(0,o.KR)(!1),w=(0,o.KR)(""),N=(0,o.KR)(!1),R=(0,o.KR)([]),L=(0,o.KR)(!1),E=(0,o.KR)(!1),_=(0,o.KR)(!1),P=(0,o.KR)(""),T=(0,o.KR)(!1),A=(0,s.EW)((()=>i.state.userModule)),M=(0,o.KR)(""),D=(0,o.KR)(!1),x=(0,o.KR)(""),O=(0,o.KR)([]),K=(0,s.EW)((()=>i.state.commonModule.siteCd)),B=(0,s.EW)((()=>i.state.slideDataModule)),F=(0,o.KR)(!1),X=(0,o.KR)({RBC:{},WBC:{},PLT:{}}),$=(0,o.KR)([]),H=(0,o.KR)([]),G=(0,o.KR)([]),Y=(0,o.KR)([]),V=(0,o.KR)(!1),j=(0,o.KR)([]),Q=(0,o.KR)(!1),q=(0,o.KR)(!1),J=(0,o.KR)([]),z=(0,o.KR)("H3"),Z=(0,o.KR)(""),ee=e=>{J.value=[],J.value=e,u.value=U.TOAST_MSG_SUCCESS,Be("Success"),q.value=!1};(0,s.KC)((async()=>{if(await(0,s.dY)(),C.value=!0,C.value){const e=await ht(a?.selectItems?.slotId),l=e.data.crcArr,s=e.data.code||"",o=e.data.remarkList||[],n=e.data.commentList||[],i=e.data.recoList||[];l?(t.value=l,k.value=s,M.value=s,f.value=o,y.value=n,b.value=i,[f,y,b].forEach((e=>{e.value=e.value.map((e=>({...e,remarkAllContent:ue(e.remarkAllContent)})))})),N.value=!0):(t.value=(await qe()).data,N.value=!0,Le(b),Le(f),Le(y)),h.value=(await st()).data}const e=await rt();0!==e.data.length&&(S.value=e.data[0].crcMode,R.value=e.data[0].crcRemarkCount,w.value=e.data[0].crcPassWord,P.value=e.data[0].crcPassWord,T.value=e.data[0].lisTwoMode);const{lisFilePathSetArr:l,lisHotKey:o}=await Ep();x.value=o,O.value=l,await be()})),(0,s.sV)((async()=>{if(await(0,s.dY)(),await ae(),F.value="lisCbc"===a.selectItems?.submitState||"Submit"===a.selectItems?.submitState,K.value===I["원주기독병원"]||K.value){const{data:e,cbcDataVal:t,slip:l}=await Oy(a.selectItems?.barcodeNo,await Pp());z.value=l,Z.value="",await Ue({cbcPatientNo:t?.pt_no,cbcPatientNm:t?.pt_nm,cbcSex:t?.sex,cbcAge:t?.age});for(const a of e)switch(a.classNm.trim()){case"8HN109GBL_F":Z.value+="Blasts Flag\n";break;case"8HN109G_NRBC_F":Z.value+="Nucleated RBC Flag\n";break;case"8HN109G_ATYP_FRAG":Z.value+="Atypical Lymphocyte Flag\n";break;case"8HN109GIG_F":Z.value+="Immature Granulocytes Flag\n";break}}else z.value="H3"}));const te=()=>{q.value=!1},ae=async()=>{$.value=await Pp();const e=await _p();if(e&&""!==e&&K.value===I["SD의학연구소"]){const{cbcData:e,cbcSex:t,cbcAge:l}=await Op(a?.selectItems?.barcodeNo,$.value);G.value=await xp(e,a?.selectItems?.wbcInfoAfter,a?.selectItems?.rbcInfoAfter,t,l);const s=await ht(a?.selectItems?.slotId),o=s?.data?.crcArr;if(!o)if(0===G.value.length)ie("Normal");else{const a=await Dp(e,t,l);j.value=a,j.value.length,Q.value=!0}}},le=e=>{ie(e),Q.value=!1},se=()=>{Q.value=!1},oe=async()=>{V.value=!0},ne=()=>{V.value=!1},ie=e=>{k.value=e,M.value=e,D.value=!1,De(e)},re=()=>{setTimeout((()=>{D.value=!1}),200)},ce=(0,s.EW)((()=>M.value?h.value.filter((e=>e.code.toLowerCase().includes(M.value.toLowerCase()))):h.value)),ue=e=>e.replaceAll("<br>","\r\n"),de=e=>{if(0!==R.value.length)return R.value[e].checked};let me=!1;const ve=e=>{const t=e.key;me||t.toUpperCase()!==x.value.toUpperCase()||(e.preventDefault(),me=!0,ge())},pe=e=>{const t=e.key;t.toUpperCase()===x.value.toUpperCase()&&(me=!1)};window.addEventListener("keydown",ve),window.addEventListener("keyup",pe);const ge=async()=>{d.value="lisCbc",E.value||!F.value?await Ce():_.value=!0},fe=(e,t)=>(["plt","rbc","wbc"].forEach((a=>{t.crcContent[a].forEach((t=>{const a=e.find((e=>e.id===t.id));a&&a.crcCode&&(t.crcTitle=a.crcCode)}))})),t),ye=e=>{const a=JSON.parse(JSON.stringify(t.value)),l=a.findIndex((t=>t.id===e.id));a[l].val=e.val,H.value=a},be=async()=>{X.value={RBC:{},WBC:{},PLT:{}};for(const e of t.value){if(!e.crcCode||!e.crcCodeMatching||!e.crcContent)continue;const t=e.crcCodeMatching.split(",").map((e=>e.trim())),a=e.crcContent.split(",").map((e=>e.trim()));if("RBC"===e.morphologyType){X.value.RBC[e.crcCode]={};for(let l=0;l<t.length;l++){const s=t[l],o=a[l]?a[l]:"";X.value.RBC[e.crcCode][o]=s}}else if("WBC"===e.morphologyType){X.value.WBC[e.crcCode]={};for(let l=0;l<t.length;l++){const s=t[l],o=a[l]?a[l]:"";X.value.WBC[e.crcCode][o]=s}}else if("PLT"===e.morphologyType){X.value.PLT[e.crcCode]={};for(let l=0;l<t.length;l++){const s=t[l],o=a[l]?a[l]:"";X.value.PLT[e.crcCode][o]=s}}}},Ie=(e,t)=>(["plt","rbc","wbc"].forEach((a=>{t.crcContent[a].forEach((t=>{if("select"!==t.crcType&&"Etc"!==t.crcContent)return;const a=e.find((e=>e.id===t.id));if(a&&a.crcCode){const e=X.value[a.morphologyType];e&&e[a.crcCode]&&(t.crcContent=e[a.crcCode][t.crcContent]||t.crcContent)}}))})),t),Ce=async()=>{if(""===M.value)return u.value=U.TOAST_MSG_ERROR,Be("Please enter the code."),void(E.value=!1);0!==H.value.length&&(t.value=H.value);const e=t.value;let l=h.value.find((e=>e.code===k.value));switch(["plt","rbc","wbc"].forEach((t=>{l.crcContent[t].forEach((t=>{for(const a of e)t.id===a.id&&("select"===a.crcType?t.crcContent=a.val:t.crcContent=a.crcContent)}))})),"string"===typeof f.value[0]?.remarkAllContent&&f.value[0].remarkAllContent.replace(/\n/g,"\r"),console.log("commentList",y.value),"string"===typeof y.value[0]?.remarkAllContent&&y.value[0].remarkAllContent.replace(/\n/g,"\r"),"string"===typeof b.value[0]?.remarkAllContent&&b.value[0].remarkAllContent.replace(/\n/g,"\r"),Object.assign(l,{crcRemark:f.value,crcComment:y.value,crcRecommendation:b.value}),l=fe(e,l),l=Ie(e,l),K.value){case I["SD의학연구소"]:await ke(Kp(a.selectItems?.barcodeNo,l,O.value));break;case I["원주기독병원"]:await he(l);break;case I["UIMD"]:await he(l);break;case I["NONE"]:await ke(Kp(a.selectItems?.barcodeNo,l,O.value));break;default:await ke(Kp(a.selectItems?.barcodeNo,l,O.value));break}},he=async e=>{if(Y.value=e,await(0,s.dY)(),"H3"===z.value.trim())await oe();else{if(Z.value.length>60)return u.value=U.TOAST_MSG_ERROR,void Be("Text is too long");if(0===Z.value.length)return u.value=U.TOAST_MSG_ERROR,void Be("Please enter CBC flag.");const e={tsmp_no:a.selectItems?.barcodeNo,text_rslt:Z.value},t=await Dy(e);201===t?.code?(u.value=U.TOAST_MSG_SUCCESS,Be("Success")):(u.value=U.TOAST_MSG_ERROR,Be("Lis fail"))}},ke=async e=>{const t=await e;"Success"===t?await Se():(u.value=U.TOAST_MSG_ERROR,Be("Lis Send Fail"))},Se=async()=>{if(a.selectItems?.id){const e=W()().local(),t={submitState:"lisCbc",submitOfDate:e.format(),submitUserId:A.value.userId},l={id:a.selectItems?.id,...t};await we(l,!0),F.value=!0}u.value=U.TOAST_MSG_SUCCESS,Be(U.IDS_MSG_SUCCESS)},we=async(e,t)=>{try{const a=sessionStorage.getItem("lastSearchParams")||localStorage.getItem("lastSearchParams")||"",{startDate:l,endDate:s,page:o,searchText:n,nrCount:i,testType:r,wbcInfo:c,wbcTotal:d}=JSON.parse(a),m=l+s+o+n+i+r+c+d,v=await Nd({userId:Number(A.value.id),runingInfoDtoItems:[e],dayQuery:m});v?t||(u.value=U.TOAST_MSG_SUCCESS,Be("Success")):console.error("백엔드가 디비에 저장 실패함")}catch(a){console.error("Error:",a)}},Ne=e=>{switch(e){case"remark":m.value=!0;break;case"comment":v.value=!0;break;case"recommendation":p.value=!0;break}},Re=e=>{switch(e){case"remark":m.value=!1;break;case"comment":v.value=!1;break;case"recommendation":p.value=!1;break}},Le=e=>{0===e.value.length&&e.value.push({code:"",id:0,remarkAllContent:"",remarkContent:""})},Ee=(e,t)=>{switch(Le(b),Le(f),Le(y),t){case"remark":_e(e,f),Re("remark");break;case"comment":_e(e,y),Re("comment");break;case"reco":_e(e,b),Re("recommendation");break}},_e=(e,t)=>{for(const a of e)0===t.value[0].remarkAllContent.length||(t.value[0].remarkAllContent+="\r\r"),t.value[0].remarkAllContent+=ue(a.remarkAllContent)},Pe=()=>{d.value="",L.value?g.value=2:_.value=!0},Te=()=>{g.value=3},Ae=e=>{const t=""===d.value,a=()=>{_.value=!1},l=()=>{t?L.value=!0:E.value=!0,a(),t?g.value=2:(Ce(),E.value=!1)},s=()=>{t?L.value=!1:E.value=!1,a(),u.value=U.TOAST_MSG_ERROR,Be("The administrator password is incorrect.")};e?l():s()},Me=()=>{_.value=!1},De=async e=>{k.value=e,M.value=e;const a=h.value.filter((t=>t.code===e)),l=["plt","rbc","wbc"];l.forEach((e=>{a[0].crcContent[e].forEach((e=>{const a=t.value.find((t=>t.id===e.id));a&&("select"===a.crcType?a.val=e.crcContent:a.crcContent=e.crcContent)}))})),f.value=a[0].crcRemark||[],y.value=a[0].crcComment||[],b.value=a[0].crcRecommendation||[],f.value=f.value.map((e=>({...e,remarkAllContent:ue(e.remarkAllContent)}))),y.value=y.value.map((e=>({...e,remarkAllContent:ue(e.remarkAllContent)}))),b.value=b.value.map((e=>({...e,remarkAllContent:ue(e.remarkAllContent)})))},xe=async()=>{const e=await ht(a.selectItems.slotId),l={slotId:a.selectItems.slotId,code:k.value,crcDataArr:h.value,crcArr:t.value,remarkList:f.value,commentList:y.value,recoList:b.value};0===e?.data.length?await Ct(l):await kt(l),u.value=U.TOAST_MSG_SUCCESS,Be("Data saved to temporary storage")},Oe=async()=>{t.value=[],t.value=(await qe()).data,Z.value="",b.value=[],f.value=[],y.value=[],k.value="",M.value="",u.value=U.TOAST_MSG_SUCCESS,Be("Data empty to storage")},Ke=async()=>{const e=(await st()).data;h.value=e},Be=e=>{r.value=e,setTimeout((()=>{r.value=""}),1500)},Fe=()=>{switch(K.value){case I["원주기독병원"]:const e=Z.value.length;e>60&&(Z.value=Z.value.substring(0,60),u.value=U.TOAST_MSG_ERROR,Be("Text is too long"));break;default:break}},Ue=async({cbcPatientNo:e,cbcPatientNm:t,cbcSex:a,cbcAge:l})=>{const s={cbcPatientNo:e,cbcPatientNm:t,cbcSex:a,cbcAge:l},o={id:B.value.id,...s};await we(o,!0)};return(a,i)=>{const c=(0,s.g2)("font-awesome-icon");return(0,s.uX)(),(0,s.CE)(s.FK,null,[C.value?((0,s.uX)(),(0,s.CE)("div",Ph,[(0,s.Lk)("div",Th,[(0,s.Lk)("button",{class:(0,n.C4)(["tab",{active:1===g.value}]),onClick:i[0]||(i[0]=e=>g.value=1)}," Result Codes ",2),(0,s.Lk)("button",{class:(0,n.C4)(["tab",{active:2===g.value}]),onClick:i[1]||(i[1]=e=>Pe())}," Code Repository ",2),K.value===(0,o.R1)(I)["NONE"]?((0,s.uX)(),(0,s.CE)("button",{key:0,class:(0,n.C4)(["tab",{active:3===g.value}]),onClick:i[2]||(i[2]=e=>Te())}," Dashboard ",2)):(0,s.Q3)("",!0)]),1===g.value?((0,s.uX)(),(0,s.CE)("div",Ah,[(0,s.Lk)("div",Mh,[(0,s.Lk)("button",{class:"crcBtn",onClick:ge},[(0,s.bF)(c,{icon:["fas","upload"]})]),i[14]||(i[14]=(0,s.Lk)("span",{class:"crcSpanMenu"},"List",-1)),(0,s.Lk)("div",Dh,[(0,s.bo)((0,s.Lk)("input",{"onUpdate:modelValue":i[3]||(i[3]=e=>M.value=e),placeholder:"code Search",class:"autocomplete-input",onFocus:i[4]||(i[4]=e=>D.value=!0),onBlur:re},null,544),[[l.Jo,M.value]]),D.value&&ce.value.length?((0,s.uX)(),(0,s.CE)("ul",xh,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(ce.value,((e,t)=>((0,s.uX)(),(0,s.CE)("li",{key:t,onClick:t=>ie(e.code),class:"autocomplete-item"},(0,n.v_)(e.code),9,Oh)))),128))])):(0,s.Q3)("",!0)]),(0,s.Lk)("button",{class:"crcBtn tempSave ml10",onClick:xe},"Save"),(0,s.Lk)("button",{class:"crcBtn tempSave ml10",onClick:Oe},"Clear"),K.value===(0,o.R1)(I)["원주기독병원"]?((0,s.uX)(),(0,s.CE)("button",{key:0,class:"crcBtn tempSave ml10",onClick:i[5]||(i[5]=e=>q.value=!0)}," Image Select ")):(0,s.Q3)("",!0)]),N.value?((0,s.uX)(),(0,s.Wv)(wu,{key:0,items:t.value,moType:"RBC",pageName:"report",onChangeCrcData:ye},null,8,["items"])):(0,s.Q3)("",!0),(0,s.Lk)("div",Kh,[(0,s.Lk)("div",null,[N.value?((0,s.uX)(),(0,s.Wv)(wu,{key:0,items:t.value,moType:"WBC",pageName:"report",onChangeCrcData:ye},null,8,["items"])):(0,s.Q3)("",!0)]),(0,s.Lk)("div",null,[N.value?((0,s.uX)(),(0,s.Wv)(wu,{key:0,items:t.value,moType:"PLT",pageName:"report",onChangeCrcData:ye},null,8,["items"])):(0,s.Q3)("",!0)])]),de(0)&&"H3"===z.value?((0,s.uX)(),(0,s.CE)("div",Bh,[(0,s.Lk)("div",Fh,[(0,s.Lk)("span",null,[(0,s.bF)(c,{icon:["fas","message"]}),i[15]||(i[15]=(0,s.eW)(" Remark"))]),(0,s.Lk)("button",{class:"reSelect",onClick:i[6]||(i[6]=e=>Ne("remark"))},"Remark Select")]),(0,s.Lk)("div",Uh,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(f.value,((e,t)=>((0,s.uX)(),(0,s.CE)("div",{key:t},[(0,s.bo)((0,s.Lk)("textarea",{maxlength:"1000","onUpdate:modelValue":t=>e.remarkAllContent=t},null,8,Xh),[[l.Jo,e.remarkAllContent]])])))),128))])])):(0,s.Q3)("",!0),de(1)&&"H3"===z.value?((0,s.uX)(),(0,s.CE)("div",$h,[(0,s.Lk)("div",Wh,[(0,s.Lk)("span",null,[(0,s.bF)(c,{icon:["fas","message"]}),i[16]||(i[16]=(0,s.eW)(" Comment "))]),(0,s.Lk)("button",{class:"reSelect",onClick:i[7]||(i[7]=e=>Ne("comment"))},"Comment Select")]),(0,s.Lk)("div",Hh,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(y.value,((e,t)=>((0,s.uX)(),(0,s.CE)("div",{key:t},[(0,s.bo)((0,s.Lk)("textarea",{maxlength:"1000","onUpdate:modelValue":t=>e.remarkAllContent=t},null,8,Gh),[[l.Jo,e.remarkAllContent]])])))),128))])])):(0,s.Q3)("",!0),de(2)&&"H3"===z.value?((0,s.uX)(),(0,s.CE)("div",Yh,[(0,s.Lk)("div",Vh,[(0,s.Lk)("span",null,[(0,s.bF)(c,{icon:["fas","message"]}),i[17]||(i[17]=(0,s.eW)(" Recommendation "))]),(0,s.Lk)("button",{class:"reSelect",onClick:i[8]||(i[8]=e=>Ne("recommendation"))},"Recommendation Select")]),(0,s.Lk)("div",jh,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(b.value,((e,t)=>((0,s.uX)(),(0,s.CE)("div",{key:t},[(0,s.bo)((0,s.Lk)("textarea",{"onUpdate:modelValue":t=>e.remarkAllContent=t},null,8,Qh),[[l.Jo,e.remarkAllContent]])])))),128))])])):(0,s.Q3)("",!0),"H1"===z.value?((0,s.uX)(),(0,s.CE)("div",qh,[(0,s.Lk)("div",Jh,[(0,s.Lk)("span",null,[(0,s.bF)(c,{icon:["fas","message"]}),i[18]||(i[18]=(0,s.eW)(" CBC flag "))])]),(0,s.Lk)("div",zh,[(0,s.Lk)("div",null,[(0,s.bo)((0,s.Lk)("textarea",{"onUpdate:modelValue":i[9]||(i[9]=e=>Z.value=e),onInput:i[10]||(i[10]=e=>Fe())},null,544),[[l.Jo,Z.value]])])])])):(0,s.Q3)("",!0)])):(0,s.Q3)("",!0),2===g.value?((0,s.uX)(),(0,s.Wv)(wC,{key:1,crcPassWord:w.value,crcArr:t.value,onRefresh:Ke},null,8,["crcPassWord","crcArr"])):(0,s.Q3)("",!0),3===g.value?((0,s.uX)(),(0,s.CE)("div",Zh,[(0,s.bF)(AC,{autoNomarlCheck:G.value},null,8,["autoNomarlCheck"])])):(0,s.Q3)("",!0),Q.value?((0,s.uX)(),(0,s.Wv)(Ch,{key:3,isAutoCBCMatchingArr:j.value,onCodeSelect:le,onCodeClose:se},null,8,["isAutoCBCMatchingArr"])):(0,s.Q3)("",!0)])):(0,s.Q3)("",!0),m.value?((0,s.uX)(),(0,s.Wv)(KI,{key:1,onCancel:i[11]||(i[11]=e=>Re("remark")),onListUpdated:Ee,type:"remark",crcDefaultMode:S.value,crcPassWord:w.value},null,8,["crcDefaultMode","crcPassWord"])):(0,s.Q3)("",!0),v.value?((0,s.uX)(),(0,s.Wv)(KI,{key:2,onCancel:i[12]||(i[12]=e=>Re("comment")),onListUpdated:Ee,type:"comment",crcDefaultMode:S.value,crcPassWord:w.value},null,8,["crcDefaultMode","crcPassWord"])):(0,s.Q3)("",!0),p.value?((0,s.uX)(),(0,s.Wv)(KI,{key:3,onCancel:i[13]||(i[13]=e=>Re("recommendation")),onListUpdated:Ee,type:"reco",crcDefaultMode:S.value,crcPassWord:w.value},null,8,["crcDefaultMode","crcPassWord"])):(0,s.Q3)("",!0),r.value?((0,s.uX)(),(0,s.Wv)(Eb,{key:4,message:r.value,messageType:u.value,duration:1500,position:"bottom-right"},null,8,["message","messageType"])):(0,s.Q3)("",!0),_.value?((0,s.uX)(),(0,s.Wv)(fI,{key:5,type:d.value,crcPassWord:P.value,onReturnPassWordCheck:Ae,onPassWordClose:Me},null,8,["type","crcPassWord"])):(0,s.Q3)("",!0),V.value?((0,s.uX)(),(0,s.Wv)(vh,{key:6,nowCrcData:Y.value,captureAndConvertOk:V.value,onResetBool:ne,patientNm:e.selectItems?.cbcPatientNm,barcodeNo:e.selectItems?.barcodeNo,commentList:y.value,recoList:b.value,selectWbcImgArr:J.value,slotId:e.selectItems?.slotId},null,8,["nowCrcData","captureAndConvertOk","patientNm","barcodeNo","commentList","recoList","selectWbcImgArr","slotId"])):(0,s.Q3)("",!0),q.value?((0,s.uX)(),(0,s.Wv)(_h,{key:7,selectItems:e.selectItems,onCloseWbcSelect:te,onSelectWbcImgSend:ee},null,8,["selectItems"])):(0,s.Q3)("",!0)],64)}}});const tk=ek;var ak=tk;const lk={style:{display:"flex"}},sk={class:"reportDiv"},ok={class:"wbcDiv shadowBox"},nk={key:1,class:"reportDetail shadowBox"},ik={class:"reportTitle"},rk={class:"reportDivTop"},ck={key:0,class:"reportH3"},uk={key:1,class:"reportH3"},dk={class:"reportTable"},mk={class:"reportH3 mb10 pl0"},vk={class:"tableClass mt22"},pk={key:0,class:"reportH3 mb10 pl0"},gk={key:1,class:"tableClass"},fk={key:0},yk={key:0,class:"rbcRight"},bk={class:"printRbcCategory"},Ik={key:0,class:"mb10 liTitle",style:{cursor:"default"}},Ck={style:{cursor:"default"}},hk={class:"printRbcClass"},kk={key:0,class:"mb10 liTitle",style:{cursor:"default"}},Sk={style:{cursor:"default"}},wk={key:0,style:{cursor:"default"}},Nk={key:1,style:{cursor:"default"}},Rk={class:"printRbcDegree"},Lk={key:0,class:"mb10 liTitle",style:{cursor:"default"}},Ek={style:{cursor:"default"}},_k={key:0,style:{cursor:"default"}},Pk={key:1},Tk={class:"printTotalText",style:{cursor:"default"}},Ak={class:"printRbcCount"},Mk={key:0,class:"mb10 liTitle",style:{cursor:"default"}},Dk={style:{cursor:"default"}},xk={key:0,style:{cursor:"default"}},Ok={key:1,style:{cursor:"default"}},Kk={class:"printRbcPercent"},Bk={key:0,class:"mb10 liTitle",style:{cursor:"default"}},Fk={style:{cursor:"default"}},Uk={key:0,style:{cursor:"default"}},Xk={key:1,style:{cursor:"default"}},$k={style:{cursor:"default"}};var Wk=(0,s.pM)({__name:"report",setup(e){const t=e=>e?.name,a=(0,c.Pj)(),i=(0,o.KR)([]),r=(0,o.KR)(null),u=(0,o.KR)(!1),d=(0,o.KR)([]),m=(0,s.EW)((()=>a.state.commonModule.siteCd)),g=(0,s.EW)((()=>a.state.commonModule.cbcLayer)),b=(0,s.EW)((()=>a.state.commonModule.iaRootPath)),C=(0,s.EW)((()=>a.state.slideDataModule.rbcInfoAfter)),h=(0,s.EW)((()=>a.state.slideDataModule)),k=(0,o.KR)(!1),S=(0,o.KR)([]),w=(0,o.KR)(!0),N=["NR","GP","PA","AR","MA","SM"],R=(0,o.KR)([]),L=(0,o.KR)(null),E=(0,o.KR)([]),_=(0,o.KR)(0),P=(0,o.KR)(0),T=(0,o.KR)(0),A=(0,o.KR)(0),M=(0,o.KR)(0),D=(0,o.KR)(0),x=(0,o.KR)(0),O=(0,o.KR)(0),K=((0,o.KR)([]),(0,o.KR)(!1)),B=(0,o.KR)([]),F=(0,o.KR)([]),U=(0,o.KR)(!1),X=(0,o.KR)(!1),$=(0,o.KR)(!1);(0,s.wB)((()=>h.value),(async(e,t)=>{e.id!==t?.id&&(await(0,s.dY)(),await H(e),await se(),await oe(e),k.value||await j())}),{immediate:!0,deep:!0}),(0,s.KC)((async()=>{k.value="bm"===window.PROJECT_TYPE;const e=await rt();0!==e.data.length&&(U.value=e.data[0].crcConnect);const t=await qe();200===t.code&&(X.value=!0,F.value=t.data)}));const W=e=>{L.value&&!L.value.contains(e.target)&&u.value&&te()};(0,s.sV)((async()=>{await(0,s.dY)(),w.value=!1,await se(),await oe(),document.addEventListener("click",W)})),(0,s.hi)((()=>{document.removeEventListener("click",W)}));const H=async e=>{try{if(i.value=e,m.value===I["서울성모병원"]||m.value===I["UIMD"]||m.value===I["NONE"]){let e=Nb(i.value?.wbcInfoAfter||[]);const t=G(e,"wbc");e=Nb(e),k.value?B.value=i.value?.wbcInfoAfter||[]:B.value=Od(t,e)}else B.value=i.value?.wbcInfoAfter||[]}catch(t){console.error(t)}},G=(e,t)=>{const a=["NR","GP","PA","AR","MA","SM"];return"nonWbc"===t?e.filter((e=>a.includes(e.title))):e.filter((e=>!a.includes(e.title)))},Y=()=>{const e=k.value?"bm":"pb";m.value===I["서울성모병원"]?i.value.wbcInfoAfter=Od(i.value?.wbcInfoAfter,i.value?.wbcInfoAfter):m.value===I["인하대병원"]?i.value.wbcInfoAfter=xd(i.value,i.value?.wbcInfoAfter):m.value===I["인천성모병원"]?i.value.wbcInfoAfter=Kd(e,i.value?.wbcInfoAfter):m.value===I["인천길병원"]&&(i.value.wbcInfoAfter=Bd(i.value?.wbcInfoAfter,i.value?.wbcInfo.totalCount)),r.value=i.value.wbcInfoAfter},j=async()=>{const e=""!==i.value?.img_drive_root_path&&i.value?.img_drive_root_path?i.value?.img_drive_root_path:b.value,t=`${e}/${i.value?.slotId}/${aa.RBC_CLASS}/${i.value?.slotId}_new.json`,a=await Ro({fullPath:t}),l=`${e}/${i.value?.slotId}/${aa.RBC_CLASS}/${i.value?.slotId}.json`,s=await Ro({fullPath:l});if("not file"!==a.data){const e=a?.data;for(const t of s.data[0].rbcClassList)for(const a of e){const e=t.classInfo.findIndex((e=>Number(e.index)===Number(a.index)));if(-1!==e&&t.classInfo.splice(e,1),t.categoryId===a.categoryId){let e={classNm:a.classNm,classId:a.classId,posX:String(a.posX),posY:String(a.posY),width:a.width,height:a.height,index:a.index};t.classInfo.push(e)}}E.value=s.data[0].rbcClassList}else E.value=s?.data[0].rbcClassList;if(!E.value||!Array.isArray(E.value))return;let o=0,n=0,r=0,c=0;E.value.forEach((e=>{const t=e.classInfo.length>0?(e.classInfo[e.classInfo.length-1].index||"").replace(/[^\d]/g,""):"";switch(e.categoryId){case v.SIZE.CATEGORY_ID:o=t;break;case v.CHROMIA.CATEGORY_ID:n=t;break;case v.SHAPE.CATEGORY_ID:r=t;for(const t of e.classInfo)p.includes(t.classId)||(M.value+=1);break;case v.INCLUSION_BODY.CATEGORY_ID:c=t;break;default:break}})),_.value=Number(o)+1,P.value=Number(o)+1,T.value=n,A.value=Number(r)+Number(c)+2,C.value.forEach((e=>{e.classInfo.forEach((e=>{e.originalDegree=0}))})),E.value.forEach((e=>{const t=C.value.find((t=>t.categoryId===e.categoryId));t&&e.classInfo.forEach((e=>{const a=t.classInfo.find((t=>t.classId===e.classId));a&&a.originalDegree++}))})),await Q()},Q=async()=>{let e=0,t=0;for(const a of E.value){if("01"===a.categoryId){const e=a.classInfo[a.classInfo.length-1].index;x.value=Number(e.replace("S",""))+1}if("04"===a.categoryId)for(const t of a.classInfo)"Platelet"===t.classNm&&(e+=1);else if("05"===a.categoryId)for(const e of a.classInfo)"Malaria"===e.classNm&&(t+=1)}O.value=Math.floor(e/parseFloat(x.value)*1e3),D.value=t},q=(e,t)=>{const a=(Number(e)/J(t)*100).toFixed(1);return Number(a)===Math.floor(Number(a))?Math.floor(Number(a)).toString():a},J=e=>{switch(e){case v.SIZE.CATEGORY_ID:return Number(_.value);case v.CHROMIA.CATEGORY_ID:return Number(T.value);case v.SHAPE.CATEGORY_ID:case v.INCLUSION_BODY.CATEGORY_ID:return Number(A.value);default:return Number(_.value)}},z=async()=>{await se(),await oe()},Z=e=>{const t=ee(m.value,i.value?.testType);return!t.includes(e)},ee=(e,t)=>{e||""!==e||(e="0000",t="01");const a={"0006":{includesStr:["AR","NR","GP","PA","MC","MA","SM","NE","GP","PA","OT"],includesStr2:["NR","AR","MC","MA","SM","NE","GP","PA","OT"]}},l=a[e]||{includesStr:["AR","NR","GP","PA","MC","SM","MA","GP","PA","OT"],includesStr2:["NR","AR","MC","MA","SM","GP","PA","OT"]};return"01"===t||"04"===t?l.includesStr:l.includesStr2},te=()=>{u.value=!1},ae=()=>k.value?"BM Classification":"WBC Classification",le=e=>{e.stopPropagation(),u.value=!0},se=async()=>{try{const e=await He();e&&(0===e?.data.length?S.value=[]:S.value=e.data.sort(((e,t)=>Number(e.orderIdx)-Number(t.orderIdx))))}catch(e){console.error(e)}};async function oe(e){if(i.value?.wbcInfoAfter&&0!==i.value?.wbcInfoAfter.length){let e=0!==S.value.length?S.value:"bm"===window.PROJECT_TYPE?el:Za;const t=ne(i.value?.wbcInfoAfter,e);if(R.value=t.filter((e=>N.includes(e.title))),i.value.wbcInfoAfter=t,r.value=t,!R.value||0===R.value.length){const t=ne(i.value?.wbcInfo.wbcInfo[0],e);R.value=t.filter((e=>N.includes(e.title)))}}else{let e=0!==S.value.length?S.value:"bm"===window.PROJECT_TYPE?el:Za;const t=ne(i.value?.wbcInfo.wbcInfo[0],e);R.value=t.filter((e=>N.includes(e.title))),i.value.wbcInfoAfter=t,r.value=t}await Y(),d.value=e}const ne=(e,t)=>{let a=JSON.parse(JSON.stringify(e));return a.sort(((e,a)=>{const l=t.findIndex((t=>(t.title||t.abbreviation)===(e.title||e.abbreviation))),s=t.findIndex((e=>(e.title||e.abbreviation)===(a.title||a.abbreviation)));return-1===l?1:-1===s?-1:l-s})),a},ie=e=>{e&&(K.value=!K.value)},re=e=>{e===I["인천길병원"]&&($.value=!$.value)};return(e,a)=>{const c=(0,s.g2)("font-awesome-icon");return(0,s.uX)(),(0,s.CE)(s.FK,null,[(0,s.bF)(Py,{changeSlideByLisUpload:$.value},null,8,["changeSlideByLisUpload"]),"0007"!==m.value?((0,s.uX)(),(0,s.CE)("div",{key:0,class:(0,n.C4)("reportSection"+(g.value?" cbcLayer":""))},[(0,s.bF)(fb,{testType:k.value?(0,o.R1)(y)(i.value?.testType):(0,o.R1)(f)(i.value?.testType),barcodeNo:i.value?.barcodeNo,cbcPatientNo:i.value?.cbcPatientNo,patientName:i.value?.patientName,hospitalName:i.value?.hosName,cbcPatientName:i.value?.cbcPatientNm,cbcSex:i.value?.cbcSex,cbcAge:i.value?.cbcAge,analyzedDttm:i.value?.analyzedDttm},null,8,["testType","barcodeNo","cbcPatientNo","patientName","hospitalName","cbcPatientName","cbcSex","cbcAge","analyzedDttm"]),(0,s.Lk)("div",lk,[g.value?((0,s.uX)(),(0,s.Wv)(sb,{key:0,selectItems:i.value},null,8,["selectItems"])):(0,s.Q3)("",!0),(0,s.Lk)("div",sk,[k.value||"04"!==i.value.testType?(0,s.Q3)("",!0):((0,s.uX)(),(0,s.CE)("div",{key:0,class:(0,n.C4)(["rbcDiv shadowBox",g.value?"rbcDivInReportWithCBC":""])},[w.value?(0,s.Q3)("",!0):((0,s.uX)(),(0,s.Wv)(xf,{key:0,rbcInfo:d.value,type:"report",onSubmitStateChanged:ie,isCommitChanged:K.value},null,8,["rbcInfo","isCommitChanged"]))],2)),(0,s.Lk)("div",ok,[w.value?(0,s.Q3)("",!0):((0,s.uX)(),(0,s.Wv)(mI,{key:0,wbcInfo:r.value,selectItems:i.value,type:"report",onClassOrderChanged:z,onSubmitStateChanged:ie,isCommitChanged:K.value,onUploadLisChangeSlide:re},null,8,["wbcInfo","selectItems","isCommitChanged"]))]),U.value?X.value&&U.value?((0,s.uX)(),(0,s.Wv)(ak,{key:2,crcDataVal:F.value,selectItems:i.value},null,8,["crcDataVal","selectItems"])):(0,s.Q3)("",!0):((0,s.uX)(),(0,s.CE)("div",nk,[(0,s.Lk)("div",ik,[a[0]||(a[0]=(0,s.Lk)("span",null,"[Hospital]",-1)),a[1]||(a[1]=(0,s.eW)()),(0,s.Lk)("span",null,"DM Serial Nbr : "+(0,n.v_)(i.value?.slotId),1),(0,s.bF)(c,{icon:["fas","print"],onClick:le,class:"printStart"})]),(0,s.Lk)("div",rk,[k.value?(0,s.Q3)("",!0):((0,s.uX)(),(0,s.CE)("h3",ck,"Analysis Report from UIMD PB system")),k.value?((0,s.uX)(),(0,s.CE)("h3",uk,"Analysis Report from UIMD BM system")):(0,s.Q3)("",!0),(0,s.Lk)("table",dk,[(0,s.Lk)("tbody",null,[(0,s.Lk)("tr",null,[a[2]||(a[2]=(0,s.Lk)("th",null,"Slot ID",-1)),(0,s.Lk)("td",null,(0,n.v_)(i.value?.slotId),1)]),(0,s.Lk)("tr",null,[a[3]||(a[3]=(0,s.Lk)("th",null,"Ordered date",-1)),(0,s.Lk)("td",null,(0,n.v_)((0,o.R1)(V)(i.value?.orderDttm)),1)]),(0,s.Lk)("tr",null,[a[4]||(a[4]=(0,s.Lk)("th",null,"Signed by ID",-1)),(0,s.Lk)("td",null,(0,n.v_)(i.value?.submitUserId),1)]),(0,s.Lk)("tr",null,[a[5]||(a[5]=(0,s.Lk)("th",null,"Signed date",-1)),(0,s.Lk)("td",null,(0,n.v_)(i.value?.submitOfDate),1)]),(0,s.Lk)("tr",null,[a[6]||(a[6]=(0,s.Lk)("th",null,"Patient ID",-1)),(0,s.Lk)("td",null,(0,n.v_)(i.value?.patientId),1)]),(0,s.Lk)("tr",null,[a[7]||(a[7]=(0,s.Lk)("th",null,"Ordered Classification",-1)),(0,s.Lk)("td",null,(0,n.v_)(k.value?(0,o.R1)(y)(i.value?.testType):(0,o.R1)(f)(i.value?.testType)),1)]),(0,s.Lk)("tr",null,[a[8]||(a[8]=(0,s.Lk)("th",null,"Name",-1)),(0,s.Lk)("td",null,(0,n.v_)(i.value?.patientName),1)]),(0,s.Lk)("tr",null,[a[9]||(a[9]=(0,s.Lk)("th",null,"Birth",-1)),(0,s.Lk)("td",null,(0,n.v_)(i.value?.birthDay),1)]),(0,s.Lk)("tr",null,[a[10]||(a[10]=(0,s.Lk)("th",null,"Gender",-1)),(0,s.Lk)("td",null,(0,n.v_)(""===i.value?.gender?"":"01"===i.value?.gender?"Male":"Female"),1)])])])]),(0,s.Lk)("div",{class:(0,n.C4)(["reportDivBottom","04"!==i.value.testType&&"reportDiff"])},[(0,s.Lk)("div",{class:(0,n.C4)(["wbcLeft",k.value&&"wbcLeftBm"])},[(0,s.Lk)("h3",mk,(0,n.v_)(ae())+" result",1),(0,s.Lk)("table",vk,[a[13]||(a[13]=(0,s.Lk)("colgroup",null,[(0,s.Lk)("col",{width:"40%"}),(0,s.Lk)("col",{width:"20%"}),(0,s.Lk)("col",{width:"20%"})],-1)),a[14]||(a[14]=(0,s.Lk)("thead",null,[(0,s.Lk)("tr",{class:"reportWbcclassificationSmallTitle"},[(0,s.Lk)("th",null,"Class"),(0,s.Lk)("th",null,"Count"),(0,s.Lk)("th",null,"Percent")])],-1)),(0,s.Lk)("tbody",null,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(B.value,(e=>((0,s.uX)(),(0,s.CE)("tr",{key:e.id,class:"wbcClassDbDiv"},[Z(e.title)?((0,s.uX)(),(0,s.CE)(s.FK,{key:0},[(0,s.Lk)("td",null,(0,n.v_)(e?.name),1),(0,s.Lk)("td",null,(0,n.v_)(e?.count),1),(0,s.Lk)("td",null,(0,n.v_)(Math.floor(Number(e?.percent))||"0"),1)],64)):(0,s.Q3)("",!0)])))),128)),(0,s.Lk)("tr",null,[a[11]||(a[11]=(0,s.Lk)("td",null,"Total",-1)),(0,s.Lk)("td",null,(0,n.v_)(i.value?.wbcInfo?.totalCount||0),1),a[12]||(a[12]=(0,s.Lk)("td",null,"100.00",-1))])])]),i.value?.wbcInfo?.nonRbcClassList||k.value?(0,s.Q3)("",!0):((0,s.uX)(),(0,s.CE)("h3",pk,"non-WBC")),k.value?(0,s.Q3)("",!0):((0,s.uX)(),(0,s.CE)("table",gk,[a[16]||(a[16]=(0,s.Lk)("colgroup",null,[(0,s.Lk)("col",{width:"40%"}),(0,s.Lk)("col",{width:"20%"}),(0,s.Lk)("col",{width:"20%"})],-1)),(0,s.Lk)("tbody",null,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(R.value,((e,o)=>(0,s.bo)(((0,s.uX)(),(0,s.CE)("tr",{key:o},[(0,s.Lk)("td",null,(0,n.v_)(t(e)),1),(0,s.Lk)("td",null,[(0,s.eW)((0,n.v_)(Number(e?.count)||0)+" ",1),"NR"===e?.title||"GP"===e?.title?((0,s.uX)(),(0,s.CE)("span",fk," /"+(0,n.v_)(i.value?.wbcInfo?.maxWbcCount)+" WBC",1)):(0,s.Q3)("",!0)]),a[15]||(a[15]=(0,s.Lk)("td",null,"-",-1))],512)),[[l.aG,"0006"!==m.value&&"SM"!==e?.title]]))),128))])]))],2),k.value||"04"!==i.value.testType?(0,s.Q3)("",!0):((0,s.uX)(),(0,s.CE)("div",yk,[a[17]||(a[17]=(0,s.Lk)("h3",{class:"reportH3 pl0"},"RBC classification result",-1)),((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)([C.value],((t,a)=>((0,s.uX)(),(0,s.CE)(s.FK,{key:a},[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(t,((t,a)=>((0,s.uX)(),(0,s.CE)("div",{key:a,class:"categories"},[(0,s.Lk)("ul",bk,[(0,s.eW)((0,n.v_)(e.type)+" ",1),0===a?((0,s.uX)(),(0,s.CE)("li",Ik,"Category")):(0,s.Q3)("",!0),(0,s.Lk)("li",Ck,(0,n.v_)(t?.categoryNm),1)]),(0,s.Lk)("ul",hk,[0===a?((0,s.uX)(),(0,s.CE)("li",kk,"Class")):(0,s.Q3)("",!0),((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(t?.classInfo,((e,a)=>((0,s.uX)(),(0,s.CE)(s.FK,{key:a},[(0,s.Lk)("li",Sk,(0,n.v_)(e?.classNm),1),a===t.classInfo.length-1&&"03"===t?.categoryId?((0,s.uX)(),(0,s.CE)("li",wk," Others ")):(0,s.Q3)("",!0),a===t.classInfo.length-1&&"Inclusion Body"===t?.categoryNm?((0,s.uX)(),(0,s.CE)("li",Nk," Malaria ")):(0,s.Q3)("",!0)],64)))),128))]),(0,s.Lk)("ul",Rk,[0===a?((0,s.uX)(),(0,s.CE)("li",Lk,"Degree")):(0,s.Q3)("",!0),((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(t?.classInfo,((e,a)=>((0,s.uX)(),(0,s.CE)(s.FK,{key:a},[(0,s.Lk)("li",Ek,(0,n.v_)(Number(e?.degree)||0),1),a===t.classInfo.length-1&&"03"===t?.categoryId?((0,s.uX)(),(0,s.CE)("li",_k," - ")):(0,s.Q3)("",!0),a===t.classInfo.length-1&&"Inclusion Body"===t?.categoryNm?((0,s.uX)(),(0,s.CE)("li",Pk," - ")):(0,s.Q3)("",!0)],64)))),128)),(0,s.bo)((0,s.Lk)("li",Tk,"Total ",512),[[l.aG,"Shape"!==t.categoryNm]])]),(0,s.Lk)("ul",Ak,[0===a?((0,s.uX)(),(0,s.CE)("li",Mk,"Count")):(0,s.Q3)("",!0),((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(t?.classInfo,((e,a)=>((0,s.uX)(),(0,s.CE)(s.FK,{key:a},[(0,s.Lk)("li",Dk,(0,n.v_)(Number(e?.originalDegree)||0),1),a===t.classInfo.length-1&&"03"===t?.categoryId?((0,s.uX)(),(0,s.CE)("li",xk,(0,n.v_)(Number(M.value)||0),1)):(0,s.Q3)("",!0),a===t.classInfo.length-1&&"Inclusion Body"===t?.categoryNm?((0,s.uX)(),(0,s.CE)("li",Ok,(0,n.v_)(Number(D.value)||0),1)):(0,s.Q3)("",!0)],64)))),128)),(0,s.bo)((0,s.Lk)("li",{style:{cursor:"default"}},(0,n.v_)(Number(P.value)||0),513),[[l.aG,"Size"===t?.categoryNm||"Chromia"===t?.categoryNm]]),(0,s.bo)((0,s.Lk)("li",{style:{cursor:"default"}},(0,n.v_)(Number(A.value)||0),513),[[l.aG,"Inclusion Body"===t?.categoryNm]])]),(0,s.Lk)("ul",Kk,[0===a?((0,s.uX)(),(0,s.CE)("li",Bk,"Percent")):(0,s.Q3)("",!0),((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(t?.classInfo,((e,a)=>((0,s.uX)(),(0,s.CE)(s.FK,{key:a},[(0,s.Lk)("li",Fk,(0,n.v_)(q(Number(e?.originalDegree),(0,o.R1)(v).SIZE.CATEGORY_ID)||0),1),a===t.classInfo.length-1&&"03"===t?.categoryId?((0,s.uX)(),(0,s.CE)("li",Uk,(0,n.v_)(q(M.value,(0,o.R1)(v).SHAPE.CATEGORY_ID)||0),1)):(0,s.Q3)("",!0),a===t.classInfo.length-1&&"Inclusion Body"===t?.categoryNm?((0,s.uX)(),(0,s.CE)("li",Xk,(0,n.v_)(q(D.value,(0,o.R1)(v).INCLUSION_BODY.CATEGORY_ID)||0),1)):(0,s.Q3)("",!0)],64)))),128)),(0,s.bo)((0,s.Lk)("li",$k,"100%",512),[[l.aG,"Shape"!==t.categoryNm]])])])))),128))],64)))),128))]))],2)]))])])],2)):(0,s.Q3)("",!0),(0,s.Lk)("div",{ref_key:"printContent",ref:L},[u.value?((0,s.uX)(),(0,s.Wv)(tv,{key:0,onPrintClose:te})):(0,s.Q3)("",!0)],512)],64)}}});const Hk=Wk;var Gk=Hk,Yk=a(2543);const Vk={class:"tiling-viewer_img_list-box_img_list",style:{"border-radius":"4px"}},jk=["src"],Qk={key:0,class:"selectImgWarn"},qk={class:"hand-pointer"};var Jk=(0,s.pM)({__name:"wps",props:["wpsImgClickInfoData","slotId","selectItems"],emits:["borderDel","borderOn"],setup(e,{emit:t}){const a=(0,c.Pj)(),i=e,r=(0,o.KR)({}),u=(0,o.KR)(null);let d=(0,o.KR)(null);const m=(0,o.KR)("0"),v=(0,o.KR)("0"),p=(0,o.KR)([]),g=(0,s.EW)((()=>a.state.commonModule.viewerCheck)),f=(0,s.EW)((()=>a.state.commonModule.cbcLayer)),y="viewer"===g.value?window.MAIN_API_IP:window.APP_API_BASE_URL,b=(0,o.KR)(a.state.commonModule.iaRootPath),I=(0,o.KR)(null),C=(0,o.KR)(""),h=(0,o.KR)(!1),k=(0,o.KR)(!1),S=(0,o.KR)([]),w=(0,o.KR)("");let N=(0,o.KR)(!0);const R=(0,o.KR)(""),L=(0,o.KR)(U.TOAST_MSG_SUCCESS),E=t;let _=null;const P=(0,o.KR)("");(0,s.wB)((()=>i.wpsImgClickInfoData),(async e=>{if(w.value!==i.slotId){const t=""!==i.selectItems?.img_drive_root_path&&i.selectItems?.img_drive_root_path?i.selectItems?.img_drive_root_path:b.value,a=document.getElementById("tilingViewerImgListWps");if(a){w.value=i.slotId,a.innerHTML="",d.value&&d.value.destroy();const l=`${t}/${i.slotId}/04_WPS/WPS_files/0`,s=`${y}/folders?folderPath=${l}`,o=await fetch(s),n=await o.json();P.value=n[0].split(".")[1];const c=`${t}/${i.slotId}/04_WPS/WPS.json`,u=await Ro({fullPath:c});S.value=u.data,await A(),r.value=e}const l=S.value.find((t=>t.FILE_NM===e.img.fileName.split("_").slice(2).join("_")));l||(L.value=U.TOAST_MSG_ERROR,F("Selected image does not have corresponding coordinates."),E("borderDel"))}else if(d.value){N.value=!1;const t=S.value.find((t=>t.FILE_NM===e.img.fileName.split("_").slice(2).join("_")));if(t){const{x1:a,x2:l,y1:s,y2:o}=t;T(a,l,s,o);const n=Number(t.POSX1),i=Number(t.POSY1),c=Number(t.POSX2),u=Number(t.POSY2),d=c-n,m=u-i;E("borderOn"),r.value=e,await D(n,i,d,m)}else L.value=U.TOAST_MSG_ERROR,F("Selected image does not have corresponding coordinates."),E("borderDel")}}),{deep:!0});const T=(e,t,a,l)=>{const s=document.querySelector(".openseadragon-container .navigator"),o=document.querySelector(".openseadragon-container .navigator .openseadragon-canvas"),n=s?.parentNode;if(n&&(o?.classList.add("nav-bar-canvas"),n?.classList.add("opacityZero"),n.style.zIndex="10",n.style.position="relative",n.style.width="130px",n.style.height="375px"),s){s.classList.add("custom-nav-bar-canvas");const o=Number(t)-Number(e),n=Number(l)-Number(a),i=.5,r=e*i,c=a*i;s.style.position="absolute",s.style.width=o*i+"px",s.style.height=n*i+"px",s.style.left=`${r}px`,s.style.top=`${c}px`}},A=async()=>{const e=""!==i.selectItems?.img_drive_root_path&&i.selectItems?.img_drive_root_path?i.selectItems?.img_drive_root_path:b.value,t=`${e}/${i.slotId}/04_WPS`;C.value=`${y}/images/getImageRealTime?folder=${t}&imageName=slide.jpg`;const a=await x(t);try{d.value=Kf()({id:"tilingViewerImgListWps",animationTime:.4,navigatorHeight:.5*(+S.value[0].y2-+S.value[0].y1),navigatorWidth:.5*(+S.value[0].x2-+S.value[0].x1),showNavigator:!h.value,navigatorAutoFade:!0,sequenceMode:!0,defaultZoomLevel:1,navigatorBackground:"transparent",prefixUrl:ty(y),tileSources:a,showReferenceStrip:!1,showFullPageControl:!1,showSequenceControl:!1,showZoomControl:!1,showHomeControl:!1,gestureSettingsMouse:{clickToZoom:!1},minZoomLevel:1,zoomPerClick:1.2,zoomPerScroll:1.2,viewportMargins:{top:0,left:0,bottom:0,right:0},visibilityRatio:1});const e=new(Kf().Button)({tooltip:"Toggle Navigator",srcRest:ty(y)+"home_rest.png",srcGroup:ty(y)+"home_grouphover.png",srcHover:ty(y)+"home_hover.png",srcDown:ty(y)+"home_pressed.png",onClick:()=>{h.value=!h.value;const e=d.value.navigator?.element;e&&(e.style.display="none"===e.style.display?"block":"none")}});d.value.buttonGroup.buttons.push(e),d.value.buttonGroup.element.appendChild(e.element);const t=document.createElement("canvas");d.value.addOverlay({element:t,location:new(Kf().Rect)(0,0,1,1)}),t.id="myCanvas",I.value=t,d.value.addHandler("open",(function(e){k.value=!0,t.width=e.source.Image.Size.Width,t.height=e.source.Image.Size.Height;const a=new(Kf().Rect)(.1,.1,.2,.2);d.value.viewport.fitBounds(a),T(S.value[0].x1,S.value[0].x2,S.value[0].y1,S.value[0].y2)})),N.value=!1,d.value.addHandler("animation",(async()=>{const e=i.wpsImgClickInfoData.img.fileName.split("_").slice(2).join("_"),t=S.value.find((t=>t.FILE_NM===e));if(t){const e=Number(t.POSX1),a=Number(t.POSY1),l=Number(t.POSX2),s=Number(t.POSY2),o=Number(l)-Number(e),n=Number(s)-Number(a);await D(e,a,o,n)}}))}catch(l){console.error("Error initializing viewer:",l)}},M=(e,t,a,l)=>{if(!N.value){if(d.value){let s=d.value.viewport.imageToViewportRectangle(e,t,a,l);const o=.09,n=new(Kf().Rect)(s.x+s.width*(1-1/o)/2,s.y+s.height*(1-1/o)/2,s.width/o,s.height/o);d.value.viewport.fitBounds(n,!0)}N.value=!0}};const D=async(e,t,a,l)=>{if(!d.value)return;_&&(d.value.removeOverlay(_),_=null);const s=document.createElement("div");s.style.border="2px solid red",s.style.position="absolute",s.style.width=`${a}%`,s.style.height=`${l}%`;const o=d.value.viewport.imageToViewportRectangle(Number(e),Number(t),Number(a),Number(l));d.value.addOverlay({element:s,location:o}),_=s,M(e,t,a,l)},x=async e=>{const t=`${y}/folders?folderPath=${e}`,a=await fetch(t);if(a.ok){const t=await a.json(),l=[];p.value=[];for(const a of t)if(a.endsWith("_files")){const t=O(a);p.value.push(t);const{width:s,height:o,tileSize:n}=await K(t);l.push({Image:{xmlns:"http://schemas.microsoft.com/deepzoom/2009",Type:"image",Url:`${y}/folders?folderPath=${e}/${a}/`,Format:P.value,Overlap:"1",TileSize:n,buildPyramid:!1,Size:{Width:s,Height:o}}}),v.value=s,m.value=o}return l}throw new Error("Network response was not ok")},O=e=>{const t="_files",a=e.indexOf(t);return-1!==a?e.substring(0,a):e},K=async()=>{const e=""!==i.selectItems?.img_drive_root_path&&i.selectItems?.img_drive_root_path?i.selectItems?.img_drive_root_path:b.value,t=`${e}/${i.selectItems.slotId}/04_WPS/WPS.dzi`,a=await Lo({filePath:t});return await B(a)},B=e=>{const t=new DOMParser,a=t.parseFromString(e,"application/xml"),l=a.getElementsByTagName("Size")[0],s=a.getElementsByTagName("Image")[0],o=s.getAttribute("TileSize"),n=l.getAttribute("Width"),i=l.getAttribute("Height");return{width:Number(n),height:Number(i),tileSize:Number(o)}},F=e=>{R.value=e,setTimeout((()=>{R.value=""}),1500)};return(e,t)=>{const a=(0,s.g2)("font-awesome-icon");return(0,s.uX)(),(0,s.CE)(s.FK,null,[(0,s.Lk)("div",{class:(0,n.C4)("wpsDiv main "+(f.value?"cbcLayer":""))},[(0,s.Lk)("div",Vk,[(0,s.Lk)("div",{ref_key:"tilingViewerLayer",ref:u,id:"tilingViewerImgListWps",class:"tilingViewerImgListWps",style:{width:"100%"}},null,512)]),(0,s.bo)((0,s.Lk)("img",{id:"background-image",src:C.value,class:"background-image"},null,8,jk),[[l.aG,k.value&&!h.value]]),k.value?(0,s.Q3)("",!0):((0,s.uX)(),(0,s.CE)("div",Qk,[(0,s.Lk)("p",qk,[(0,s.bF)(a,{icon:["fas","arrow-pointer"]})]),t[0]||(t[0]=(0,s.Lk)("span",null,"Please select an class image.",-1))]))],2),R.value?((0,s.uX)(),(0,s.Wv)(Eb,{key:0,message:R.value,messageType:L.value,duration:1500,position:"bottom-right"},null,8,["message","messageType"])):(0,s.Q3)("",!0)],64)}}});const zk=Jk;var Zk=zk;const eS={key:0,class:"loaderBackground"},tS={class:"wbcInfoDbUl"},aS=["onClick","onDrop"],lS=["title"],sS={key:0},oS={class:"mt10"},nS=["onInput","checked"],iS={class:"smallName"},rS=["onDrop"],cS=["onClick","onDblclick","onContextmenu"],uS={class:"pos-relative"},dS={key:0,class:"titleImg"},mS=["onClick","src","width","height","onDragstart","onError","onLoad"],vS={key:2,class:"divCompare"},pS={class:"divCompareChild"},gS=["value"],fS={class:"cellImgBox"},yS={class:"mt10"},bS=["checked"],IS={class:"smallName"},CS=["onClick","onDblclick","onContextmenu"],hS={style:{position:"relative"}},kS={key:0,class:"titleImg"},SS=["src","width","height","onDragstart","onError"],wS={class:"divCompareChild"},NS=["value"],RS={class:"cellImgBox"},LS={class:"mt10"},ES=["checked"],_S={class:"smallName"},PS=["onClick","onDblclick","onContextmenu"],TS={style:{position:"relative"}},AS={key:0,class:"titleImg"},MS=["src","width","height","onDragstart","onError"];var DS=(0,s.pM)({__name:"ImageGallery",props:{wbcInfo:{},updateWbcInfo:{type:Function},classCompareShow:{type:Boolean},selectedTitle:{},hiddenImages:{},setRef:{type:Function},replaceFileNamePrefix:{type:Function},onDragOver:{type:Function},isBorderChanged:{type:Function},isSelected:{type:Function},totalCount:{},wbcReset:{type:Boolean},slotId:{},iaRootPath:{},projectTypeReturn:{},projectType:{},apiBaseUrl:{},wbcInfoRefresh:{},imageSize:{},wpsShow:{type:Boolean},selectItems:{},isAllClassesChecked:{type:Boolean}},setup(e,{expose:t,emit:a}){const i=(0,o.KR)([]),r=(0,c.Pj)(),u=(0,s.EW)((()=>r.state.commonModule.siteCd)),d=(0,o.KR)(null),m=(0,o.KR)({}),v=(0,o.KR)(0),p=(0,o.KR)(0),g=(0,o.KR)({}),f=(0,o.KR)([]),y=(0,o.KR)(!0),b=(0,o.KR)(null),I=(0,o.KR)(""),C=(0,o.KR)(U.TOAST_MSG_SUCCESS),h=(0,o.KR)(null),k=e=>{const t=i.value[e];t&&t.scrollIntoView({behavior:"smooth"})};t({scrollToElement:k});const S=e,w=a,N=(0,o.KR)([]),{wbcInfo:R}=(0,o.QW)(S),L=(0,o.KR)("Metamyelocyte"),E=(0,o.KR)("Myelocyte"),_=(0,o.KR)("Metamyelocyte"),P=(0,o.KR)("Myelocyte"),T=(0,o.KR)({...S.hiddenImages}),A=(0,o.KR)({});(0,s.wB)(S.hiddenImages,(e=>{T.value={...e},y.value=!1})),(0,s.wB)((()=>S.selectItems),(e=>{const t=oc(e.wbcInfoAfter)?e.wbcInfoAfwbcInfo.wbcInfo[0]:e.wbcInfoAfter;O(t)}));const M=(0,Yk.debounce)((async e=>{const t=Date.now();y.value=!1,N.value=[],N.value=Nb(e).map(((e,a)=>({...e,uniqueKey:`item_${a}_${t}`,images:e.images.map(((e,l)=>({...e,uniqueKey:`image_${a}_${l}_${t}`})))||[]}))),await X("first",null),await X("last",null)}),10);(0,s.wB)(R,M,{deep:!0}),(0,s.wB)((()=>S.wbcReset),(async e=>{if(e){if(S.wbcInfoRefresh)return;N.value=[],await(0,s.dY)(),N.value=S.wbcInfo.map(((e,t)=>({...e,uniqueKey:`item_${t}_${Date.now()}`,images:e.images.map(((e,a)=>({...e,uniqueKey:`image_${t}_${a}_${Date.now()}`})))||[]}))),await(0,s.dY)(),X("first",null),X("last",null)}}));const D=()=>{if(!h.value)return;const e=h.value.scrollTop+h.value.clientHeight>=h.value.scrollHeight;e&&!S.isAllClassesChecked&&w("allClassesChecked")},x=(e,t)=>{A.value={item:t,img:e}},O=e=>{oc(e)||(L.value=e.find((e=>e.images.length>0)).name,E.value=e.find((e=>e.images.length>0&&e.name!==L.value)).name,_.value=L.value,P.value=E.value)},K=e=>{w("update:cellRef",d),X("first",null),X("last",null),f.value=S.wbcInfo.filter((e=>"0006"!==u.value&&"SM"!==e?.title)),e===S.wbcInfo.length-1||e<S.wbcInfo.length-1?y.value=!1:y.value=!0};function B(e,t,a,l,s){if(!R.value||0===R.value.length)return"";const o=S.slotId||"",n=`${S.iaRootPath}/${o}/${S.projectTypeReturn}/${t}_${a}`;let i="";return i="getImageRealTime"===l||"pb"===S.projectType?`${S.apiBaseUrl}/images/getImageRealTime?folder=${n}&imageName=${e}`:`${S.apiBaseUrl}/images?folder=${n}&imageName=${e}`,i}const F=e=>t=>{t&&(i.value[e]=t)},X=async(e,t)=>{const a=(e,a,l,s)=>{if(L.value===E.value)return e.value=a.value,C.value=U.TOAST_MSG_ERROR,void $("Class already selected.");a.value=t?t.target.value:e.value,l.value=S.wbcInfo.find((t=>t?.name===e.value)),s.value=S.wbcInfo.findIndex((t=>t?.name===e.value))};"first"===e?a(L,_,m,v):a(E,P,g,p),"0"===S.totalCount&&(y.value=!1)},$=e=>{I.value=e,setTimeout((()=>{I.value=""}),1500)};return(e,t)=>{const a=(0,s.g2)("font-awesome-icon");return(0,s.uX)(),(0,s.CE)(s.FK,null,[y.value?((0,s.uX)(),(0,s.CE)("div",eS,t[16]||(t[16]=[(0,s.Lk)("div",{class:"loader"},null,-1),(0,s.Lk)("p",{class:"loadingText"},"Loading...",-1)]))):(0,s.Q3)("",!0),(0,s.Lk)("ul",tS,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(N.value,(a=>((0,s.uX)(),(0,s.CE)(s.FK,{key:a.id},["0006"!==u.value&&"SM"!==a?.title?((0,s.uX)(),(0,s.CE)("li",{key:0,onClick:e=>k(a.id),onDragover:t[0]||(t[0]=(0,l.D$)((t=>e.$emit("onDragOverCircle")),["prevent"])),onDrop:t=>e.$emit("onDropCircle",a)},[(0,s.Lk)("div",{class:"circle",title:a.name},[(0,s.Lk)("p",null,(0,n.v_)(a?.title),1),(0,s.Lk)("p",null,(0,n.v_)(a?.count),1)],8,lS)],40,aS)):(0,s.Q3)("",!0)],64)))),128))]),e.classCompareShow?e.classCompareShow?((0,s.uX)(),(0,s.CE)("div",vS,[(0,s.Lk)("div",pS,[(0,s.bo)((0,s.Lk)("select",{"onUpdate:modelValue":t[4]||(t[4]=e=>L.value=e),onChange:t[5]||(t[5]=e=>X("first",e))},[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(f.value,(e=>((0,s.uX)(),(0,s.CE)("option",{key:e.id,value:e.name},(0,n.v_)(e?.name),9,gS)))),128))],544),[[l.u1,L.value]]),(0,s.Lk)("ul",fS,[(0,s.Lk)("li",null,[(0,s.Lk)("div",null,[(0,s.Lk)("p",yS,[(0,s.Lk)("input",{type:"checkbox",onInput:t[6]||(t[6]=t=>e.$emit("allCheckChange",t,m.value?.title)),checked:e.selectedTitle===m.value?.title},null,40,bS),(0,s.Lk)("label",null,[(0,s.eW)((0,n.v_)(m.value?.title)+" ",1),(0,s.Lk)("span",IS,"("+(0,n.v_)(m.value.name)+")",1),(0,s.eW)(" ("+(0,n.v_)(m.value?.count)+") ",1)])])]),(0,s.Lk)("ul",{class:(0,n.C4)("wbcImgWrap "+m.value?.title),onDragover:t[8]||(t[8]=(0,l.D$)(((...t)=>e.onDragOver&&e.onDragOver(...t)),["prevent"])),onDrop:t[9]||(t[9]=()=>e.$emit("onDrop",v.value))},[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(m.value.images,((o,i)=>((0,s.uX)(),(0,s.CE)(s.FK,{key:o?.fileName},[o&&!T.value[`${m.value.id}-${o.fileName}`]?((0,s.uX)(),(0,s.CE)("li",{key:0,class:(0,n.C4)({"border-changed":e.isBorderChanged(o),"selected-image":e.isSelected(o),wbcImgWrapLi:!0}),onClick:()=>e.$emit("selectImage",v.value,i,m.value),onDblclick:()=>e.$emit("openModal",o,m.value),onContextmenu:(0,l.D$)((t=>e.$emit("handleRightClick",t,o,m.value)),["prevent"])},[(0,s.Lk)("div",hS,[o?(0,s.bo)(((0,s.uX)(),(0,s.CE)("div",kS,[(0,s.Lk)("div",{class:"fileTitle",style:(0,n.Tr)({fontSize:e.imageSize?parseInt(e.imageSize)/6+"px":"15px"})},[(0,s.eW)((0,n.v_)(e.replaceFileNamePrefix(o.fileName))+" ",1),(0,s.bF)(a,{icon:["fas","arrow-right"]}),(0,s.eW)(" "+(0,n.v_)(o.title),1)],4)],512)),[[l.aG,e.replaceFileNamePrefix(o.fileName)!==m.value?.title]]):(0,s.Q3)("",!0),o&&o.fileName&&!T.value[`${m.value.id}-${o.fileName}`]?((0,s.uX)(),(0,s.CE)("img",{key:1,src:B(o.fileName,m.value.id,m.value.title,""),width:e.imageSize,height:e.imageSize,style:(0,n.Tr)({filter:o.filter}),onDragstart:()=>e.$emit("onDragStart",v.value,i),draggable:"true",class:"cellImg",ref_for:!0,ref_key:"cellRef",ref:d,onError:()=>e.$emit("hideImage",m.value.id,o.fileName,m.value.title),onLoad:t[7]||(t[7]=e=>K(v.value))},null,44,SS)):(0,s.Q3)("",!0),o&&o.coordinates?((0,s.uX)(),(0,s.CE)("div",{key:2,class:"center-point",style:(0,n.Tr)(o.coordinates)},null,4)):(0,s.Q3)("",!0)])],42,CS)):(0,s.Q3)("",!0)],64)))),128))],34)])])]),(0,s.Lk)("div",wS,[(0,s.bo)((0,s.Lk)("select",{"onUpdate:modelValue":t[10]||(t[10]=e=>E.value=e),onChange:t[11]||(t[11]=e=>X("last",e))},[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(f.value,(e=>((0,s.uX)(),(0,s.CE)("option",{key:e.id,value:e.name},(0,n.v_)(e?.name),9,NS)))),128))],544),[[l.u1,E.value]]),(0,s.Lk)("ul",RS,[(0,s.Lk)("li",null,[(0,s.Lk)("div",null,[(0,s.Lk)("p",LS,[(0,s.Lk)("input",{type:"checkbox",onInput:t[12]||(t[12]=t=>e.$emit("allCheckChange",t,g.value?.title)),checked:e.selectedTitle===g.value?.title},null,40,ES),(0,s.eW)(" "+(0,n.v_)(g.value?.title)+" ",1),(0,s.Lk)("span",_S,"("+(0,n.v_)(g.value.name)+")",1),(0,s.eW)(" ("+(0,n.v_)(g.value?.count)+") ",1)])]),(0,s.Lk)("ul",{class:(0,n.C4)("wbcImgWrap "+g.value?.title),onDragover:t[14]||(t[14]=(0,l.D$)(((...t)=>e.onDragOver&&e.onDragOver(...t)),["prevent"])),onDrop:t[15]||(t[15]=()=>e.$emit("onDrop",p.value))},[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(g.value.images,((o,i)=>((0,s.uX)(),(0,s.CE)(s.FK,{key:o?.fileName},[o&&!T.value[`${g.value.id}-${o.fileName}`]?((0,s.uX)(),(0,s.CE)("li",{key:0,class:(0,n.C4)({"border-changed":e.isBorderChanged(o),"selected-image":e.isSelected(o),wbcImgWrapLi:!0}),onClick:()=>e.$emit("selectImage",p.value,i,g.value),onDblclick:()=>e.$emit("openModal",o,g.value),onContextmenu:(0,l.D$)((t=>e.$emit("handleRightClick",t,o,g.value)),["prevent"])},[(0,s.Lk)("div",TS,[o?(0,s.bo)(((0,s.uX)(),(0,s.CE)("div",AS,[(0,s.Lk)("div",{class:"fileTitle",style:(0,n.Tr)({fontSize:e.imageSize?parseInt(e.imageSize)/6+"px":"15px"})},[(0,s.eW)((0,n.v_)(e.replaceFileNamePrefix(o.fileName))+" ",1),(0,s.bF)(a,{icon:["fas","arrow-right"]}),(0,s.eW)(" "+(0,n.v_)(o.title),1)],4)],512)),[[l.aG,e.replaceFileNamePrefix(o.fileName)!==g.value?.title]]):(0,s.Q3)("",!0),o&&o.fileName&&!T.value[`${g.value.id}-${o.fileName}`]?((0,s.uX)(),(0,s.CE)("img",{key:1,src:B(o.fileName,g.value.id,g.value.title,""),width:e.imageSize,height:e.imageSize,style:(0,n.Tr)({filter:o.filter}),onDragstart:()=>e.$emit("onDragStart",p.value,i),draggable:"true",class:"cellImg",ref_for:!0,ref_key:"cellRef",ref:d,onError:()=>e.$emit("hideImage",g.value.id,o.fileName,g.value.title),onLoad:t[13]||(t[13]=e=>K(p.value))},null,44,MS)):(0,s.Q3)("",!0),o&&o.coordinates?((0,s.uX)(),(0,s.CE)("div",{key:2,class:"center-point",style:(0,n.Tr)(o.coordinates)},null,4)):(0,s.Q3)("",!0)])],42,PS)):(0,s.Q3)("",!0)],64)))),128))],34)])])])])):(0,s.Q3)("",!0):((0,s.uX)(),(0,s.CE)(s.FK,{key:1},[(0,s.Lk)("ul",{class:(0,n.C4)({wpsDiv:e.wpsShow,cellImgBox:!0}),ref_key:"scrollContainer",ref:h,onScroll:D},[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(N.value,((o,i)=>((0,s.uX)(),(0,s.CE)("li",{key:o.id,ref_for:!0,ref:F(o.id)},["0"!==o?.count&&0!==o?.count?((0,s.uX)(),(0,s.CE)("div",sS,[(0,s.Lk)("p",oS,[(0,s.Lk)("input",{type:"checkbox",onInput:t=>e.$emit("allCheckChange",t,o.title),checked:e.selectedTitle===o.title},null,40,nS),(0,s.eW)(" "+(0,n.v_)(o?.title)+" ",1),(0,s.Lk)("span",iS,"("+(0,n.v_)(o.name)+")",1),(0,s.eW)(" ("+(0,n.v_)(o?.count)+") ",1)])])):(0,s.Q3)("",!0),"0"!==o?.count&&0!==o?.count&&o.images?((0,s.uX)(),(0,s.CE)("ul",{key:1,class:(0,n.C4)("wbcImgWrap "+o?.title),onDragover:t[1]||(t[1]=(0,l.D$)(((...t)=>e.onDragOver&&e.onDragOver(...t)),["prevent"])),onDrop:()=>e.$emit("onDrop",i)},[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(o.images,((t,r)=>((0,s.uX)(),(0,s.CE)(s.FK,{key:t.uniqueKey},[t.uniqueKey&&!T.value[`${o.id}-${t.fileName}`]?((0,s.uX)(),(0,s.CE)("li",{key:0,class:(0,n.C4)({"border-changed":e.isBorderChanged(t),"selected-image":e.isSelected(t),wbcImgWrapLi:!0}),ref_for:!0,ref_key:"clickableItem",ref:b,onClick:()=>e.$emit("selectImage",i,r,o),onDblclick:()=>e.$emit("openModal",t,o),onContextmenu:(0,l.D$)((a=>e.$emit("handleRightClick",a,t,o)),["prevent"])},[(0,s.Lk)("div",uS,[t?(0,s.bo)(((0,s.uX)(),(0,s.CE)("div",dS,[(0,s.Lk)("div",{class:"fileTitle",style:(0,n.Tr)({fontSize:e.imageSize?parseInt(e.imageSize)/6+"px":"15px"})},[(0,s.eW)((0,n.v_)(e.replaceFileNamePrefix(t.fileName))+" ",1),(0,s.bF)(a,{icon:["fas","arrow-right"]}),(0,s.eW)(" "+(0,n.v_)(t.title),1)],4)],512)),[[l.aG,e.replaceFileNamePrefix(t.fileName)!==o?.title]]):(0,s.Q3)("",!0),t&&t.fileName&&!T.value[`${o.id}-${t.fileName}`]?((0,s.uX)(),(0,s.CE)("img",{onClick:e=>x(t,o),key:t.uniqueKey,src:B(t.fileName,o.id,o.title,""),width:e.imageSize,height:e.imageSize,style:(0,n.Tr)({filter:t.filter}),onDragstart:()=>e.$emit("onDragStart",i,r),draggable:"true",class:"cellImg",ref_for:!0,ref_key:"cellRef",ref:d,onError:()=>e.$emit("hideImage",o.id,t.fileName,o.title),onLoad:e=>K(i)},null,44,mS)):(0,s.Q3)("",!0),t&&t.coordinates?((0,s.uX)(),(0,s.CE)("div",{key:2,class:"center-point",style:(0,n.Tr)(t.coordinates)},null,4)):(0,s.Q3)("",!0)])],42,cS)):(0,s.Q3)("",!0)],64)))),128))],42,rS)):(0,s.Q3)("",!0)])))),128))],34),e.wpsShow?((0,s.uX)(),(0,s.Wv)(Zk,{key:0,wpsImgClickInfoData:A.value,slotId:e.slotId,selectItems:e.selectItems,iaRootPath:e.iaRootPath,onBorderDel:t[2]||(t[2]=()=>e.$emit("borderDel")),onBorderOn:t[3]||(t[3]=()=>e.$emit("borderOn"))},null,8,["wpsImgClickInfoData","slotId","selectItems","iaRootPath"])):(0,s.Q3)("",!0)],64)),I.value?((0,s.uX)(),(0,s.Wv)(Eb,{key:3,message:I.value,messageType:C.value,duration:1500,position:"bottom-right"},null,8,["message","messageType"])):(0,s.Q3)("",!0)],64)}}});const xS=DS;var OS=xS;const KS=(e,t)=>{let a=0,l=0;const s={isNormal:"Y",classInfo:[]};return e&&(e.forEach((e=>{-1===["NR","AR","GP","PA","MC","MA"].indexOf(e.title)&&(a+=Number(e.count)),["NE","NS","NB"].includes(e.title)&&(l+=Number(e.count))})),e.forEach((e=>{t.forEach((t=>{if("01"===t.classId){let o=0;["01","71"].includes(e.id)&&(o=l/a*100,(o<t.min||o>t.max)&&(s.isNormal="N",s.classInfo.push({classNm:"NE",val:`[${o.toFixed(2)}] %`})))}else if(e.id===t.classId)if("Count"===t.unit)(Number(e.count)<t.min||Number(e.count)>t.max)&&(s.isNormal="N",s.classInfo.push({classNm:`${e.title}`,val:`[${e.count}] Count`}));else{let l=0;l=Number(e.count)/a*100,(l<t.min||l>t.max)&&(s.isNormal="N",s.classInfo.push({classNm:`${e.title}`,val:`[${l.toFixed(2)}] %`}))}}))}))),s};const BS=async({barcodeNo:e,siteCd:t,userId:a,deviceSerialNm:l,imageDriveRootPath:s,slotId:o})=>{const n=await _p();if(n&&""!==n)switch(t){case I["SD의학연구소"]:return await FS({barcodeNo:e,cbcFilePathSetArr:n,imageDriveRootPath:s,slotId:o});default:return}},FS=async({barcodeNo:e,imageDriveRootPath:t,cbcFilePathSetArr:a,slotId:l})=>{const s={directoryPath:`${a}`,keyword:e};let o="",n="";const i=await vp(s);if("NoFile"===i.data){const a=`directoryPath=${t}\\${l}&searchString=${e}`;try{const e=await pp(a);e.data&&Array.isArray(e.data)&&e.data.length>0&&(o=e.data[0].split(".")[0])}catch(c){console.error("Error fetching file list:",c)}n=`${t}\\${l}`}else o=e,n=a;const r=await _o(`path=${n}&filename=${o}`);if(r.data.success){const e=await Po(r.data.data);let t="";for(const a of e?.data?.segments)if("PID"===a.name.trim()){t=a.fields[4].value[0][0].value[0]||"";break}return{cbcPatientNm:t}}console.error(r.data.message)},US={class:"moveImgIsBool"},XS={class:"wbcContent"},$S={class:"imgMenuSetDiv"},WS={class:"sizeContainer"},HS={class:"customImgSet size"},GS=["value"],YS={class:"imgSetWrap",ref:"imgSetWrap"},VS={class:"imgSet"},jS={class:"customImgSet"},QS={class:"customImgSet rgb"},qS={class:"flex-align-center"},JS={class:"flex-align-center"},zS={class:"flex-align-center"},ZS=["onClick"],ew={class:"wbcModalImageContent"},tw=["src"],aw={class:"buttons"},lw={class:"rangeBox"};var sw=(0,s.pM)({__name:"listDetail",setup(e){const t=(0,o.KR)(""),a=(0,o.KR)(null),i=(0,o.KR)(null),r=(0,o.KR)(null),u=(0,c.Pj)(),d=(0,o.KR)(""),m=(0,s.EW)((()=>u.state.userModule)),v=(0,s.EW)((()=>u.state.commonModule.cbcLayer)),p=(0,s.EW)((()=>u.state.commonModule.moveImgIsBool)),g=(0,s.EW)((()=>u.state.commonModule.classInfoSort)),b=(0,o.KR)(u.state.commonModule.iaRootPath),C=(0,s.EW)((()=>u.state.commonModule.siteCd)),h=(0,s.EW)((()=>u.state.commonModule.deviceSerialNm)),k=(0,s.EW)((()=>u.state.commonModule.iaRootPath)),S=(0,o.KR)(null),w=(0,o.KR)(null),N=(0,o.KR)(!1),R=(0,o.KR)(!1),L=(0,o.KR)(null),E=(0,o.KR)(!1),_=(0,o.KR)(null),P=(0,o.KR)([]),T=(0,o.KR)(null),A=(0,o.KR)([]),M=(0,o.KR)([]),D=[],x=(0,o.KR)(150),O=(0,o.KR)(100),K=(0,o.KR)([0,0,0]),B=(0,o.KR)("ME"),F=(0,o.KR)(""),X=(0,o.KR)(null),$=(0,o.KR)(!1),W=(0,o.KR)(!1),H=(0,o.KR)(""),G=(0,o.KR)("200px"),Y=(0,o.KR)("200px"),V=(0,o.KR)(!1),j="viewer"===sessionStorage.getItem("viewerCheck")?window.MAIN_API_IP:window.APP_API_BASE_URL,Q=(0,o.KR)([]),q=(0,o.KR)([]),J=(0,o.KR)([]),z=((0,s.nI)(),(0,o.KR)("")),Z=(0,o.KR)("0.9"),ee=(0,o.KR)(200),te=(0,o.KR)([]),ae=(0,o.KR)([]),le=(0,o.KR)([]),se=(0,o.KR)(!1),oe=(0,o.KR)({}),ne=(0,o.KR)(!1),ie=(0,o.KR)(0),re=(0,o.KR)(0),ce=(0,o.KR)(null),de=(0,o.KR)(!1),me=(0,o.KR)(!1),pe=(0,o.KR)(!1),ge=(0,o.KR)(!0),fe=(0,o.KR)(null),ye=(0,o.KR)(!1),be=(0,o.KR)(""),Ce=(0,o.KR)(""),he=(0,o.KR)(!1),ke=(0,o.KR)(!0),Se=(0,o.KR)(!1),we=(0,o.KR)(!1),Ne=(0,o.KR)(""),Re=(0,o.KR)(U.TOAST_MSG_SUCCESS),Le=(0,o.KR)(!1),Ee=(0,o.KR)([]),_e=(0,s.EW)((()=>u.state.slideDataModule)),Pe=(0,o.KR)(""),Te=(0,o.KR)(""),Ae=(0,o.KR)(""),Me=(0,o.KR)(!1);(0,s.KC)((async()=>{ge.value=!1,ke.value=!1,z.value=window.PROJECT_TYPE,ke.value=!1,E.value=!1})),(0,s.sV)((async()=>{window.addEventListener("keydown",At),window.addEventListener("keyup",Dt),document.body.addEventListener("click",Tt),document.addEventListener("click",ze)})),(0,s.hi)((async()=>{document.addEventListener("click",ze)})),(0,s.wB)((()=>_e.value),(async(e,t)=>{if(e.id!==t?.id){await(0,s.dY)(),"bm"!==z.value?await Oe(e):Se.value=!1;try{await sa(),await Fe(e),ke.value=!1,a.value=[],ke.value=!0,await lt(!1,null),E.value=!0,await Ye(),$.value=!1,await gt(!0)}catch(l){console.error("비동기 작업 중 에러 발생:",l)}}}),{immediate:!0,deep:!0}),(0,s.wB)(O,(e=>{localStorage.setItem("imgBrightness",String(e))})),(0,s.wB)(x,(e=>{localStorage.setItem("imageSize",String(e))})),(0,s.wB)(K,(e=>{const t=e[0],a=e[1],l=e[2];localStorage.setItem("imageRgb",JSON.stringify([t,a,l]))}),{deep:!0}),(0,s.wB)((()=>p.value),(e=>{e?cn():un()}));const De=()=>{we.value=!0},xe=()=>{we.value=!1},Oe=async e=>{const t=`${b.value}/${e?.slotId}/04_WPS`,a=`folderPath=${t}`,l=await Ip(a);400!==l?.code?Se.value=!0:(Se.value=!1,pe.value=!1)},Ke=e=>{Ne.value=e,setTimeout((()=>{Ne.value=""}),1500)},Be=()=>{const e=ee.value;G.value=`${e}px`,Y.value=`${e}px`},Fe=async e=>{try{Me.value=e.value?.isAllClassesChecked,b.value=""!==e?.img_drive_root_path&&null!==e?.img_drive_root_path&&e?.img_drive_root_path?e?.img_drive_root_path:u.state.commonModule.iaRootPath,Te.value=e?.patientNm,Ae.value=e?.cbcPatientNm,r.value=e}catch(t){console.error(t)}},Ue=e=>{X.value=e.value},Xe=()=>{me.value=!me.value},$e=()=>{pe.value=!pe.value,pe.value||(we.value=!1),me.value&&(Re.value=U.TOAST_MSG_ERROR,Ke("When classCompare is enabled, WPS cannot be checked."),pe.value=!1)},We=e=>Math.floor((e-50)/240*170+30)+"%",Ge=e=>Math.floor(240*(e-30)/170+50),Ye=async()=>{const e=localStorage.getItem("imgBrightness"),t=localStorage.getItem("imageRgb"),l=localStorage.getItem("imageSize");t&&(K.value=JSON.parse(t)),e&&(O.value=Number(e)),l&&(x.value=Number(l));const s=K.value[0],o=K.value[1],n=K.value[2];a.value.forEach((e=>{e.images.forEach((e=>{e.filter=`opacity(0.9) drop-shadow(0 0 0 rgb(${s}, ${o}, ${n})) brightness(${O.value}%)`,e.width=Number(x.value),e.height=Number(x.value)}))}))},Ve=()=>{de.value=!0},je=()=>{de.value=!1},Qe=(e,t,a)=>{e.preventDefault(),Ze(e,a)};function qe(e,t,a){oe.value[`${e}-${t}`]=!0}const Je=()=>{se.value=!se.value},ze=e=>{e.target.closest(".imgSetWrap")||(V.value=!1,t.value=""),e.target.closest(".sizeContainer, .sizeButton")||(se.value=!1)};document.addEventListener("click",(e=>{ne.value&&(ne.value=!1)}));const Ze=(e,t)=>{const a=506,l=window.innerHeight,s=e.clientX,o=e.clientY;ne.value=!0;let n=s,i=o;i=o+a>l?o-a:o;const r=200;n+r>window.innerWidth&&(n=window.innerWidth-r),ie.value=n,re.value=i,ce.value=t},et=async(e,t)=>{if(!A.value||0===Object.entries(A.value).length)return ye.value=!0,be.value="error",void(Ce.value="Please select an image");const l=a.value.find((t=>t.id===e.id));if(ce.value.title===l.title)return ye.value=!0,be.value="error",void(Ce.value="Transfer to different classes is the only option available.");await Et();const s=a.value[t];if(ce.value){const t=a.value.findIndex((t=>t.id===e.id));await Wt(t,A.value,s,a.value[t],!1,"",a.value),ne.value=!1}ne.value=!1},tt=e=>"Smudge"===e&&C.value!==I["고대안암병원"]?"":e,at=async(e,t)=>{let a=e.slice();a.sort(((e,a)=>{const l=t.findIndex((t=>(t.title||t.abbreviation)===(e.title||e.abbreviation))),s=t.findIndex((e=>(e.title||e.abbreviation)===(a.title||a.abbreviation)));return-1===l?1:-1===s?-1:l-s})),e.splice(0,e.length,...a)},lt=async(e,t)=>{const l=await va();Pe.value=l.data,a.value=[];try{const l=await ue(),s=l.data,o=s.filter((e=>e.abbreviation)),n=sessionStorage.getItem("customClass"),i=JSON.parse(n);i&&i.forEach((e=>{const t=s.find((t=>t.customNum===e.customNum&&t.abbreviation!==e.abbreviation));if(t){if(""===e?.abbreviation)return;const t=`${b.value}/${r.value?.slotId}/${ta(z.value)}/${e.customNum}_${e?.abbreviation}`;gp({path:t})}})),sessionStorage.setItem("customClass",JSON.stringify(s)),Q.value=s;let c=0!==r.value?.wbcInfoAfter.length?r.value?.wbcInfoAfter:r.value?.wbcInfo.wbcInfo[0];if(0!==o.length)for(const e of o){const{fullNm:t,abbreviation:l,customNum:s}=e,o=`${b.value}/${r.value?.slotId}/${ta(z.value)}/${s}_${l}`;await up({path:o});const n={id:s,name:t,count:"0",images:[],title:l},i=c.find((e=>e.id==n.id&&e.name===n.name));i||(c.push(n),a.value=c,await Vt("notWbcAfterSave"))}else{const e=[],t="bm"===window.PROJECT_TYPE?za:Ja;c.forEach((a=>{const l=t.find((e=>e.id===a.id));if(!l){const t=`${b.value}/${r.value?.slotId}/${ta(z.value)}/${a}_${a?.title}`;gp({path:t}),e.push(a)}})),e.forEach((e=>{const t=c.indexOf(e);t>-1&&c.splice(t,1)})),r.value.wbcInfoAfter=c,a.value=r.value.wbcInfoAfter,await Vt()}await st(),await Ot(),await xt(o,e,t)}catch(s){console.error(s)}},st=async()=>{try{const e=await ve();e&&e?.data&&(q.value=e.data)}catch(e){console.error(e)}};function ot(e){const t=e.fileName.split("_")[0],a=r.value.wbcInfoAfter.find((e=>"NE"===e.title)),l={NES:a?"NE":"NS",NEB:"NB"},s=Object.keys(l).reduce(((e,t)=>e.replace(t,l[t])),t);return e.title!==s}function nt(e){const t=r.value.wbcInfoAfter.find((e=>"NE"===e.title)),a={NES:t?"NE":"NS",NEB:t?"NE":"NB"},l=e.split("_")[0],s=Object.keys(a).reduce(((e,t)=>e.replace(t,a[t])),l);return s}const it=(e,t)=>{W.value=!0,H.value=qt(e.fileName,t.id,t.title,"getImageRealTime")},rt=()=>{W.value=!1},ct=e=>{e.target.classList.contains("wbc-modal-content")&&(W.value=!1)},ut=e=>{e.deltaY<0?mt():vt()},dt=()=>{V.value=!V.value},mt=()=>{let e=Math.min(parseFloat(G.value)+50,600),t=Math.min(parseFloat(Y.value)+50,600);G.value=`${e}px`,Y.value=`${t}px`,ee.value=Number(e)},vt=()=>{let e=Math.max(parseFloat(G.value)-50,200),t=Math.max(parseFloat(Y.value)-50,200);G.value=`${e}px`,Y.value=`${t}px`,ee.value=Number(e)};(0,s.wB)(m.value,((e,t)=>{d.value=e.id})),(0,s.wB)((()=>g.value),(async e=>{E.value=!0,await Ot();const t=0!==le.value.length?le.value:"bm"===window.PROJECT_TYPE?el:Za;await at(a.value,t)}));const pt=async e=>{ke.value=!1,$.value=!1,await Fe(e),ke.value=!0,await gt(!0),me.value=!1,r.value=e,b.value=""!==r.value?.img_drive_root_path&&r.value?.img_drive_root_path?r.value?.img_drive_root_path:u.state.commonModule.iaRootPath,await lt(!0,e),await Ye(),await(0,s.dY)(),"bm"!==z.value?await Oe(e):Se.value=!1},gt=async e=>{if(e||($.value=!$.value),$.value){let e="";"pb"===z.value?e=`${b.value}/${r.value?.slotId}/${"01"===r.value.testType||"04"===r.value?.testType?"01_WBC_Classification":"05_BF_Classification"}/${r.value?.slotId}.json`:"bm"===z.value&&(e=`${b.value}/${r.value?.slotId}/${ta(z.value)}/${r.value?.slotId}.json`);const t=await Ro({fullPath:e});if(t&&t.success){const e=t.data;a.value.forEach((t=>{0!==t.images.length&&t.images.forEach((t=>{const a=X.value,l=e.find((e=>e?.FILE_NM===t?.fileName));if(l){const e=(a[0]?.width||150)/Number(l.ORG_WIDTH)*100,s=(a[0]?.height||150)/Number(l.ORG_HEIGHT)*100,o=(Number(l.POSX2)-Number(l.POSX1))*(e/100),n=(Number(l.POSY2)-Number(l.POSY1))*(s/100),i=a[0]?.offsetLeft+Number(l.POSX1)*(e/100)+o/2+"px",r=a[0]?.offsetTop+Number(l.POSY1)*(s/100)+n/2+"px";t.coordinates={position:"absolute",left:i,top:r,width:"5px",height:"5px",background:"#10ff00"}}}))}))}}else a.value.forEach((e=>{e.images.forEach((e=>{e.coordinates={display:"none"}}))}))},ft=(e,a)=>{F.value=e?.target?.checked?a:"",t.value=e?.target?.checked?a:"",yt()},yt=()=>{A.value=[],te.value=[],ae.value=[];for(const e in a.value)if(F.value===a.value[e].title)for(const t in a.value[e].images){const l={id:a.value[e].id,title:a.value[e].title,...a.value[e].images[t]};A.value.push(l),te.value.push(l)}},bt=e=>{fe.value&&fe.value.scrollToElement(e)};function It(){K.value=[0,0,0],Z.value="0.9",kt("reset")}function Ct(){gt(!0),x.value=150,a.value.forEach((e=>{e.images.forEach((e=>{e.width=150,e.height=150}))}))}function ht(){O.value=100,Z.value="0.9",kt("reset")}function kt(e){const t=B.value;if(!t)return void It();"reset"!==e&&(Z.value="0.9");const l=K.value[0],s=K.value[1],o=K.value[2];a.value.forEach((e=>{e.images.forEach((e=>{e.filter=`opacity(${Z.value}) drop-shadow(0 0 0 rgb(${l}, ${s}, ${o})) brightness(${O.value}%)`}))}))}function St(e){const t=K.value[0],l=K.value[1],s=K.value[2],o=e?.target?.value;a.value.forEach((e=>{e.images.forEach((e=>{e.filter=`opacity(1) drop-shadow(0 0 0 rgb(${t}, ${l}, ${s})) brightness(${o}%)`}))}))}function wt(e){const t=Number(e?.target?.value);for(const l of a.value)for(const e of l.images)e.width=t,e.height=t;requestAnimationFrame((()=>gt(!0)))}const Nt=e=>{const t=e.target,a=parseFloat(t.value);isNaN(a)||(x.value=Ge(a+1)),requestAnimationFrame((()=>gt(!0)))},Rt=(0,s.EW)((()=>We(x.value).replace("%","")));function Lt(){}async function Et(){D.push(JSON.parse(JSON.stringify(a.value)))}async function _t(e){const t=a.value[_.value];if(e.id!==t.id)if(await Et(),0===A.value.length){const l=t.images[T.value];e.images.push(l);const s=JSON.parse(JSON.stringify(a.value)),o=s.findIndex((t=>t.id===e.id));-1!==o?s[o].images.push(l):console.error("일치하는 id를 가진 요소 없음"),await Wt(o,[{fileName:l.fileName}],a.value[_.value],s[o],!1)}else{const l=a.value.findIndex((t=>t.id===e.id));await Wt(l,A.value,t,a.value[l],!1,"",a.value)}}function Tt(e){const t=e.target;t.closest(".wbcImgWrapLi")||t.closest(".context-menu")||"openseadragon-canvas"===t.className||(A.value=[],M.value=[],te.value=[])}async function At(e){e.shiftKey&&(N.value=!0),e.ctrlKey&&(R.value=!0),"Escape"===e.key&&W&&(W.value=!1),"pb"===z.value?e.key&&("01"===r.value?.testType||"04"===r.value?.testType?q.value:J.value).some((t=>t.key.toUpperCase()===e.key.toUpperCase()))&&await Mt(("01"===r.value?.testType||"04"===r.value?.testType?q.value:J.value).find((t=>t.key.toUpperCase()===e.key.toUpperCase()))):"bm"===z.value&&e.key&&q.value.some((t=>t.key.toUpperCase()===e.key.toUpperCase()))&&await Mt(q.value.find((t=>t.key.toUpperCase()===e.key.toUpperCase())))}async function Mt(e){const t=a.value.findIndex((t=>(t.title||t.abbreviation)===(e.title||e.abbreviation))),l=A.value;await Et();const s=[];for(const o of l){const e=a.value.findIndex((e=>(e.title||e.abbreviation)===(o.title||o.abbreviation))),t=a.value[e],l=t.images.findIndex((e=>e.fileName===o.fileName));-1!==l&&s.push({fileName:o.fileName,id:o.id,title:o.title})}s.length>0&&await Wt(t,s,l,e,!0,"keyMove")}function Dt(e){e.shiftKey||(N.value=!1),e.ctrlKey||(R.value=!1)}async function xt(e,t,l){a.value=[];let s=[];t?(a.value=0!==l.wbcInfoAfter.length?l.wbcInfoAfter:l.wbcInfo.wbcInfo[0],s=l):(a.value=0!==r.value.wbcInfoAfter.length?r.value.wbcInfoAfter:r.value.wbcInfo.wbcInfo[0],s=r.value),s.wbcInfoAfter&&0!==s.wbcInfoAfter.length?(a.value=s.wbcInfoAfter,s.wbcInfo.wbcInfo[0].forEach((e=>{const t=e.title,a=s.wbcInfoAfter.find((e=>e.title===t));a&&a.images.forEach((e=>{e.title=t}))}))):(a.value=s.wbcInfo.wbcInfo[0],s.wbcInfo.wbcInfo[0].forEach((e=>{e.images&&e.images.length>0&&e.images.forEach((t=>{t.title=e.title}))}))),""!==e&&(s.wbcInfo.wbcInfo[0]=s.wbcInfo.wbcInfo[0].filter((t=>!e.find((e=>e.customNum===t.id&&""===e.abbreviation)))));const o=a.value.map((e=>e.id)),n=s.wbcInfo.wbcInfo[0].filter((e=>!o.includes(e.id)));a.value=[...a.value,...n];const i=le.value.sort(((e,t)=>Number(e.orderIdx)-Number(t.orderIdx))),c=0!==le.value.length?i:"bm"===window.PROJECT_TYPE?za:Ja;await at(a.value,c),await ea()}const Ot=async()=>{try{const e=await He();e&&(0===e?.data.length?le.value=[]:le.value=e.data.sort(((e,t)=>Number(e.orderIdx)-Number(t.orderIdx))))}catch(e){console.error(e)}};function Kt(){}function Bt(e,t){S.value=e,w.value=t,T.value=t,_.value=e,P.value.push(e)}function Ft(e,l,s){if(!we.value)if(N.value){if(null!==L.value){M.value.push(l);const o=Math.min(L.value,l),n=Math.max(L.value,l);A.value=[],te.value=[];for(let t=o;t<=n;t++)A.value.push({id:a.value[e].id,title:a.value[e].title,...a.value[e].images[t]}),te.value.push(s);te.value.length===n-o+1&&(t.value=a.value[0].title)}}else{L.value=l;const t=a.value[e].images[l];if(!R.value)return A.value=[],te.value=[],A.value.push({...t,id:a.value[e].id}),void te.value.push(s);const o=A.value.findIndex((e=>e.fileName===t.fileName));-1===o?(A.value.push({...t,id:a.value[e].id}),te.value.push(s)):(A.value.splice(o,1),te.value.splice(o,1))}}function Ut(e){const t=e.fileName;return A.value.some((e=>e.fileName===t))}async function Xt(e){if(await Et(),0===A.value.length)return await $t(e);await u.dispatch("commonModule/setCommonInfo",{moveImgIsBool:!0});const l=[],s=[],o=[];let n=!1,i="";for(const r of A.value){const n=r.fileName,c=a.value.findIndex((e=>e.images.some((e=>e.fileName===n))));if(-1===c){console.error(`Dragged item with image ${n} not found`);continue}const u=a.value[c];u.id!==a.value[e].id?(l.push({fileName:r.fileName}),s.push(u),o.push(a.value[e]),i=i||r.keyMove||""):t.value=""}l.length>0&&await Wt(e,l,s,o[0],n,i),await u.dispatch("commonModule/setCommonInfo",{moveImgIsBool:!1}),A.value=[],te.value=[],M.value=[]}async function $t(e){if(null!==S.value&&null!==w.value&&S.value!==e){const t=a.value[S.value],l=t.images[w.value];await Wt(e,[{fileName:l.fileName}],t,a.value[e],!1)}}async function Wt(e,l,s,o,n,i,c){E.value=!1;const{slotId:d}=r.value,m=l;let v=[],p=[],g=[],f=0;for(const t of m){const e=t.fileName;g.push(e);try{if("keyMove"===i){const e=o.id<10?`0${o.id}`:o.id,a="bm"===window.PROJECT_TYPE?za:Ja,l=a.find((e=>e.abbreviation===(t.title||t.abbreviation))),i=n?`${b.value}/${d}/${ta(z.value)}/${l?.id}_${t.title}`:`${b.value}/${d}/${ta(z.value)}/${l?.id}_${s[f].title}`,r=`${b.value}/${d}/${ta(z.value)}/${e}_${o.abbreviation}`;p.push(r),v.push(i)}else if(!c&&"keyMove"!==i){const e=s[f]?s[f]:s,a=n?`${b.value}/${d}/${ta(z.value)}/${t.id}_${t.title}`:`${b.value}/${d}/${ta(z.value)}/${e.id}_${e.title}`,l=`${b.value}/${d}/${ta(z.value)}/${o.id}_${o.title}`;p.push(l),v.push(a)}}catch(I){console.error("Error during image move:",I)}f++}const y={sourceFolders:v,destinationFolders:p,fileNames:g};try{const t=await Uf(y);if(await u.dispatch("commonModule/setCommonInfo",{moveImgIsBool:!0}),t){let t=0;for(const l of m){const o=l.fileName;if("keyMove"===i){const t=a.value.findIndex((e=>e.title===(l.title||l.abbreviation))),s=a.value[t],n=s.images.findIndex((e=>e.fileName===o));if(-1!==n){const t=s.images.splice(n,1)[0];t.title=a.value[e].title,t.width=x.value,t.height=x.value,t.imgBrightness=O.value,a.value[e].images.push(t),s.count--,a.value[e].count++}}else{let n=[];n=s[t]?s[t]:s;const i=n.images.findIndex((e=>e.fileName===o));-1!==i&&n.images.splice(i,1);const r=a.value.findIndex((e=>e.title===n.title));a.value[r]=n;const c={width:x.value,height:x.value,filter:`opacity(0.9) drop-shadow(0 0 0 rgb(${K.value[0]}, ${K.value[1]}, ${K.value[2]})) brightness(${O.value}%)`};a.value[e].images.push({...l,...c}),a.value=Gt(a.value),a.value.forEach((e=>{e.count=e.images.length,e.images.length>0&&e.images.forEach((t=>{t.title=e.title}))}))}t++}A.value=[],te.value=[],M.value=[],await Vt()}else console.error("이미지 옮기기 실패.")}catch(I){console.error("이미지 옮기는 작업 서버 실패:",I)}finally{await u.dispatch("commonModule/setCommonInfo",{moveImgIsBool:!1})}if(c)try{await u.dispatch("commonModule/setCommonInfo",{moveImgIsBool:!0});for(const e of te.value){const t="bm"===window.PROJECT_TYPE?za:Ja,a=t.find((t=>t.abbreviation===(e.title||e.abbreviation))),l=`${b.value}/${d}/${ta(z.value)}/${a?.id}_${e.title}`,s=`${b.value}/${d}/${ta(z.value)}/${o.id}_${o.title}`;p.push(s),v.push(l)}const t={sourceFolders:v,destinationFolders:p,fileNames:g};let s=await Uf(t);if(s){const t=a.value[e];for(const e of Ht(te.value,"title")){const s=l.filter((t=>t.title===(e.title||e.abbreviation)));t.images.push(...s),t.count=t.images.length;const o=a.value.findIndex((t=>t.title===(e.title||e.abbreviation)));if(-1!==o){const e=a.value[o],t=l.map((e=>e.fileName)),s=e.images.filter((e=>!t.includes(e.fileName)));e.images=s,e.count=e.images.length}}for(const s of l)s.title=a.value[e].title,s.width=x.value,s.height=x.value,s.filter=`opacity(0.9) drop-shadow(0 0 0 rgb(${K.value[0]}, ${K.value[1]}, ${K.value[2]})) brightness(${O.value}%)`}else console.error("이미지 움직임 실패.")}catch(I){console.error("서버 이미지 옮기기 실패:",I)}finally{await u.dispatch("commonModule/setCommonInfo",{moveImgIsBool:!1})}A.value=[],te.value=[],M.value=[],F.value="",t.value="",await Vt()}function Ht(e,t){const a=new Set;return e.filter((e=>{const l=e[t];return!a.has(l)&&(a.add(l),!0)}))}function Gt(e){const t=new Set;return e.map((e=>{const a=e.images.filter((e=>!t.has(e.fileName)&&(t.add(e.fileName),!0)));return{...e,images:a}}))}const Yt=(e,t)=>{e||""!==e||(e="0000",t="01");const a={"0006":{includesStr:["AR","NR","GP","PA","MC","MA","SM","NE","GP","PA","OT"],includesStr2:["NR","AR","MC","MA","SM","NE","GP","PA","OT"]}},l=a[e]||{includesStr:["AR","NR","GP","PA","MC","MA","SM","GP","PA","OT"],includesStr2:["NR","AR","MC","MA","SM","GP","PA","OT"]};return"01"===t||"04"===t?l.includesStr:l.includesStr2};async function Vt(e){let t=[],l=JSON.parse(JSON.stringify(a.value)),s=0;l.forEach((e=>{if("bm"===z.value)"OT"!==e.title&&(s+=Number(e.count));else{const t=Yt(C.value,r.value?.testType);t.includes(e.title)||(s+=Number(e.count))}})),l.forEach((e=>{if("bm"===z.value){if("OT"!==e.title){const t=(Number(e.count)/Number(s)*100).toFixed(1);e.percent=Number(t)===Math.floor(Number(t))?Math.floor(Number(t)).toString():t}}else{const t=Yt(C.value,r.value?.testType);if(!t.includes(e.title)){const t=(Number(e.count)/Number(s)*100).toFixed(1);e.percent=Number(t)===Math.floor(Number(t))?Math.floor(Number(t)).toString():t}}}));let o=[];const n=l.map((e=>{const t=e.images.filter((e=>!o.includes(e.fileName)&&(o.push(e.fileName),!0)));return{...e,images:t}}));if(l=n,"notWbcAfterSave"!==e){r.value.wbcInfoAfter=l,a.value=l;const e=_e.value;e&&(e.wbcInfoAfter=l);const{isNormal:s,classInfo:o}=KS(l,Ee.value);e.isNormal=s,e.abnormalClassInfo=o,e.pcIp=Pe.value,e.lock_status=!0,e.submitState=""!==e.submitState&&e?.submitState?e.submitState:"checkFirst",t=[e]}await jt(l,t)}async function jt(e,t){try{const a=await xg(Tg,{id:t[0].id,isNormal:t[0].isNormal,abnormalClassInfo:t[0].abnormalClassInfo,pcIp:t[0].pcIp,lock_status:t[0].lock_status,wbcInfoAfter:t[0].wbcInfoAfter,submitState:t[0].submitState});if(a&&0!==a?.data?.updateRunningInfoGQL[0].length){$.value&&await gt(!0),e.value=[],e.value=a?.data?.updateRunningInfoGQL[0].wbcInfoAfter;const t=0!==le.value.length?le.value:"bm"===window.PROJECT_TYPE?el:Za;await at(e.value,t),he.value=!0,await(0,s.dY)(),he.value=!1}else console.error("백엔드가 디비에 저장 실패함")}catch(a){console.error("Error:",a)}}const Qt=async e=>{try{const t=sessionStorage.getItem("lastSearchParams")||localStorage.getItem("lastSearchParams")||"",{startDate:a,endDate:l,page:s,searchText:o,nrCount:n,testType:i,wbcInfo:r,wbcTotal:c}=JSON.parse(t),u=a+l+s+o+n+i+r+c,d=await Nd({userId:Number(m.value.id),runingInfoDtoItems:[e],dayQuery:u});d||console.error("백엔드가 디비에 저장 실패함")}catch(t){console.error("Error:",t)}};function qt(e,t,l,s,o){if(!a.value||0===a.value.length)return"";const n=r.value?.slotId||"";let i=`${b.value}/${n}/${ta(z.value)}/${t}_${l}`,c="";return c="getImageRealTime"===s||"pb"===z.value?`${j}/images/getImageRealTime?folder=${i}&imageName=${e}`:`${j}/images?folder=${i}&imageName=${e}`,c}async function Jt(){if(D.length<=0)return;const e=D.pop();S.value=null,w.value=null,_.value=null,P.value=[],T.value=null,A.value=[],te.value=[],M.value=[],await Zt(a.value,e),a.value=e}const zt=(e,t,a)=>{e.forEach(((e,l)=>{const s=t[l];e&&s&&e.images.forEach(((e,t)=>{const o=s.images[t];void 0===o&&a.push({itemIndex:l,imageIndex:t,fileName:e.fileName,title:s.title,id:s.id})}))}))};async function Zt(e,t){const l=[],s=[];zt(e,t,l),zt(t,e,s);let o=[],n=[],c=[];for(const a in l){const e=`${b.value}/${r.value?.slotId}/${ta(z.value)}/${l[a].id}_${l[a].title}`,t=`${b.value}/${r.value?.slotId}/${ta(z.value)}/${s[a].id}_${s[a].title}`;o.push(e),n.push(t),c.push(l[a].fileName)}const u={sourceFolders:o,destinationFolders:n,fileNames:c};let d=await Uf(u);d&&(a.value=t),i.value=a.value;const m=le.value.sort(((e,t)=>Number(e.orderIdx)-Number(t.orderIdx))),v=0!==le.value.length?m:"bm"===window.PROJECT_TYPE?za:Ja;await at(a.value,v),await Vt()}const ea=async()=>{try{const e=`${b.value}/${r.value.slotId}/${ta(z.value)}`,t=await fetch(`${j}/folders/check-and-move-images`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({folderPath:e,wbcInfo:a.value})});if(!t.ok)throw new Error(`HTTP error! status: ${t.status}`);await t.json()}catch(e){console.error("Error:",e)}},ta=e=>"bm"===e?"04_BM_Classification":"pb"===e?"01_WBC_Classification":void 0,aa=()=>{ye.value=!1},la=e=>{e===I["인천길병원"]&&(Le.value=!Le.value)};async function sa(){try{const e=await Ie();if(e&&e?.data){const t=e.data;Ee.value=t}}catch(e){console.error(e)}}const oa=async e=>{const t=""!==e?.img_drive_root_path&&e?.img_drive_root_path?e?.img_drive_root_path:k.value,a=await BS({barcodeNo:e.barcodeNo,siteCd:C.value,userId:d.value,deviceSerialNm:h.value,imageDriveRootPath:t,slotId:e.slotId});if(a){const t={cbcPatientNm:a?.cbcPatientNm,patientNm:a?.cbcPatientNm},l={...e,...t};Te.value=a?.cbcPatientNm,Ae.value=a?.cbcPatientNm,await Qt(l)}},na=async()=>{Me.value=!0};return(e,c)=>{const u=(0,s.g2)("font-awesome-icon");return(0,s.uX)(),(0,s.CE)(s.FK,null,[(0,s.bo)((0,s.Lk)("div",US," Moving image...",512),[[l.aG,p.value]]),(0,s.bF)(Py,{onRefreshClass:pt,isNext:de.value,onIsNextFalse:je,changeSlideByLisUpload:Le.value},null,8,["isNext","changeSlideByLisUpload"]),(0,s.Lk)("div",XS,[_e.value?((0,s.uX)(),(0,s.Wv)(fb,{key:0,testType:"bm"===z.value?(0,o.R1)(y)(r.value?.testType):(0,o.R1)(f)(r.value?.testType),barcodeNo:r.value?.barcodeNo,cbcPatientNo:r.value?.cbcPatientNo,hospitalName:r.value?.hosName,cbcSex:r.value?.cbcSex,cbcAge:r.value?.cbcAge,analyzedDttm:r.value?.analyzedDttm,cbcPatientName:Ae.value,patientName:Te.value,slideData:r.value,onUpdateSlideDataByCBCData:oa},null,8,["testType","barcodeNo","cbcPatientNo","hospitalName","cbcSex","cbcAge","analyzedDttm","cbcPatientName","patientName","slideData"])):(0,s.Q3)("",!0),v.value?((0,s.uX)(),(0,s.Wv)(sb,{key:1,selectItems:r.value},null,8,["selectItems"])):(0,s.Q3)("",!0),(0,s.Lk)("div",{class:(0,n.C4)("databaseWbcRight shadowBox"+(v.value?" cbcLayer":""))},[ge.value?(0,s.Q3)("",!0):((0,s.uX)(),(0,s.Wv)(mI,{key:0,wbcInfo:a.value,selectItems:r.value,classCompareShow:me.value,type:"listTable",onNextPage:Ve,onScrollEvent:bt,onUploadLisChangeSlide:la,isAllClassesChecked:Me.value},null,8,["wbcInfo","selectItems","classCompareShow","isAllClassesChecked"]))],2),(0,s.Lk)("div",{class:(0,n.C4)("databaseWbcLeft"+(v.value?" cbcLayer":""))},[(0,s.Lk)("div",$S,[(0,s.Lk)("button",{type:"button",onClick:c[0]||(c[0]=e=>gt(!1))},[(0,s.bF)(u,{icon:$.value?["fas","toggle-on"]:["fas","toggle-off"]},null,8,["icon"]),c[17]||(c[17]=(0,s.eW)(" Cell Marking "))]),(0,s.Lk)("button",{onClick:Je,class:"sizeButton"},[(0,s.bF)(u,{icon:["fas","plus-minus"]}),c[18]||(c[18]=(0,s.eW)(" Size "))]),(0,s.bo)((0,s.Lk)("div",WS,[(0,s.Lk)("div",null,[c[19]||(c[19]=(0,s.Lk)("div",{class:"sizeTitle"},"Size",-1)),(0,s.Lk)("div",HS,[(0,s.Lk)("input",{type:"number",value:Rt.value,onInput:Nt},null,40,GS)]),(0,s.bo)((0,s.Lk)("input",{type:"range",min:"50",max:"290","onUpdate:modelValue":c[1]||(c[1]=e=>x.value=e),onInput:wt},null,544),[[l.Jo,x.value]]),(0,s.Lk)("button",{class:"resetBtn mb10",onClick:Ct},"Size Reset")])],512),[[l.aG,se.value]]),(0,s.Lk)("div",YS,[(0,s.Lk)("button",{onClick:dt},[(0,s.bF)(u,{icon:["fas","gear"]}),c[20]||(c[20]=(0,s.eW)(" IMG Setting "))]),(0,s.bo)((0,s.Lk)("div",VS,[(0,s.Lk)("div",null,[(0,s.bF)(u,{icon:["fas","sun"]}),c[21]||(c[21]=(0,s.eW)(" Brightness ")),(0,s.Lk)("div",jS,[(0,s.bo)((0,s.Lk)("input",{type:"number","onUpdate:modelValue":c[2]||(c[2]=e=>O.value=e),onInput:St},null,544),[[l.Jo,O.value]])]),(0,s.bo)((0,s.Lk)("input",{type:"range",min:"50",max:"120","onUpdate:modelValue":c[3]||(c[3]=e=>O.value=e),onInput:St},null,544),[[l.Jo,O.value]]),(0,s.Lk)("button",{class:"resetBtn mb20",onClick:ht},"Brightness Reset")]),(0,s.Lk)("div",null,[(0,s.bF)(u,{icon:["fas","palette"]}),c[29]||(c[29]=(0,s.eW)(" RGB ")),(0,s.Lk)("div",QS,[c[22]||(c[22]=(0,s.eW)(" [ ")),(0,s.bo)((0,s.Lk)("input",{type:"number","onUpdate:modelValue":c[4]||(c[4]=e=>K.value[0]=e),onInput:c[5]||(c[5]=e=>kt(""))},null,544),[[l.Jo,K.value[0]]]),c[23]||(c[23]=(0,s.eW)(", ")),(0,s.bo)((0,s.Lk)("input",{type:"number","onUpdate:modelValue":c[6]||(c[6]=e=>K.value[1]=e),onInput:c[7]||(c[7]=e=>kt(""))},null,544),[[l.Jo,K.value[1]]]),c[24]||(c[24]=(0,s.eW)(", ")),(0,s.bo)((0,s.Lk)("input",{type:"number","onUpdate:modelValue":c[8]||(c[8]=e=>K.value[2]=e),onInput:c[9]||(c[9]=e=>kt(""))},null,544),[[l.Jo,K.value[2]]]),c[25]||(c[25]=(0,s.eW)(" ] "))]),(0,s.Lk)("div",qS,[c[26]||(c[26]=(0,s.Lk)("label",null,"R",-1)),(0,s.bo)((0,s.Lk)("input",{type:"range",min:"0",max:"255","onUpdate:modelValue":c[10]||(c[10]=e=>K.value[0]=e),onInput:c[11]||(c[11]=e=>kt(""))},null,544),[[l.Jo,K.value[0]]])]),(0,s.Lk)("div",JS,[c[27]||(c[27]=(0,s.Lk)("label",null,"G",-1)),(0,s.bo)((0,s.Lk)("input",{type:"range",min:"0",max:"255","onUpdate:modelValue":c[12]||(c[12]=e=>K.value[1]=e),onInput:c[13]||(c[13]=e=>kt(""))},null,544),[[l.Jo,K.value[1]]])]),(0,s.Lk)("div",zS,[c[28]||(c[28]=(0,s.Lk)("label",null,"B",-1)),(0,s.bo)((0,s.Lk)("input",{type:"range",min:"0",max:"255","onUpdate:modelValue":c[14]||(c[14]=e=>K.value[2]=e),onInput:c[15]||(c[15]=e=>kt(""))},null,544),[[l.Jo,K.value[2]]])]),(0,s.Lk)("button",{class:"resetBtn",onClick:It},"RGB Reset")])],512),[[l.aG,V.value]])],512),(0,s.Lk)("button",{onClick:Xe},[(0,s.bF)(u,{icon:["fas","code-compare"]}),c[30]||(c[30]=(0,s.eW)(" Class Compare "))]),Se.value?((0,s.uX)(),(0,s.CE)("button",{key:0,onClick:$e},[(0,s.bF)(u,{icon:["fas","expand"]}),c[31]||(c[31]=(0,s.eW)(" WPS "))])):(0,s.Q3)("",!0),(0,s.Lk)("button",{onClick:Jt,class:"rollbackButton"},[(0,s.bF)(u,{icon:["fas","rotate-left"]}),c[32]||(c[32]=(0,s.eW)(" Rollback "))])]),(0,s.Lk)("div",null,[ke.value?((0,s.uX)(),(0,s.Wv)(OS,{key:0,ref_key:"$imageGalleryRef",ref:fe,wbcInfoRefresh:E.value,wbcInfo:a.value,wbcReset:he.value,selectItems:r.value,totalCount:r.value?.wbcInfo?.totalCount,slotId:r.value?.slotId,iaRootPath:b.value,projectTypeReturn:ta(z.value),projectType:z.value,apiBaseUrl:(0,o.R1)(j),classCompareShow:me.value,wpsShow:pe.value,selectedTitle:t.value,hiddenImages:oe.value,replaceFileNamePrefix:nt,onDragOver:Kt,isBorderChanged:ot,isSelected:Ut,imageSize:x.value,isAllClassesChecked:Me.value,updateWbcInfo:i.value,onAllCheckChange:ft,onSelectImage:Ft,onBorderDel:De,onBorderOn:xe,onOpenModal:it,onHideImage:qe,onHandleRightClick:Qe,onOnDrop:Xt,onOnDragStart:Bt,onOnDropCircle:_t,onOnDragOverCircle:Lt,onScrollToElement:bt,onAllClassesChecked:na,cellRef:X.value,"onUpdate:cellRef":Ue},null,8,["wbcInfoRefresh","wbcInfo","wbcReset","selectItems","totalCount","slotId","iaRootPath","projectTypeReturn","projectType","apiBaseUrl","classCompareShow","wpsShow","selectedTitle","hiddenImages","imageSize","isAllClassesChecked","updateWbcInfo","cellRef"])):(0,s.Q3)("",!0)]),ne.value?((0,s.uX)(),(0,s.CE)("div",{key:0,style:(0,n.Tr)({top:re.value+"px",left:ie.value+"px"}),class:"context-menu detail"},[(0,s.Lk)("ul",null,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(a.value,((e,t)=>((0,s.uX)(),(0,s.CE)("li",{key:t,onClick:a=>et(e,t)},(0,n.v_)(tt(e.name)),9,ZS)))),128))])],4)):(0,s.Q3)("",!0),(0,s.bo)((0,s.Lk)("div",{class:"wbcModal",onWheel:ut},[(0,s.Lk)("div",{class:"wbc-modal-content",onClick:ct},[(0,s.Lk)("span",{class:"wbcClose",onClick:rt},"×"),(0,s.Lk)("div",ew,[(0,s.Lk)("img",{src:H.value,style:(0,n.Tr)({width:G.value,height:Y.value}),class:"modal-image",ref:"modalImage"},null,12,tw)]),(0,s.Lk)("div",aw,[(0,s.Lk)("div",lw,[(0,s.Lk)("p",null,(0,n.v_)(((ee.value-200)/400*100).toFixed(0))+" %",1),(0,s.bo)((0,s.Lk)("input",{type:"range",min:"200",max:"600","onUpdate:modelValue":c[16]||(c[16]=e=>ee.value=e),onInput:Be},null,544),[[l.Jo,ee.value]])])])])],544),[[l.aG,W.value]])],2)]),Ne.value?((0,s.uX)(),(0,s.Wv)(Eb,{key:0,message:Ne.value,messageType:Re.value,duration:1500,position:"bottom-right"},null,8,["message","messageType"])):(0,s.Q3)("",!0),ye.value?((0,s.uX)(),(0,s.Wv)(Pt,{key:1,"is-visible":ye.value,type:be.value,message:Ce.value,onHide:aa,"onUpdate:hideAlert":aa},null,8,["is-visible","type","message"])):(0,s.Q3)("",!0)],64)}}});const ow=sw;var nw=ow;const iw={class:"leftImgList"},rw={class:"leftImgUl"},cw=["src","onDblclick"],uw={class:"leftImgUl"},dw=["src","onDblclick"],mw={class:"leftImgUl"},vw=["src","onDblclick"],pw={class:"leftImgUl"},gw=["src","onDblclick"];var fw=(0,s.pM)({__name:"leftImgList",props:["selectItems"],setup(e){const t=e,a=(0,c.Pj)(),l=window.APP_API_BASE_URL||"http://192.168.0.131:3002",n=(0,o.KR)([]),i=(0,o.KR)([]),r=(0,o.KR)([]),u=(0,o.KR)([]),d=(0,o.KR)([]),m=(0,o.KR)([]),v=(0,o.KR)([]),p=(0,o.KR)([]),g=["02_Particle_Image","03_Cell_Ideal_Image","04_Cell_Ideal_Stitch_Image","05_Mega_Image"],f=(0,o.KR)(!1);let y=null;(0,s.EW)((()=>a.state.commonModule.iaRootPath));(0,s.sV)((async()=>{await C()})),(0,s.wB)((()=>t.selectItems),(async()=>{await C()}));const b=async e=>{const a=t.selectItems?.slotId||"",s=""!==t.selectItems?.img_drive_root_path&&t.selectItems?.img_drive_root_path?t.selectItems?.img_drive_root_path:sessionStorage.getItem("iaRootPath"),o=`${s}/${a}/${e}`,n=`${l}/folders?folderPath=${o}`,i=await fetch(n),r=await i.json();return r.some((e=>e.endsWith("_files")))},I=async(e,a)=>{let s;const o=t.selectItems?.slotId||"",n=""!==t.selectItems?.img_drive_root_path&&t.selectItems?.img_drive_root_path?t.selectItems?.img_drive_root_path:sessionStorage.getItem("iaRootPath");let i="";switch(a){case"particle":s=`02_Particle_Image/${e}/10`,i=await b("02_Particle_Image")?`${l}/folders/getFilesInFolderWhole?folderPath=${n}/${o}/${s}/0_0.jpg`:"02_Particle_Image/Thumb";break;case"idealZone":i=await b("03_Cell_Ideal_Image")?`${l}/folders/getFilesInFolderWhole?folderPath=${n}/${o}/03_Cell_Ideal_Image/${e}`:"03_Cell_Ideal_Image";break;case"idealStitch":s=`04_Cell_Ideal_Stitch_Image/${e}/10`,i=await b("04_Cell_Ideal_Stitch_Image")?`${l}/folders/getFilesInFolderWhole?folderPath=${n}/${o}/${s}/0_0.jpg`:"04_Cell_Ideal_Stitch_Image";break;case"mega":i=await b("05_Mega_Image")?`${l}/folders/getFilesInFolderWhole?folderPath=${n}/${o}/05_Mega_Image/${e}`:"05_Mega_Image";break;default:break}return i.includes(l)?i:`${l}/folders/getFilesInFolderWhole?folderPath=${n}/${o}/${i}/${e}`},C=async()=>{const e=t.selectItems?.slotId||"",a=""!==t.selectItems?.img_drive_root_path&&t.selectItems?.img_drive_root_path?t.selectItems?.img_drive_root_path:sessionStorage.getItem("iaRootPath");for(const t of g)try{const s=await z.A.get(`${l}/folders?folderPath=${a}/${e}/${t}`);switch(t){case"02_Particle_Image":n.value=await b("02_Particle_Image")?s.data.filter((e=>!e.includes(".dzi"))).slice(0,7):s.data.filter((e=>"Thumb"!==e)).slice(0,7),d.value=await Promise.all(n.value.map((e=>I(e,"particle"))));break;case"03_Cell_Ideal_Image":i.value=s.data.filter((e=>"Thumb"!==e)).slice(0,14),m.value=await Promise.all(i.value.map((e=>I(e,"idealZone"))));break;case"04_Cell_Ideal_Stitch_Image":r.value=await b("04_Cell_Ideal_Stitch_Image")?s.data.filter((e=>!e.includes(".dzi"))).slice(0,7):s.data.filter((e=>"Thumb"!==e)),v.value=await Promise.all(r.value.map((e=>I(e,"idealStitch"))));break;case"05_Mega_Image":u.value=s.data.filter((e=>"Thumb"!==e)),p.value=await Promise.all(u.value.map((e=>I(e,"mega"))));break}}catch(s){console.error("Error:",s)}},h=async(e,a,s,o)=>{y&&y.destroy();let n={};if("03_Cell_Ideal_Image"!==a&&await s){const e=t.selectItems?.slotId||"",l=""!==t.selectItems?.img_drive_root_path&&t.selectItems?.img_drive_root_path?t.selectItems?.img_drive_root_path:sessionStorage.getItem("iaRootPath"),s=`${l}/${e}/${a}`,i=await S(s);n=i[o]}else n={type:"image",url:e};y=Kf()({id:"viewerSmall",element:document.getElementById("viewerSmall"),tileSources:n,defaultZoomLevel:.2,navigator:!1,prefixUrl:ty(l),minZoomLevel:.2,maxZoomLevel:2,showZoomControl:!1,showHomeControl:!1,showFullScreenControl:!1,showRotationControl:!1,showFullPageControl:!1}),f.value=!0;const i=document.createElement("img");i.alt="Close Viewer",i.style.position="absolute",i.style.transform="rotate(45deg)",i.style.cursor="pointer",i.style.padding="10px",i.style.color="white",i.src=ty(l)+"zoomin_grouphover.png",i.addEventListener("click",(()=>{k()})),y.addControl(i,{anchor:Kf().ControlAnchor.ABSOLUTE,top:100,left:"49%"}),y.addHandler("open",(function(){const e=y.source.dimensions.x,t=y.source.dimensions.y,a=document.getElementById("viewerSmall"),l=a.clientWidth,s=t/e,o=l*s;a.style.position="fixed",a.style.height=`${o}px`,a.style.width="100%",a.style.left="0",a.style.background="#00000061"})),y.addHandler("canvas-click",(e=>{e.preventDefaultAction=!0}))},k=()=>{if(y){y.destroy();const e=document.getElementById("viewerSmall");e&&(e.innerHTML="",e.style.background="none",e.style.height="0",e.style.width="0",e.removeEventListener("click",k)),y=null,f.value=!1}},S=async e=>{const t=`${l}/folders?folderPath=${e}`,a=await fetch(t);if(!a.ok)throw new Error("Network response was not ok");const s=await a.json(),o=[];for(const n of s)if(n.endsWith("_files")){const t=w(n),{width:a,height:s,tileSize:i}=await N(t,e);o.push({Image:{xmlns:"http://schemas.microsoft.com/deepzoom/2009",Url:`${l}/folders?folderPath=${e}/${n}/`,Format:"jpg",Overlap:"1",TileSize:i,Size:{Width:a,Height:s}}})}return o},w=e=>{const t="_files",a=e.indexOf(t);return-1!==a?e.substring(0,a):e},N=async(e,t)=>{const a=`${t}/${e}.dzi`,l=await Lo({filePath:a});return await R(`${e}`,l)},R=(e,t)=>{const a=new DOMParser,l=a.parseFromString(t,"application/xml"),s=l.getElementsByTagName("Size")[0],o=l.getElementsByTagName("Image")[0],n=o.getAttribute("TileSize"),i=s.getAttribute("Width"),r=s.getAttribute("Height");return{fileName:e,width:Number(i),height:Number(r),tileSize:Number(n)}};return(e,t)=>((0,s.uX)(),(0,s.CE)(s.FK,null,[t[4]||(t[4]=(0,s.Lk)("div",{id:"viewerSmall"},null,-1)),(0,s.Lk)("div",iw,[t[0]||(t[0]=(0,s.Lk)("p",null,"Partical Image",-1)),(0,s.Lk)("ul",rw,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(n.value,((e,t)=>((0,s.uX)(),(0,s.CE)("li",{key:t,class:"leftImgLi"},[(0,s.Lk)("img",{src:d.value[t],alt:"Partical Image",onDblclick:e=>h(d.value[t],"02_Particle_Image",b("02_Particle_Image"),t)},null,40,cw)])))),128))]),t[1]||(t[1]=(0,s.Lk)("p",null,"Ideal Zone",-1)),(0,s.Lk)("ul",uw,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(i.value,((e,t)=>((0,s.uX)(),(0,s.CE)("li",{key:t,class:"leftImgLi",style:{width:"100px"}},[(0,s.Lk)("img",{src:m.value[t],onDblclick:e=>h(m.value[t],"03_Cell_Ideal_Image",b("03_Cell_Ideal_Image"),t)},null,40,dw)])))),128))]),t[2]||(t[2]=(0,s.Lk)("p",null,"Ideal Stitch",-1)),(0,s.Lk)("ul",mw,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(r.value,((e,t)=>((0,s.uX)(),(0,s.CE)("li",{key:t,class:"leftImgLi"},[(0,s.Lk)("img",{src:v.value[t],onDblclick:e=>h(v.value[t],"04_Cell_Ideal_Stitch_Image",b("04_Cell_Ideal_Stitch_Image"),t)},null,40,vw)])))),128))]),t[3]||(t[3]=(0,s.Lk)("p",null,"Megakaryocyte",-1)),(0,s.Lk)("ul",pw,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(u.value,((e,t)=>((0,s.uX)(),(0,s.CE)("li",{key:t,class:"leftImgLi"},[(0,s.Lk)("img",{src:p.value[t],onDblclick:e=>h(p.value[t],"05_Mega_Image",b("05_Mega_Image"),t)},null,40,gw)])))),128))])])],64))}});const yw=fw;var bw=yw;const Iw={class:"tilingViewerContainer",style:{height:"100%"},id:"tiling-container"};var Cw=(0,s.pM)({__name:"tilingViewer",props:["selectItems"],setup(e){const t=e,a=(0,c.Pj)(),l=(0,s.EW)((()=>a.state.commonModule.iaRootPath)),i=(0,s.EW)((()=>a.state.commonModule.viewerCheck)),r="viewer"===i.value?window.MAIN_API_IP:window.APP_API_BASE_URL,u=(0,o.KR)(null),d=(0,o.KR)(""),m=(0,o.KR)(""),v=(0,o.KR)("85vh");let p=null;(0,s.sV)((async()=>{const e="PMC_Result",{width:t,height:a}=await y(e);d.value=a,m.value=t,v.value=`${Math.min(a/window.innerHeight*100,85)}vh`,await g(a,!1)})),(0,s.wB)((()=>t.selectItems),(async e=>{await(0,s.dY)();const t="PMC_Result",{width:a,height:l}=await y(t);d.value=l,m.value=a,await g(l,!1)})),(0,s.wB)((()=>window.innerHeight),(()=>{v.value=`${Math.min(Number(d.value)/window.innerHeight*100,85)}vh`}));const g=async(e,a)=>{p&&p.destroy();const l=t.selectItems?.slotId||"",s=""!==t.selectItems?.img_drive_root_path&&t.selectItems?.img_drive_root_path?t.selectItems?.img_drive_root_path:sessionStorage.getItem("iaRootPath"),o=`${s}/${l}/01_Stitching_Image`;try{const e=await f(o);p=Kf()({id:"tiling-viewer",animationTime:.4,navigatorSizeRatio:.25,showNavigator:!0,sequenceMode:!0,defaultZoomLevel:1,prefixUrl:ty(r),tileSources:e,gestureSettingsMouse:{clickToZoom:!1}}),p.addHandler("open",(function(){p.source.dimensions.x,p.source.dimensions.y;const e=document.getElementById("tiling-viewer"),t=e.clientWidth;e.style.width=`${t}px`,e.style.position="absolute",e.style.left="50%",e.style.top="50%",e.style.transform="translate(-50%, -50%)"}));const t=p.buttons.buttons.find((e=>"Toggle full page"===e.tooltip));t&&t.element.addEventListener("click",(async()=>{p.isFullPage()?(await document.exitFullscreen(),p.setFullPage(!1)):p.setFullPage(!0)})),p.addHandler("zoom",(function(){const e=document.getElementById("tiling-viewer");a&&e&&(e.style.height="80vh")})),p.addHandler("full-page",(async function(e){e.fullPage?p.element.style.backgroundColor="black":(p.element.style.backgroundColor="",await document.documentElement.requestFullscreen())}))}catch(n){console.error("Error:",n)}},f=async e=>{const t=`${r}/folders?folderPath=${e}`,a=await fetch(t);if(!a.ok)throw new Error("Network response was not ok");const l=await a.json(),s=[];for(const o of l)if(o.endsWith("_files")){const t=I(o),{width:a,height:l,tileSize:n}=await y(t);s.push({Image:{xmlns:"http://schemas.microsoft.com/deepzoom/2009",Url:`${r}/folders?folderPath=${e}/${o}/`,Format:"jpg",Overlap:"1",TileSize:n,Size:{Width:a,Height:l}}})}return s},y=async e=>{const a=""!==t.selectItems?.img_drive_root_path&&t.selectItems?.img_drive_root_path?t.selectItems?.img_drive_root_path:l.value,s=`${a}/${t.selectItems.slotId}/01_Stitching_Image/${e}.dzi`,o=await Lo({filePath:s});return await b(`${e}`,o)},b=(e,t)=>{const a=new DOMParser,l=a.parseFromString(t,"application/xml"),s=l.getElementsByTagName("Size")[0],o=l.getElementsByTagName("Image")[0],n=o.getAttribute("TileSize"),i=s.getAttribute("Width"),r=s.getAttribute("Height");return{fileName:e,width:Number(i),height:Number(r),tileSize:Number(n)}},I=e=>{const t="_files",a=e.indexOf(t);return-1!==a?e.substring(0,a):e};return(e,t)=>((0,s.uX)(),(0,s.CE)("div",Iw,[(0,s.Lk)("div",{ref_key:"tilingViewerLayer",ref:u,id:"tiling-viewer",style:(0,n.Tr)({height:v.value})},null,4)]))}});const hw=Cw;var kw=hw;const Sw={class:"imgContent"},ww={class:"wrap-whole"},Nw={class:"leftWhole"};var Rw=(0,s.pM)({__name:"index",setup(e){const t=(0,c.Pj)(),a=(0,s.EW)((()=>t.state.slideDataModule)),l=(0,o.KR)(null),n=(0,o.KR)(!1),i=(0,o.KR)(null),r=(0,o.KR)(null);(0,s.KC)((async()=>{await u()})),(0,s.sV)((async()=>{i.value=document.querySelector(".img")}));const u=async()=>{try{n.value=!0,l.value=a.value,n.value=!1}catch(e){console.error(e),l.value=[],n.value=!1}},d=async e=>{l.value=e};return(e,t)=>((0,s.uX)(),(0,s.CE)(s.FK,null,[(0,s.bF)(Py,{onRefreshClass:d}),(0,s.Lk)("div",Sw,[(0,s.Lk)("div",ww,[(0,s.Lk)("div",{ref_key:"imageContainer",ref:r,class:"image-container"},[n.value?(0,s.Q3)("",!0):((0,s.uX)(),(0,s.Wv)(kw,{key:0,selectItems:l.value},null,8,["selectItems"]))],512),(0,s.Lk)("div",Nw,[n.value?(0,s.Q3)("",!0):((0,s.uX)(),(0,s.Wv)(bw,{key:0,selectItems:l.value},null,8,["selectItems"]))])])])],64))}});const Lw=Rw;var Ew=Lw;const _w=(0,r.aE)({history:(0,r.LA)(),routes:[{path:"/analysis",name:"AnalysisView",component:to},{path:"/user/join",name:"join",component:go},{path:"/user/login",name:"login",component:Ho},{path:"/setting",name:"setting",component:kd},{path:"/database",name:"database",component:Ig},{path:"/databaseDetail",name:"databaseDetail",component:nw},{path:"/databaseWhole",name:"databaseWhole",component:Ew},{path:"/databaseRbc",name:"databaseRbc",component:Cb},{path:"/report",name:"report",component:Gk}]});_w.beforeEach((async(e,t,a)=>{const l=sessionStorage.getItem("user"),o=JSON.parse(l||"{}"),n=(0,c.Pj)(),i=(0,s.EW)((()=>n.state.commonModule.settingChangedChecker)),r=n.state.userModule;if("/setting"===t.path){const t=(0,s.EW)((()=>n.state.commonModule.beforeSettingFormattedString)),l=(0,s.EW)((()=>n.state.commonModule.afterSettingFormattedString)),o=t.value,r=l.value;if(o!==r)return await n.dispatch("commonModule/setCommonInfo",{settingChangedChecker:!i.value}),await n.dispatch("commonModule/setCommonInfo",{enteringRouterPath:e.path}),void a(!1);await n.dispatch("commonModule/setCommonInfo",{beforeSettingFormattedString:null}),await n.dispatch("commonModule/setCommonInfo",{afterSettingFormattedString:null}),await n.dispatch("commonModule/setCommonInfo",{enteringRouterPath:""}),await n.dispatch("commonModule/setCommonInfo",{settingType:""}),a()}"login"===e.name||"join"===e.name||o.userId||r.value?"database"===e.name?(await n.dispatch("commonModule/setCommonInfo",{dataBasePageReset:!0}),a()):a():a("/user/login")}));var Pw=_w;const Tw={class:"progress-component-container"},Aw={class:"progress-component-bar"},Mw={key:0,class:"progress-component-glow"};var Dw={__name:"ProgressBar",props:{value:{type:Number,required:!0,validator:e=>e>=0&&e<=100},gradientStart:{type:String,default:"#42b883"},gradientEnd:{type:String,default:"#3b8070"},color:{type:String,default:"#00c2ff"},animationDuration:{type:Number,default:.3},showGlowEffect:{type:Boolean,default:!0},text:{type:String}},setup(e){const t=e,a=(0,s.EW)((()=>Math.round(t.value)));(0,s.EW)((()=>`linear-gradient(90deg, ${t.gradientStart}, ${t.gradientEnd})`));return(t,l)=>((0,s.uX)(),(0,s.CE)("div",Tw,[(0,s.Lk)("p",null,(0,n.v_)(e.text),1),(0,s.Lk)("div",Aw,[(0,s.Lk)("div",{class:"progress-component-fill",style:(0,n.Tr)({width:`${a.value}%`,backgroundColor:e.color,transition:`width ${e.animationDuration}s ease-in-out`})},[e.showGlowEffect?((0,s.uX)(),(0,s.CE)("div",Mw)):(0,s.Q3)("",!0)],4)])]))}};const xw=Dw;var Ow=xw;const Kw={class:"errLogDiv"},Bw={class:"title"},Fw={class:"errLogNum"},Uw={class:"errLogIco"},Xw={class:"errLogBody"},$w={class:"arrLogDesc"},Ww={class:"arrLogDesc"},Hw={class:"errLogTimestamp"};var Gw=(0,s.pM)({__name:"ErrLog",props:["errArr","ErrLogOpen"],emits:["closeErrLog","errMouseSet"],setup(e,{emit:t}){const a=t;document.body.addEventListener("click",o);const l=()=>{a("closeErrLog"),a("errMouseSet")};function o(e){const t=e.target;t.closest(".iconHeaderMenu")||(a("closeErrLog"),a("errMouseSet"))}return(t,a)=>{const o=(0,s.g2)("font-awesome-icon");return(0,s.uX)(),(0,s.CE)("div",Kw,[(0,s.Lk)("div",Bw,[(0,s.Lk)("span",null,[a[0]||(a[0]=(0,s.eW)("Notifications ")),(0,s.Lk)("span",Fw,(0,n.v_)(e.errArr.length),1)]),(0,s.Lk)("span",{class:"errLogClose",onClick:l},[(0,s.bF)(o,{icon:["fas","circle-xmark"]})])]),(0,s.Lk)("ul",null,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(e.errArr,((e,t)=>((0,s.uX)(),(0,s.CE)(s.FK,{key:t},["DLOG"!==e.type?((0,s.uX)(),(0,s.CE)("li",{key:0,class:(0,n.C4)(["errLogLi",e.type?e.type.toLowerCase():""])},[(0,s.Lk)("div",null,[(0,s.Lk)("div",Uw,["WARN"===e.type?((0,s.uX)(),(0,s.Wv)(o,{key:0,icon:["fas","circle-exclamation"],class:"warn"})):(0,s.Q3)("",!0),"CRIT"===e.type?((0,s.uX)(),(0,s.Wv)(o,{key:1,icon:["fas","triangle-exclamation"],class:"crit"})):(0,s.Q3)("",!0),"NOTI"===e.type?((0,s.uX)(),(0,s.Wv)(o,{key:2,icon:["fas","circle-check"],class:"noti"})):(0,s.Q3)("",!0)])]),(0,s.Lk)("div",Xw,[(0,s.Lk)("div",{class:(0,n.C4)(["errLogTitle",e.type?e.type.toLowerCase():""])},[(0,s.Lk)("span",null,"[ "+(0,n.v_)(e?.code)+" ]",1),(0,s.Lk)("span",null,(0,n.v_)(e?.name),1)],2),(0,s.Lk)("div",$w," Description: "+(0,n.v_)(e?.desc),1),(0,s.Lk)("div",Ww," Solution: "+(0,n.v_)(e?.soln),1),(0,s.Lk)("div",Hw,(0,n.v_)(e?.timestamp),1)])],2)):(0,s.Q3)("",!0)],64)))),128))])])}}});const Yw=Gw;var Vw=Yw;const jw={class:"header"},Qw={class:"borderLine"},qw={class:"logoProjectTitle"},Jw={key:1,class:"autoStart-container"},zw={class:"small-icon-menu"},Zw={class:"lastMenu"},eN={class:"lastLiM"},tN={class:"iconHeaderMenu"},aN={class:"storage pos-relative"},lN={class:"immersionOilContainer"},sN={class:"flex-justify-between flex-align-center mt10"},oN={class:"f18"},nN={class:"flex-column-align-end"},iN={class:"mt20"},rN={class:"flex-column-align-end"};var cN=(0,s.pM)({__name:"AppHeader",setup(e){const t=(0,r.lq)(),a=(0,o.KR)(!1),u=(0,c.Pj)(),d=sessionStorage.getItem("user"),m=JSON.parse(d||"{}"),v=(0,s.EW)((()=>u.state.commonModule.viewerCheck)),p=(0,o.KR)(!1);let g=null;(0,s.EW)((()=>u.state.commonModule.siteCd)),(0,s.nI)();const f=(0,o.KR)(!1),y=(0,o.KR)(""),b=(0,o.KR)(""),I=(0,s.EW)((()=>u.state.embeddedStatusModule)),C=(0,o.KR)(0),h=(0,o.KR)(""),k=(0,o.KR)(0),S=(0,o.KR)(""),w=(0,s.EW)((()=>u.state.commonModule)),N=(0,o.KR)(!1),R=(0,o.KR)({icon:["fas","person"],class:""}),L=(0,o.KR)(""),E=(0,o.KR)(""),_=(0,o.KR)(!1),P=(0,o.KR)(1e3),T=(0,o.KR)(null),A=(0,o.KR)(null),M=(0,o.KR)(""),D=(0,s.EW)((()=>u.state.userModule)),x=(0,o.KR)(sessionStorage.getItem("isNsNbIntegration")||""),O=(0,s.EW)((()=>u.state.commonModule.analysisType)),K=(0,s.EW)((()=>u.state.commonModule.isCompleteAlarm)),B=(0,s.EW)((()=>u.state.commonModule.isErrorAlarm)),F=(0,s.EW)((()=>u.state.commonModule.iaRootPath)),X=(0,o.KR)(!1),$=(0,o.KR)(!1),W=(0,o.KR)(0),G=(0,o.KR)(!1),Y=(0,o.KR)(""),V=(0,o.KR)("");let j=null,Q=null;const q=(0,o.KR)(!1),Z=(0,o.KR)(!1),ee=(0,o.KR)(!1),te=(0,o.KR)(""),ae=(0,o.KR)(""),se=(0,o.KR)(!1),oe=(0,o.KR)(""),ne=(0,o.KR)(""),ie=(0,o.KR)(!1),re=(0,o.KR)(!1),ce=(0,o.KR)(0),ue=(0,o.KR)([]),de=(0,o.KR)(""),me=(0,o.KR)(U.TOAST_MSG_SUCCESS),ve=(0,o.KR)(!1),pe=(0,o.KR)(!1),ge=(0,o.Kh)({oilPrime:!1,storage:!1}),fe=(0,s.EW)((()=>Y.value)),ye=(0,s.EW)((()=>V.value)),be=()=>{ie.value=!ie.value},Ie=()=>{const e=new Date;Y.value=e.toLocaleDateString(void 0,{year:"numeric",month:"2-digit",day:"2-digit"}),V.value=e.toLocaleTimeString("en-US")},Ce=async()=>{ve.value=!ve.value,pe.value||(N.value=!N.value,await he())},he=async()=>{const e=`folderPath=${F.value.replace("PBIA_proc","")}UIMD_Data/Backend_Log`,t=await Cp(e);if(200===t.code){if(400===t?.data?.status)return me.value=U.TOAST_MSG_ERROR,void He(t?.data?.response.error);let e=[];for(const a in t.data){const l=t.data[a];for(const t of l){const l=`${a} ${t.timestamp}`;"DEV_INFO"!==t.E_TYPE&&e.push({timestamp:l,code:t?.E_CODE,type:t?.E_TYPE,desc:t?.E_DESC,soln:t?.E_SOLN,name:t?.E_NAME})}}ue.value=e}},ke=async()=>{if(f.value=!1,await oo({userId:M.value}),"exit"===ne.value)if("main"===v.value)await Nt.publish("childEmitSocketData",J().embedStatus.exit);else{const e=await va(),t=`ip=${e.data}`,a=`http://${e.data}:3000/close?${t}`;await z.A.get(a)}else sessionStorage.clear(),await Pw.push("user/login"),document.fullscreenElement&&await document.exitFullscreen()},Se=()=>{f.value=!1},we=()=>{document.fullscreenElement?document.exitFullscreen():document.documentElement.requestFullscreen()};(0,s.KC)((()=>{se.value="bm"===window.PROJECT_TYPE,oe.value=window.MACHINE_VERSION})),(0,s.sV)((async()=>{We(),Ie();const e=setInterval(Ie,1e3);(0,s.xo)((()=>{clearInterval(e)})),""===M.value&&await u.dispatch("userModule/setUserAction",m),document.addEventListener("click",Le),window.addEventListener("wheel",Ne,{passive:!1})})),(0,s.xo)((()=>{document.removeEventListener("click",Le),window.removeEventListener("wheel",Ne)})),(0,s.wB)(D.value,((e,t)=>{We(),M.value=e.id})),(0,s.wB)([I.value],(async e=>{await(0,s.dY)(),C.value=Number(e[0].sysInfo.oilCount),h.value=e[0].sysInfo.isDoorOpen,k.value=Number(e[0].sysInfo.storageSize),S.value=e[0].sysInfo.eqStatCd;const t=e[0].sysInfo?.autoStartTimer;"100a"===oe.value&&void 0!==t&&(ce.value=parseFloat(t)/5*100),R.value=Oe(e[0].sysInfo.eqStatCd),L.value=De(),E.value=xe(),re.value||await Re()}));const Ne=e=>{e.ctrlKey&&e.preventDefault()},Re=async()=>{const e=H(),t={jobCmd:"SEARCH_CARD_COUNT",reqUserId:M.value,reqDttm:e,testType:O.value};Nt.publish("childEmitSocketData",t),re.value=!0};(0,s.wB)([w.value],(async e=>{const t=JSON.parse(JSON.stringify(e));t[0].isRunningState?G.value=!0:G.value=!1})),(0,s.wB)((()=>B.value),(async e=>{if(e&&!X.value){if(!Z.value){X.value=!0,Z.value=!0;try{await Zf.play()}catch(t){console.error(t)}finally{Z.value=!1}}Q=setTimeout((()=>{u.dispatch("commonModule/setCommonInfo",{isErrorAlarm:!1}),X.value=!1}),W.value)}})),(0,s.wB)((()=>K.value),(async e=>{if(e&&!$.value){if(!q.value){$.value=!0,q.value=!0;try{await ey.play()}catch(t){console.error(t)}finally{q.value=!1}}j=setTimeout((()=>{$.value=!1,u.dispatch("commonModule/setCommonInfo",{isCompleteAlarm:!1})}),W.value)}}));const Le=e=>{const t=document.querySelector(".userSetOutUl"),a=document.querySelector(".cursorPointer");a&&a.contains(e.target)||t&&!t.contains(e.target)&&(ie.value=!1)},Ee=e=>{ee.value=!0,te.value="success",ae.value=e},_e=e=>{ee.value=!0,te.value="error",ae.value=e},Pe=()=>{ee.value=!1},Te=e=>t.path===e,Ae=()=>{ne.value="logout",b.value=U.LOGOUT,f.value=!0,localStorage.removeItem("user"),ie.value=!1},Me=async()=>{ne.value="exit",b.value=U.exit,f.value=!0,ie.value=!1},De=()=>C.value>=0&&C.value<=100?"10%":C.value>100&&C.value<=250?"25%":C.value>250&&C.value<=500?"50%":C.value>500&&C.value<=750?"75%":"100%",xe=()=>k.value>=0&&k.value<=30?"30%":k.value>30&&k.value<=60?"60%":k.value>60&&k.value<=90?"90%":"100%",Oe=e=>"01"===e?{icon:["fas","person"],class:""}:"02"===e?{icon:["fas","person-walking"],class:""}:"03"===e?{icon:["fas","person-running"],class:"runRed"}:"04"===e||"05"===e?{icon:["fas","person-running"],class:"runBlue"}:{icon:["fas","person"],class:""},Ke=()=>{"viewer"!==v.value?_.value=!0:_e("Access is only available from the main PC.")},Be=e=>{_.value=e},Fe=()=>{Ue();const e=J().embedStatus.settings;e.reqUserId=M,Object.assign(e,{oilCount:C,isOilReset:"Y",userId:"",isNsNbIntegration:x.value||""}),Nt.publish("childEmitSocketData",e),Ee(U.IDS_MSG_SUCCESS)},Ue=()=>{if(!T.value||!A.value)return;const e=Math.min(Math.round(C.value/P.value*100),100),t=e/100*T.value.offsetWidth+"px";A.value.style.width=t},Xe=()=>{null!==g&&clearTimeout(g),p.value=!0,J().embedStatus.oilPrime.reqUserId=M,Nt.publish("childEmitSocketData",J().embedStatus.oilPrime),g=setTimeout((()=>{p.value=!1,g=null}),1500)},$e=()=>{Ue()},We=async()=>{try{const e=await le();if(e&&e?.data){const t=e.data;await u.dispatch("commonModule/setCommonInfo",{isNsNbIntegration:t.isNsNbIntegration?"Y":"N"}),W.value=t?.isAlarm?1e3*Number(t.alarmCount):5e3,await u.dispatch("dataBaseSetDataModule/setDataBaseSetData",{isNsNbIntegration:t?.isNsNbIntegration?"Y":"N"}),sessionStorage.setItem("isNsNbIntegration",t.isNsNbIntegration?"Y":"N"),sessionStorage.setItem("wbcPositionMargin",t?.diffWbcPositionMargin),sessionStorage.setItem("rbcPositionMargin",t?.diffRbcPositionMargin),sessionStorage.setItem("pltPositionMargin",t?.diffPltPositionMargin),sessionStorage.setItem("edgeShotType",String(t?.edgeShotType)),sessionStorage.setItem("edgeShotLPCount",String(t?.edgeShotLPCount)),sessionStorage.setItem("edgeShotHPCount",String(t?.edgeShotHPCount)),sessionStorage.setItem("iaRootPath",t?.iaRootPath),await u.dispatch("commonModule/setCommonInfo",{iaRootPath:String(t?.iaRootPath)}),await u.dispatch("commonModule/setCommonInfo",{showLISUploadAfterCheckingAll:t?.lisUploadCheckAll})}}catch(e){console.error(e)}},He=e=>{de.value=e,setTimeout((()=>{de.value=""}),1500)},Ge=()=>{N.value=!1},Ye=async()=>{N.value=!0,pe.value=!0,await he()},Ve=()=>{ve.value||(pe.value=!1,N.value=!1)},je=()=>{pe.value=!1,N.value=!1,ve.value=!1},Qe=(e,t)=>{ge[e]=t};return(e,r)=>{const c=(0,s.g2)("font-awesome-icon"),u=(0,s.g2)("router-link");return(0,s.uX)(),(0,s.CE)(s.FK,null,[(0,s.Lk)("header",jw,[(0,s.Lk)("nav",null,[a.value?(0,s.Q3)("",!0):((0,s.uX)(),(0,s.CE)("div",{key:0,class:(0,n.C4)(["appHeaderLeft",{bmComponent:se.value}])},[(0,s.Lk)("div",Qw,[r[6]||(r[6]=(0,s.Lk)("img",{src:i,class:"headerLogo"},null,-1)),(0,s.Lk)("p",qw,(0,n.v_)(se.value?"BM":"PB"),1)]),(0,s.bF)(u,{to:G.value?"#":"/setting",class:(0,n.C4)({leftActive:Te("/setting"),disabledLink:G.value})},{default:(0,s.k6)((()=>[(0,s.bF)(c,{icon:["fas","gear"],style:{"font-size":"1rem"}}),r[7]||(r[7]=(0,s.Lk)("span",{class:"icoText"},"Setting",-1))])),_:1},8,["to","class"]),"main"===v.value?((0,s.uX)(),(0,s.Wv)(u,{key:0,to:"/",class:(0,n.C4)({leftActive:Te("/analysis")||"/"===(0,o.R1)(t).path})},{default:(0,s.k6)((()=>[(0,s.bF)(c,{icon:["fas","chart-pie"],style:{"font-size":"1rem"}}),r[8]||(r[8]=(0,s.Lk)("span",{class:"icoText"},"Analysis",-1))])),_:1},8,["class"])):(0,s.Q3)("",!0),(0,s.bF)(u,{to:"/dataBase",class:(0,n.C4)({leftActive:Te("/dataBase")||Te("/databaseDetail")||Te("/databaseRbc")||Te("/report")||Te("/databaseWhole")})},{default:(0,s.k6)((()=>[(0,s.bF)(c,{icon:["fas","server"],style:{"font-size":"1rem"}}),r[9]||(r[9]=(0,s.Lk)("span",{class:"icoText"},"Database",-1))])),_:1},8,["class"]),"100a"===oe.value?((0,s.uX)(),(0,s.CE)("div",Jw,[(0,s.bF)(Ow,{text:"Auto Start",value:ce.value,gradientStart:"#2196f3",gradientEnd:"#03a9f4",animationDuration:.3,showGlowEffect:!0},null,8,["value"])])):(0,s.Q3)("",!0),(0,s.Lk)("div",zw,[(0,s.Lk)("div",Zw,[(0,s.Lk)("ul",null,[(0,s.Lk)("li",null,(0,n.v_)(fe.value)+" "+(0,n.v_)(ye.value),1),(0,s.Lk)("li",eN,[(0,s.Lk)("div",{class:"cursorPointer userBox",onClick:be},[(0,s.bF)(c,{icon:["fas","circle-user"]}),(0,s.eW)(" "+(0,n.v_)(D.value.userId),1)]),(0,s.bo)((0,s.Lk)("ul",{class:"userSetOutUl",onClick:r[0]||(r[0]=(0,l.D$)((()=>{}),["stop"]))},[(0,s.Lk)("li",{onClick:Ae},"LOGOUT")],512),[[l.aG,ie.value]]),(0,s.Lk)("div",{class:"logOutBox",onClick:Me}," EXIT "),(0,s.Lk)("div",{class:"logOutBox",onClick:we},"FULL SCREEN")])])]),(0,s.Lk)("div",tN,[(0,s.Lk)("ul",null,[(0,s.Lk)("li",{class:"alarm",onClick:Ce,onMouseover:Ye,onMouseleave:Ve},[(0,s.bF)(c,{icon:["fas","bell"],class:(0,n.C4)({"blinking-red":B.value,"blinking-blue":K.value})},null,8,["class"]),N.value?((0,s.uX)(),(0,s.Wv)(Vw,{key:0,onClick:r[1]||(r[1]=(0,l.D$)((()=>{}),["stop"])),onCloseErrLog:Ge,ErrLogOpen:N.value,errArr:ue.value,onErrMouseSet:je},null,8,["ErrLogOpen","errArr"])):(0,s.Q3)("",!0)],32),(0,s.Lk)("li",null,["Y"!==h.value?((0,s.uX)(),(0,s.Wv)(c,{key:0,icon:["fas","door-closed"]})):((0,s.uX)(),(0,s.Wv)(c,{key:1,icon:["fas","door-open"],style:{color:"red"}}))]),(0,s.Lk)("li",null,[(0,s.bF)(c,{icon:R.value.icon,class:(0,n.C4)(R.value.class)},null,8,["icon","class"])]),(0,s.Lk)("li",{class:"oliCount pos-relative",onClick:Ke},[(0,s.bF)(c,{icon:["fas","droplet"],onMouseenter:r[2]||(r[2]=e=>Qe("oilPrime",!0)),onMouseleave:r[3]||(r[3]=e=>Qe("oilPrime",!1))}),(0,s.bF)(rn,{isVisible:ge.oilPrime,className:"mb08",position:"bottom",type:"",message:`OilCount: ${L.value||0}`},null,8,["isVisible","message"])]),(0,s.Lk)("li",aN,[(0,s.bF)(c,{icon:["fas","database"],onMouseenter:r[4]||(r[4]=e=>Qe("storage",!0)),onMouseleave:r[5]||(r[5]=e=>Qe("storage",!1))}),(0,s.bF)(rn,{isVisible:ge.storage,className:"mb08",position:"bottom",type:"",message:`Storage: ${E.value||0}`},null,8,["isVisible","message"])])])])])],2))])]),_.value?((0,s.uX)(),(0,s.Wv)(ac,{key:0,"onUpdate:closeLayer":Be,onAfterOpen:$e},{header:(0,s.k6)((()=>r[10]||(r[10]=[(0,s.Lk)("h2",null,"Immersion Oil",-1)]))),content:(0,s.k6)((()=>[(0,s.Lk)("div",lN,[r[12]||(r[12]=(0,s.Lk)("h5",{class:"modalTitle mb10"},"Immersion Oil count Reset",-1)),r[13]||(r[13]=(0,s.Lk)("span",{class:"grayText"},"Reset Immersion Oil count after changing Oil pack",-1)),(0,s.Lk)("div",sN,[r[11]||(r[11]=(0,s.Lk)("span",null,"Estimated number of slides left",-1)),(0,s.Lk)("span",oN,(0,n.v_)(C.value),1)]),(0,s.Lk)("div",nN,[(0,s.Lk)("div",{ref_key:"statusBarWrapper",ref:T,class:"statusBarWrapper"},[(0,s.Lk)("div",{ref_key:"statusBar",ref:A,class:"statusBar"},null,512)],512),(0,s.Lk)("div",null,[(0,s.Lk)("button",{onClick:Fe,class:"alertButton"},"Reset")])])]),(0,s.Lk)("div",iN,[r[15]||(r[15]=(0,s.Lk)("h5",{class:"modalTitle mb10"},"Prime Immersion Oil",-1)),r[16]||(r[16]=(0,s.Lk)("span",{class:"grayText mt10"},"Prime oil to remove air from the oil hose",-1)),(0,s.Lk)("div",rN,[r[14]||(r[14]=(0,s.Lk)("div",{class:"statusBarWrapper"},null,-1)),(0,s.Lk)("button",{type:"button",onClick:Xe,class:(0,n.C4)({alertButton:!0,blinkGripper:p.value})},"Prime ",2)])])])),_:1})):(0,s.Q3)("",!0),ee.value?((0,s.uX)(),(0,s.Wv)(Pt,{key:1,"is-visible":ee.value,type:te.value,message:ae.value,onHide:Pe,"onUpdate:hideAlert":Pe},null,8,["is-visible","type","message"])):(0,s.Q3)("",!0),f.value?((0,s.uX)(),(0,s.Wv)(ra,{key:2,"is-visible":f.value,type:y.value,message:b.value,onHide:Se,onOkConfirm:ke},null,8,["is-visible","type","message"])):(0,s.Q3)("",!0),de.value?((0,s.uX)(),(0,s.Wv)(Eb,{key:3,message:de.value,messageType:me.value,duration:1500,position:"bottom-right"},null,8,["message","messageType"])):(0,s.Q3)("",!0)],64)}}});const uN=cN;var dN=uN;const mN=[{id:"01",title:"NE",name:"Neutrophil",count:0,percent:0,key:"",order:1},{id:"71",title:"NS",name:"Neutrophil-Segmented",count:0,percent:0,key:"",order:2},{id:"72",title:"NB",name:"Neutrophil-Band",count:0,percent:0,key:"",order:3},{id:"02",title:"ME",name:"Metamyelocyte",count:0,percent:0,key:"",order:4},{id:"03",title:"MY",name:"Myelocyte",count:0,percent:0,key:"",order:5},{id:"04",title:"PR",name:"Promyelocyte",count:0,percent:0,key:"",order:6},{id:"05",title:"LY",name:"Lymphocyte",count:0,percent:0,key:"",order:7},{id:"61",title:"LR",name:"Reactive lymphocyte",count:0,percent:0,key:"",order:8},{id:"62",title:"LA",name:"Abnormal lymphocyte",count:0,percent:0,key:"",order:9},{id:"07",title:"MO",name:"Monocyte",count:0,percent:0,key:"",order:10},{id:"08",title:"EO",name:"Eosinophil",count:0,percent:0,key:"",order:11},{id:"09",title:"BA",name:"Basophil",count:0,percent:0,key:"",order:12},{id:"10",title:"BL",name:"Blast",count:0,percent:0,key:"",order:13},{id:"11",title:"PC",name:"Plasma cell",count:0,percent:0,key:"",order:14},{id:"12",title:"NR",name:"nRBC",count:0,percent:0,key:"",order:15},{id:"13",title:"GP",name:"Giant platelet",count:0,percent:0,key:"",order:16},{id:"14",title:"PA",name:"Platelet aggregation",count:0,percent:0,key:"",order:17},{id:"16",title:"MA",name:"Malaria",count:0,percent:0,key:"",order:18},{id:"15",title:"AR",name:"Artifact",count:0,percent:0,key:"",order:19},{id:"17",title:"SM",name:"Smudge",count:0,percent:0,key:"",order:20}],vN=[{id:"01",title:"NE",name:"Neutrophil",count:0,percent:0,order:1},{id:"71",title:"NS",name:"Neutrophil-Segmented",count:0,percent:0,key:"",order:2},{id:"72",title:"NB",name:"Neutrophil-Band",count:0,percent:0,key:"",order:3},{id:"02",title:"ME",name:"Metamyelocyte",count:0,percent:0,order:4},{id:"03",title:"MY",name:"Myelocyte",count:0,percent:0,order:5},{id:"04",title:"PR",name:"Promyelocyte",count:0,percent:0,order:6},{id:"05",title:"LY",name:"Lymphocyte",count:0,percent:0,order:7},{id:"06",title:"LA",name:"Abnormal lymphocyte",count:0,percent:0,order:8},{id:"07",title:"MO",name:"Monocyte",count:0,percent:0,order:9},{id:"08",title:"EO",name:"Eosinophil",count:0,percent:0,order:10},{id:"09",title:"BA",name:"Basophil",count:0,percent:0,order:11},{id:"10",title:"BL",name:"Blast",count:0,percent:0,order:12},{id:"11",title:"PC",name:"Plasma cell",count:0,percent:0,order:13},{id:"12",title:"ON",name:"Orthochromic Normoblast",count:0,percent:0,order:14},{id:"13",title:"PN",name:"Polychromic Normoblast",count:0,percent:0,order:15},{id:"14",title:"BN",name:"Basophilic Normoblast",count:0,percent:0,order:16},{id:"15",title:"PE",name:"Proerythroblast",count:0,percent:0,order:17},{id:"16",title:"HC",name:"Histiocyte",count:0,percent:0,order:18},{id:"17",title:"OT",name:"Others",count:0,percent:0,order:19}],pN=async e=>{if("00000"===e?.resultCd){const t={embeddedStatusJobCmd:"",userStop:"Y"===e.isRecovery,isRecoveryRun:"N"===e.isRecovery&&!1,isPause:"PAUSE"===e.jobCmd,sysInfo:e,isInit:e?e.isInit:void 0},a={siteCd:e.siteCd,deviceSerialNm:e.deviceBarcode};return await Hr.dispatch("commonModule/setCommonInfo",a),await Hr.dispatch("embeddedStatusModule/setEmbeddedStatusInfo",t),null}return await Hr.dispatch("commonModule/setCommonInfo",{appAlertOpen:!0}),e?.resultMsg},gN=async e=>{await Hr.dispatch("runningInfoModule/setRunningInfo",e)};var fN=(0,s.pM)({__name:"App",setup(e){const t=(0,r.rd)(),a=(0,o.KR)(!1),l=(0,o.KR)(""),i=(0,o.KR)(""),u=(0,c.Pj)(),d=(0,s.EW)((()=>u.state.commonModule)),m=(0,s.nI)(),v=(0,o.KR)(""),p=sessionStorage.getItem("user"),g=JSON.parse(p||"{}"),f=(0,o.KR)([]),y=(0,s.EW)((()=>u.state.userModule)),b=(0,s.EW)((()=>u.state.commonModule)),C=(0,o.KR)(!1);let h=null,k=null;const S=(0,s.EW)((()=>u.state.commonModule.iaRootPath)),w=(0,s.EW)((()=>u.state.commonModule.slotIndex)),N=(0,s.EW)((()=>u.state.commonModule.siteCd)),R=(0,s.EW)((()=>u.state.commonModule.inhaTestCode)),L=(0,s.EW)((()=>u.state.commonModule.isRewindingBelt)),E=(0,s.EW)((()=>u.state.commonModule.isNsNbIntegration)),_=(0,o.KR)([]),P=(0,o.KR)([]),T=(0,o.KR)([]),A=(0,o.KR)(""),M=(0,o.KR)(!1),D=(0,o.KR)({}),x=(0,o.KR)({}),O=(0,o.KR)(!1),K=(0,o.KR)(""),B=(0,o.KR)(""),F=(0,o.KR)(!1);let X;const $=(0,o.KR)(!1);let W;const H=(0,o.KR)(!1),G=(0,o.KR)(""),Y=(0,o.KR)(""),V=(0,o.KR)([]),j=(0,o.KR)([]),Q=(0,o.KR)([]),q=(0,o.KR)("");m?.appContext.config.globalProperties.$socket.on("isTcpConnected",(async e=>{e&&setTimeout((async()=>{await u.dispatch("commonModule/setCommonInfo",{isTcpConnected:!0})}),1500)})),m?.appContext.config.globalProperties.$socket.on("viewerCheck",(async e=>{await Z(e)}));const Z=async e=>{try{const e=await va();e.data,A.value=e.data}catch(t){console.error(t)}};function ee(){const{path:e}=t.currentRoute.value;"/user/login"!==e&&($.value=window.matchMedia("(display-mode: fullscreen)").matches,$.value?i.value===U.FULLSCREEN_SUGGEST&&he():be(U.FULLSCREEN_SUGGEST))}function te(){ee(),W=setInterval(ee,6e4)}(0,s.wB)(b.value,(async e=>{if(!e.reqArr)return;const t=ue(e.reqArr),a=t.filter((e=>!["SYSINFO","RUNNING_INFO"].includes(e.jobCmd)));return a.length>0?(await fe(a[0]),void await u.dispatch("commonModule/setCommonInfo",{reqArrPaste:[]})):F.value?(F.value=!1,void await u.dispatch("commonModule/setCommonInfo",{reqArrPaste:[]})):void(0!==t.length&&(a.length>0?await fe(a[0]):await fe(t[0]),await u.dispatch("commonModule/setCommonInfo",{reqArrPaste:[]})))})),(0,s.wB)(y.value,(e=>{""!==e.id&&(ye(),v.value=e.id)})),(0,s.KC)((()=>{m?.appContext.config.globalProperties.$socket.emit("viewerCheck",{type:"SEND_DATA",payload:window.APP_API_BASE_URL})})),window.addEventListener("beforeunload",(async function(e){await oo({userId:v.value}),await u.dispatch("commonModule/setCommonInfo",{firstLoading:!1})}));const ae=async e=>{if(e.preventDefault(),H.value)await Nt.publish("childEmitSocketData",J().embedStatus.exit);else{const e=await va(),t=`ip=${e.data}`,a=`http://${e.data}:3000/close?${t}`;await z.A.get(a)}};(0,s.KC)((()=>{M.value="bm"===window.PROJECT_TYPE,K.value=window.MACHINE_VERSION}));const se=(e,t)=>{const a=/http:\/\/([0-9]+\.[0-9]+\.[0-9]+\.[0-9]+):/,l=e.match(a);return!(!l||!l[1])&&l[1]===t};async function oe(e){if("main"===d.value.viewerCheck){F.value=!1;try{if("string"===typeof e)return void await be(U.TCP_DiSCONNECTED);const l=new TextDecoder("utf-8"),s=l.decode(e),o=JSON.parse(s),n=o;switch(i.value===U.TCP_DiSCONNECTED&&he(),n.jobCmd){case"RBC_RE_CLASSIFICATION":await u.dispatch("commonModule/setCommonInfo",{rbcReDataClass:!0}),await u.dispatch("commonModule/setCommonInfo",{rbcReData:!0}),await u.dispatch("commonModule/setCommonInfo",{rbcReDataCheck:!1});break;case"SYSINFO":x.value=n;const b=await pN(n);if(null!==b){Ce(b);const h=sessionStorage.getItem("isAlarm");"true"===h&&await u.dispatch("commonModule/setCommonInfo",{isErrorAlarm:!0})}break;case"INIT":G.value="",await u.dispatch("commonModule/setCommonInfo",{initValData:!1}),pe();break;case"START":G.value="",await c();break;case"RUNNING_INFO":D.value=n,C.value=!0,await gN(n),await m(n);break;case"STOP":console.log("stop!=--------------------------"),G.value="",await u.dispatch("commonModule/setCommonInfo",{isRunningState:!1}),await u.dispatch("timeModule/setTimeInfo",{totalSlideTime:"00:00:00"}),await u.dispatch("timeModule/setTimeInfo",{slideTime:"00:00:00"}),await u.dispatch("commonModule/setCommonInfo",{runningSlotId:""}),await u.dispatch("commonModule/setCommonInfo",{slotIndex:0}),await u.dispatch("commonModule/setCommonInfo",{runningArr:[]}),await u.dispatch("runningInfoModule/setSlideBoolean",{key:"slideBoolean",value:!1}),O.value=!1,C.value=!1;break;case"RUNNING_COMP":G.value="",await r();break;case"PAUSE":G.value="",await u.dispatch("embeddedStatusModule/setEmbeddedStatusInfo",{isPause:!0}),await u.dispatch("commonModule/setCommonInfo",{runningSlotId:""}),await u.dispatch("commonModule/setCommonInfo",{slotIndex:0}),await u.dispatch("commonModule/setCommonInfo",{runningArr:[]}),await u.dispatch("runningInfoModule/setSlideBoolean",{key:"slideBoolean",value:!1}),O.value=!1,C.value=!1;break;case"RESTART":G.value="",await gN(n),await m(n),await u.dispatch("embeddedStatusModule/setEmbeddedStatusInfo",{isPause:!1}),await u.dispatch("timeModule/setTimeInfo",{totalSlideTime:"00:00:00"}),await u.dispatch("timeModule/setTimeInfo",{slideTime:"00:00:00"}),C.value=!0,O.value=!0,await u.dispatch("commonModule/setCommonInfo",{runningSlotId:""}),await u.dispatch("commonModule/setCommonInfo",{slotIndex:0}),await u.dispatch("commonModule/setCommonInfo",{runningArr:[]}),P.value=[],T.value=[];break;case"RECOVERY":G.value="",await u.dispatch("embeddedStatusModule/setEmbeddedStatusInfo",{userStop:!1}),await u.dispatch("commonModule/setCommonInfo",{runningSlotId:""}),await u.dispatch("commonModule/setCommonInfo",{slotIndex:0}),await u.dispatch("commonModule/setCommonInfo",{runningArr:[]});break;case"ERROR_CLEAR":a.value=!1,console.log("ERROR CLEAR");break}async function r(){await u.dispatch("commonModule/setCommonInfo",{runningInfoStop:!0}),await u.dispatch("commonModule/setCommonInfo",{embeddedNumber:String(e?.iCasStat)}),await u.dispatch("commonModule/setCommonInfo",{startEmbedded:!1}),await u.dispatch("commonModule/setCommonInfo",{isRunningState:!1}),await u.dispatch("commonModule/setCommonInfo",{isCompleteAlarm:!0}),await u.dispatch("commonModule/setCommonInfo",{runningSlotId:""}),await u.dispatch("commonModule/setCommonInfo",{slotIndex:0}),await u.dispatch("commonModule/setCommonInfo",{runningArr:[]}),await u.dispatch("runningInfoModule/setChangeSlide",{key:"changeSlide",value:"stop"}),await u.dispatch("runningInfoModule/setSlideBoolean",{key:"slideBoolean",value:!1}),C.value=!1,O.value=!1}async function c(){await u.dispatch("commonModule/setCommonInfo",{isRunningState:!0}),await u.dispatch("runningInfoModule/setChangeSlide",{key:"changeSlide",value:"start"}),await u.dispatch("commonModule/setCommonInfo",{startEmbedded:"start"}),await u.dispatch("timeModule/setTimeInfo",{totalSlideTime:"00:00:00"}),await u.dispatch("timeModule/setTimeInfo",{slideTime:"00:00:00"}),await u.dispatch("commonModule/setCommonInfo",{runningInfoStop:!1}),await u.dispatch("commonModule/setCommonInfo",{slotIndex:0}),await u.dispatch("commonModule/setCommonInfo",{runningSlotId:""}),await u.dispatch("commonModule/setCommonInfo",{runningArr:[]}),O.value=!0,P.value=[],T.value=[],C.value=!0}async function m(e){const t=/[1,2,9]/g;if("999999999999"!==String(e?.iCasStat)){const a=String(e?.iCasStat),l=e?.slotInfo,s=e?.iCasStat,o=[...s],n=-1===o.lastIndexOf("3")?0:o.lastIndexOf("3")+1;if(-1!==o.lastIndexOf("2")&&await u.dispatch("runningInfoModule/setSlideBoolean",{key:"slideBoolean",value:!0}),-1!==e?.iCasStat.indexOf("2")&&await u.dispatch("commonModule/setCommonInfo",{slideProceeding:e?.iCasStat.indexOf("2")}),"100a"===K.value&&(B.value="1"===e?.iCasChange?"reset":""),a.search(t)<0||"111111111111"===e?.oCasStat&&!d.value.runningInfoStop)return J().embedStatus.runIngComp.reqUserId=y.value.userId,("100a"!==K.value||"Y"===e?.workingDone)&&(await u.dispatch("commonModule/setCommonInfo",{reqArr:J().embedStatus.runIngComp}),await u.dispatch("commonModule/setCommonInfo",{runningInfoStop:!0})),void await p(e,e?.slotInfo?.slotNo);await u.dispatch("runningInfoModule/setChangeSlide",{key:"changeSlide",value:"start"}),"Y"===l?.isLowPowerScan&&"03"===l?.testType?(J().embedStatus.pause.reqUserId=v.value,await u.dispatch("commonModule/setCommonInfo",{reqArr:J().embedStatus.pause}),J().embedStatus.pause.reqUserId=v.value,await u.dispatch("commonModule/setCommonInfo",{isRunningState:!1})):n!==w.value&&(await u.dispatch("runningInfoModule/setChangeSlide",{key:"changeSlide",value:"afterChange"}),await u.dispatch("runningInfoModule/setSlideBoolean",{key:"slideBoolean",value:!0}),await p(_.value,_.value?.slotInfo?.slotNo),await u.dispatch("commonModule/setCommonInfo",{runningSlotId:l?.slotId}),await u.dispatch("commonModule/setCommonInfo",{slotIndex:n})),-1!==o.lastIndexOf("2")&&(_.value=e)}}async function p(e,t,a,l){const s=e.slotInfo;if(s){s.userId=v.value,s.cassetId=e.cassetId,s.isNormal="Y";const{isNormal:o,classInfo:n}=KS(s.wbcInfo,f.value);s.isNormal=o;const i=P.value.filter((e=>e?.slotId===s.slotId)),r=T.value.filter((e=>e?.slotId===s.slotId)),c=i[0],u={wbcInfo:c?.wbcInfo,nonRbcClassList:c?.nonRbcClassList,totalCount:c?.totalCount,maxWbcCount:c?.maxWbcCount};let d=[],m=[];const p=()=>M.value?{wbcInfo:[vN]}:{wbcInfo:[mN]},b=()=>M.value?[vN]:[mN],C=S.value,h=M.value?"04_BM_Classification":"01_WBC_Classification",k=`${C}/${s.slotId}/${h}/${s.slotId}.json`,w=await Ro({fullPath:k});for(const e of u?.wbcInfo[0])e.images||(e.images=[]);for(const e of w?.data){const t=e.FILE_NM?.split("_")[0];let a="";a="Y"===E.value?"NEB"===t||"NES"===t?"NE":t:"NES"===t?"NS":"NEB"===t?"NB":t;const l=u?.wbcInfo[0].findIndex((e=>e.title===a));-1!==l&&u?.wbcInfo[0][l].images.push({fileName:e.FILE_NM})}const L=()=>0===Object.keys(u).length?p():u,_=()=>0===Object.keys(u).length?b():u?.wbcInfo[0],A=M.value?[]:r[0].rbcInfo;let D="";N.value===I["인하대병원"]&&"04"!==s.testType?(u.wbcInfo[0]=await xd(s,_()),m=L(),d=_(),G.value!==s.barcodeNo&&(await wp(Y.value,s,V.value,"lisUpload"),await Np(d,A,s.barcodeNo,q.value,R.value,j.value,Q.value,s,y.value.id),G.value=s?.barcodeNo,D="lisCbc")):(m=L(),d=_(),D="");const x="100a"===K.value?`${e.traySlot}`:"1",O={slotNo:s.slotNo,lock_status:!1,traySlot:x+"-"+t,barcodeNo:s.barcodeNo,patientId:s.patientId,patientNm:s.patientNm,gender:s.gender,birthDay:s.birthDay,wbcCount:s.wbcCount,slotId:s.slotId,orderDttm:s.orderDttm,testType:s.testType,analyzedDttm:J().embedStatus.settings.saveReqDttm,tactTime:s.tactTime,maxWbcCount:s.maxWbcCount,bf_lowPowerPath:s.bf_lowPowerPath,wbcInfo:m,wbcInfoAfter:d,rbcInfo:M.value?[]:{pltCount:s.pltCount,malariaCount:s.malariaCount,maxRbcCount:s.maxRbcCount,rbcClass:r[0].rbcInfo},rbcInfoAfter:A,bminfo:s.bminfo,cassetId:s.cassetId,isNormal:s.isNormal,submitState:D,submitOfDate:"",submitUserId:"",isNsNbIntegration:E.value||"",wbcMemo:"",rbcMemo:"",abnormalClassInfo:n};await g(O,a,l)}}async function g(e,t,a){try{let a;a=await wd({userId:Number(v.value),runingInfoDtoItems:e}),a&&(t&&console.log("save successful"),ie("SEND_DATA","refreshDb",300))}catch(l){console.error(l)}}}catch(t){console.error(t)}}}(0,s.sV)((async()=>{await(0,s.dY)(),await ye(),await ge(),await ne(),te();const e=await va();if(H.value=se(window.APP_API_BASE_URL,e.data),!M.value){Y.value=await _p(),V.value=await Pp();const{lisCodeWbcArr:e,lisCodeRbcArr:t}=await Lp();j.value=e,Q.value=t;const{lisFilePathSetArr:a}=await Ep();q.value=a}window.addEventListener("beforeunload",ae),""===v.value&&(await u.dispatch("userModule/setUserAction",g),v.value=y.value.id),d.value.isRunningState||!d.value.firstLoading&&H.value&&"main"===window.FORCE_VIEWER&&(h=setInterval((async()=>{await de()}),400),k=setInterval((async()=>{d.value.runningInfoStop||await me()}),500),await u.dispatch("commonModule/setCommonInfo",{firstLoading:!0})),Nt.subscribe("childEmitSocketData",ve)})),(0,s.xo)((async()=>{window.removeEventListener("beforeunload",ae),k&&(clearInterval(k),k=null),h&&(clearInterval(k),k=null)})),m?.appContext.config.globalProperties.$socket.on("chat",(async e=>{await oe(e)}));const ne=async()=>{try{const e=await da();e&&(sessionStorage.setItem("autoStart",e.data[0]?.autoStart),await u.dispatch("commonModule/setCommonInfo",{siteCd:e.data[0]?.siteCd}),localStorage.setItem("siteCd",e.data[0]?.siteCd))}catch(e){console.error("Error handling device information",e)}},ie=(e,t,a)=>{void 0!==X&&clearTimeout(X),X=window.setTimeout((()=>{m?.appContext.config.globalProperties.$socket.emit("state",{type:"SEND_DATA",payload:"refreshDb"})}),a)},re=e=>{T.value[e.iCasStatArr]=e.rbc},ce=e=>{P.value[e.iCasStatArr]=e.classInfo},ue=e=>{const t=new Set,a=[];return e.forEach((e=>{t.has(e.jobCmd)||(t.add(e.jobCmd),a.push(e))})),a},de=async()=>{J().embedStatus.sysInfo.reqUserId=v.value;const e=J().embedStatus.sysInfo;let t=sessionStorage.getItem("autoStart")||1;"true"===t?t=1:"false"===t&&(t=0),"100a"===window.MACHINE_VERSION&&(Object.assign(e,{isRewindingBelt:L.value}),Object.assign(e,{autoStart:t})),await u.dispatch("commonModule/setCommonInfo",{reqArr:e})},me=async()=>{if(!C.value)return;J().embedStatus.runningInfo.reqUserId=v.value;const e=J().embedStatus.runningInfo;await u.dispatch("commonModule/setCommonInfo",{reqArr:e})},ve=async e=>{await u.dispatch("commonModule/setCommonInfo",{reqArr:e}),await u.dispatch("commonModule/setCommonInfo",{rbcReDataCheck:!0})},pe=()=>{const e={jobCmd:"SETTINGS",reqUserId:"",reqDttm:J().embedStatus.settings.reqDttm,pbiaRootDir:S.value||"",oilCount:"1000",isOilReset:"N",deviceType:"01",isNsNbIntegration:E.value};u.dispatch("commonModule/setCommonInfo",{reqArr:e})},ge=async()=>{try{const e=await Ie();if(e&&e?.data){const t=e.data;f.value=t}}catch(e){console.error(e)}},fe=async e=>{const t=async()=>{m?.appContext.config.globalProperties.$socket.emit("message",{type:"SEND_DATA",payload:e})};await t(),F.value=!0},ye=async()=>{try{const e=await le();if(e&&e?.data){const t=e.data;sessionStorage.setItem("iaRootPath",t?.iaRootPath),await u.dispatch("commonModule/setCommonInfo",{iaRootPath:String(t?.iaRootPath)}),await u.dispatch("dataBaseSetDataModule/setDataBaseSetData",{isNsNbIntegration:t?.isNsNbIntegration?"Y":"N"}),await u.dispatch("commonModule/setCommonInfo",{isNsNbIntegration:t?.isNsNbIntegration?"Y":"N"}),sessionStorage.setItem("isNsNbIntegration",t?.isNsNbIntegration?"Y":"N"),sessionStorage.setItem("wbcPositionMargin",t?.diffWbcPositionMargin),sessionStorage.setItem("rbcPositionMargin",t?.diffRbcPositionMargin),sessionStorage.setItem("pltPositionMargin",t?.diffPltPositionMargin),sessionStorage.setItem("isAlarm",String(t?.isAlarm));const a="pb"===window.PROJECT_TYPE?"keepPage":"bmKeepPage";sessionStorage.setItem(a,String(t?.keepPage)),await u.dispatch("commonModule/setCommonInfo",{showLISUploadAfterCheckingAll:t?.lisUploadCheckAll}),sessionStorage.setItem("edgeShotType",String(t?.edgeShotType)),sessionStorage.setItem("edgeShotLPCount",String(t?.edgeShotLPCount)),sessionStorage.setItem("edgeShotHPCount",String(t?.edgeShotHPCount)),sessionStorage.setItem("keepPage",String(t?.keepPage))}}catch(e){console.error(e)}},be=async e=>{a.value=!0,l.value="success",i.value=e},Ce=e=>{a.value=!0,l.value="coreError",i.value=e},he=()=>{"coreError"===l.value&&ke(),a.value=!1},ke=async()=>{await u.dispatch("commonModule/setCommonInfo",{reqArr:J().embedStatus.errorClear})};return(e,r)=>{const c=(0,s.g2)("router-view");return(0,s.uX)(),(0,s.CE)("div",null,["/user/login"!==(0,o.R1)(t).currentRoute.value.path&&"/user/join"!==(0,o.R1)(t).currentRoute.value.path?((0,s.uX)(),(0,s.Wv)(dN,{key:0})):(0,s.Q3)("",!0),(0,s.Lk)("main",{class:(0,n.C4)(["content",{bmComponent:M.value}])},[(0,s.bF)(c),(0,s.bF)(zs,{onClassAppUpdateLast:ce,onRbcAppUpdate:re,parsedData:D.value,parsedDataSysInfo:x.value,isClass:"/"===(0,o.R1)(t).currentRoute.value.path,startStatus:O.value,pb100aCassette:B.value},null,8,["parsedData","parsedDataSysInfo","isClass","startStatus","pb100aCassette"])],2),a.value?((0,s.uX)(),(0,s.Wv)(Pt,{key:1,"is-visible":a.value,type:l.value,message:i.value,onHide:he,onErrorClear:ke,"onUpdate:hideAlert":he},null,8,["is-visible","type","message"])):(0,s.Q3)("",!0)])}}});const yN=fN;var bN=yN,IN=a(7107),CN=a(6188),hN=a(1273),kN=a(4787);const SN=window.MAIN_WEBSOCKET_IP||"http://192.168.0.131:3002",wN={install:e=>{const t=(0,kN.io)(`${SN}`,{transports:["websocket"],withCredentials:!0,reconnection:!0,reconnectionAttempts:15,reconnectionDelay:3e3,timeout:3e4});let a=null;function l(){t.connected&&(t.emit("ping"),console.log("Ping sent to server")),a=setTimeout(l,1e4)}t.on("connect",(()=>{console.log("WebSocket connected"),e.config.globalProperties.$socketError=!1,l(),a&&(clearTimeout(a),a=null)})),t.on("disconnect",(()=>{console.log("WebSocket disconnected"),e.config.globalProperties.$socketError=!0,console.log("연결이 끊어졌습니다. 재연결을 시도합니다."),l(),a&&(clearTimeout(a),a=null)})),t.on("connect_error",(t=>{console.error("WebSocket connection error:",t),e.config.globalProperties.$socketError=!0,l(),a&&(clearTimeout(a),a=null),console.log("서버와의 연결에 문제가 발생했습니다. 재연결을 시도합니다.")})),t.on("pong",(e=>{console.log(`Pong received with latency: ${e}ms`)})),e.config.globalProperties.$socket=t,e.config.globalProperties.$socketError=!1}};var NN=wN;const RN={prefix:"fac",iconName:"half-circle-up",icon:[512,512,[],"e002","M256 0c141.385 0 256 114.615 256 256H0C0 114.615 114.615 0 256 0z"]},LN={prefix:"fac",iconName:"half-circle-down",icon:[512,512,[],"e003","M256 512c-141.385 0-256-114.615-256-256h512c0 141.385-114.615 256-256 256z"]};var EN=a(3950),_N=a(88);const PN=window.APP_API_BASE_URL||"http://192.168.0.131:3002",TN=new EN.R({uri:`${PN}/graphql`,cache:new _N.D({})});function AN(){(0,av._5)(TN)}IN.Yv.add(CN.X7I),IN.Yv.add(CN.GEE),IN.Yv.add(RN),IN.Yv.add(LN);const MN=(0,l.Ef)(bN);MN.use(Pw),MN.use(Hr),MN.use(NN),MN.component("font-awesome-icon",hN.gc),AN(),MN.mount("#app")}},t={};function a(l){var s=t[l];if(void 0!==s)return s.exports;var o=t[l]={id:l,loaded:!1,exports:{}};return e[l].call(o.exports,o,o.exports,a),o.loaded=!0,o.exports}a.m=e,function(){var e=[];a.O=function(t,l,s,o){if(!l){var n=1/0;for(u=0;u<e.length;u++){l=e[u][0],s=e[u][1],o=e[u][2];for(var i=!0,r=0;r<l.length;r++)(!1&o||n>=o)&&Object.keys(a.O).every((function(e){return a.O[e](l[r])}))?l.splice(r--,1):(i=!1,o<n&&(n=o));if(i){e.splice(u--,1);var c=s();void 0!==c&&(t=c)}}return t}o=o||0;for(var u=e.length;u>0&&e[u-1][2]>o;u--)e[u]=e[u-1];e[u]=[l,s,o]}}(),function(){a.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return a.d(t,{a:t}),t}}(),function(){a.d=function(e,t){for(var l in t)a.o(t,l)&&!a.o(e,l)&&Object.defineProperty(e,l,{enumerable:!0,get:t[l]})}}(),function(){a.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){a.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){a.nmd=function(e){return e.paths=[],e.children||(e.children=[]),e}}(),function(){a.p="/"}(),function(){var e={524:0};a.O.j=function(t){return 0===e[t]};var t=function(t,l){var s,o,n=l[0],i=l[1],r=l[2],c=0;if(n.some((function(t){return 0!==e[t]}))){for(s in i)a.o(i,s)&&(a.m[s]=i[s]);if(r)var u=r(a)}for(t&&t(l);c<n.length;c++)o=n[c],a.o(e,o)&&e[o]&&e[o][0](),e[o]=0;return a.O(u)},l=self["webpackChunkuimdCell"]=self["webpackChunkuimdCell"]||[];l.forEach(t.bind(null,0)),l.push=t.bind(null,l.push.bind(l))}();var l=a.O(void 0,[504],(function(){return a(2963)}));l=a.O(l)})();
//# sourceMappingURL=app.3d263835.js.map